%============================================================================
% XeLaTeX File
% Daniel J. Greenhoe
%============================================================================

%=======================================
\chapter{Magnitude characteristics of z-filters}
%=======================================

%---------------------------------------
\# 1: The magnitude response (MR) repeats every $2\pi$ (every $F_s$)
%---------------------------------------

\begin{align*}
  \abs{\Fh(\omega-2\pi n)}^2
    &\eqd \abs{\Zh(z)}^2_{z=e^{i(\omega-2\pi n)}}
    && \text{by definition of $\Fh(\omega)$}
  \\&\eqd \abs{\sum_{m=0}^{\xN} \fx[m] z^{-m}}^2_{z=e^{i(\omega-2\pi n)}}
    &&\text{by definition of $\opZ$}
  \\&= \abs{\sum_{m=0}^{\xN} \fx[m] e^{-i\omega m}\cancelto{1}{e^{-i2\pi nm}}}^2
  \\&\eqd \abs{\Fh(\omega)}^2
    && \text{by definition of $\Fh(\omega)$}
\end{align*}


%---------------------------------------

\# 2: If the coefficients are \propb{real}, then the MR is \propb{symmetric}
%---------------------------------------

{\begin{align*}
  \boxed{\abs{H(\omega)}^2}
    &= \abs{H(z)}^2_{z=e^{i\omega}}
     = \brlr{H(z)H^\ast(z)}_{z=e^{i\omega}}
     = \brlr{
         \brp{\frac{\ds\sum_{n=0}^{\xN}b_nz^{-n}}
                   {\ds\sum_{n=0}^{\xN}a_nz^{-n}}}
         \brp{\frac{\ds\sum_{n=0}^{\xN}b_nz^{-n}}
                   {\ds\sum_{n=0}^{\xN}a_nz^{-n}}}^\ast
         }_{z=e^{i\omega}}
  \\&= \brp{\frac{\ds\sum_{n=0}^{\xN}b_ne^{-i\omega n}}
                 {\ds\sum_{n=0}^{\xN}a_ne^{-i\omega n}}}  
       \brp{\frac{\ds\sum_{n=0}^{\xN}b_ne^{-i\omega n}}
                 {\ds\sum_{n=0}^{\xN}a_ne^{-i\omega n}}}^\ast
     = \brp{\frac{\ds\sum_{n=0}^{\xN}b_ne^{-i(-\omega) n}}
                 {\ds\sum_{n=0}^{\xN}a_ne^{-i(-\omega) n}}}  
       \brp{\frac{\ds\sum_{n=0}^{\xN}b_ne^{-i(-\omega) n}}
                 {\ds\sum_{n=0}^{\xN}a_ne^{-i(-\omega) n}}}^\ast
  \\&= H(-\omega)H^\ast(-\omega)
     = \boxed{\abs{H(-\omega)}^2}
\end{align*}}



%---------------------------------------

\# 3: MR is flat at $0$ Hertz
%---------------------------------------

\begin{align*}
  \abs{\Zh(z)}^2_{z=e^{i\omega}}  
    &= \brs{\Zh(z)\Zh^\ast(z)}_{z=e^{i\omega}}
  \\&= \brp{\frac{\ds\sum_{n=0}^{\xN}b_n z^{-n}}{\ds\sum_{n=0}^{\xN}a_n z^{-n}}}_{z=e^{i\omega}}  
       \brp{\frac{\ds\sum_{n=0}^{\xN}b_n z^{-n}}{\ds\sum_{n=0}^{\xN}a_n z^{-n}}}_{z=e^{-i\omega}}  
  \\&= \brp{\frac{\ds\sum_{n=0}^{\xN}b_n e^{-i\omega n}\ds\sum_{m=0}^{\xN}b_m e^{i\omega m}}
                 {\ds\sum_{n=0}^{\xN}a_n e^{-i\omega n}\ds\sum_{m=0}^{\xN}a_m e^{i\omega m}}}
  \\&=     {\frac{\ds\sum_{n=0}^{\xN}\ds\sum_{m=0}^{\xN} b_n b_m e^{-i\omega(n-m)}}
                 {\ds\sum_{n=0}^{\xN}\ds\sum_{m=0}^{\xN} a_n a_m e^{-i\omega(n-m)}}}
  \\&=     {\frac{\ds\sum_{n=0}^{\xN}b_n^2 + 2\sum_{n=0}^{\xN}\ds\sum_{m=n}^{\xN} b_n b_m \cos\brs{\omega(n-m)}}
                 {\ds\sum_{n=0}^{\xN}a_n^2 + 2\sum_{n=0}^{\xN}\ds\sum_{m=n}^{\xN} a_n a_m \cos\brs{\omega(n-m)}}}
\end{align*}



\begin{align*}
  \ddw\abs{\Zh(z)}^2_{z=e^{i\omega},\omega=0}  
    &= \ddw\brs{\Zh(z)\Zh^\ast(z)}_{z=e^{i\omega},\omega=0}
  \\&= \ddw\brs{\frac{\ds\sum_{n=0}^{\xN}b_n^2 + 2\sum_{n=0}^{\xN}\ds\sum_{m=n}^{\xN} b_n b_m \cos\brs{\omega(n-m)}}
                 {\ds\sum_{n=0}^{\xN}a_n^2 + 2\sum_{n=0}^{\xN}\ds\sum_{m=n}^{\xN} a_n a_m \cos\brs{\omega(n-m)}}}_{\omega=0}
  \\&= \ddw\brs{\frac{\ff(\omega)}{\fg(\omega)}}_{\omega=0}
  \\&= \brs{\frac{\ff'(\omega)\fg(\omega) - \ff(\omega)\fg'(\omega)}{\fg^2(\omega)}}_{\omega=0}
  \\&= 0
\end{align*}

















