%============================================================================
% LaTeX File
% Daniel J. Greenhoe
%============================================================================
%=======================================
\chapter{Additive noise}
%=======================================
%=======================================
\section{Effects of additive noise}
%=======================================
%---------------------------------------
\begin{minipage}{\tw-55mm}
\begin{theorem}
\label{thm:xvy}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated to the right:
\end{theorem}
\end{minipage}
\qquad\tbox{\includegraphics{graphics/sys_xvy.pdf}}
\thmbox{
  %\brbr{\begin{array}{@{\hspace{2pt}}FrclDD}
  %    (A).& \Rxx(n_1,m)             &=& \Rxx(n_2,m)         &(\prope{WSS})          & and
  %  \\(B).& \pE\brs{\rvx(n)\rvv(n)} &=&\pE\rvx(n)\pE\rvv(n) &(\prope{uncorrelated}) & and
  %  \\(C).& \pE\rvv(n)              &=& 0                   & (\prope{zero-mean})
  %\end{array}}
  \brbr{\begin{array}{@{\hspace{2pt}}FMMD}
      (A).& $\rvx(n)$ is                & \prope{WSS}          & and 
    \\(B).& $\rvx(n)$ and $\rvv(n)$ are & \prope{uncorrelated} & and
    \\(C).& $\rvv(n)$ is                & \prope{zero-mean}
  \end{array}}
  \implies
  \brbl{\begin{array}{FrclD}
      (1).&\Ryv(m) &=&           \Rvv(m) & and
    \\(2).&\Ryy(m) &=&           \Rxx(m) + \Rvv(m) & and
    \\(3).&\Rxx(m) &=& \mc{2}{l}{\Ryy(m) + \Rvv(m) - 2\Real\Ryv(m)}
  \end{array}}
  }
\\
\begin{proof}
\begin{align*}
  \Ryv(m)
    &\eqd \pE\brs{\rvy(m)\rvv^\ast(0)}
    && \text{by (A) and definition of $\Ryv$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brs{(\rvx(m)+\rvv(m))\rvv^\ast(0)}
    && \text{by definition of $\rvy$}
  \\&= \pE\brs{\rvx(m)\rvv^\ast(0)} + \pE\brs{\rvv(m)\rvv^\ast(0)}
  \\&= \pE\rvx(m)\pE\rvv^\ast(0) + \pE\brs{\rvv(m)\rvv^\ast(0)}
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(B)}
  \\&= \pE\rvx(m)\cancelto{0}{\pE\rvv^\ast(0)} + \pE\brs{\rvv(m)\rvv^\ast(0)}
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(C)}
  \\&= \Rxv(m) + \Rvv(m)
    && \text{by definitions of $\Rxy$ and $\Rxx$}
    && \text{\xref{def:Rxxm}}
\end{align*}
\begin{align*}
  \Ryy(m)
    &\eqd \pE\brs{\rvy(m)\rvy^\ast(0)}
    && \text{by (A) and definition of $\Ryy$}
    %&& \text{\xref{def:Rxym}}
  \\&\eqd \pE\brs{(\rvx(m)+\rvv(m))(\rvx(0)+\rvv(0))^\ast}
    && \text{by definition of $\rvy$}
  \\&= \mathrlap{
       \pE\brs{\rvx(m)\rvx^\ast(0)}
     + \pE\brs{\rvx(m)\rvv^\ast(0)}
     + \pE\brs{\rvv(m)\rvx^\ast(0)}
     + \pE\brs{\rvv(m)\rvv^\ast(0)}
     }
  \\&= \mathrlap{
       \pE\brs{\rvx(m)\rvx^\ast(0)}
     + \pE{\rvx(m)\pE\rvv^\ast(0)}
     + \pE{\rvv(m)\pE\rvx^\ast(0)}
     + \pE\brs{\rvv(m)\rvv^\ast(0)}
     \quad\text{by \prope{uncorrelated} hypothesis (B)}
     }
  \\&= \mathrlap{
       \pE\brs{\rvx(m)\rvx^\ast(0)}
     + \pE\rvx(m)\cancelto{0}{\pE\rvv^\ast(0)}
     + \cancelto{0}{\pE\rvv(m)}\pE\rvx^\ast(0)
     + \pE\brs{\rvv(m)\rvv^\ast(0)}
     \quad\text{by \prope{zero-mean} hypothesis (C)}
     }
  \\&= \Rxx(m) + \Rvv(m)
    && \text{by definition of $\Rxx$}
    %&& \text{\xref{def:Rxxm}}
  \\
  \Rxx(m)
    &\eqd \pE\brs{\rvx(m)\rvx^\ast(0)}
  \\&\eqd \pE\brp{\brs{\rvy(m)-\rvv(m)}\brs{\rvy(0)-\rvv(0)}^\ast}
  \\&= \pE\brs{\rvy(m)\rvy^\ast(0)}
     - \pE\brs{\rvy(m)\rvv^\ast(0)}
     - \pE\brs{\rvv(m)\rvy^\ast(0)}
     + \pE\brs{\rvv(m)\rvv^\ast(0)}
  \\&\eqd \Ryy(m) - \Ryv(m) - \Rvy(m) + \Rvv(m)
  \\&= \Ryy(m) + \Rvv(m) - 2\Real\Ryv(m) 
\end{align*}
\end{proof}

%---------------------------------------
\begin{remark}
%---------------------------------------
Because in \pref{thm:xvy} $\rvy = \rvx + \rvv$ and $\Ryy = \Rxx + \Rvv$,
one might assume that $R$ is a kind of \ope{linear operator} \ifxref{operator}{def:linop} 
and further assume that
because $\rvx=\rvy-\rvv$ and $\Rxx[(-v)(-v)]=\Rvv$, that $\Rxx = \Ryy + \Rvv$.
As \pref{thm:xvy} demonstrates, this is simply \textbf{not the case}.
%The $\Ryy=\Rxx+\Rvv$ result of \pref{thm:xvy} is simple and beautiful.
%However, don't get to giddy and free with it.
%Rather, pay attention to the constraints on the left.
%In particular, note that if $\rvw\eqd-\rvv$ such that $\rvx=\rvy+\rvw$,
%then it is \textbf{not true} that $\Rxx=\Ryy+\Rww$.
The problem here is that $\rvy$ and $\rvv$ are very much 
\prope{correlated}---in fact $\rvy$ is obviously a \emph{function} of $\rvv$. % in that $\rvy=\rvx+\rvw$.
%As such, the correct expression for $\Rxx$ here would be
%\begin{align*}
%  \Rxx(m)
%    &\eqd \pE\brs{\rvx(m)\rvx^\ast(0)}
%  \\&\eqd \pE\brp{\brs{\rvy(m)+\rvw(m)}\brs{\rvy(0)+\rvw(0)}^\ast}
%  \\&= \pE\brs{\rvy(m)\rvy^\ast(0)}
%     + \pE\brs{\rvy(m)\rvw^\ast(0)}
%     + \pE\brs{\rvw(m)\rvy^\ast(0)}
%     + \pE\brs{\rvw(m)\rvw^\ast(0)}
%  \\&\eqd \Ryy(m) + \Ryw(m) + \Rwy(m) + \Rww(m)
%  \\&= \boxed{\Ryy(m) + \Rww(m) + 2\Real\Ryw(m)}
%\end{align*}
\end{remark}

%---------------------------------------
\begin{corollary}
\label{cor:xvy}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{thm:xvy}.
\corbox{
  \brbr{\begin{array}{M}
    hypotheses of\\
    \prefpp{thm:xvy}
  \end{array}}
  \implies
  \brbl{\begin{array}{FrclD}
      (1).&\Szyy(z)      &=& \Szxx(z)      + \Szvv(z)                                            & and
    \\(2).&\Szyv(z)      &=&                 \Szvv(z)                                            & and
    \\(3).&\Szyv(z)      &=& \Szyy(z)      + \Szvv(z) + \Szyv(z) + \Szyv^\ast(z^\ast)            & and
    \\(4).&\Swyy(\omega) &=& \Swxx(\omega) + \Swvv(\omega)                                       & and
    \\(5).&\Swyv(\omega) &=&                 \Swvv(\omega)                                       & and
    \\(6).&\Swyv(\omega) &=& \Swyy(\omega) + \Swvv(\omega) + \Swyv(\omega) + \Swyv^\ast(-\omega) & 
  \end{array}}
  }
\end{corollary}
\begin{proof}
\begin{align*}
  \Szyy(z)
    &\eqd \opZ\Ryy(m)
    && \text{by definition of $\Szxx$}
    && \text{\xref{def:Szxx}}
  \\&= \opZ\Rqq(m) + \opZ\Rvv(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Szqq(z) + \Szvv(z)
    && \text{by definition of $\Szyy$}
    && \text{\xref{def:Swxy}}
  \\
  \Swyy(\omega)
    &\eqd \opDTFT\Ryy(m)
    && \text{by definition of $\Swyy$}
    && \text{\xref{def:Swxx}}
  \\&= \opDTFT\Rqq(m) + \opDTFT\Rvv(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Swqq(\omega) + \Swvv(\omega)
    && \text{by definition of $\Swyy$}
    && \text{\xref{def:Swxy}}
\end{align*}
\end{proof}

%---------------------------------------
\begin{minipage}{\tw-55mm}
\begin{theorem}
\label{thm:dual_addnoise}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated to the right:
\end{theorem}
\end{minipage}
\qquad\tbox{\includegraphics{graphics/dual_addnoise.pdf}}
\thmbox{
  \brb{\begin{array}{FrclDD}
      (A).& \mc{4}{M}{$\rvx(n)$ and $\rvr(n)$ are \prope{wide sense stationary}}      & and
    \\(B).& \pE\brs{\rvx(n)\rvw(n)} &=& \pE\rvx(n)\pE\rvw(n) & (\prope{uncorrelated}) & and
    \\(C).& \pE\brs{\rvr(n)\rvv(n)} &=& \pE\rvr(n)\pE\rvv(n) & (\prope{uncorrelated}) & and
    \\(D).& \pE\brs{\rvw(n)\rvv(n)} &=& \pE\rvw(n)\pE\rvv(n) & (\prope{uncorrelated}) & and
    \\(E).& \pE\rvv(n)=\pE\rvw(n)   &=& 0                    & (\prope{zero-mean})
  \end{array}}
  \implies
  \brb{\begin{array}{rcl}
      \Rsy(m) &=& \Rsx(m)
            \\&=& \Rry(m)
            \\&=& \Rrx(m)
  \end{array}}
  }
\\
\begin{proof}
\begin{align*}
  \Rsy(m)
    &\eqd \pE\brs{\rvs(m)\rvy^\ast(0)}
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brp{\brs{\rvr(m)+\rvw(m)}\brs{\rvx(0)+\rvv(0)}^\ast}
    && \text{by definition of $\opS$}
  \\&= \mathrlap{
       \pE\brs{\rvr(m)\rvx^\ast(0)}
      +\pE\brs{\rvr(m)\rvv^\ast(0)}
      +\pE\brs{\rvw(m)\rvx^\ast(0)}
      +\pE\brs{\rvw(m)\rvv^\ast(0)}
      }
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)}
      +\pE\rvr(m)\pE\rvv^\ast(0)
      \\&\qquad
      +\pE\rvw(m)\pE\rvx^\ast(0)
      +\pE\rvw(m)\pE\rvv^\ast(0)
    && \text{by \prope{uncorrelated} hypotheses}
    && \text{(B), (C), and (D)}
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)}
      +\pE\rvr(m)\cancelto{0}{\pE\rvv^\ast(0)}
      \\&\qquad
      +\cancelto{0}{\pE\rvw(m)}\pE\rvx^\ast(0)
      +\cancelto{0}{\pE\rvw(m)}\pE\rvv^\ast(0)
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(E)}
  \\&= \Rrx(m)
    && \text{by definition of $\Rrx$}
    && \text{\xref{def:Rxym}}
  \\
  \Rsx(m)
    &\eqd \pE\brs{\rvs(m)\rvx^\ast(0)}
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brp{\brs{\rvr(m)+\rvw(m)}\rvx^\ast(0)}
    && \text{by definition of $\opS$}
 %\\&= \pE\brs{\rvr(m)\rvx^\ast(0)} + \pE\brs{\rvw(m)\rvx^\ast(0)}
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)} + \pE\rvw(m)\pE\rvx^\ast(0)
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(B)}
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)} + \cancelto{0}{\pE\rvw(m)}\pE\rvx^\ast(0)
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(E)}
  \\&= \Rrx(m)
    && \text{by definition of $\Rrx$}
    && \text{\xref{def:Rxym}}
  \\
  \Rry(m)
    &\eqd \pE\brs{\rvr(m)\rvy^\ast(0)}
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brp{\rvr(m)\brs{\rvx(0)+\rvv(0)}^\ast}
    && \text{by definition of $\opS$}
 %\\&= \pE\brs{\rvr(m)\rvx^\ast(0)} + \pE\brs{\rvr(m)\rvv^\ast(0)}
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)} + \pE\rvr(m)\pE\rvv^\ast(0)
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(C)}
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)} + \pE\rvr(m)\cancelto{0}{\pE\rvv^\ast(0)}
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(E)}
  \\&= \Rrx(m)
    && \text{by definition of $\Rrx$}
    && \text{\xref{def:Rxym}}
\end{align*}
\end{proof}

%---------------------------------------
\begin{corollary}
\label{cor:dual_addnoise}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{thm:dual_addnoise}.
\corbox{
  \brb{\begin{array}{M}
    hypotheses of\\
    \prefpp{thm:dual_addnoise}
  \end{array}}
  \implies
  \brb{\begin{array}{FrclclclD}
      (1).&\Szsy(z)      &=& \Szsx(z)      &=& \Szry(z)      &=& \Szrx(z)       & and
    \\(2).&\Swsy(\omega) &=& \Swsx(\omega) &=& \Swry(\omega) &=& \Swrx(\omega)  &
  \end{array}}
  }
\end{corollary}
\begin{proof}
\begin{align*}
  \Szsy(\omega)
    &\eqd \opZ\Rsy(m)
    && \text{by definition of $\Szxy$}
    && \text{\xref{def:Szxy}}
  \\&= \opZ\Rrx(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Szrx(z)
    && \text{by definition of $\Szxy$}
    && \text{\xref{def:Szxy}}
  \\
  \Swsy(\omega)
    &\eqd \opDTFT\Rsy(m)
    && \text{by definition of $\Swxy$}
    && \text{\xref{def:Swxy}}
  \\&= \opDTFT\Rrx(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Swrx(\omega)
    && \text{by definition of $\Swxy$}
    && \text{\xref{def:Swxy}}
\end{align*}
\end{proof}

%=======================================
\section{Effects of additive noise and filtering}
%=======================================
\begin{figure}[h]
  \centering
  \begin{tabular}{|c|c|c|}
    \hline
      \includegraphics{graphics/sysT_xyvq.pdf}
     &\includegraphics{graphics/sysT_xyup.pdf}
     &\includegraphics{graphics/sysT_mnoise.pdf}
    \\\xref{thm:sysT_addnoise_v} &\xref{thm:sysT_addnoise_u} &\xref{thm:sysT_mnoise}
    \\\hline
  \end{tabular}
  \caption{\label{fig:sysT_addnoise}Additive noise with transform $\opT$}
\end{figure}
Adding in zero-mean uncorrelated noise \emph{after} a transform (operation) $\opT$
has \emph{no effect} on cross-correlation across the transform (next theorem).
However, adding \emph{before} $\opT$ \emph{does} \prefpp{thm:sysT_addnoise_u}.
%---------------------------------------
\begin{theorem}
Let $\opS$ be the \structe{system} illustrated in \prefpp{fig:sysT_addnoise}.
\label{thm:sysH_addnoise}
\label{thm:sysT_addnoise_v}
%---------------------------------------
\thmbox{
  \brb{\begin{array}{FrclDD}
      (A).& \Rxx(n_1,m)             &=& \Rxx(n_2,m)          &(\prope{WSS})          & and
    \\(B).& \pE\brs{\rvx(n)\rvv(n)} &=& \pE\rvx(n)\pE\rvv(n) &(\prope{uncorrelated}) & and
    \\(E).& \pE\rvv(n)              &=& 0                    & (\prope{zero-mean})   &
  \end{array}}
  \implies
  \brb{\begin{array}{FrclD}
      (1).& \Rxy(m)      &=& \Rxq(m)       & and
    \\(2).& \Szxy(z)     &=& \Szxq(z)      & and
    \\(3).& \Swxy(\omega)&=& \Swxq(\omega) &
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{align*}
  \Rxy(m)
    &\eqd \pE\brs{\rvx(m)\rvy^\ast(0)}
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brs{\rvx(m)(\rvq(0)+\rvv(0))^\ast}
    && \text{by definition of $\opS$}
  \\&= \pE\brs{\rvx(m)\rvq^\ast(0)+\rvx(m)\rvv^\ast(0)}
  \\&= \pE\brs{\rvx(m)\rvq^\ast(0)} + \pE\brs{\rvx(m)\rvv^\ast(0)}
  \\&= \pE\brs{\rvx(m)\rvq^\ast(0)} + \brs{\pE\rvx(m)}\brs{\pE\rvv^\ast(0)}
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(B)}
  \\&= \pE\brs{\rvx(m)\rvq^\ast(0)} + \brs{\pE\rvx(m)}\cancelto{0}{\brs{\pE\rvv^\ast(0)}}
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(E)}
  \\&= \Rxq(m)
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\
  \Szxy(z)
    &\eqd \opZ\Rxy(m)
    && \text{by definition of $\Szxy$}
    && \text{\xref{def:Szxy}}
  \\&= \opZ\Rxq(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Szxq(z)
    && \text{by definition of $\Szxy$}
    && \text{\xref{def:Szxy}}
  \\
  \Swxy(\omega)
    &\eqd \opDTFT\Rxy(m)
    && \text{by definition of $\Swxy$}
    && \text{\xref{def:Swxy}}
  \\&= \opDTFT\Rxq(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Swxq(\omega)
    && \text{by definition of $\Swxq$}
    && \text{\xref{def:Swxy}}
\end{align*}
\end{proof}

%---------------------------------------
\begin{theorem}
\label{thm:sysT_addnoise_u}
%\includegraphics{graphics/sysH_xyuvpq.pdf}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{fig:sysT_addnoise}.
\thmbox{
  \brb{\begin{array}{FrclDD}
      (A).& \Rxx(n_1,m)             &=& \Rxx(n_2,m)         &(\prope{WSS})          & and
    \\(B).& \pE\brs{\rvx(n)\rvu(n)} &=&\pE\rvx(n)\pE\rvu(n) &(\prope{uncorrelated}) & and
    \\(C).& \pE\rvu(n)              &=& 0                   & (\prope{zero-mean})   &
  \end{array}}
  \implies
  \brb{\begin{array}{Frcl@{\hspace{2pt}}c@{\hspace{2pt}}lD}
      (1).& \Rpy(m)      &=& \Rxy(m)       &+& \Ruy(m)       & and 
    \\(2).& \Szpq(z)     &=& \Szxy(z)      &+& \Szuy(z)      & and
    \\(3).& \Swpq(\omega)&=& \Swxy(\omega) &+& \Swuy(\omega) &
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{align*}
  \Rpy(m)
    &\eqd \pE\brs{\rvp(m)\rvy^\ast(0)}
    && \text{by definition of $\Rpy$}
    && \text{\pref{def:Rxym}}
  \\&\eqd \pE\brp{\brs{\rvx(m)+\rvu(m)}\rvy^\ast(0)}
    && \text{by definition of $\opS$}
  \\&= \pE\brs{\rvx(m)\rvy^\ast(0)+\rvu(m)\rvy^\ast(0)}
  \\&= \pE\brs{\rvx(m)\rvy^\ast(0)} + \pE\brs{\rvu(m)\rvy^\ast(0)}
    && \text{because $\pE$ is a \ope{linear operator}}
    && \text{\xref{thm:pE_linop}}
  \\&\eqd \Rxy(m) + \Ruy(m)
    && \text{by definition of $\Rxy$}
    && \text{\pref{def:Rxym}}
\end{align*}
\end{proof}

%---------------------------------------
\begin{theorem}
\label{thm:sysT_mnoise}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{fig:sysT_addnoise} (C).
\thmbox{
  \brb{\begin{array}{FrclDD}
      (A).& \Rxx(n_1,m)             &=& \Rxx(n_2,m)         &(\prope{WSS})          & and
    \\(B).& \pE\brs{\rvx(n)\rvu(n)} &=&\pE\rvx(n)\pE\rvu(n) &(\prope{uncorrelated}) & and
    \\(C).& \pE\rvu(n)              &=& 0                   &(\prope{zero-mean})    &
  \end{array}}
  \implies
  \brb{\begin{array}{Frcl@{\hspace{2pt}}c@{\hspace{2pt}}lD}
      (1).& \Rpy(m)      &=& \Rxy(m)       &+& \Ruy(m)       & and 
    \\(2).& \Szpq(z)     &=& \Szxy(z)      &+& \Szuy(z)      & and
    \\(3).& \Swpq(\omega)&=& \Swxy(\omega) &+& \Swuy(\omega) &
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{align*}
  \Rxy(m)
    &\eqd \pE\brs{\rvx(m)\rvy^\ast(0)}
    && \text{by definition of $\Rpy$}
    && \text{\pref{def:Rxym}}
  \\&\eqd \pE\brp{\brs{\rvp(m)+\rvw(m)}\rvy^\ast(0)}
    && \text{by definition of $\opS$}
  \\&= \pE\brs{\rvp(m)\rvy^\ast(0)+\rvw(m)\rvy^\ast(0)}
  \\&= \pE\brs{\rvp(m)\rvy^\ast(0)} + \pE\brs{\rvw(m)\rvy^\ast(0)}
    && \text{because $\pE$ is a \ope{linear operator}}
    && \text{\xref{thm:pE_linop}}
  \\&\eqd \Rpy(m) + \Rwy(m)
    && \text{by definition of $\Rxy$}
    && \text{\pref{def:Rxym}}
  \\&= \Rpy(m) + \cancelto{0}{\Rwy(m)}
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(B)}
\end{align*}
\end{proof}

%%---------------------------------------
%\begin{corollary}
%\label{cor:sysH_addnoise_z}
%%---------------------------------------
%Let $\opS$ be the \structe{system} illustrated in \prefpp{thm:sysH_addnoise}.
%\corbox{
%  \brb{\begin{array}{M}
%    hypotheses of\\
%    \pref{thm:sysH_addnoise}
%  \end{array}}
%  \implies
%  \brb{\begin{array}{Frcl}
%      (1).& \Szxy(z)&=& \Szxq(z)
%    \\(2).& \Szuy(z)&=& \Szuq(z)
%    \\(3).& \Szpy(z)&=& \Szpq(z)
%    \\(4).& \Szpq(z)&=& \Szxy(z) + \Szuy(z)
%    \\(5).& \Szpq(z)&=& \Szxy(z) + \Szuq(z)
%  \end{array}}
%  }
%\end{corollary}
%\begin{proof}
%\begin{align*}
%  \Swxy(\omega)
%    &\eqd \opDTFT\Rxy(m)
%    && \text{by definition of $\Swxy$}
%    && \text{\xref{def:Swxy}}
%  \\&= \opDTFT\Rxq(m)
%    && \text{by \prefp{thm:sysH_addnoise}}
%    && \text{(1)}
%  \\&= \Swxq(\omega)
%    && \text{by definition of $\Swxy$}
%    && \text{\xref{def:Swxy}}
%\end{align*}
%\end{proof}
%
%%---------------------------------------
%\begin{corollary}
%\label{cor:sysH_addnoise}
%%---------------------------------------
%Let $\opS$ be the \structe{system} illustrated in \prefpp{thm:sysH_addnoise}.
%\corbox{
%  \brb{\begin{array}{M}
%    hypotheses of\\
%    \pref{thm:sysH_addnoise}
%  \end{array}}
%  \implies
%  \brb{\begin{array}{Frcl}
%      (1).& \Swxy(\omega)&=& \Swxq(\omega)
%    \\(2).& \Swuy(\omega)&=& \Swuq(\omega)
%    \\(3).& \Swpy(\omega)&=& \Swpq(\omega)
%    \\(4).& \Swpq(\omega)&=& \Swxy(\omega) + \Swuy(\omega)
%    \\(5).& \Swpq(\omega)&=& \Swxy(\omega) + \Swuq(\omega)
%  \end{array}}
%  }
%\end{corollary}
%\begin{proof}
%\begin{align*}
%  \Swxy(\omega)
%    &\eqd \opDTFT\Rxy(m)
%    && \text{by definition of $\Swxy$}
%    && \text{\xref{def:Swxy}}
%  \\&= \opDTFT\Rxq(m)
%    && \text{by \prefp{thm:sysH_addnoise}}
%    && \text{(1)}
%  \\&= \Swxq(\omega)
%    && \text{by definition of $\Swxy$}
%    && \text{\xref{def:Swxy}}
%\end{align*}
%\end{proof}

\prefpp{thm:ZSxy} demonstrates that if a random input $\rvx(n)$ is processed by an \prope{LTI} system
$\fh(n)$ with output $\rvy(n)$, then the cross-spectral density and auto-spectral density are 
related simply by
$\Swxy(\omega)=\Swxx(\omega)\FH^\ast(\omega)$. 
But what happens to $\Swxy(\omega)$ if we add uncorrelated zero-mean noise into the input $\rvx$
and similarly to the output $\rvy$?
The somewhat surprising but happy answer to this question is: \emph{Nothing}!
\ldots as demonstrated by \pref{cor:sysH_addnoise_lti} (next). 
That is, uncorrelated additive noise has \emph{no effect} on cross-correlation!
However note that it \emph{does} have an effect on auto-correlation (also next).
%---------------------------------------
\begin{corollary}
\label{cor:sysH_addnoise_lti}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{thm:sysH_addnoise}.
\corbox{
  \brb{\begin{array}{FMD}
      (A).& $\FH$ is \prope{LTI} &and
    \\(B).& hypotheses of
        \\& \pref{thm:sysH_addnoise}&\xrefpo{thm:sysH_addnoise}
  \end{array}}
  \implies
  \brb{\begin{array}{FrclD}
      (1).&\Szyy(z)      &=& \brs{\Szxx(z)     +\Szuu(z)}\ZH(z)\ZH^\ast\brp{\frac{1}{z^\ast}} + \Szvv(z) & and
    \\(2).&\Swyy(\omega) &=& \brs{\Swxx(\omega)+\Swuu(\omega)}\abs{\FH(\omega)}^2 + \Swvv(\omega)   & and
    \\(3).&\Szxy(z)      &=&      \Szxx(z)      \ZH^\ast\brp{\frac{1}{z^\ast}}                      & and
    \\(4).&\Swxy(\omega) &=&      \Swxx(\omega) \FH^\ast(\omega)                                    &
  \end{array}}
  }
\end{corollary}
\begin{proof}
\begin{align*}
  \Szyy(z)
    &= \Szqq(z) + \Szvv(z)
    && \text{by \prefp{cor:xvy}}
  \\&= \Szpp(z)\ZH(z)\ZH^\ast\brp{\frac{1}{z^\ast}} + \Szvv(z)
    && \text{by \prefp{thm:ZSxy}}
  \\&= \brs{\Szxx(z)+\Szuu(z)}\ZH(z)\ZH^\ast\brp{\frac{1}{z^\ast}} + \Szvv(z)
    && \text{by \prefp{cor:xvy}}
  \\
  \Swyy(\omega)
    &= \Swqq(\omega) + \Swvv(\omega)
    && \text{by \prefp{cor:xvy}}
  \\&= \Swpp(\omega)\abs{\FH(\omega)}^2 + \Swvv(\omega)
    && \text{by \prefp{cor:Swxy}}
  \\&= \brs{\Swxx(\omega)+\Swuu(\omega)}\abs{\FH(\omega)}^2 + \Swvv(\omega)
    && \text{by \prefp{cor:xvy}}
  \\
  \Szxy(z)
    &= \Szpq(z) - \Szuq(z)
    && \text{by \prefp{cor:sysH_addnoise}}
  \\&= \Szpp(z)\ZH^\ast\brp{\frac{1}{z^\ast}} - \Szuu(z)\ZH^\ast\brp{\frac{1}{z^\ast}}
    && \text{by \prefp{thm:ZSxy}}
  \\&= \brs{\Szxx(z)+\Szuu(z)}\ZH^\ast\brp{\frac{1}{z^\ast}}  - \Szuu(z)\ZH^\ast\brp{\frac{1}{z^\ast}}
    && \text{by \prefp{cor:xvy}}
  \\&= \Szxx(z)\ZH^\ast\brp{\frac{1}{z^\ast}}
  \\
  \Swxy(\omega)
    &= \brlr{\Szxy(z)}_{z=e^{-\omega}}
  \\&= \brlr{\Szxx(z)\ZH^\ast\brp{\frac{1}{z^\ast}}}_{z=e^{-\omega}}
    && \text{by previous result}
  \\&= \Swxx(\omega)\FH^\ast(\omega)
\end{align*}
\end{proof}

%---------------------------------------
\begin{minipage}{\tw-80mm}
\begin{corollary}
\label{cor:GHz}
\label{cor:GHw}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated to the right.
\end{corollary}
\end{minipage}
\hfill\tbox{\includegraphics{graphics/xGy_xHw_addnoise.pdf}}
\\
\corbox{
  \brb{\begin{array}{FMMD}
      (A).& $\fg(n)$  is                &\prope{LTI}       & and
    \\(B).& $\rvx(n)$ is                &\prope{WSS}       & and
    \\(C).& $\rvu(n)$ and $\rvv(n)$ are &\prope{zero-mean} & and
    \\(D).& $\rvx(n)$, $\rvu(n)$, $\rvv(n)$ are &\prope{uncorrelated}
  \end{array}}
  \implies
  \brb{\begin{array}{FrclD}
    (1).& \Szsy(z)      &=& \ZG(z)          \Szpq(z)                      &    \\ 
        & \mc{3}{l}{\qquad= \ZG(z)     \brs{\Szxy(z)     +\Szuy(z)}}      & and\\
    (2).& \Swsy(\omega) &=& \FG(\omega)     \Swpq(\omega)                 &    \\
        & \mc{3}{l}{\qquad= \FG(\omega)\brs{\Swxy(\omega)+\Swuy(\omega)}} &
  \end{array}}
  }
\\
\begin{proof}
\begin{align*}
  \Szsy(z)
    &= \Szrq(z)
    && \text{by \prefp{cor:dual_addnoise}}
    && \text{and (B), (C) and (D)}
  \\&= \ZG(z)\Szpq(z)
    && \text{by \prefp{cor:xGw_xHy}}
    && \text{and (A)}
  \\&= \ZG(z)\brs{\Szxy(z) + \Szuy(z)}
    && \text{by \prefp{cor:sysH_addnoise_z}}
    && \text{and (A)}
  \\
  \Swsy(\omega)
    &= \Swrq(\omega)
    && \text{by \prefp{cor:dual_addnoise}}
    && \text{and (B), (C) and (D)}
  \\&= \FG(\omega)\Swpq(\omega)
    && \text{by \prefp{cor:xGw_xHy}}
    && \text{and (A)}
  \\&= \FG(\omega)\brs{\Swxy(\omega) + \Swuy(\omega)}
    && \text{by \prefp{cor:sysH_addnoise}}
    && \text{and (A)}
\end{align*}
\end{proof}

