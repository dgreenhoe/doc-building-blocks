%============================================================================
% Daniel J. Greenhoe
% XeLaTeX file
% nominal unit = 10mm
%============================================================================
\begin{pspicture}(-3.8,-0.5)(3.8,3.5)
  %-------------------------------------
  % settings
  %-------------------------------------
  \psset{linewidth=1pt,linecolor=latline,radius=0.75\psunit}%
  %-------------------------------------
  % nodes
  %-------------------------------------
  \rput(0,3){\ovalnode{lub}{$\spX=\oppS\set{T^n(x)}{n=0,1,2,3}$}}%
  %\cnodeput(0,2){lub}{$\spX$}
  %\rput[l](1,2){\rnode{Xlabel}{$\spX=\oppS\set{\cos^n(2\pi x)}{n=0,1,2,3}$}}%
  \rput[bl](-3.5,-0.3){\rnode[tl]{slabel}{scaling subspace}}%
  \Cnode(-3,1.5){cos0hz}%
  \Cnode(-1,1.5){cos1hz}%
  \Cnode( 1,1.5){cos2hz}%
  \Cnode( 3,1.5){cos3hz}%
  \cnodeput( 0,0){glb}{$\spZero$}%
  %-------------------------------------
  % connecting lines
  %-------------------------------------
  \ncline{cos0hz}{lub}%
  \ncline{cos1hz}{lub}%
  \ncline{cos2hz}{lub}%
  \ncline{cos3hz}{lub}%
  \ncline{cos0hz}{glb}%
  \ncline{cos1hz}{glb}%
  \ncline{cos2hz}{glb}%
  \ncline{cos3hz}{glb}%
  \ncline{->}{Xlabel}{lub}
  \ncline{->}{slabel}{cos0hz}
  %\ncarc[arcangle=30]{->}{slabel}{cos0hz}
  %\ncdiag[angleA=120,angleB=-120]{->}{slabel}{cos0hz}
  %-------------------------------------
  % plots
  %-------------------------------------
  \rput(cos0hz){% %(-3, 0){% cos(0x)
    \psline[linecolor=axis]{<->}(-0.7,0)(0.7,0)%
    \psline[linecolor=axis]{<->}(0,-0.7)(0,0.7)%
    \psplot[linecolor=blue,plotpoints=64]{-0.4}{0.4}{1 0.5 mul}
    \psplot[linecolor=blue,plotpoints=32,linestyle=dotted,dotsep=0.05]{0.4}{0.6}{1 0.5 mul}
    \psplot[linecolor=blue,plotpoints=32,linestyle=dotted,dotsep=0.05]{-0.4}{-0.6}{1 0.5 mul}
    }
  \rput(cos1hz){% (-1, 0){% cos(x)
    \psline[linecolor=axis]{<->}(-0.7,0)(0.7,0)%
    \psline[linecolor=axis]{<->}(0,-0.7)(0,0.7)%
    \psplot[linecolor=red,plotpoints=64]{-0.4}{0.4}{x}
    \psplot[linecolor=red,plotpoints=32,linestyle=dotted,dotsep=0.05]{0.4}{0.6}{x}
    \psplot[linecolor=red,plotpoints=32,linestyle=dotted,dotsep=0.05]{-0.4}{-0.6}{x}
    }
  \rput(cos2hz){% ( 1, 0){% cos(2x)
    \psline[linecolor=axis]{<->}(-0.7,0)(0.7,0)%
    \psline[linecolor=axis]{<->}(0,-0.7)(0,0.7)%
    \psplot[linecolor=red,plotpoints=64]{-0.45}{0.45}{2 x 2 mul 2 exp mul 1 sub 0.5 mul}
    \psplot[linecolor=red,plotpoints=32,linestyle=dotted,dotsep=0.05]{0.45}{0.55}{2 x 2 mul 2 exp mul 1 sub 0.5 mul}
    \psplot[linecolor=red,plotpoints=32,linestyle=dotted,dotsep=0.05]{-0.45}{-0.55}{2 x 2 mul 2 exp mul 1 sub 0.5 mul}
    }
  \rput(cos3hz){% ( 3, 0){% cos(3x)
    \psline[linecolor=axis]{<->}(-0.7,0)(0.7,0)%
    \psline[linecolor=axis]{<->}(0,-0.7)(0,0.7)%
    \psplot[linecolor=red,plotpoints=64]{-0.45}{0.45}{4 x 2 mul 3 exp mul 3 x 2 mul mul sub 0.5 mul}
    \psplot[linecolor=red,plotpoints=32,linestyle=dotted,dotsep=0.05]{0.45}{0.5}{4 x 2 mul 3 exp mul 3 x 2 mul mul sub 0.5 mul}
    \psplot[linecolor=red,plotpoints=32,linestyle=dotted,dotsep=0.05]{-0.45}{-0.5}{4 x 2 mul 3 exp mul 3 x 2 mul mul sub 0.5 mul}
    }
\end{pspicture}%
