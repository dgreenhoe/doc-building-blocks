%============================================================================
% Daniel J. Greenhoe
% LaTeX File
%============================================================================

%======================================
\chapter{Wavelet Design for real functions}
%======================================




%=======================================
\section{Properties}
%=======================================

\begin{minipage}[t]{8\tw/16}
%\begin{figure}[t]%
%  \color{figcolor}%
  \begin{center}%
  \begin{fsL}%
  \setlength{\unitlength}{\textwidth/800}%
  \begin{picture}(500,200)(-250,-50)%
    %{\color{graphpaper}\graphpaper[10](-250,-50)(500,200)}%
    {\color{axis}%
      \put(-220, 0){\line(1, 0){440} }%
      \put(0, 0){\line(0, 1){120} }%
      \multiput(-200,-10)(50,0){9}{\line(0, 1){20}}%
      \put( 230,  0){\makebox(0,0)[l]{$t$}}%
      \put( 200,-20){\makebox(0,0)[t]{$2$}}%
      \put( 100,-20){\makebox(0,0)[t]{$1$}}%
      \put(   0,-20){\makebox(0,0)[t]{$0$}}%
      \put(-100,-20){\makebox(0,0)[t]{$-1$}}%
      \put(-200,-20){\makebox(0,0)[t]{$-2$}}%
    }%
    {\color{figcolor}%
      \put(   0,110){\makebox(0,0)[b]{$\fx(t)$}}%
      \put(-100, 0){\line( 1, 1){100} }%
      \put( 100, 0){\line(-1, 1){100} }%
    }%
    {\color{red}%
      \put( 150,110){\makebox(0,0)[b]{$\opT \fx(t)$}}%
      \put( 150,100){\vector( 0,-1){50} }%
      \put(   0, 0){\line( 1, 1){100} }%
      \put( 200, 0){\line(-1, 1){100} }%
    }%
    {\color{green}%
      \put(-150,110){\makebox(0,0)[b]{$\opTi\fx(t)$}}%
      \put(-150,100){\vector( 0,-1){50} }%
      \put(-200, 0){\line( 1, 1){100} }%
      \put(   0, 0){\line(-1, 1){100} }%
    }%
  \end{picture}%
  \end{fsL}%
  \end{center}%
  \begin{center}%
  \begin{fsL}%
  \setlength{\unitlength}{\textwidth/800}%
  \begin{picture}(500,200)(-250,-50)%
    %{\color{graphpaper}\graphpaper[10](-250,-50)(500,200)}%
    {\color{axis}%
      \put(-220, 0){\line(1, 0){440} }%
      \put(0, 0){\line(0, 1){150} }%
      \multiput(-200,-10)(50,0){9}{\line(0, 1){20}}%
      \put( 230,  0){\makebox(0,0)[l]{$t$}}%
      \put( 200,-20){\makebox(0,0)[t]{$2$}}%
      \put( 100,-20){\makebox(0,0)[t]{$1$}}%
      \put(   0,-20){\makebox(0,0)[t]{$0$}}%
      \put(-100,-20){\makebox(0,0)[t]{$-1$}}%
      \put(-200,-20){\makebox(0,0)[t]{$-2$}}%
    }%
    {\color{figcolor}%
      \put( 130,80){\makebox(0,0)[l]{$\fx(t)$}}%
      \put( 130,70){\vector( -1,-1){50} }%
      \put(-100, 0){\line( 1, 1){100} }%
      \put( 100, 0){\line(-1, 1){100} }%
    }%
    {\color{red}%
      \put( 110,120){\makebox(0,0)[l]{$\opD \fx(t)$}}%
      \put( 100,120){\vector(-1,0){90} }%
      \put( -50, 0){\line( 1, 3){50} }%
      \put(  50, 0){\line(-1, 3){50} }%
    }%
    {\color{green}%
      \put(-100,110){\makebox(0,0)[b]{$\opDi\fx(t)$}}%
      \put(-100,100){\vector( 0,-1){65} }%
      \put(-200, 0){\line( 3, 1){200} }%
      \put( 200, 0){\line(-3, 1){200} }%
    }%
  \end{picture}%
  \end{fsL}%
  \end{center}%
%  \caption{
%    Translation $\opT$ and dilation operator $\opD$
%    \label{fig:wav_TD}
%    }
%\end{figure}
\end{minipage}
\begin{minipage}[c]{8\tw/16}
For real functions, the translation operator $\opT$ and dilation operator $\opD$ 
can be defined as in \prefpp{def:vsmra_real_T} and illustrated to the left.
Under these definitions, the operators form a \vsmratext (\pref{thm:vsmra_real}).
Additionally, translation and dilation in the case of the 
\hie{Haar transform}\footnotemark
are illustrated in \prefpp{fig:haar-jn}.
\end{minipage}
\footnotetext{\citer{haar1910}}

\begin{figure}[t]
\setlength{\unitlength}{8mm}
\begin{center}
\begin{tabular}{cc}
   \includegraphics*[width=6\tw/16, height=6\tw/16, clip=true]{../common/wavelets/haar_sj.eps} &
   \includegraphics*[width=6\tw/16, height=6\tw/16, clip=true]{../common/wavelets/haar_sk.eps} \\
   \footnotesize varying dilation, constant translation   & 
   \footnotesize varying translation, constant dilation
\end{tabular}
\caption{
   \label{fig:haar-jn}
   Haar scaling function at varying dilations and translations.
   }
\end{center}
\end{figure}

%---------------------------------------
\begin{definition}
\label{def:vsmra_real_T}
\label{def:vsmra_real_D}
%---------------------------------------
Let $\spLL$ be the set of real Lebesgue measurable functions.
Define the operators $\opT:\spLL\to\spLL$ and $\opD:\spLL\to\spLL$ as follows:
\defbox{\begin{array}{l >{\ds}lc>{\ds}l @{\qquad}C@{\qquad}D}
  1. & \opT  \fx(t) &\eqd&         \fx(t-1) 
     & \forall \fx\in\spLL 
     & (\hie{translation operator})
     \\
  2. & \opD  \fx(t) &\eqd& \sqrt{2}\fx(2t)  
     & \forall \fx\in\spLL
     & (\hie{dilation operator})
\end{array}}
\end{definition}



%---------------------------------------
\begin{proposition}[Adjoints of transversal operators]
\label{prop:vsmra_real_Ta}
\label{prop:vsmra_real_Da}
%---------------------------------------
%Let $\vsmrasysLL$ be the \vsmratext of real functions.
%Then the {inverse} $\opTi$ of $\opT$ 
%and  the {inverse} $\opDi$ of $\opD$ are
\formbox{
  \mcom{\left.\begin{array}{llclC}
    1. & \opT  \fx(t) &\eqd&         \fx(t-1) & \forall \fx\in\spLL \\
    2. & \opD  \fx(t) &\eqd& \sqrt{2}\fx(2t)  & \forall \fx\in\spLL
  \end{array}\right\}}{definition of $\opT$ and $\opD$ (\prefp{def:vsmra_real_T})}
  \quad\implies\quad
  \mcom{\left\{\begin{array}{lcl @{\qquad}C}
    \opTa \fx(t) &=& \fx(t+1)  
      & \forall \fx\in\spLL  
      \\
    \opDa \fx(t) &=& \cwt \:\fx\left(\frac{1}{2}t\right)  
      & \forall \fx\in\spLL
  \end{array}\right.}{adjoints of $\opT$ and $\opD$}
  }
\end{proposition}
\begin{proof}
\begin{align*}
  \inprod{\opT\fx(t)}{\fy(t)}
    &= \inprod{\fx(t-1)}{\fy(t)}
    && \text{by definition of $\opT$ \prefpo{def:vsmra_real_T}}
  \\&= \inprod{\fx(u)}{\mcom{\fy(u+1)}{$\opTa\fy(u)$}}
    && \text{where $u=t-1$}
  \\
  \inprod{\opD\fx(t)}{\fy(t)}
    &= \inprod{\sqrt{2}\fx(2t)}{\fy(t)}
    && \text{by definition of $\opT$ \prefpo{def:vsmra_real_T}}
  \\&= \int_t \sqrt{2}\fx(2t) \fy(t) \dt
    && \text{by definition of $\inprodn$}
  \\&= \int_u \sqrt{2}\fx(u) \fy\brp{\frac{u}{2}} \frac{1}{2} \du
    && \text{where $u=2t$}
  \\&= \inprod{\fx(u)}{\mcom{\cwt  \fy\brp{\frac{u}{2}}}{$\opDa \fy(u)$}}
\end{align*}
\end{proof}



%---------------------------------------
\begin{proposition}[Inverses of transversal operators]
\label{prop:vsmra_real_Ti}
\label{prop:vsmra_real_Di}
%---------------------------------------
\formbox{
  \mcom{\left.\begin{array}{llclC}
    1. & \opT  \fx(t) &\eqd&         \fx(t-1) & \forall \fx\in\spLL \\
    2. & \opD  \fx(t) &\eqd& \sqrt{2}\fx(2t)  & \forall \fx\in\spLL
  \end{array}\right\}}{definition of $\opT$ and $\opD$ (\prefp{def:vsmra_real_T})}
  \quad\implies\quad
  \mcom{\left\{\begin{array}{lcl @{\qquad}C}
    \opTi \fx(t) &=& \fx(t+1)  
      & \forall \fx\in\spLL  
      \\
    \opDi \fx(t) &=& \cwt \:\fx\left(\frac{1}{2}t\right)  
      & \forall \fx\in\spLL
  \end{array}\right.}{inverses of $\opT$ and $\opD$}
  }
\end{proposition}
\begin{proof}
\begin{align*}
  \intertext{1a. Proof that $\opTi\opT = \opI$:}
  \opTi\opT\fx(t)
    &= \opTi\fx(t-1)
    && \text{by defintion of $\opT$ \prefpo{def:vsmra_real_T}}
  \\&= \fx([t+1]-1)
    && \text{by hypothesis}
  \\&= \opI\fx(t)
    && \text{by definition of $\opI$ \prefpo{def:opI}}
  \\
  \intertext{1b. Proof that $\opT\opTi = \opI$:}
  \opT\opTi\fx(t)
    &= \opT\fx(t+1)
    && \text{by hypothesis}
  \\&= \fx([t-1]+1)
    && \text{by defintion of $\opT$ \prefpo{def:vsmra_real_T}}
  \\&= \opI\fx(t)
    && \text{by definition of $\opI$ \prefpo{def:opI}}
  \\
  \intertext{2a. Proof that $\opDi\opD = \opI$:}
  \opDi\opD\fx(t)
    &= \opDi \sqrt{2}\fx(2t)
    && \text{by defintion of $\opD$ \prefpo{def:vsmra_real_T}}
  \\&= \left(\cwt \right)\sqrt{2}\fx\left(2\left[\frac{1}{2}t\right]\right)
    && \text{by hypothesis}
  \\&= \opI\fx(t)
    && \text{by definition of $\opI$ \prefpo{def:opI}}
  \\
  \intertext{2b. Proof that $\opD\opDi = \opI$:}
  \opD\opDi\fx\left(t\right)
    &= \opD \left[\cwt \fx\left(\frac{1}{2}t\right) \right]
    && \text{by hypothesis}
  \\&= \sqrt{2} \left[\cwt \fx\left(\frac{1}{2}[2t]\right) \right]
    && \text{by defintion of $\opD$ \prefpo{def:vsmra_real_T}}
  \\&= \opI\fx(t)
    && \text{by definition of $\opI$ \prefpo{def:opI}}
\end{align*}
\end{proof}



%---------------------------------------
\begin{proposition}
\label{prop:vsmra_real_commute}
%---------------------------------------
Let $\vsmrasysLL$ be the \vsmratext of real functions.
\formbox{
  \mcom{\left.\begin{array}{llclC}
    1. & \opT  \fx(t) &\eqd&         \fx(t-1) & \forall \fx\in\spLL \\
    2. & \opD  \fx(t) &\eqd& \sqrt{2}\fx(2t)  & \forall \fx\in\spLL
  \end{array}\right\}}{definition of $\opT$ and $\opD$ (\prefp{def:vsmra_real_T})}
  \qquad\implies\qquad
  \opT^n\opD = \opD\opT^{2n}
  \quad\forall n\in\Z
}
\end{proposition}
\begin{proof}
  \begin{align*}
    \intertext{1a. Proof for $n=0$:}
      \left.\opD \opT^{2n}\fx(t)\right|_{n=0}
        &= \opD \opT^{2\cdot0} \fx(t)
      \\&= \opD \opI 
      \\&= \opI \opD 
      \\&= \opT^0 \opD 
      \\&= \left. \opT^n \opD \right|_{n=0}
    \\
    \intertext{1b. Proof for $n>0$:}
      \opD \opT^{2n}\fx(t)
        &= \opD \fx(t-2n)
        && \text{by \prefp{def:vsmra_real_T}}
      \\&= \sqrt{2}\,\fx(2t-2n)
        && \text{by \prefp{def:vsmra_real_D}}
      \\&= \sqrt{2}\,\fx\brp{2\brs{t-n}}
      \\&= \opT^n \sqrt{2}\,\fx\brp{2t}
        && \text{by \prefp{def:vsmra_real_T}}
      \\&= \opT^n \opD\fx\brp{t}
        && \text{by \prefp{def:vsmra_real_D}}
    \\
    \intertext{1c. Proof for $n<0$:}
      \opD \opT^{2n}\fx(t)
        &= \opD \fx(t-2n)
        && \text{by \prefp{prop:vsmra_real_Ti}}
      \\&= \sqrt{2}\,\fx(2t-2n)
        && \text{by \prefp{def:vsmra_real_D}}
      \\&= \sqrt{2}\,\fx\brp{2[t-n]}
      \\&= \opT^{n}\sqrt{2}\,\fx\brp{2t}
        && \text{by \prefp{prop:vsmra_real_Ti}}
      \\&= \opT^{n}\opD\fx(t)
        && \text{by \prefp{def:vsmra_real_D}}
  \end{align*}
\end{proof}



%---------------------------------------
\begin{proposition}
\label{prop:vsmra_real_sa}
%---------------------------------------
Let $\vsmrasysLL$ be the \vsmratext of real functions.
Let $\opA^\ast$ be the \hi{adjoint} of a given operator $\opA$.
\formbox{
  \mcom{\left.\begin{array}{llclC}
    1. & \opT  \fx(t) &\eqd&         \fx(t-1) & \forall \fx\in\spLL \\
    2. & \opD  \fx(t) &\eqd& \sqrt{2}\fx(2t)  & \forall \fx\in\spLL
  \end{array}\right\}}{definition of $\opT$ and $\opD$ (\prefp{def:vsmra_real_T})}
  \qquad\implies\qquad
  \mcom{\brp{\sum_n \opT^n} = \brp{\sum_n \opT^n}^\ast}
       {$\brp{\sum_n \opT^n}$ is self-adjoint}
}
\end{proposition}
\begin{proof}
   Let $\opA\eqd\brp{\sum_n \opT^n}$. 
    \begin{align*}
      \inprod{(\opA\fx)(t)}{\fy(t)}
        &= \inprod{\sum_n \fx(t+n)}{\fy(t)}
      \\&= \sum_n \inprod{\fx(t+n)}{\fy(t)}
        && \text{by additivity property of $\inprodn$ \prefpo{def:inprod}}
      \\&= \sum_n \inprod{\fx(u)}{\fy(u-n)}
        && \text{where $u=t+n$}
      \\&= \inprod{\fx(u)}{\sum_n \fy(u-n)}
      \\&= \inprod{\fx(u)}{\sum_n \fy(u+n)}
      \\&= \inprod{\fx(t)}{\sum_n \fy(t+n)}
      \\&= \inprod{\fx(t)}{(\opA\fy)(t)}
      \\&\implies \opA=\opAa 
      \\&\implies \text{ $\opA$ is self-adjoint}
    \end{align*}
\end{proof}



%---------------------------------------
\begin{theorem}
\label{thm:vsmra_real}
%---------------------------------------
Let $\spLL$ be the set of real Lebesgue measurable functions.
\formbox{
  \mcom{\left.\begin{array}{llclC}
    1. & \opT  \fx(t) &\eqd&         \fx(t-1) & \forall \fx\in\spLL \\
    2. & \opD  \fx(t) &\eqd& \sqrt{2}\fx(2t)  & \forall \fx\in\spLL
  \end{array}\right\}}{definition of $\opT$ and $\opD$ (\prefp{def:vsmra_real_T})}
  \quad\implies\quad
  \text{$\vsmrasysLL$ is a \vsmratext}.
}
\end{theorem}
\begin{proof}
  \begin{enumerate}
    \item Proof that $\opT^n\opD = \opD\opT^{2n}$:  By \prefpp{prop:vsmra_real_commute}
    \item Proof that $\brp{\sum_n \opT^n}$ is normal:
      \begin{enumerate}
        \item By \prefpp{prop:vsmra_real_sa}, $\brp{\sum_n \opT^n}$ is self-adjoint.
        \item Because self-adjoint $\implies$ normal, 
              $\brp{\sum_n \opT^n}$ is also normal.
      \end{enumerate}
    \item Proof that $\normop{\opT}=\normop{\opD}=1$: 
      \begin{enumerate}
        \item By \prefpp{prop:vsmra_real_Ta} and \prefpp{prop:vsmra_real_Ti},
          $\opTi=\opTa$ and $\opDi=\opDa$.
        \item Therefore, $\opT$ and $\opD$ are both unitary operators because
          $\opTa\opT=\opT\opTa=\opI$ and $\opDa\opD=\opD\opDa=\opI$.
        \item Because $\opT$ and $\opD$ are unitary operators, 
          by \prefpp{thm:unitary_prop}
          $\normop{\opT}=\normop{\opD}=1$.
    \end{enumerate}
  \end{enumerate}
\end{proof}



%---------------------------------------
\begin{proposition}
\label{prop:vsmra_real_FT}
\label{prop:vsmra_real_FD}
%---------------------------------------
Let $\vsmrasysLL$ be the \vsmratext of real functions and 
$\opFT$ the Fourier transform defined as
$\ds \brs{\opFT \fx}(\omega) \eqd \frac{1}{\sqrt{2\pi}} \int_t \fx(t) e^{-i\omega t} \dt$.
\formbox{\begin{array}{>{\ds}rc>{\ds}l@{\qquad}D}
  \opFT\opT^n  &=& e^{-i\omega n} \opFT 
\end{array}}
\end{proposition}
\begin{proof}
\begin{align*}
  \opFT\opT^n \fx(t)
    &= \opFT \fx(t-n)
    && \text{by definition of $\opT$ \prefpo{def:vsmra_real_T}}
  \\&= \frac{1}{\sqrt{2\pi}} \int_t \fx(t-n) e^{-i\omega t} \dt
  \\&= \frac{1}{\sqrt{2\pi}} \int_u \fx(u) e^{-i\omega (u+n)} \du
    && \text{where $u\eqd t-n$}
  \\&= e^{-i\omega (n)}\;\brs{\frac{1}{\sqrt{2\pi}} \int_u \fx(u) e^{-i\omega u} \du}
  \\&= e^{-i\omega (n)}\;\opFT \fx(t)
\end{align*}
\end{proof}


%---------------------------------------
\begin{proposition}
\label{prop:vsmra_real_FD}
%---------------------------------------
Let $\vsmrasysLL$ be the \vsmratext of real functions.
\formbox{
  \left\{\begin{array}{rcl}
    \opFT\opD &=& \opDi\opFT  \\
    \opD\opFT &=& \opFT\opDi
  \end{array}\right\}
  \qquad\text{where}\qquad
  \brs{\opFT \fx}(\omega) \eqd \frac{1}{\sqrt{2\pi}} \int_t \fx(t) e^{-i\omega t} \dt.
  }
\end{proposition}
\begin{proof}
\begin{align*}
  \opFT\opD\ff(t)
    &= \opF \brs{\sqrt{2}\,\ff(2t)}
    && \text{by definition of $\opD$ \prefpo{def:vsmra_real_D}}
  \\&= \frac{1}{\sqrt{2\pi}}\,\int_t \brs{\sqrt{2}\,\ff(2t)} e^{-i\omega t} \dt
    && 
  \\&= \frac{1}{\sqrt{2\pi}}\,\int_u \brs{\sqrt{2}\,\ff(u)} e^{-i\omega \frac{u}{2}} \frac{1}{2}\du
    && \text{let $u\eqd 2t \implies t=\frac{1}{2}u$}
  \\&= \cwt \, \frac{1}{\sqrt{2\pi}}\,
       \int_u \ff(u) e^{-i\frac{\omega}{2} u} \du
  \\&= \cwt \, \frac{1}{\sqrt{2\pi}}\,
       \int_u \ff(u) e^{-i\frac{\omega}{2} u} \du
  \\&= \opDi\,\brs{ \frac{1}{\sqrt{2\pi}}\,
       \int_u \ff(u) e^{-i\omega u} \du}
    && \text{by \prefp{prop:vsmra_real_Di}}
  \\&= \opDi\, \opFT \, \ff(t)
  \\
  \opD\opFT\,\ff(t)
    &= \opD \brs{\frac{1}{\sqrt{2\pi}} \int_t \ff(t) e^{-i\omega t} \dt  }
  \\&= \frac{\sqrt{2}}{\sqrt{2\pi}} \int_t \ff(t) e^{-i2\omega t} \dt
    && \text{by definition of $\opD$ \prefpo{def:vsmra_real_D}}
  \\&= \frac{\sqrt{2}}{\sqrt{2\pi}} \int_u \ff\brp{\frac{u}{2}} e^{-i\omega u} \frac{1}{2}\du
    && \text{let $u\eqd 2t \implies t=\frac{1}{2}u$}
  \\&= \frac{1}{\sqrt{2\pi}} \int_u \brs{\cwt  \ff\brp{\frac{u}{2}} }e^{-i\omega u} \du
  \\&= \frac{1}{\sqrt{2\pi}} \int_u \brs{\opDi \ff}(u) \,e^{-i\omega u} \du
    && \text{by \prefp{prop:vsmra_real_Di}}
  \\&= \opFT\opDi \ff(t)
    && 
\end{align*}
\end{proof}



%---------------------------------------
\begin{corollary}
\label{cor:vsmra_real_DFD}
%---------------------------------------
Let $\vsmrasysLL$ be the \vsmratext of real functions.
\formbox{
  \left\{\begin{array}{rcl cl}
    \opD  &=& \opFT\opDi\opFTi &=& \opFTi\opDi\opFT \\
    \opFT &=& \opD\opFT\opD    &=& \opDi\opFT\opDi  
  \end{array}\right\}
  \qquad\text{where}\qquad
  \brs{\opFT \fx}(\omega) \eqd \frac{1}{\sqrt{2\pi}} \int_t \fx(t) e^{-i\omega t} \dt.
  }
\end{corollary}
\begin{proof}
These results follow from \prefpp{prop:vsmra_real_FD}.
\end{proof}


%--------------------------------------
\begin{proposition}
\label{prop:vsmra_real_Fphi}
%--------------------------------------
Let $\vsmrasysLL$ be the \vsmratext of real functions.\\
Let 
  $\begin{array}[t]{rc>{\ds}l c>{\ds}l D}
    \Fphi\brp{\omega} 
      &\eqd& \opFT \vphi       
      &\eqd& \frac{1}{\sqrt{2\pi}}\int_t \fphi(t) e^{-i\omega t} \dt        
      &      (Fourier transform)
      \\
    \Fh(\omega) 
      &\eqd& \opDTFT\seqn{h_n} 
      &\eqd& \sum_n h_n e^{-i\omega n} 
      &      (Discrete-time Fourier Transform).
  \end{array}$
\propbox{
  \Fphi\brp{\omega} = \brp{\opDi \opDTFT \seqn{h_n}} \; \brp{\opDi \opF \vphi}
                    = \frac{1}{2}\: \Fh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
  }
\end{proposition}
\begin{proof}
\begin{align*}
  \Fphi\brp{\omega} 
    &= \opF\vphi
  \\&= \opF \sum_n h_n \opD \opT^n \vphi
    && \text{by dilation equation \prefpo{thm:vsmra_dilation}}
  \\&= \sum_n h_n \opF \opD \opT^n \vphi
  \\&= \sum_n h_n \opDi \opF \opT^n \vphi
    && \text{by \prefp{prop:vsmra_real_FD}}
  \\&= \sum_n h_n \opDi e^{-i\omega n} \opF \vphi
    && \text{by \prefp{prop:vsmra_real_FT}}
  \\&= \brp{\opDi \sum_n h_n e^{-i\omega n}} \; \brp{\opDi \opF \vphi}
  \\&= \brp{\opDi \opDTFT \seqn{h_n}} \; \brp{\opDi \opF \vphi}
  \\&= \frac{1}{\sqrt{2}}\: \Fh\brp{\frac{\omega}{2}}\: \frac{1}{\sqrt{2}}\Fphi\brp{\frac{\omega}{2}}
    && \text{by \prefp{prop:vsmra_real_Di}}
  \\&= \frac{1}{2}\: \Fh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
\end{align*}
\end{proof}



%--------------------------------------
\begin{theorem}[Partition of unity]
\label{thm:vsmra_real_unity}
\index{partition of unity}
\index{theorems!partition of unity}
%--------------------------------------
Let $\vsmrasysLL$ be the \vsmratext of real functions.
\formbox{
  \mcom{\sum_n \opT^n \vphi = 1}
       {partition of unity}
  \qquad\iff\qquad
  \mcom{\sum_n (-1)^n h_n=0}
       {zero at $z=-1$}
  }
\end{theorem}
\begin{proof}
\begin{align*}
  \intertext{1. Proof that 
  $\sum_n \opT^n \vphi = 1 \impliedby \sum_n (-1)^n h_n=0$:}
  \sum_n \opT^n \vphi
    &= \sum_n \opT^n \brs{\sum_m h_m \opD \opT^m \vphi}
    && \text{by dilation equation \prefpo{thm:vsmra_dilation}}
  \\&= \sum_m h_m \sum_n \opT^n \opD \opT^m \vphi
  \\&= \sum_m h_m \sum_n \opD \opT^{2n} \opT^m \vphi
  \\&= \opD \sum_m h_m \sum_n \opT^{2n} \opT^m \vphi
  \\&= \opD \sum_m h_m \brs{\sqrt{\frac{2\pi}{2}}\opFSi\opS_2\opFT\brp{\opT^m \vphi}}
    && \text{by PSF \prefpo{thm:psf}}
  \\&= \sqrt{\pi} \opD \sum_m h_m \opFSi\opS_2 e^{-i\omega m}\opFT\vphi
    && \text{by \prefp{prop:vsmra_real_FT}}
  \\&= \sqrt{\pi} \opD \sum_m h_m \opFSi e^{-i\frac{2\pi}{2}k m}\opS_2 \opFT\vphi
    && \text{by definition of $\opS$ \prefpo{thm:psf}}
  \\&= \sqrt{\pi} \opD \sum_m h_m \opFSi \brp{-1}^{km} \opS_2 \opFT\vphi
  \\&= \sqrt{\pi} \opD \sum_m h_m \brs{\cwt \sum_k \brp{-1}^{km} \brp{\opS_2 \opFT\vphi} e^{i\frac{2\pi}{2}kt}}
    && \text{by definition of $\opFSi$ \prefpo{def:opFSi}}
  \\&= \frac{\sqrt{2\pi}}{2} \opD \sum_k  \brp{\opS_2 \opFT\vphi} e^{i\pi kt}\sum_m \brp{-1}^{km} h_m 
  \\&= \frac{\sqrt{2\pi}}{2} \opD \sum_{k\in\Ze} \brp{\opS_2 \opFT\vphi} e^{i\pi kt}\sum_m \brp{-1}^{km} h_m 
     + \frac{\sqrt{2\pi}}{2} \opD \sum_{k\in\Zo}  \brp{\opS_2 \opFT\vphi} e^{i\pi kt}\sum_m \brp{-1}^{km} h_m 
  \\&= \frac{\sqrt{2\pi}}{2} \opD \sum_{k\in\Ze} \brp{\opS_2 \opFT\vphi} e^{i\pi kt} \mcom{\sum_m h_m}{$\sqrt{2}$}
     + \frac{\sqrt{2\pi}}{2} \opD \sum_{k\in\Zo}  \brp{\opS_2 \opFT\vphi} e^{i\pi kt} \mcom{\sum_m \brp{-1}^m h_m }{$0$}
  \\&= \sqrt{\pi} \opD \sum_{k\in\Ze} \brp{\opS_2 \opFT\vphi} e^{i\pi kt} 
  \\&= \sqrt{\pi} \opD \sum_{k\in\Ze} \Fphi\brp{\frac{2\pi}{2}k} e^{i\pi kt} 
  \\&= \sqrt{\pi} \opD \sum_{k\in\Z} \Fphi\brp{2\pi k} e^{i2\pi kt} 
  \\&= \sqrt{\pi} \opD \Fphi\brp{2\pi\cdot0} e^{i2\pi\cdot 0} 
     + \mcom{\sqrt{\pi} \opD \sum_{k\in\Z\setd\setn{0}} \Fphi\brp{2\pi k} e^{i2\pi kt}}{$0$ because no imaginary parts}
  \\&= \frac{2\sqrt{\pi}}{\sqrt{2}} \Fphi\brp{0} 
    && \text{by definition of $\opD$ \prefpo{def:vsmra_real_D}}
  \\
  \intertext{2. Proof that 
  $\sum_n \opT^n \vphi = 1 \implies \sum_n (-1)^n h_n=0$:}
  1
    &= \sum_n \opT^n \vphi
    && \text{by left hypothesis}
  \\&= \sqrt{2\pi}\: \opFSi \opS \opF \vphi
    && \text{by PSF \prefpo{thm:psf}}
  \\&= \sqrt{2\pi}\: \opFSi \opS 
       \brp{\opDi\sum_n h_n e^{-i\omega n}}\: 
       \brp{\opDi \opF \vphi}
    && \text{by \prefp{prop:vsmra_real_Fphi}}
  \\&= \sqrt{2\pi}\: \opFSi 
       \brp{\opS\opDi\sum_n h_n e^{-i\omega n}}\: 
       \brp{\opS \opF\opD \vphi}
    && \text{by \prefp{prop:wav_FD}}
  \\&= \sqrt{2\pi}\: \opFSi 
       \brp{\opS\frac{1}{\sqrt{2}}\sum_n h_n e^{-i\frac{\omega}{2} n}}\: 
       \brp{\opS \opF\opD \vphi}
    && \text{by \prefp{prop:vsmra_real_Di}}
  \\&= \sqrt{\pi}\: \opFSi 
       \brp{\sum_n h_n e^{-i\frac{2\pi k}{2} n}}\: 
       \brp{\opS \opF\opD \vphi}
    && \text{by definition of $\opS$ \prefpo{thm:psf}}
  \\&= \sqrt{\pi}\: \opFSi 
       \brp{\sum_n h_n (-1)^{kn}}\: 
       \brp{\opS \opDi\opF \vphi}
  \\&= \sqrt{\pi}\: \opFSi 
       \brp{\sum_n h_n (-1)^{kn}}\: 
       \brp{\opS\frac{1}{\sqrt{2}}\Fphi\brp{\frac{\omega}{2}}}
  \\&= \sqrt{\pi}\: \opFSi 
       \brp{\sum_n h_n (-1)^{kn}}\: 
       \brp{\frac{1}{\sqrt{2}}\Fphi\brp{\frac{2\pi k}{2}}}
  \\&= \sqrt{\frac{\pi}{2}}\: \opFSi 
       \brp{\sum_n h_n (-1)^{kn}}\: 
       \brp{\Fphi\brp{\frac{2\pi k}{2}}}
  \\&= \sqrt{\frac{\pi}{2}}\: \sum_k 
       \sum_n h_n (-1)^{kn}\: 
       \Fphi\brp{\pi k}
       e^{i 2\pi k t}
  \\&= \sqrt{\frac{\pi}{2}}\brs{
       \sum_{\text{$k$ even}} 
       \sum_n h_n (-1)^{kn}\: 
       \Fphi\brp{\pi k}
       e^{i 2\pi k t}
       +
       \sum_{\text{$k$ odd}} 
       \sum_n h_n (-1)^{kn}\: 
       \Fphi\brp{\pi k}
       e^{i 2\pi k t}
       }
  \\&= \sqrt{\frac{\pi}{2}}\brs{
       \sum_{\text{$k$ even}} 
       \brp{\cancelto{\sqrt{2}}{\sum_n h_n}} \: 
       \Fphi\brp{\pi k}
       e^{i 2\pi k t}
       +
       \sum_{\text{$k$ odd}} 
       \brp{\sum_n h_n (-1)^{n}}\: 
       \Fphi\brp{\pi k}
       e^{i 2\pi k t}
       }
  \\&= \sqrt{\frac{\pi}{2}}\sum_k \brs{
       \sqrt{2} \: 
       \Fphi\brp{\pi 2k}
       e^{i 2\pi 2k t}
       +
       \brp{\sum_n h_n (-1)^{n}}\: 
       \Fphi\brp{\pi [2k+1]}
       e^{i 2\pi [2k+1] t}
       }
  \\&= \sqrt{\frac{\pi}{2}}\sum_k\brs{
       \sqrt{2} 
       \Fphi\brp{2\pi k}
       +
       \brp{\sum_n h_n (-1)^{n}}\: 
       \Fphi\brp{\pi [2k+1]}
       e^{i 2\pi t}
       }e^{i 4\pi k t}
  \\&= \sqrt{\frac{\pi}{2}}\brs{
       \sqrt{2} 
       \Fphi(0)
       +
       \brp{\sum_n h_n (-1)^{n}}\: 
       \Fphi(\pi)
       e^{i 2\pi t}
       }
    && \text{$k$ must be $0$ to make real constant for all $t$}
  \\&\implies \qquad \brp{\sum_n h_n (-1)^{n}}=0
\end{align*}
\end{proof}


%=======================================
\subsubsection{Design examples}
%=======================================
%--------------------------------------
\begin{example}
\label{ex:sw_gh_d1}
%--------------------------------------
The figure below illustrates scaling and wavelet coefficients and functions
for the \hie{Haar} scaling function---
which is also the \hie{Daubechies-$p1$} scaling function.
\begin{align*}
  h_0 + h_1 &= \sqrt{2}    &&\text{(admissibility equation)} \\
  h_0 - h_1 &= 0           &&\text{(partition of unity)}  \\
  \\
  2h_0 &= \sqrt{2}         &&\text{(add two equations together)}\\
  2h_1 &= \sqrt{2}         &&\text{(subtract second from first)} \\
  \\
  h_0 &= \frac{1}{\sqrt{2}} \\
  h_1 &= \frac{1}{\sqrt{2}} 
\end{align*}

  \parbox[b][35\tw/160][c]{5\tw/16}{\begin{tabular}[b]{l|r|r}
    $n$ & $\sqrt{2} h_n $  \\
    \hline
    0   & $1$    \\
    1   & $1$  
  \end{tabular}}
  \includegraphics*[width=5\tw/16, clip=true]{../common/wavelets/d1sc_x3125.eps}
\end{example}

%--------------------------------------
\begin{example}
\label{ex:sw_gh_d2}
%--------------------------------------
The figure below illustrates scaling coefficients and functions
for the \hie{Daubechies-$p2$} scaling function.
\begin{enumerate}
\item Set of simultaneous equations:
\[\begin{array}{*{9}{r}l}
  h_0      &+& h_1      &+& h_2   &+& h_3   &=& \sqrt{2}      
  &\text{(admissibility)} 
  \\
  h_0      &-& h_1      &+& h_2   &-& h_3   &=& 0          
  &\text{(partition of unity)} 
  \\
  h_0^2    &+& h_1^2    &+& h_2^2 &+& h_3^2 &=& 1                  
  &\text{($m=0$ orthonormal quadrature condition)} 
  \\
  \fh_0\fh_2 &+& \fh_1\fh_3 & &         & &         &=& 0
  &\text{($m=1$ orthonormal quadrature condition)} 
\end{array}\]

\item These equations are linearly independent, however they are 
      still dependent\footnote{
        Many thanks to X\=in L\'in X\`ie for pointing this out to me!!!
%        \begin{tabular}[t]{ccc}
%          {\MiQ\cH225} & \z{\MgQ\cH106} & \z{\MjQ\cH204}  \\
%          X\`ie        & X\=in          & L\'in           \\
%          to thank     & glad           & continuous heavy rain
%        \end{tabular}
        }
      as shown next:
  \begin{align*}
    &  [(h_0+h_1+h_2+h_3)+(h_0-h_1+h_2-h_3)]^2+[(h_0+h_1+h_2+h_3)-(h_0-h_1+h_2-h_3)]^2
  \\&= [2h_0+2h_2]^2+[2h_1+2h_3]^2
  \\&= 4[h_0+h_2]^2+4[h_1+h_3]^2
  \\&= 4[h_0^2+2h_0h_2+h_2^2]+4[h_1^2+2h_1h_3+h_3^2]
  \\&= 4[h_0^2 + h_1^2 + h_2^2 + h_3^2 + 2h_0h_2 + 2h_1h_3]
  \\&= 4(h_0^2 + h_1^2 + h_2^2 + h_3^2) + 8(h_0h_2 + h_1h_3)
  \\ \implies & \text{The last two equations are (non-linearly) dependent on the first two.}
  \end{align*}

\item Because of this dependence, the system of equations has one degree of freedom.

\item Solutions using {\em Maxima}\texttrademark \\
  \begin{verbatim}
    solve([h0+h1+h2+h3=sqrt(2),h0-h1+h2-h3=0,h0^2+h1^2+h2^2+h3^2=1,h0*h2+h1*h3=0],
          [h0,h1,h2,h3]
         );
  \end{verbatim}
\begin{enumerate}
\item {\em Maxima} first solution:
  \begin{align*}
    h_1 &= \frac{\sqrt{2}}{4}\left(\sqrt{-8h_0^2+4\sqrt{2}h_0+1}+1\right)
  \\h_2 &= \frac{2h_0-\sqrt{2}}{2}
  \\h_3 &= \frac{\sqrt{2}}{4}\left(\sqrt{-8h_0^2+4\sqrt{2}h_0+1}-1\right)
  \end{align*}

\item {\em Maxima} second solution:
  \begin{align*}
    h_1 &= \frac{\sqrt{2}}{4}\left(\sqrt{-8h_0^2+4\sqrt{2}h_0+1}-1\right)
  \\h_2 &= -\frac{2h_0-\sqrt{2}}{2}
  \\h_3 &= \frac{\sqrt{2}}{4}\left(\sqrt{-8h_0^2+4\sqrt{2}h_0+1}+1\right)
  \end{align*}
\end{enumerate}
\end{enumerate}

  \parbox[b][35\tw/160][c]{5\tw/16}{\begin{tabular}[b]{l|r|r}
    $n$ & $\sqrt{2} h_n $ & $\sqrt{2} g_n $ \\
    \hline
      0   & $\frac{1+\sqrt{3}}{4}$  \\ %& $ \frac{1-\sqrt{3}}{4}$  \\
      1   & $\frac{3+\sqrt{3}}{4}$  \\ %& $-\frac{3-\sqrt{3}}{4}$  \\
      2   & $\frac{3-\sqrt{3}}{4}$  \\ %& $ \frac{3+\sqrt{3}}{4}$  \\
      3   & $\frac{1-\sqrt{3}}{4}$  \\ %& $-\frac{1+\sqrt{3}}{4}$  \\
  \end{tabular}}
  \includegraphics*[width=5\tw/16, clip=true]{../common/wavelets/d2sc_x3125.eps}
  %\includegraphics*[width=5\tw/16, clip=true]{../common/wavelets/d2wc_x3125.eps}
\end{example}




%=======================================
\section{Fourier analysis}
%=======================================

%--------------------------------------
\begin{definition}
\label{def:wav_fkern}
%--------------------------------------
Let the \hid{Fourier kernel} $\fkernn:\R^2\to\C$ be defined as 
  \defbox{ 
    \fkern{t}{\omega} \eqd \fkerne{t}{\omega}
    \qquad \forall t,\omega\in\R
  }
\end{definition}

%--------------------------------------
\begin{lemma}
\label{lem:TDk}
%--------------------------------------
Let $\opT$ be the translation operator,
    $\opD$ be the dilation operator,
    $\opAa$ be the adjoint of an operator $\opA$,
and $\fkern{t}{\omega}$ be the Fourier kernel.
\formbox{\begin{array}{rcl@{\qquad}C}
  \opT^n \fkern{t}{\omega} &=& \fkern{t-n}{\omega}        & \forall n\in\Z \\
  \opD   \fkern{t}{\omega} &=& \sqrt{2}\fkern{2t}{\omega} &  \\
  (\opT^n\opD)^\ast \fkern{t}{\omega} 
    &=& \sqrt{2}\fkern{n}{\frac{1}{2}\omega}
                \fkern{t}{\frac{1}{2}\omega} &  \forall n\in\Z
\end{array}}
\end{lemma}
\begin{proof}
\begin{align*}
  \opT^n \fkern{t}{\omega}
    &= \opT^n e^{i\omega t}
    && \text{by definition of $\fkernn$ \prefpo{def:wav_fkern}}
  \\&= e^{i\omega (t-n)}
    && \text{by definition of $\opT$ \prefpo{def:wav_opT}}
  \\&= \fkern{t-n}{\omega}
    && \text{by definition of $\fkernn$ \prefpo{def:wav_fkern}}
  \\
  \\
  \opD \fkern{t}{\omega}
    &= \opD e^{i\omega t}
    && \text{by definition of $\fkernn$ \prefpo{def:wav_fkern}}
  \\&= \sqrt{2} e^{i\omega (2t)}
    && \text{by definition of $\opD$ \prefpo{def:wav_opD}}
  \\&= \fkern{2t}{\omega}
    && \text{by definition of $\fkernn$ \prefpo{def:wav_fkern}}
  \\
  \\
  (\opT^n\opD)^\ast \fkern{t}{\omega}
    &= \opDa\left(\opT^n\right)^\ast \; \fkern{t}{\omega}
    && \text{by \prefp{thm:adjoint_prop}}
  \\&= \opDa\left(\opTa\right)^n \; \fkern{t}{\omega}
    && \text{by \prefp{thm:adjoint_prop}}
  \\&= \opDi\left(\opTi\right)^n \; \fkern{t}{\omega}
    && \text{by \prefp{thm:TD_unitary}}
  \\&= \opDi\left(\opTi\right)^n \; e^{i\omega t}
    && \text{by definition of $\fkernn$ \prefpo{def:wav_fkern}}
  \\&= \opDi e^{i\omega (t+n)}
    && \text{by \prefp{thm:wav_opTi}}
  \\&= \cwt  \; e^{i\omega \frac{1}{2} (t+n)}
    && \text{by \prefp{thm:wav_opDi}}
  \\&= \cwt  \; e^{i\frac{1}{2}\omega n}
                          \; e^{i\frac{1}{2}\omega t}
  \\&= \cwt  \; \fkern{t}{\frac{1}{2}\omega}
                          \; \fkern{n}{\frac{1}{2}\omega}
\end{align*}
\end{proof}

%--------------------------------------
\begin{theorem}
\label{thm:Phi=HPhi}
\index{dilation equation}
\index{refinement equation}
\index{two-scale difference equation}
\raggedright
%--------------------------------------
Let $\spX$ be a vector space with unit vector $\vunit$,
wavelet basis lattice $\wavlatbasis$,
and ``\hie{Fourier transforms}"
\[ \begin{array}{rcl cl}
     \Fphi(\omega) &\eqd& \inprod{\fphi(t)}{\fkern{t}{\omega}}
                   &\eqd& \inprodint{\fphi(t)}{\fkernea{t}{\omega}}
     \\
     \Fpsi(\omega) &\eqd& \inprod{\fpsi(t)}{\fkern{t}{\omega}}
                   &\eqd& \inprodint{\fpsi(t)}{ \fkernea{t}{\omega}}
\end{array} \]
and ``\hie{discrete Fourier transforms}"
\[ \begin{array}{rcl cl @{\qquad}l}
     \Fh(\omega) &\eqd& \inproda{\fphi(t)}{\fkern{n}{\omega}}
                 &\eqd& \sum_n h_n \fkerna{n}{\omega}
                 &      n \in\Z
     \\
     \Fg(\omega) &\eqd& \inproda{\fpsi(t)}{\fkern{n}{\omega}}
                 &\eqd& \sum_n g_n \fkerna{n}{\omega} 
                 &      n \in\Z
\end{array} \]
\formbox{
\renewcommand{\arraystretch}{1}
\begin{array}{rc>{\ds}l c>{\ds}l}
   \Fphi(\omega) &=& \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{2}\right)\Fphi\left(\frac{\omega}{2}\right)
                 &=& \mcomr{\inprod{\vphi}{\vunit}}{(normally set to $1$)} \;
                     \prod_{n=1}^\infty \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{2^n}\right)
   \\
   \Fpsi(\omega) &=& \frac{1}{\sqrt{2}} \Fg\left(\frac{\omega}{2}\right)\Fphi\left(\frac{\omega}{2}\right)
   \\
\end{array}
}
\end{theorem}
\begin{proof}
\begin{align*}
   \intertext{\ding{"C0} Proof that
     $\Fphi(\omega)=\cwt  \Fh\left(\frac{\omega}{2}\right)\Fphi\left(\frac{\omega}{2}\right)$:}
   \opF\vphi
     &= \inprod{\vphi}{\fkern{t}{\omega}}
   \\&= \inprod{\sum_n  h_n  \opT^n\opD\vphi}{\fkern{t}{\omega}}
     && \text{by dilation equation \prefpo{thm:dilation_eq}}
   \\&= \sum_n  h_n \inprod{\opT^n\opD\vphi}{\fkern{t}{\omega}}
     && \text{by definition of $\inprod{\cdot}{\cdot}$ \prefpo{def:inprod}}
   \\&= \sum_n  h_n \inprod{\vphi}{\left(\opT^n\opD\right)^\ast \fkern{t}{\omega}}
     && \text{by definition of operator adjoint \prefpo{def:op_adj}}
   \\&= \sum_n  h_n \inprod{\vphi}{\cwt \fkern{n}{\frac{1}{2}\omega}\fkern{t}{\frac{1}{2}\omega}}
     && \text{by \prefp{lem:TDk}}
   \\&= \sum_n  h_n  \;
        \cwt  \; 
        \fkerna{n}{\frac{1}{2}\omega} \;
        \inprod{\vphi}{\fkern{t}{\frac{1}{2}\omega}}
     && \text{by property of innerproducts \prefpo{def:inprod}}
   \\&= \cwt  \;
        \inprod{h_n}{\fkern{n}{\frac{1}{2}\omega}} \;
        \inprod{\vphi}{\fkern{t}{\frac{1}{2}\omega}}
     && \text{by assumption}
  \\&= \cwt \, \Fh\left(\frac{\omega}{2}\right)\; \Fphi\left(\frac{\omega}{2}\right)
    && \text{by definitions of $\Fg$ and $\Fphi$}
\\
   \intertext{\ding{"C1} Proof that
     $\Fpsi(\omega)=\cwt  \Fg\left(\frac{\omega}{2}\right)\Fphi\left(\frac{\omega}{2}\right)$:
     essentially same as above but substitute $g_n$ for $h_n$.
     }
\\
   \intertext{\ding{"C2} Proof that
     $\Fphi(\omega)=\int_t \fphi(t) \dt\: \prod_{n=1}^\infty \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{2^n}\right)$:
     }
   \Fphi(\omega)
     &= \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{2}\right)\Fphi\left(\frac{\omega}{2}\right)
     && \text{by part \ding{"C0}}
   \\&= \left[
          \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{2}\right)
          \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{4}\right)
        \right]\; \Fphi\left(\frac{\omega}{4}\right)
   \\&= \left[
          \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{2}\right)
          \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{4}\right)
          \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{8}\right)
        \right]\; \Fphi\left(\frac{\omega}{8}\right)
   \\&\vdots
   \\&= \left[\prod_{n=1}^\infty \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{2^n}\right)\right]
        \left[ \lim_{n\to\infty} \Fphi\left(\frac{\omega}{n}\right) \right]
   \\&= \Fphi\left(0\right) \;
        \left[\prod_{n=1}^\infty \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{2^n}\right)\right]
   \\&= \left. \inprod{\vphi}{\fkern{t}{\omega}} \right|_{\omega=0} \;
        \left[ \prod_{n=1}^\infty \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{2^n}\right) \right]
     && \text{by definition of $\Fh(\omega)$}
   \\&= \inprod{\vphi}{\vunit} \;
        \prod_{n=1}^\infty \frac{1}{\sqrt{2}} \Fh\left(\frac{\omega}{2^n}\right)
\end{align*}
\end{proof}



%=======================================
\section{Fourier analysis necessary conditions}
%=======================================

\prefp{def:wav_RS} (next) defines six quantities.
In this text, the quantities' notation and names are chosen
to be similar to notation and terminology used in the study
of {\em random processes}.
%--------------------------------------
\begin{definition}
\citep{chui}{134}
\label{def:wav_RS}
\index{scaling autocorrelation function          }
\index{wavelet autocorrelation function          }
\index{scaling wavelet cross-correlation function}
\index{scaling spectral density function         }
\index{wavelet spectral density function         }
\index{scaling wavelet spectral density function }
\index{Laurent polynomial}
%--------------------------------------
Let $\wavsys$ be a \hi{wavelet system}.
We define the following quantities:\footnote{
  In the special case of an \hie{orthonormal \hi{wavelet system}} (\prefp{def:ows}),
  the spectral density relationships simplify greatly to 
  $\Sphi=1$, $\Spsi=1$, and $\Shs=0$
  (\prefp{lem:SSSo}).}
\defbox{
\begin{array}{>{\small}l >{\ds}rc>{\ds}l}
  \text{scaling autocorrelation function:}
  &  \Rphi(n)&\eqd& \inprod{\fphi(t)}{\fphi(t-n)}
  \\
  \text{wavelet autocorrelation function:}
  &   \Rpsi(n)&\eqd& \inprod{\fpsi(t)}{\fpsi(t-n)}
  \\
  \text{scaling wavelet cross-correlation function:}
  &   \Rhs (n)&\eqd& \inprod{\fphi(t)}{\fpsi(t-n)}
  \\
  \text{scaling spectral density function:}
  &  \Sphi(\omega)&\eqd& \sum_n \Rphi(n) \fkerna{n}{\omega}
  \\
  \text{wavelet spectral density function:}
  &   \Spsi(\omega) &\eqd&   \sum_n \Rpsi(n) \fkerna{n}{\omega}
  \\
  \text{scaling wavelet spectral density function:}
  &   \Shs (\omega) &\eqd&   \sum_n \Rhs (n) \fkerna{n}{\omega}
\end{array}}
The Laurent polynomial $\Sphi(\omega)$ is called the
\hie{Euler-Frobenius polynomial}.
\end{definition}

The three spectral density functions defined in \prefpp{def:wav_RS} 
have an infinite series relationship with the Fourier transforms of the scaling and
and wavelet functions as shown in \pref{lem:SSS} (next).
%--------------------------------------
\begin{lemma}
\label{lem:SSS}
\citep{chui}{135}
%--------------------------------------
Let $\wavsys$ be a \hi{wavelet system}
with spectral density functions $\Sphi(\omega)$, $\Spsi(\omega)$, and $\Shs(\omega)$
as defined in \prefpp{def:wav_RS}.
\formbox{
\begin{array}{rc>{\ds}l}
  \Sphi(\omega) &=& \sum_n |\Fphi(\omega+2\pi n)|^2  \\
  \Spsi(\omega) &=& \sum_n |\Fpsi(\omega+2\pi n)|^2  \\
  \Shs (\omega) &=& \sum_n \Fphi(\omega+2\pi n) \Fpsi^\ast(\omega+2\pi n)
\end{array}
}
\end{lemma}
\begin{proof}
First note that
\begin{eqnarray}
  [\opFT\ff^\ast(-t)](\omega)
   &\eqd& \int_t \ff^\ast(-t) \fkernea{t}{\omega}\dt
   =    \int_u \ff^\ast(u) e^{i\omega u}\du
   =    \left[ \int_u \ff(u) e^{-i\omega u}\du \right]^\ast
   \eqd \Ff^\ast(\omega).\label{equ:f^ast}
\end{eqnarray}
\begin{align*}
%  \intertext{1. Proof that
%    $\Shs(\omega)=\sum_n \Fphi(\omega+2\pi n) \Fpsi^\ast(\omega+2\pi n)$:
%    }
  \Shs(\omega)
    &= \sum_n \Rhs (n) \fkerna{n}{\omega}
    && \text{by \prefp{def:wav_RS}}
  \\&= \sum_n \inprod{\fphi(x)}{\psi(x-n)} \fkerna{n}{\omega}
    && \text{by \prefp{def:wav_RS}}
  \\&= \sum_n \left[ \int_x \phi(x) \fpsi^\ast(-(u-x)) \dx\right]_{u=n} \fkerna{n}{\omega}
    && \text{by definition of $\inprod{\cdot}{\cdot}$ in space $\spLL$}
  \\&= \sum_n \left[ \fphi(u) \conv \fpsi^\ast(-u)\right](n) \fkerna{n}{\omega}
    && \text{by convolution definition (\prefp{def:conv} \prefpo{def:conv})}
  \\&= \sum_n \left[ \opFi \Fphi(\omega) \Fpsi^\ast(\omega)\right](n) \fkerna{n}{\omega}
    && \text{by Convolution Theorem (\pref{thm:conv} \prefpo{thm:conv})}
  \\&= \sum_n \Fphi(\omega+2\pi n) \Fpsi^\ast(\omega+2\pi n)
    && \text{by IPSF (\pref{thm:ipsf} \prefpo{thm:ipsf})}
\\
\\
%  \intertext{2. Proof that
%    $\Sphi(\omega)=\sum_n |\Fphi(\omega+2\pi n)|^2$:
%    }
  \Sphi(\omega)
    &= \sum_n \Rphi(n) \fkerna{n}{\omega}
    && \text{by \prefp{def:wav_RS}}
  \\&= \left. \sum_n \Rhs(n) \fkerna{n}{\omega} \right|_{\fpsi=\fphi}
  \\&= \left. \Shs(\omega) \right|_{\fpsi=\fphi}
    && \text{by \prefp{def:wav_RS}}
  \\&= \left.
       \sum_n \Fphi(\omega+2\pi n) \Fpsi^\ast(\omega+2\pi n)
       \right|_{\fpsi=\fphi}
    && \text{by 1.}
  \\&= \sum_n \Fphi(\omega+2\pi n) \Fphi^\ast(\omega+2\pi n)
  \\&= \sum_n \left| \Fphi(\omega+2\pi n) \right|^2
\\
\\
%  \intertext{3. Proof that
%    $\Spsi(\omega)=\sum_n |\Fpsi(\omega+2\pi n)|^2$:
%    }
  \Spsi(\omega)
    &= \sum_n \Rpsi(n) \fkerna{n}{\omega}
    && \text{by \prefp{def:wav_RS}}
  \\&= \left. \sum_n \Rhs(n) \fkerna{n}{\omega} \right|_{\fphi=\fpsi}
  \\&= \left. \Shs(\omega) \right|_{\fphi=\fpsi}
    && \text{by \prefp{def:wav_RS}}
  \\&= \left.
       \sum_n \Fpsi(\omega+2\pi n) \Fphi^\ast(\omega+2\pi n)
       \right|_{\fphi=\fpsi}
    && \text{by 1.}
  \\&= \sum_n \Fpsi(\omega+2\pi n) \Fpsi^\ast(\omega+2\pi n)
  \\&= \sum_n \left| \Fpsi(\omega+2\pi n) \right|^2
\end{align*}
\end{proof}


In this chapter, we don't assume the special case of orthonormality.
But good things happen if we do happen to have orthonormality.
One of them is that the spectral density equations in Lemma~\ref{lem:SSS}
simplify to constants.
This is shown in Lemma~\ref{lem:SSSo} (\prefpo{lem:SSSo}).

The {\em quadrature} necessary conditions of a \hi{wavelet system} are presented next.
These relations simplify significantly in the special case of
orthonormal \hi{wavelet system}s as presented in \prefpp{thm:quadcon}.
%--------------------------------------
\begin{theorem}[Quadrature conditions]
\footnote{
  {\em quadrature conditions}:\\ \hspace{6ex}
   \begin{tabular}[t]{lll}
      \citei{chui}    & page  135       \\
      \citei{goswami} & page  110
   \end{tabular}
  }
\label{thm:gen_quadcon}
\index{quadrature condition}
%--------------------------------------
Let $\wavsys$ be a \hi{wavelet system}.
\formbox{\begin{array}{rcl}
   \left|\Fh\left(\omega     \right)\right|^2 \Sphi(\omega) +
   \left|\Fh\left(\omega+\pi \right)\right|^2 \Sphi(\omega+\pi)
   &=& 2\Sphi(2\omega)
\\
   \left|\Fg\left(\omega\right)\right|^2\Sphi(\omega) +
   \left|\Fg\left(\omega+\pi \right)\right|^2 \Sphi(\omega+\pi)
   &=& 2\Spsi(2\omega)
\\
   \Fh(\omega     ) \Fg^\ast(\omega     )\Sphi(\omega)  +
   \Fh(\omega +\pi) \Fg^\ast(\omega +\pi)\Sphi(\omega+\pi)
   &=& 2\Shs(2\omega)
\end{array}}
\end{theorem}
\begin{proof}
First note that $\Fh(\omega)$ and $\Fg(\omega)$
are periodic with period $2\pi$ such that
\begin{eqnarray}
   \Fh\left(\omega+2\pi n\right)
     &=& \sum_m h(m)e^{-i \left(\omega+2\pi n\right)m}
     = \sum_m h(m)e^{-i\omega m}e^{-i2\pi nm} \nonumber
  \\&=& \sum_m h(m)e^{-i\omega m}\cdot1
     = \Fh(\omega)
     \label{equ:qc1}
\\
\\
   \Fg\left(\omega+2\pi n\right)
     &=& \sum_m \fg(m) e^{-i(\omega+2\pi n)m}
      =  \sum_m \fg(m) e^{-i\omega m} e^{-i2\pi nm}
      =  \sum_m \fg(m) e^{-i\omega m}  \nonumber
  \\&=& \Fg(\omega)
     \label{equ:psi_qc1}
\end{eqnarray}

\begin{enumerate}
\item Proof that
   $
   \left|\Fh\left(\omega     \right)\right|^2 \Sphi(\omega) +
   \left|\Fh\left(\omega+\pi \right)\right|^2 \Sphi(\omega+\pi)
   = 2\Sphi(2\omega)
   $:
\begin{align*}
   2\Sphi(2\omega)
     &\eqd 2\sum_n \left|\Fphi(2\omega+2\pi n)\right|^2
         \hspace{1cm}\text{by Lemma~\ref{lem:SSSo}}
   \\&= 2\sum_n \left|\cwt \Fh\left(\frac{2\omega+2\pi n}{2}\right)\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2
        \hspace{1cm}\text{by Corollary~\ref{cor:Phi=HPhi}}
   \\&= \sum_{n\;\mathrm{even}} \left|\Fh\left(\frac{2\omega+2\pi n}{2}\right)\right|^2\left|\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2 +
        \sum_{n\;\mathrm{odd} } \left|\Fh\left(\frac{2\omega+2\pi n}{2}\right)\right|^2\left|\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2
   \\&= \sum_n \left|\Fh\left(\omega+2\pi n\right)\right|^2\left|\Fphi\left(\omega+2\pi n\right)\right|^2 +
        \sum_n \left|\Fh\left(\omega+2\pi n+\pi \right)\right|^2\left|\Fphi\left(\omega+2\pi n+ \pi \right)\right|^2
   \\&= \sum_n \left|\Fh\left(\omega\right)\right|^2\left|\Fphi\left(\omega+2\pi n\right)\right|^2 +
        \sum_n \left|\Fh\left(\omega+\pi \right)\right|^2\left|\Fphi\left(\omega+2\pi n+ \pi \right)\right|^2
        \hspace{1cm}\text{by (\ref{equ:qc1})}
   \\&= \left|\Fh\left(\omega     \right)\right|^2 \sum_n \left|\Fphi\left(\omega    +2\pi n\right)\right|^2 +
        \left|\Fh\left(\omega+\pi \right)\right|^2 \sum_n \left|\Fphi\left(\omega+\pi+2\pi n\right)\right|^2
   \\&\eqd \left|\Fh\left(\omega     \right)\right|^2 \Sphi(\omega) +
         \left|\Fh\left(\omega+\pi \right)\right|^2 \Sphi(\omega+\pi)
\end{align*}

\item Proof that
   $
   \left|\Fg\left(\omega\right)\right|^2\Sphi(\omega) +
   \left|\Fg\left(\omega+\pi \right)\right|^2 \Sphi(\omega+\pi)
   = 2\Spsi(2\omega)
   $:
\begin{eqnarray*}
   2\Spsi(2\omega)
     &\eqd& 2\sum_n \left|\Fpsi(2\omega+2\pi n)\right|^2
   \\&=& 2\sum_n \left|\cwt \Fg\left(\frac{2\omega+2\pi n}{2}\right)\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2
         \hspace{1cm}\text{by Corollary~\ref{cor:Phi=HPhi}}
   \\&=& \sum_{n\;\mathrm{even}} \left|\Fg\left(\frac{2\omega+2\pi n}{2}\right)\right|^2\left|\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2 +
         \sum_{n\;\mathrm{odd} } \left|\Fg\left(\frac{2\omega+2\pi n}{2}\right)\right|^2\left|\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2
   \\&=& \sum_n \left|\Fg\left(\omega+2\pi n\right)          \right|^2\left|\Fphi\left(\omega+2\pi n\right)\right|^2 +
         \sum_n \left|\Fg\left(\omega+2\pi n+\pi \right)\right|^2\left|\Fphi\left(\omega+2\pi n + \pi \right)\right|^2
   \\&=& \sum_n \left|\Fg\left(\omega     \right)\right|^2\left|\Fphi\left(\omega+2\pi n\right)\right|^2 +
         \sum_n \left|\Fg\left(\omega+\pi \right)\right|^2\left|\Fphi\left(\omega+2\pi n + \pi \right)\right|^2
%         \hspace{1cm}\text{by (\ref{equ:phi_qc1})}
   \\&=& \left|\Fg\left(\omega\right)\right|^2\sum_n \left|\Fphi\left(\omega+2\pi n\right)\right|^2 +
         \left|\Fg\left(\omega+\pi \right)\right|^2\sum_n \left|\Fphi\left(\omega+\pi+2\pi n\right)\right|^2
   \\&=& \left|\Fg\left(\omega\right)\right|^2\Sphi(\omega) +
         \left|\Fg\left(\omega+\pi \right)\right|^2 \Sphi(\omega+\pi)
%   \\&=& \left|\Fg(\omega    )\right|^2  +
%         \left|\Fg(\omega+\pi)\right|^2
%         \hspace{1cm}\text{by Lemma~\ref{lem:SSSo}}
\end{eqnarray*}


\item Proof that
   $
   \Fh(\omega     ) \Fg^\ast(\omega     )\Sphi(\omega)  +
   \Fh(\omega +\pi) \Fg^\ast(\omega +\pi)\Sphi(\omega+\pi)
   = 2\Shs(2\omega)
   $:
\begin{eqnarray*}
  2\Shs(2\omega)
    &=& 2\sum_n \Fphi(2\omega+2\pi n) \Fpsi^\ast(2\omega+2\pi n)
  \\&=& 2\sum_n
        \cwt 
        \Fh  \left(\omega +\pi n \right)
        \Fphi\left(\omega +\pi n \right)
        \cwt 
        \Fg^\ast  \left(\omega +\pi n \right)
        \Fphi^\ast\left(\omega +\pi n \right)
        \hspace{1cm}\text{by Corollary~\ref{cor:Phi=HPhi}}
  \\&=& \sum_n
        \Fh  \left(\omega +\pi n \right)
        \Fg^\ast  \left(\omega +\pi n \right)
        \left| \Fphi\left(\omega +\pi n \right) \right|^2
  \\&=& \sum_{n\mathrm{\;odd}}
        \Fh  \left(\omega +\pi n \right)
        \Fg^\ast  \left(\omega +\pi n \right)
        \left| \Fphi\left(\omega +\pi n \right) \right|^2
      + \sum_{n\mathrm{\;even}}
        \Fh  \left(\omega +\pi n \right)
        \Fg^\ast  \left(\omega +\pi n \right)
        \left| \Fphi\left(\omega +\pi n \right) \right|^2
  \\&=& \sum_n
        \Fh  \left(\omega +2\pi n+\pi \right)
        \Fg^\ast  \left(\omega +2\pi n+\pi \right)
        \left| \Fphi\left(\omega +2\pi n+\pi \right) \right|^2
      + \\&& \sum_n
        \Fh  \left(\omega +2\pi n\right)
        \Fg^\ast  \left(\omega +2\pi n\right)
        \left| \Fphi\left(\omega +2\pi n\right) \right|^2
  \\&=& \sum_n
        \Fh  \left(\omega +\pi \right)
        \Fg^\ast  \left(\omega +\pi \right)
        \left| \Fphi\left(\omega +2\pi n+\pi \right) \right|^2
      + \sum_n
        \Fh  \left(\omega \right)
        \Fg^\ast  \left(\omega \right)
        \left| \Fphi\left(\omega +2\pi n\right) \right|^2
  \\&=& \Fh  \left(\omega \right)
        \Fg^\ast  \left(\omega \right)
        \sum_n \left| \Fphi\left(\omega +2\pi n\right) \right|^2
      + \Fh  \left(\omega +\pi \right)
        \Fg^\ast  \left(\omega +\pi \right)
        \sum_n\left| \Fphi\left(\omega +\pi+2\pi n\right) \right|^2
  \\&=& \Fh(\omega)
        \Fg^\ast(\omega)
        \sum_n \left| \Fphi(\omega +2\pi n) \right|^2
      + \Fh  (\omega +\pi)
        \Fg^\ast (\omega +\pi)
        \sum_n\left| \Fphi(\omega +\pi+2\pi n) \right|^2
  \\&=& \Fh(\omega     ) \Fg^\ast(\omega     )\Sphi(\omega)
      + \Fh(\omega +\pi) \Fg^\ast(\omega +\pi)\Sphi(\omega+\pi)
\end{eqnarray*}

\end{enumerate}
\end{proof}








%=======================================
\section{Special properties of \hi{wavelet system}s}
%=======================================
There are several properties that are very useful for \hi{wavelet system}s
to have but yet are not absolutely required.
These properties are presented in this section.

%=======================================
\subsection{Support of wavelet functions}
%=======================================
The \hie{support} of a function is what it's non-zero part ``sits" on.
If the support of the scaling coefficients $\seqn{h_n}$ goes from say
$[0,3]\subset\Z$, what is the support of the scaling function $\fphi(t)$?
The answer is $[0,3]\subset\R$---essentially the same
as the support of $\seqn{h_n}$ except that the two functions have different
domains ($\Z$ versus $\R$).
This concept is illustrated by \pref{ex:sw_gh_d1} -- \pref{ex:sw_gh_bspline}
(pages \pageref{ex:sw_gh_d1} -- \pageref{ex:sw_gh_bspline}),
defined next,
and proven in \prefpp{thm:support}.

%--------------------------------------
\begin{definition}
\index{support}
\label{def:support}
%--------------------------------------
  Let $\ff:X\to\R$.
  The \hid{support} $\opS\ff$ is
  \defbox{ \opS\ff \eqd \cls{\set{x\in X}{\ff(x)\ne 0}}. }
\end{definition}

%--------------------------------------
\begin{theorem}[Support size]
\citepp{mallat}{243}{244}
\label{thm:support}
\index{support size}
%--------------------------------------
\formbox{
  \opS\fphi = \opS\fh
}
If $N\in\Zo$, $ g_n  = \pm(-1)^n\fh(N-n)$, and $\opS\fh=[n_1,n_2]$ then
\formbox{
  \opS\fpsi = \left[ \frac{N-(n_2-n_1)}{2}, \frac{N+(n_2-n_1)}{2} \right]
}
\end{theorem}
\begin{proof}
\begin{enumerate}
\item Proof that $\opS\fphi = \opS\fh$:
Let
\begin{align*}
  \opS\fphi &\eqd [n_1,n_2] \\
  \opS\fh   &\eqd [k_1,k_2].
\end{align*}
Then
\begin{align*}
  \opS\phi(2t) &= \left[ \frac{n_1}{2}, \frac{n_2}{2} \right] \\
  \opS\fh(N-n) &= \left[ N-n_2, N-n \right]  \\
\\
\\
  \left[n_1,n_2\right]
    &= \opS\fphi(t)
  \\&= \opS \left[ \sqrt{2}\sum_n  h_n \fphi(2t-n)\right]
  \\&= \cls{\set{t\in\R}{\fphi(t)\ne 0}}
  \\&= \cls{\set{t\in\R}{\sqrt{2}\sum_n  h_n \fphi(2t-n)\ne 0}}
  \\&= \cls{\set{t\in\R}{\sum_n  h_n \fphi\left(2\left[t-\frac{n}{2}\right])\right)\ne 0}}
  \\&= \left[ \frac{n_1}{2}+\frac{k_1}{2}, \frac{n_2}{2}+\frac{k_2}{2}\right]
\end{align*}
This implies that $k_1=n_1$ and $k_2=n_2$ and so $\opS\fphi = \opS\fh = [n_1,n_2]$.

\item $\opS \psi$:
\begin{align*}
  \opS\fpsi(t)
    &= \opS\fpsi(t)
  \\&= \opS \left[ \sqrt{2}\sum_n  g_n \fphi(2t-n)\right]
  \\&= \opS \left[ \sqrt{2}\sum_n \pm (-1)^n \fh(N-n)\fphi(2t-n)\right]
  \\&= \opS \left[ \sum_n \fh(N-n)\fphi(2t-n)\right]
  \\&= \cls{\set{t\in\R}{\sum_n \fh(N-n)\fphi(2t-n)\ne 0}}
  \\&= \left[ \frac{n_1}{2}+\frac{N-n_2}{2}, \frac{n_2}{2}+\frac{N-n_1}{2}\right]
  \\&= \left[ \frac{N-(n_2-n_1)}{2}, \frac{N+(n_2-n_1)}{2}\right]
\end{align*}
\end{enumerate}
\end{proof}



%=======================================
\subsection{Partition of Unity scaling function property}
\index{partition of unity}
%=======================================
One very nice property (but not a required property) for a scaling
function is have is that it forms a {\bf partition of unity}.
Without this property, it becomes very difficult to approximate
even some of the simplist functions (such as constants).\citep{jawerth}{8}
%-------------------------------------
\begin{definition}
\index{partition of unity}
%-------------------------------------
A {\bf partition of unity} is a property of a function
$\ff:\R\to\R$ such that
\defbox{ \sum_n \ff(t-n) = 1 }
\end{definition}

It is convenient to have the {\em partition of unity} property
available in both time and frequency domain representations:
%-------------------------------------
\begin{lemma}
\citep{jawerth}{8}
\index{partition of unity}
\label{lem:unity}
%-------------------------------------
Let $\ff(t)$ be a function with Fourier Transform
$\Ff(\omega)\eqd\int_t\ff(t)\fkernea{t}{\omega}\dt$ and
$c\in\R$.
Then
\formbox{
   \mcom{\sum_n \ff(t-n)=c}{partition of unity in time domain}
   \qquad\iff\qquad
   \mcom{\Ff(2\pi k) = c \: \kdelta_k}{partition of unity in frequency domain}
}
\end{lemma}
\begin{proof}
\begin{align*}
\intertext{1. Proof that
  $\left[ \sum_n \ff(t-n)=c \right] \implies \left[ \Ff(2\pi k) = c\kdelta_k \right]$:
  }
   c
     &= \sum_n \ff(t-n)
     && \text{by left hypothesis}
   \\&= \sum_k \Ff(2\pi k) e^{-i2\pi kt}
     && \text{by PSF \prefpo{thm:psf}}
   \\&= \Ff(0) + \sum_{k\ne 0} \Ff(2\pi k) e^{-i2\pi k t}
   \\&= \Ff(0) + \sum_{k\ne 0} \Ff(2\pi k) \cos(2\pi kt)
                     - i\sum_{k\ne 0} \Ff(2\pi k) \sin(2\pi kt)
   \\ \implies
   \Ff(2\pi k) &= c\kdelta_k
     && \text{because $c$ is real for all $f$}
\\
\intertext{2. Proof that
  $\left[ \sum_n \ff(t-n)=c \right] \impliedby \left[ \Ff(2\pi k) = c\kdelta_k \right]$:
  }
  \ds \sum_n \ff(f -n)
     &= \sum_n \Ff(2\pi n) e^{-i2\pi nt}
     && \text{by PSF \prefpo{thm:psf}}
   \\&= \Ff(0) + \sum_{n\ne0} \Ff(nT) e^{-i2\pi nt}
   \\&= c
     && \text{by right hypothesis}
\end{align*}
\end{proof}

%=======================================
\subsection{Zero at $z=-1$ scaling function property}
\index{partition of unity}
%=======================================


\begin{figure}[ht] \color{figcolor}
\begin{center}
\begin{fsL}
\setlength{\unitlength}{0.10mm}
\begin{picture}(300,300)(-130,-130)
  %\graphpaper[10](0,0)(200,200)
  \thinlines
  \input{../common/circle.inp}
  \put(-130 ,   0){\line(1,0){260} }
  \put(   0 ,-130){\line(0,1){260} }
  \put( 140 ,   0){\makebox(0,0)[l]{$\Reb{z}$}}
  \put(   0 , 140){\makebox(0,0)[b]{$\Imb{z}$}}

  \put( 120 , 120){\makebox(0,0)[lb]{$z=e^{i\omega}$}}
  \put(-100,    0){\circle{15}}
  \put( 115 , 115){\vector(-1,-1){42}}

  \put(-150 , -50){\makebox(0,0)[tr]{$\Zh(-1)=\Fh(\pi)=0$}}
  \put(-150 , -50){\vector( 1, 1){43}}

  %\put( 150 , -50){\makebox(0,0)[tl]{$\Zh(1)=\Fh(0)=\sqrt{2}$}}
  %\put( 150 , -50){\vector(-1, 1){50}}
\end{picture}
\end{fsL}
\end{center}
\caption{
   Orthogonal scaling coefficient requirement at $\Zh(-1)$
   \label{fig:dsn_zero}
   }
\end{figure}

Having a zero at $z=-1$ is an extremely common property of
scaling coefficients.
It is convenient to have this property
available in time, frequency, and z-domain representations.
This is presented next.
%-------------------------------------
\begin{lemma}
\label{lem:twz}
\index{zero at $-1$}
%-------------------------------------
Let $\seq{\alpha_n}{n\in\Z}\in\spII$
with Fourier Transform $\Falpha(\omega)\eqd\sum_n \alpha_n \fkerna{n}{\omega}$.
\formbox{
  \mcom{\sum_n (-1)^n \alpha_n = 0}
       {zero at $z=-1$ in time domain}
  \qquad\iff\qquad
  \mcom{\left. \Falpha(\omega)\right|_{\omega=\pi} = 0}
       {zero at $z=-1$ in frequency domain}
  %\qquad\iff\qquad
  %\mcom{\left. \Zf(z     )\right|_{z=-1      } = 0}{$z$ domain}
}
\end{lemma}
\begin{proof}
\begin{align*}
\intertext{1. Proof that $\sum_n (-1)^n \alpha_n = 0  \implies \Falpha(\pi)=0$:}
  \left.\Falpha(\omega)\right|_{\omega=\pi}
    &= \left.\sum_n \alpha_n  \fkerna{n}{\omega}\right|_{\omega=\pi}
  \\&= \sum_n \alpha_n e^{-i\pi n}
  \\&= \sum_n (-1)^n \alpha_n
  \\&= 0
    && \text{by left hypothesis}
\\
\intertext{2. Proof that $\sum_n (-1)^n \alpha_n = 0  \impliedby \Falpha(\pi)=0$:}
  0
    &= \left.\Falpha(\omega)\right|_{\omega=\pi}
    && \text{by right hypothesis}
  \\&= \left.\sum_n \alpha_n  \fkerna{n}{\omega}\right|_{\omega=\pi}
  \\&= \sum_n \alpha_n  e^{-i\pi n}
  \\&= \sum_n (-1)^n \alpha_n
\end{align*}
\end{proof}

Somewhat surprisingly, the {\em partition of unity} and
{\em zero at $z=-1$} properties are actually
equivalent, as presented next.
%-------------------------------------
\begin{theorem}
\label{thm:zero_unity_evenodd}
\citep{chui}{123}
\index{zero at $z=-1$}
\index{partition of unity}
\index{sum of even}
\index{sum of odd}
%-------------------------------------
Let $\wavsys$ be a \hi{wavelet system}.
\formbox{
  \mcom{\sum_n \fphi(t-n)=\int_t\fphi(t)\dt }
       {partition of unity}
  \iff
  \mcom{\sum_n (-1)^n  h_n  = 0 }
       {zero at $z=-1$}
  \iff
  \mcom{\sum_n \fh(2n) = \sum_n \fh(2n+1) = \frac{1}{\sqrt{2}}}
       {sum of even = sum of odd = $\cwt $}
  }
\end{theorem}
\begin{proof}
Let $\Fh(\omega)\eqd\sum_n  h_n \fkernea{t}{\omega}$.
\begin{enumerate}
\if 0
\item Proof that $\sum_n(-1)^n  h_n =0 \implies \sum_n\fphi(t-n)=\int_t\fphi(t)\dt$:
\[\begin{array}{rclllllll}
  \Fphi(\omega) &=& \frac{1}{\sqrt{2}}\Fh(\omega/2) \Fphi(\omega/2) \\
  \Fphi(2\pi k) &=& \frac{1}{\sqrt{2}}\Fh(\pi k) \Fphi(\pi k) \\
  \Fphi(2\pi 0) &=& \frac{1}{\sqrt{2}}\Fh(\pi 0) \Fphi(\pi 0)
                &=& \frac{1}{\sqrt{2}}\sqrt{2}   \int_t\fphi(t)\dt
                &=& \int_t\fphi(t)\dt \\
  \Fphi(2\pi 1) &=& \frac{1}{\sqrt{2}}\Fh(\pi ) \Fphi(\pi )
                &=& \frac{1}{\sqrt{2}} 0 \Fphi(\pi )
                &=& 0 \\
  \Fphi(2\pi 2) &=& \frac{1}{\sqrt{2}}\Fh(2\pi ) \Fphi(2\pi )
                &=& \frac{1}{\sqrt{2}}\Fh(2\pi ) 0
                &=& 0 \\
  \Fphi(2\pi 3) &=& \frac{1}{\sqrt{2}}\Fh(3\pi ) \Fphi(3\pi )
                &=& \frac{1}{\sqrt{2}}\Fh(\pi ) \Fphi(3\pi )
                &=& \frac{1}{\sqrt{2}} 0 \Fphi(3\pi )
                &=& 0 \\
  \Fphi(2\pi 4) &=& \frac{1}{\sqrt{2}}\Fh(4\pi ) \Fphi(4\pi )
                &=& \frac{1}{\sqrt{2}}\Fh(4\pi ) 0
                &=& 0 \\
  \vdots \\
  \Fphi(2\pi k) &=& \kdelta_k \int_t\fphi(t)\dt
\end{array}\]
$\ds \implies \sum_n \fphi(t-n)=\int_t\fphi(t)\dt$
(by Lemma~\ref{lem:unity}).
\fi

\item Proof that $\sum_n(-1)^n  h_n =0 \implies \sum_n\fphi(t-n)=\int_t\fphi(t)\dt$:
\begin{align*}
  \sum_n \fphi(t-n)
    &= \sum_n \left[ \sqrt{2} \sum_m h_m \fphi(2t-2n-m) \right]
    && \text{by dilation equation (\prefpo{thm:h->phi})}
  \\&= \sqrt{2} \sum_m h_m \sum_n \fphi(2t-2n-m)
  \\&= \sqrt{2}\sum_m h_m \frac{1}{2}\sum_k \Fphi\left(\frac{2\pi k}{2}\right) e^{i\frac{2\pi}{2}k(2t-m)}
    && \text{by PSF (\prefpo{thm:psf})}
  \\&= \cwt  \sum_k \Fphi(\pi k) e^{i2\pi kt} \sum_m h_m e^{-i\pi km}
  \\&= \cwt  \sum_k \Fphi(\pi k) e^{i2\pi kt} \sum_m h_m (-1)^{km}
  \\&= \cwt  \sum_{\text{$k$ even}} \Fphi(\pi k) e^{i2\pi kt} \sum_m h_m (-1)^{km}
     + \cwt  \sum_{\text{$k$ odd}}  \Fphi(\pi k) e^{i2\pi kt} \sum_m h_m (-1)^{km}
  \\&= \cwt  \sum_k  \Fphi(\pi 2k   ) e^{i2\pi 2kt}    \cancelto{\sqrt{2}}{\sum_m h_m }
     + \cwt  \sum_k  \Fphi(\pi[2k+1]) e^{i2\pi(2k+1)t} \cancelto{0}{\sum_m (-1)^m h_m }
  \\&= \sum_k  \Fphi(2\pi k) e^{i4\pi kt}
    && \text{by left hypothesis}
  \\&= \Fphi(0) + \mcom{\sum_{k\ne 0}  \Fphi(2\pi k) e^{i4\pi kt}}{0 because no imaginary part $\forall t$}
    && \text{because $\sum_n \fphi(t-n)$ has no imaginary part}
  \\&= \Fphi(0)
  \\&= \left.\int_t \fphi(t) \fkernea{t}{\omega} \dt \right|_{\omega=0}
  \\&= \int_t \fphi(t) \dt
\end{align*}

\item Proof that $\sum_n(-1)^n  h_n =0 \impliedby \sum_n\fphi(t-n)=\int_t\fphi(t)\dt$:
\begin{align*}
  \sum_n(-1)^n  h_n
    &= \Fh(\pi)
    && \text{by Proposition~\ref{lem:twz} }
  \\&= \sqrt{2} \frac{\Fphi(2\pi)}{\Fphi(\pi)}
    && \text{by Corollary~\ref{cor:Phi=HPhi}}
  \\&= \sqrt{2} \frac{\kdelta_1}{\Fphi(\pi)}
    && \text{by right hypothesis and Lemma~\ref{lem:unity}}
  \\&= \sqrt{2} \frac{0}{\Fphi(\pi)}
  \\&= 0
\end{align*}

\item Proof that
      $\sum_n (-1)^n  h_n  = 0
       \implies
       \sum_n \fh(2n) = \sum_n \fh(2n+1) = \frac{1}{\sqrt{2}}
      $:
\begin{enumerate}
\item Define
\[ A \eqd \sum_n \fh(2n) \hspace{2cm} B \eqd \sum_n \fh(2n+1) \]

\item Proof that $A-B=0$:
\begin{align*}
  0
    &= \sum_n (-1)^n  h_n
    && \text{by left hypothesis}
  \\&=   \sum_{n\mathrm{\;even}} (-1)^n  h_n
       + \sum_{n\mathrm{\;odd}} (-1)^n  h_n
  \\&=   \sum_n (-1)^{2n}   \fh(2n)
       + \sum_n (-1)^{2n+1} \fh(2n+1)
  \\&=   \mcom{\sum_n \fh(2n)}{$A$} - \mcom{\sum_n \fh(2n+1)}{$B$}
\end{align*}

\item Proof that $A+B=\sqrt{2}$:
\begin{align*}
  \sqrt{2}
    &= \sum_n  h_n
    && \text{by admissibility condition (\pref{thm:admiss})}
  \\&= \sum_{n\mathrm{\;even}}  h_n  + \sum_{n\mathrm{\;odd}}  h_n
  \\&= \mcom{\sum_n \fh(2n)}{$A$} + \mcom{\sum_n \fh(2n+1)}{$B$}
\end{align*}

\item This gives two simultaneous equations:
  \begin{align*}
    A - B &= 0 \\
    A + B &= \sqrt{2}
  \end{align*}

\item Solutions to these equations give
  \begin{align*}
   \sum_n \fh(2n  )  &\eqd A &&= \ds \cwt  &&= \frac{1}{\sqrt{2}} \\
   \sum_n \fh(2n+1)  &\eqd B &&= \ds \cwt  &&= \frac{1}{\sqrt{2}}
  \end{align*}
\end{enumerate}

\item Proof that
      $\sum_n (-1)^n  h_n  = 0
       \impliedby
       \sum_n \fh(2n) = \sum_n \fh(2n+1) = \frac{1}{\sqrt{2}}
      $:
\begin{align*}
  \sum_n (-1)^n  h_n
    &= \sum_{n\;\mathrm{even}} (-1)^n  h_n
      +\sum_{n\;\mathrm{odd}}  (-1)^n  h_n
  \\&= \sum_n (-1)^{2n  } \fh(2n  ) + \sum_n (-1)^{2n+1} \fh(2n+1)
  \\&= \sum_n \fh(2n  ) -\sum_n \fh(2n+1)
  \\&= \frac{1}{\sqrt{2}} - \frac{1}{\sqrt{2}}
    && \text{by right hypothesis}
  \\&= 0
\end{align*}
\end{enumerate}

\end{proof}




%=======================================
\subsection{Vanishing moments}
\label{sec:vanish}
%=======================================
%--------------------------------------
\begin{definition}
\citep{mallat}{241}
\label{def:vanish}
%--------------------------------------
A function $\ff\in\spLL$ has $p$ {\bf vanishing moments} if
\defbox{
  \inprod{\ff(t)}{t^n}=0
  \hspace{6ex}\text{ for }\hspace{6ex}
  n=0,1,2,\ldots,p-1.
  }
\end{definition}

The number of {\em vanishing moments} of a wavelet is important
when using wavelets to decompose a function $\ff(t)$ as in
\[ \ff(t) =
   \sum_n \inprod{\ff(t)}{\fphi(t-n)}\fphi(t-n) +
   \sum_{k=0}^\infty \sum_n
   \inprod{\ff(t)}{\sqrt{2^k} \fpsi(2^kt-n)}\fpsi(2^kt-n)
\]
All differentiable functions have a Taylor (polynomial) expansion.
The coefficients of this polynomial decrease as the order of each term increases.
The innerproduct of the function and a wavelet with many vanishing moments
results in a smaller value, giving a better approximation for a fixed
number of innerproduct values.

%--------------------------------------
\begin{proposition}
%--------------------------------------
A function $\ff(t)$ with $p$ vanishing moments is orthogonal to
any polynomial of order $p-1$ or less.
\end{proposition}
\begin{proof}
\begin{eqnarray*}
  \inprod{\ff(t)}{\sum_{n=0}^{p-1}a_n t^n}
    &=& \sum_{n=0}^{p-1}a_n^\ast \inprod{\ff(t)}{t^n}
     =  \sum_{n=0}^{p-1}a_n^\ast \cdot 0
     =  0
\end{eqnarray*}
\end{proof}

Some proofs are coming up in the next theorem
which require differentiation multiple times.
This is simplified thanks to Leibnitz and his {\em generalized
product rule} (GPR \ldots next).
The Leibnitz GPR is remarkably similar in form to the {\em binomial theorem}.
%--------------------------------------
\begin{lemma}[Leibniz generalized product rule]
\footnote{\url{http://en.wikipedia.org/wiki/Leibniz_rule_(generalized_product_rule)}}
\index{Leibniz generalized product rule}
\index{binomial coefficient}
\label{lem:LGPR}
%--------------------------------------
Let $\ff(x),\fg(x)\in\spLL$ with derivatives
$\ff^{(n)}(x)\eqd\deriv{^n}{x^n}\ff(x)$ and
$\fg^{(n)}(x)\eqd\deriv{^n}{x^n}\fg(x)$ for $n=0,1,2,\ldots$,
and ${n\choose k}\eqd\frac{n!}{(n-k)!k!}$ (binomial coefficient).
Then
\formbox{
  \deriv{^n}{x^n}[\ff(x)\fg(x)] =
  \sum_{k=0}^n {n\choose k} \ff^{(k)}(x) \fg^{(n-k)}(x)
  }
\end{lemma}

The number of vanishing moments a wavelet has is closely related
to how the derivatives of the Fourier transforms of the wavelet
and wavelet coefficients behave.
This is presented in the next theorem.
In the case of orthonormal \hi{wavelet system}s,
the number of vanishing moments is also closely related to the
derivatives of the Fourier transform of the scaling coefficients,
as presented in
\pref{thm:o_vanish} (\prefpo{thm:o_vanish}).
%--------------------------------------
\begin{theorem}
\citepp{vidakovic}{82}{83}
\citepp{mallat}{241}{242}
\index{vanishing moments}
\label{thm:vanish}
%--------------------------------------
Let $\wavsys$ be a \hi{wavelet system} with Fourier transforms
\[
  \Fpsi(\omega) \eqd \int_t\fpsi(t)\fkernea{t}{\omega}\dt
  \qquad\qquad
  \Fh(\omega)   \eqd \sum_n  h_n  \fkerna{n}{\omega}
  \qquad\qquad
  \Fg(\omega)   \eqd \sum_n  g_n  \fkerna{n}{\omega}.
\]
For all $n=0,1,2,\ldots$, the following conditions are
{\bf equivalent}
\formbox{\renewcommand{\arraystretch}{1.5}\begin{array}{llcll}
  1. & \inprod{\fpsi(t)}{t^n}                                     &=& 0
     & \text{($\fpsi(t)$ has a vanishing $n$th moment)}
  \\ & \mc{1}{c}{\Updownarrow}  \\
  2. & \left.\deriv{^n}{\omega^n} \Fpsi(\omega)\right|_{\omega=0} &=& 0
  \\ & \mc{1}{c}{\Updownarrow}  \\
  3. & \left.\deriv{^n}{\omega^n} \Fg(\omega)\right|_{\omega=0}   &=& 0
  \\ & \mc{1}{c}{\Updownarrow}  \\
  4. & \ds\sum_k k^n  g_n                                        &=& 0
\end{array}}
\end{theorem}
\begin{proof}
\begin{align*}
  \intertext{$1\implies2$. Proof that $\inprod{\fpsi(t)}{t^n}=0 \implies \left.\deriv{^n}{\omega^n} \Fpsi(\omega)\right|_{\omega=0}=0$:}
    \left.\deriv{^n}{\omega^n} \Fpsi(\omega)\right|_{\omega=0}
      &= \left.\deriv{^n}{\omega^n} \int_t \fpsi(t) \fkernea{t}{\omega}\dt \right|_{\omega=0}
      && \text{by definition of $\Fpsi$}
    \\&= \left.\int_t \fpsi(t) \left[\deriv{^n}{\omega^n} \fkernea{t}{\omega}\right]\dt \right|_{\omega=0}
    \\&= \left.\int_t \fpsi(t) \left[(-i)^n t^n \fkernea{t}{\omega}\right]\dt \right|_{\omega=0}
    \\&= (-i)^n \int_t \fpsi(t) t^n \dt
    \\&= (-i)^n \inprod{\fpsi(t)}{t^n}
      && \text{by definition of $\inprod{\cdot}{\cdot}$ in $\spLL$}
    \\&= 0
      && \text{by left hypothesis}
  \\
  \intertext{$1\impliedby2$. Proof that $\inprod{\fpsi(t)}{t^n}=0 \impliedby \left.\deriv{^n}{\omega^n} \Fpsi(\omega)\right|_{\omega=0}=0$:}
    0
      &= \left. \deriv{^n}{\omega^n} \Fpsi(\omega)\right|_{\omega=0}
      && \text{by right hypothesis}
    \\&= \left.\deriv{^n}{\omega^n} \int_t \fpsi(t) \fkernea{t}{\omega}\dt \right|_{\omega=0}
      && \text{by definition of $\Fpsi$}
    \\&= \left.\int_t \fpsi(t) \left[\deriv{^n}{\omega^n} \fkernea{t}{\omega}\right]\dt \right|_{\omega=0}
    \\&= \left.\int_t \fpsi(t) \left[(-i)^n t^n \fkernea{t}{\omega}\right]\dt \right|_{\omega=0}
    \\&= (-i)^n \int_t \fpsi(t) t^n \dt
    \\&= (-i)^n \inprod{\fpsi(t)}{t^n}
      && \text{by definition of $\inprod{\cdot}{\cdot}$ in $\spLL$}
\\
\intertext{$2\implies3$. Proof that
  $\left.\deriv{^n}{\omega^n} \Fpsi(\omega)\right|_{\omega=0}=0 \implies \left.\deriv{^n}{\omega^n} \Fg(\omega)\right|_{\omega=0}=0$:
  }
    0
      &= \left.\deriv{^n}{\omega^n} \Fpsi(2\omega)\right|_{\omega=0}
      && \text{by left hypothesis}
    \\&= \left.\deriv{^n}{\omega^n} \Fg(\omega)\Fphi(\omega)\right|_{\omega=0}
      && \text{by Corollary~\ref{cor:Phi=HPhi}}
    \\&= \left.\sum_{k=0}^n {n \choose k} \Fg^{(k)}(\omega)\Fphi^{(n-k)}(\omega)\right|_{\omega=0}
      && \text{by Leibnitz GPR \prefpo{lem:LGPR}}
    \\&= \left.\left[
         \Fg^{(n)}(\omega)\Fphi(\omega)
         +\sum_{k=0}^{n-1} {n \choose k} \Fg^{(k)}(\omega)\Fphi^{(n-k)}(\omega)
         \right]\right|_{\omega=0}
    \\&= \Fg^{(n)}(0) \Fphi(0)
         +\sum_{k=0}^{n-1} {n \choose k} \Fg^{(k)}(0)\Fphi^{(n-k)}(0)
\end{align*}


  \[\begin{array}{rrcll}
    \implies&  \Fg^{(0)}(0) &=& 0   \\
    \implies&  \Fg^{(1)}(0) &=& 0   \\
    \implies&  \Fg^{(2)}(0) &=& 0   \\
    \implies&  \Fg^{(3)}(0) &=& 0   \\
    \implies&  \Fg^{(4)}(0) &=& 0   \\
    \vdots  &  \mc{1}{c}{\vdots}    \\
    \implies&  \Fg^{(n)}(0) &=& 0   \\
    \implies&  \Fg^{(n)}(0) &=& 0  & \text{for $n=0,1,2,\ldots$}
  \end{array}\]

  I would very much like to use induction in this proof,
  but so far only have this iterative proof.

\begin{align*}
  \intertext{$2\impliedby3$. Proof that $\left.\deriv{^n}{\omega^n} \Fpsi(\omega)\right|_{\omega=0}=0 \impliedby \left.\deriv{^n}{\omega^n} \Fg(\omega)\right|_{\omega=0}=0$:}
    \left.\deriv{^n}{\omega^n} \Fpsi(2\omega)\right|_{\omega=0}
      &= \left.\deriv{^n}{\omega^n} \Fg(\omega)\Fphi(\omega)\right|_{\omega=0}
      && \text{by Corollary~\ref{cor:Phi=HPhi}}
    \\&= \left.\sum_{k=0}^n {n \choose k} \Fg^{(k)}(\omega)\Fphi^{(n-k)}(\omega)\right|_{\omega=0}
      && \text{by Leibnitz GPR \prefpo{lem:LGPR}}
    \\&= \left.\sum_{k=0}^n {n \choose k} \;0\; \Fphi^{(n-k)}(\omega)\right|_{\omega=0}
      && \text{by right hypothesis}
    \\&= 0
\\
  \intertext{$3\implies4$. Proof that $\left.\deriv{^n}{\omega^n} \Fg(\omega)\right|_{\omega=0}=0 \implies \sum_k k^n  g_n  = 0$:}
    0
      &= \left.\deriv{^n}{\omega^n} \Fg(\omega)\right|_{\omega=0}
      && \text{by left hypothesis}
    \\&= \left.\deriv{^n}{\omega^n} \sum_k \fg(k)e^{-i\omega k} \right|_{\omega=0}
      && \text{by definition of $\Fg$}
    \\&= \left. \sum_k \fg(k)\left[\deriv{^n}{\omega^n} e^{-i\omega k}\right] \right|_{\omega=0}
    \\&= \left. \sum_k \fg(k)\left[(-i)^n k^n e^{-i\omega k}\right] \right|_{\omega=0}
    \\&= (-i)^n \sum_k k^n \fg(k)
\\
  \intertext{$3\impliedby4$. Proof that $\left.\deriv{^n}{\omega^n} \Fg(\omega)\right|_{\omega=0}=0 \impliedby \sum_k k^n  g_n  = 0$:}
    \left.\deriv{^n}{\omega^n} \Fg(\omega)\right|_{\omega=0}
      &= \left.\deriv{^n}{\omega^n} \sum_k \fg(k)e^{-i\omega k} \right|_{\omega=0}
      && \text{by definition of $\Fg$}
    \\&= \left. \sum_k \fg(k)\left[\deriv{^n}{\omega^n} e^{-i\omega k}\right] \right|_{\omega=0}
      && \text{by Leibnitz GPR \prefpo{lem:LGPR}}
    \\&= \left. \sum_k \fg(k)\left[(-i)^n k^n e^{-i\omega k}\right] \right|_{\omega=0}
    \\&= (-i)^n \sum_k k^n \fg(k)
    \\&= 0
      && \text{by right hypothesis}
\end{align*}
\end{proof}









