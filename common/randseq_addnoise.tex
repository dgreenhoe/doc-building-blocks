%============================================================================
% LaTeX File
% Daniel J. Greenhoe
%============================================================================
%=======================================
\chapter{Additive noise}
%=======================================
%=======================================
\section{Effects of additive noise}
%=======================================
%---------------------------------------
\begin{minipage}{\tw-55mm}
\begin{theorem}
\label{thm:xvy}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated to the right:
\end{theorem}
\end{minipage}
\qquad\tbox{\includegraphics{graphics/sys_xvy.pdf}}
\thmbox{
  %\brbr{\begin{array}{@{\hspace{2pt}}FrclDD}
  %    (A).& \Rxx(n_1,m)             &=& \Rxx(n_2,m)         &(\prope{WSS})          & and
  %  \\(B).& \pE\brs{\rvx(n)\rvv(n)} &=&\pE\rvx(n)\pE\rvv(n) &(\prope{uncorrelated}) & and
  %  \\(C).& \pE\rvv(n)              &=& 0                   & (\prope{zero-mean})
  %\end{array}}
  \brbr{\begin{array}{@{\hspace{2pt}}FMMD}
      (A).& $\rvx(n)$ is                & \prope{WSS}          & and 
    \\(B).& $\rvx(n)$ and $\rvv(n)$ are & \prope{uncorrelated} & and
    \\(C).& $\rvv(n)$ is                & \prope{zero-mean}
  \end{array}}
  \implies
  \brbl{\begin{array}{FrclD}
      (1).&\Ryv(m) &=&           \Rvv(m) & and
    \\(2).&\Ryy(m) &=&           \Rxx(m) + \Rvv(m) & and
    \\(3).&\Rxx(m) &=& \mc{2}{l}{\Ryy(m) + \Rvv(m) - 2\Real\Ryv(m)}
  \end{array}}
  }
\\
\begin{proof}
\begin{align*}
  \Ryv(m)
    &\eqd \pE\brs{\rvy(m)\rvv^\ast(0)}
    && \text{by (A) and definition of $\Ryv$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brs{(\rvx(m)+\rvv(m))\rvv^\ast(0)}
    && \text{by definition of $\rvy$}
  \\&= \pE\brs{\rvx(m)\rvv^\ast(0)} + \pE\brs{\rvv(m)\rvv^\ast(0)}
  \\&= \pE\rvx(m)\pE\rvv^\ast(0) + \pE\brs{\rvv(m)\rvv^\ast(0)}
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(B)}
  \\&= \pE\rvx(m)\cancelto{0}{\pE\rvv^\ast(0)} + \pE\brs{\rvv(m)\rvv^\ast(0)}
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(C)}
  \\&= \Rxv(m) + \Rvv(m)
    && \text{by definitions of $\Rxy$ and $\Rxx$}
    && \text{\xref{def:Rxxm}}
\end{align*}
\begin{align*}
  \Ryy(m)
    &\eqd \pE\brs{\rvy(m)\rvy^\ast(0)}
    && \text{by (A) and definition of $\Ryy$}
    %&& \text{\xref{def:Rxym}}
  \\&\eqd \pE\brs{(\rvx(m)+\rvv(m))(\rvx(0)+\rvv(0))^\ast}
    && \text{by definition of $\rvy$}
  \\&= \mathrlap{
       \pE\brs{\rvx(m)\rvx^\ast(0)}
     + \pE\brs{\rvx(m)\rvv^\ast(0)}
     + \pE\brs{\rvv(m)\rvx^\ast(0)}
     + \pE\brs{\rvv(m)\rvv^\ast(0)}
     }
  \\&= \mathrlap{
       \pE\brs{\rvx(m)\rvx^\ast(0)}
     + \pE{\rvx(m)\pE\rvv^\ast(0)}
     + \pE{\rvv(m)\pE\rvx^\ast(0)}
     + \pE\brs{\rvv(m)\rvv^\ast(0)}
     \quad\text{by \prope{uncorrelated} hypothesis (B)}
     }
  \\&= \mathrlap{
       \pE\brs{\rvx(m)\rvx^\ast(0)}
     + \pE\rvx(m)\cancelto{0}{\pE\rvv^\ast(0)}
     + \cancelto{0}{\pE\rvv(m)}\pE\rvx^\ast(0)
     + \pE\brs{\rvv(m)\rvv^\ast(0)}
     \quad\text{by \prope{zero-mean} hypothesis (C)}
     }
  \\&= \Rxx(m) + \Rvv(m)
    && \text{by definition of $\Rxx$}
    %&& \text{\xref{def:Rxxm}}
  \\
  \Rxx(m)
    &\eqd \pE\brs{\rvx(m)\rvx^\ast(0)}
  \\&\eqd \pE\brp{\brs{\rvy(m)-\rvv(m)}\brs{\rvy(0)-\rvv(0)}^\ast}
  \\&= \pE\brs{\rvy(m)\rvy^\ast(0)}
     - \pE\brs{\rvy(m)\rvv^\ast(0)}
     - \pE\brs{\rvv(m)\rvy^\ast(0)}
     + \pE\brs{\rvv(m)\rvv^\ast(0)}
  \\&\eqd \Ryy(m) - \Ryv(m) - \Rvy(m) + \Rvv(m)
  \\&= \Ryy(m) + \Rvv(m) - 2\Real\Ryv(m) 
\end{align*}
\end{proof}

%---------------------------------------
\begin{remark}
%---------------------------------------
Because in \pref{thm:xvy} $\rvy = \rvx + \rvv$ and $\Ryy = \Rxx + \Rvv$,
one might assume that $R$ is a kind of \ope{linear operator} \ifxref{operator}{def:linop} 
and further assume that
because $\rvx=\rvy-\rvv$ and $\Rxx[(-v)(-v)]=\Rvv$, that $\Rxx = \Ryy + \Rvv$.
As \pref{thm:xvy} demonstrates, this is simply \textbf{not the case}.
%The $\Ryy=\Rxx+\Rvv$ result of \pref{thm:xvy} is simple and beautiful.
%However, don't get to giddy and free with it.
%Rather, pay attention to the constraints on the left.
%In particular, note that if $\rvw\eqd-\rvv$ such that $\rvx=\rvy+\rvw$,
%then it is \textbf{not true} that $\Rxx=\Ryy+\Rww$.
The problem here is that $\rvy$ and $\rvv$ are very much 
\prope{correlated}---in fact $\rvy$ is obviously a \emph{function} of $\rvv$. % in that $\rvy=\rvx+\rvw$.
%As such, the correct expression for $\Rxx$ here would be
%\begin{align*}
%  \Rxx(m)
%    &\eqd \pE\brs{\rvx(m)\rvx^\ast(0)}
%  \\&\eqd \pE\brp{\brs{\rvy(m)+\rvw(m)}\brs{\rvy(0)+\rvw(0)}^\ast}
%  \\&= \pE\brs{\rvy(m)\rvy^\ast(0)}
%     + \pE\brs{\rvy(m)\rvw^\ast(0)}
%     + \pE\brs{\rvw(m)\rvy^\ast(0)}
%     + \pE\brs{\rvw(m)\rvw^\ast(0)}
%  \\&\eqd \Ryy(m) + \Ryw(m) + \Rwy(m) + \Rww(m)
%  \\&= \boxed{\Ryy(m) + \Rww(m) + 2\Real\Ryw(m)}
%\end{align*}
\end{remark}

%---------------------------------------
\begin{corollary}
\label{cor:xvy}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{thm:xvy}.
\corbox{
  \brbr{\begin{array}{M}
    hypotheses of\\
    \prefpp{thm:xvy}
  \end{array}}
  \implies
  \brbl{\begin{array}{FrclD}
      (1).&\Szyy(z)      &=& \Szxx(z)      + \Szvv(z)                                            & and
    \\(2).&\Szyv(z)      &=&                 \Szvv(z)                                            & and
    \\(3).&\Szyv(z)      &=& \Szyy(z)      + \Szvv(z) + \Szyv(z) + \Szyv^\ast(z^\ast)            & and
    \\(4).&\Swyy(\omega) &=& \Swxx(\omega) + \Swvv(\omega)                                       & and
    \\(5).&\Swyv(\omega) &=&                 \Swvv(\omega)                                       & and
    \\(6).&\Swyv(\omega) &=& \Swyy(\omega) + \Swvv(\omega) + \Swyv(\omega) + \Swyv^\ast(-\omega) & 
  \end{array}}
  }
\end{corollary}
\begin{proof}
\begin{align*}
  \Szyy(z)
    &\eqd \opZ\Ryy(m)
    && \text{by definition of $\Szxx$}
    && \text{\xref{def:Szxx}}
  \\&= \opZ\Rqq(m) + \opZ\Rvv(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Szqq(z) + \Szvv(z)
    && \text{by definition of $\Szyy$}
    && \text{\xref{def:Swxy}}
  \\
  \Swyy(\omega)
    &\eqd \opDTFT\Ryy(m)
    && \text{by definition of $\Swyy$}
    && \text{\xref{def:Swxx}}
  \\&= \opDTFT\Rqq(m) + \opDTFT\Rvv(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Swqq(\omega) + \Swvv(\omega)
    && \text{by definition of $\Swyy$}
    && \text{\xref{def:Swxy}}
\end{align*}
\end{proof}

%---------------------------------------
\begin{minipage}{\tw-55mm}
\begin{theorem}
\label{thm:dual_addnoise}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated to the right:
\end{theorem}
\end{minipage}
\qquad\tbox{\includegraphics{graphics/dual_addnoise.pdf}}
\thmbox{
  \brb{\begin{array}{FrclDD}
      (A).& \mc{4}{M}{$\rvx(n)$ and $\rvr(n)$ are \prope{wide sense stationary}}      & and
    \\(B).& \pE\brs{\rvx(n)\rvw(n)} &=& \pE\rvx(n)\pE\rvw(n) & (\prope{uncorrelated}) & and
    \\(C).& \pE\brs{\rvr(n)\rvv(n)} &=& \pE\rvr(n)\pE\rvv(n) & (\prope{uncorrelated}) & and
    \\(D).& \pE\brs{\rvw(n)\rvv(n)} &=& \pE\rvw(n)\pE\rvv(n) & (\prope{uncorrelated}) & and
    \\(E).& \pE\rvv(n)=\pE\rvw(n)   &=& 0                    & (\prope{zero-mean})
  \end{array}}
  \implies
  \brb{\begin{array}{rcl}
      \Rsy(m) &=& \Rsx(m)
            \\&=& \Rry(m)
            \\&=& \Rrx(m)
  \end{array}}
  }
\\
\begin{proof}
\begin{align*}
  \Rsy(m)
    &\eqd \pE\brs{\rvs(m)\rvy^\ast(0)}
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brp{\brs{\rvr(m)+\rvw(m)}\brs{\rvx(0)+\rvv(0)}^\ast}
    && \text{by definition of $\opS$}
  \\&= \mathrlap{
       \pE\brs{\rvr(m)\rvx^\ast(0)}
      +\pE\brs{\rvr(m)\rvv^\ast(0)}
      +\pE\brs{\rvw(m)\rvx^\ast(0)}
      +\pE\brs{\rvw(m)\rvv^\ast(0)}
      }
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)}
      +\pE\rvr(m)\pE\rvv^\ast(0)
      \\&\qquad
      +\pE\rvw(m)\pE\rvx^\ast(0)
      +\pE\rvw(m)\pE\rvv^\ast(0)
    && \text{by \prope{uncorrelated} hypotheses}
    && \text{(B), (C), and (D)}
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)}
      +\pE\rvr(m)\cancelto{0}{\pE\rvv^\ast(0)}
      \\&\qquad
      +\cancelto{0}{\pE\rvw(m)}\pE\rvx^\ast(0)
      +\cancelto{0}{\pE\rvw(m)}\pE\rvv^\ast(0)
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(E)}
  \\&= \Rrx(m)
    && \text{by definition of $\Rrx$}
    && \text{\xref{def:Rxym}}
  \\
  \Rsx(m)
    &\eqd \pE\brs{\rvs(m)\rvx^\ast(0)}
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brp{\brs{\rvr(m)+\rvw(m)}\rvx^\ast(0)}
    && \text{by definition of $\opS$}
 %\\&= \pE\brs{\rvr(m)\rvx^\ast(0)} + \pE\brs{\rvw(m)\rvx^\ast(0)}
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)} + \pE\rvw(m)\pE\rvx^\ast(0)
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(B)}
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)} + \cancelto{0}{\pE\rvw(m)}\pE\rvx^\ast(0)
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(E)}
  \\&= \Rrx(m)
    && \text{by definition of $\Rrx$}
    && \text{\xref{def:Rxym}}
  \\
  \Rry(m)
    &\eqd \pE\brs{\rvr(m)\rvy^\ast(0)}
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brp{\rvr(m)\brs{\rvx(0)+\rvv(0)}^\ast}
    && \text{by definition of $\opS$}
 %\\&= \pE\brs{\rvr(m)\rvx^\ast(0)} + \pE\brs{\rvr(m)\rvv^\ast(0)}
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)} + \pE\rvr(m)\pE\rvv^\ast(0)
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(C)}
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)} + \pE\rvr(m)\cancelto{0}{\pE\rvv^\ast(0)}
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(E)}
  \\&= \Rrx(m)
    && \text{by definition of $\Rrx$}
    && \text{\xref{def:Rxym}}
\end{align*}
\end{proof}

%---------------------------------------
\begin{corollary}
\label{cor:dual_addnoise}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{thm:dual_addnoise}.
\corbox{
  \brb{\begin{array}{M}
    hypotheses of\\
    \prefpp{thm:dual_addnoise}
  \end{array}}
  \implies
  \brb{\begin{array}{FrclclclD}
      (1).&\Szsy(z)      &=& \Szsx(z)      &=& \Szry(z)      &=& \Szrx(z)       & and
    \\(2).&\Swsy(\omega) &=& \Swsx(\omega) &=& \Swry(\omega) &=& \Swrx(\omega)  &
  \end{array}}
  }
\end{corollary}
\begin{proof}
\begin{align*}
  \Szsy(\omega)
    &\eqd \opZ\Rsy(m)
    && \text{by definition of $\Szxy$}
    && \text{\xref{def:Szxy}}
  \\&= \opZ\Rrx(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Szrx(z)
    && \text{by definition of $\Szxy$}
    && \text{\xref{def:Szxy}}
  \\
  \Swsy(\omega)
    &\eqd \opDTFT\Rsy(m)
    && \text{by definition of $\Swxy$}
    && \text{\xref{def:Swxy}}
  \\&= \opDTFT\Rrx(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Swrx(\omega)
    && \text{by definition of $\Swxy$}
    && \text{\xref{def:Swxy}}
\end{align*}
\end{proof}

%=======================================
\section{Additive noise and operators}
%=======================================
\begin{figure}[h]
  \centering
  \begin{tabular}{|l|l|l|}
    \hline
      \includegraphics{graphics/sysT_xyvq.pdf}
     &\includegraphics{graphics/sysT_xyup.pdf}
     &\includegraphics{graphics/sysT_mnoise.pdf}
    \\
        (A) \xref{thm:sysT_addnoise_v}
      & (B) \xxref{thm:sysT_addnoise_u}{thm:sysT_addnoise_uu}
      & (C) \xref{thm:sysT_mnoise}
    \\\hline
  \end{tabular}
  \caption{\label{fig:sysT_addnoise}Additive noise with transform $\opT$}
\end{figure}
Adding in zero-mean uncorrelated noise \emph{after} a transform (operation) $\opT$
has \emph{no effect} on cross-correlation across the transform (next theorem).
However, adding \emph{before} $\opT$ \emph{does} \prefpp{thm:sysT_addnoise_u}.
%---------------------------------------
\begin{theorem}
\label{thm:sysH_addnoise}
\label{thm:sysT_addnoise_v}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{fig:sysT_addnoise} (A).
\thmbox{
  \brb{\begin{array}{FrclDD}
      (A).& \Rxx(n_1,m)             &=& \Rxx(n_2,m)          &(\prope{WSS})          & and
    \\(B).& \pE\brs{\rvx(n)\rvv(n)} &=& \pE\rvx(n)\pE\rvv(n) &(\prope{uncorrelated}) & and
    \\(E).& \pE\rvv(n)              &=& 0                    & (\prope{zero-mean})   &
  \end{array}}
  \implies
  \brb{\begin{array}{FrclD}
      (1).& \Rxy(m)      &=& \Rxq(m)       & and
    \\(2).& \Szxy(z)     &=& \Szxq(z)      & and
    \\(3).& \Swxy(\omega)&=& \Swxq(\omega) &
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{align*}
  \Rxy(m)
    &\eqd \pE\brs{\rvx(m)\rvy^\ast(0)}
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brs{\rvx(m)(\rvq(0)+\rvv(0))^\ast}
    && \text{by definition of $\opS$}
  \\&= \pE\brs{\rvx(m)\rvq^\ast(0)+\rvx(m)\rvv^\ast(0)}
  \\&= \pE\brs{\rvx(m)\rvq^\ast(0)} + \pE\brs{\rvx(m)\rvv^\ast(0)}
  \\&= \pE\brs{\rvx(m)\rvq^\ast(0)} + \brs{\pE\rvx(m)}\brs{\pE\rvv^\ast(0)}
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(B)}
  \\&= \pE\brs{\rvx(m)\rvq^\ast(0)} + \brs{\pE\rvx(m)}\cancelto{0}{\brs{\pE\rvv^\ast(0)}}
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(E)}
  \\&= \Rxq(m)
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\
  \Szxy(z)
    &\eqd \opZ\Rxy(m)
    && \text{by definition of $\Szxy$}
    && \text{\xref{def:Szxy}}
  \\&= \opZ\Rxq(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Szxq(z)
    && \text{by definition of $\Szxy$}
    && \text{\xref{def:Szxy}}
  \\
  \Swxy(\omega)
    &\eqd \opDTFT\Rxy(m)
    && \text{by definition of $\Swxy$}
    && \text{\xref{def:Swxy}}
  \\&= \opDTFT\Rxq(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Swxq(\omega)
    && \text{by definition of $\Swxq$}
    && \text{\xref{def:Swxy}}
\end{align*}
\end{proof}

%---------------------------------------
\begin{theorem}
\label{thm:sysT_addnoise_u}
%\includegraphics{graphics/sysH_xyuvpq.pdf}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{fig:sysT_addnoise} (B).
\thmbox{
  \brb{\begin{array}{FMMD}
      (A).& $\rvx(n)$               is  & (\prope{WSS})          & and
    \\(B).& $\rvu(n)$               is  & (\prope{zero-mean})    & and
    \\(C).& $\rvx(n)$ and $\rvu(n)$ are & \mc{2}{D}{(\prope{uncorrelated})}
  \end{array}}
  \implies
  \brb{\begin{array}{Frcl@{\hspace{2pt}}c@{\hspace{2pt}}lD}
      (1).& \Rpy(m)      &=& \Rxy(m)       &+& \Ruy(m)       & and 
    \\(2).& \Szpq(z)     &=& \Szxy(z)      &+& \Szuy(z)      & and
    \\(3).& \Swpq(\omega)&=& \Swxy(\omega) &+& \Swuy(\omega) &
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{align*}
  \Rpy(m)
    &\eqd \pE\brs{\rvp(m)\rvy^\ast(0)}
    && \text{by definition of $\Rpy$}
    && \text{\pref{def:Rxym}}
  \\&\eqd \pE\brp{\brs{\rvx(m)+\rvu(m)}\rvy^\ast(0)}
    && \text{by definition of $\opS$}
  \\&= \pE\brs{\rvx(m)\rvy^\ast(0)+\rvu(m)\rvy^\ast(0)}
  \\&= \pE\brs{\rvx(m)\rvy^\ast(0)} + \pE\brs{\rvu(m)\rvy^\ast(0)}
    && \text{because $\pE$ is a \ope{linear operator}}
    && \text{\xref{thm:pE_linop}}
  \\&\eqd \Rxy(m) + \Ruy(m)
    && \text{by definition of $\Rxy$}
    && \text{\pref{def:Rxym}}
\end{align*}
\end{proof}


%---------------------------------------
\begin{theorem}
\label{thm:sysT_mnoise}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{fig:sysT_addnoise} (C).
\thmbox{
  \brb{\begin{array}{FMMD}
      (A).& $\rvx(n)$               is  & (\prope{WSS})          & and
    \\(B).& $\rvu(n)$               is  & (\prope{zero-mean})    & and
    \\(C).& $\rvx(n)$ and $\rvu(n)$ are & \mc{2}{D}{(\prope{uncorrelated})}
  \end{array}}
  \implies
  \brb{\begin{array}{Frcl@{\hspace{2pt}}c@{\hspace{2pt}}lD}
      (1).& \Rpy(m)      &=& \Rxy(m)       &+& \Ruy(m)       & and 
    \\(2).& \Szpq(z)     &=& \Szxy(z)      &+& \Szuy(z)      & and
    \\(3).& \Swpq(\omega)&=& \Swxy(\omega) &+& \Swuy(\omega) &
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{align*}
  \Rxy(m)
    &\eqd \pE\brs{\rvx(m)\rvy^\ast(0)}
    && \text{by definition of $\Rpy$}
    && \text{\pref{def:Rxym}}
  \\&\eqd \pE\brp{\brs{\rvp(m)+\rvw(m)}\rvy^\ast(0)}
    && \text{by definition of $\opS$}
  \\&= \pE\brs{\rvp(m)\rvy^\ast(0)+\rvw(m)\rvy^\ast(0)}
  \\&= \pE\brs{\rvp(m)\rvy^\ast(0)} + \pE\brs{\rvw(m)\rvy^\ast(0)}
    && \text{because $\pE$ is a \ope{linear operator}}
    && \text{\xref{thm:pE_linop}}
  \\&\eqd \Rpy(m) + \Rwy(m)
    && \text{by definition of $\Rxy$}
    && \text{\pref{def:Rxym}}
  \\&= \Rpy(m) + \cancelto{0}{\Rwy(m)}
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(B)}
\end{align*}
\end{proof}


%=======================================
\section{Additive noise and LTI operator}
%=======================================
%---------------------------------------
\begin{theorem}
\label{thm:sysH_addnoise_lti}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{fig:sysT_addnoise} (B).
\thmbox{
  \brb{\begin{array}{FMMD}
      (A).& $\rvx(n)$               is  & (\prope{WSS})           & and
    \\(B).& $\rvu(n)$               is  & (\prope{zero-mean})     & and
    \\(C).& $\rvx(n)$ and $\rvu(n)$ are & (\prope{uncorrelated})  & and
    \\(D).& $\opH\eqd\opT$          is  & (\prope{linear})        & and
    \\(E).& $\opH\eqd\opT$          is  & (\prope{time-invariant})&
  \end{array}}
  \implies
  \brb{\begin{array}{FrclD}
      (1).& \Rxy(m)      &=& \fh(m)\conv\Rxx(m)  & and 
    \\(2).& \Szxy(z)     &=& \ZH(z)\Szxx(z)      & and
    \\(3).& \Swxy(\omega)&=& \FH(\omega)\Swxx(\omega)        &
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item definition: Let $\seqn{\fh(n)}$ be the \fncte{impulse response} of operator $\opH$.
  \item lemma: $\ds\opH\vx(n)= \sum_{m\in\Z} \fh(n)\vx(m-n)$. Proof: \label{ilem:sysT_conv}
        By the \prope{linear time-invariant} hypotheses [(D) and (E)].
  \item Proof that $\Rxy(m) = \fh(n)\conv\Rxx(m)$:
    \begin{align*}
      \Rxy(m)
        &\eqd \pE\brs{\rvx(m)\rvy^\ast(0)}
        && \text{by definition of $\Rpy$}
        && \text{\pref{def:Rxym}}
      \\&= \pE\brp{\rvx(m)\brs{\opH\rvx^\ast(0) + \opH\rvu^\ast(0)}}
        && \text{by \prope{linear} hypothesis}
        && \text{(D)}
      \\&= \pE\brp{\brs{\rvx(m)\opH\rvx^\ast(0) + \rvx(m)\opH\rvu^\ast(0)}}
      \\&= \pE\brp{\brs{\rvx(m)\opH\rvx^\ast(0) + \rvx(m)\opH\rvu^\ast(0)}}
      \\&= \pE\brs{\rvx(m)\opH\rvx^\ast(0)} + \pE\brs{\rvx(m)\opH\rvu^\ast(0)}
        && \text{by \prope{linearity} of $\opE$}
        && \text{\xref{thm:pE_linop}}
      \\&= \opH\pE\brs{\rvx(m)\rvx^\ast(0)} + \opH\pE\brs{\rvx(m)\rvu^\ast(0)}
        && \text{by \prope{LTI} hypotheses}
        && \text{(D) and (E)}
      \\&= \opH\pE\brs{\rvx(m)\rvx^\ast(0)} + \opH\pE\rvx(m)\pE\rvu^\ast(0)
        && \text{by \prope{uncorrelated} hypothesis}
        && \text{(C)}
      \\&= \opH\pE\brs{\rvx(m)\rvx^\ast(0)} + \opH\pE\rvx(m)\cancelto{0}{\pE\rvu^\ast(0)}
        && \text{by \prope{zero-mean} hypothesis}
        && \text{(B)}
      \\&= \opH\Rxx(m)
        && \text{by definition of $\Rxx$}
        && \text{\pref{def:Rxxm}}
      \\&= \fn(n) \conv \Rxx(m)
        && \text{by \pref{ilem:sysT_conv}}
    \end{align*}
\end{enumerate}
\end{proof}

%20190130_invalid?%\prefpp{cor:ZSxy} demonstrates that if a random input $\rvx(n)$ is processed by an \prope{LTI} system
%20190130_invalid?%$\fh(n)$ with output $\rvy(n)$, then the cross-spectral density and auto-spectral density are 
%20190130_invalid?%related simply by
%20190130_invalid?%$\Swxy(\omega)=\Swxx(\omega)\FH^\ast(\omega)$. 
%20190130_invalid?%But what happens to $\Swxy(\omega)$ if we add uncorrelated zero-mean noise into the input $\rvx$
%20190130_invalid?%and similarly to the output $\rvy$?
%20190130_invalid?%The somewhat surprising but happy answer to this question is: \emph{Nothing}!
%20190130_invalid?%\ldots as demonstrated by \pref{cor:sysH_addnoise_lti} (next). 
%20190130_invalid?%That is, uncorrelated additive noise has \emph{no effect} on cross-correlation!
%20190130_invalid?%However note that it \emph{does} have an effect on auto-correlation (also next).
%20190130_invalid?%%---------------------------------------
%20190130_invalid?%\begin{corollary}
%20190130_invalid?%\label{cor:sysH_addnoise_lti}
%20190130_invalid?%%---------------------------------------
%20190130_invalid?%Let $\opS$ be the \structe{system} illustrated in \prefpp{thm:sysH_addnoise}.
%20190130_invalid?%\corbox{
%20190130_invalid?%  \brb{\begin{array}{FMD}
%20190130_invalid?%      (A).& $\FH$ is \prope{LTI} &and
%20190130_invalid?%    \\(B).& hypotheses of
%20190130_invalid?%        \\& \pref{thm:sysH_addnoise}&\xrefpo{thm:sysH_addnoise}
%20190130_invalid?%  \end{array}}
%20190130_invalid?%  \implies
%20190130_invalid?%  \brb{\begin{array}{FrclD}
%20190130_invalid?%      (1).&\Szyy(z)      &=& \brs{\Szxx(z)     +\Szuu(z)}\ZH(z)\ZH^\ast\brp{\frac{1}{z^\ast}} + \Szvv(z) & and
%20190130_invalid?%    \\(2).&\Swyy(\omega) &=& \brs{\Swxx(\omega)+\Swuu(\omega)}\abs{\FH(\omega)}^2 + \Swvv(\omega)   & and
%20190130_invalid?%    \\(3).&\Szxy(z)      &=&      \Szxx(z)      \ZH^\ast\brp{\frac{1}{z^\ast}}                      & and
%20190130_invalid?%    \\(4).&\Swxy(\omega) &=&      \Swxx(\omega) \FH^\ast(\omega)                                    &
%20190130_invalid?%  \end{array}}
%20190130_invalid?%  }
%20190130_invalid?%\end{corollary}
%20190130_invalid?%\begin{proof}
%20190130_invalid?%\begin{align*}
%20190130_invalid?%  \Szyy(z)
%20190130_invalid?%    &= \Szqq(z) + \Szvv(z)
%20190130_invalid?%    && \text{by \prefp{cor:xvy}}
%20190130_invalid?%  \\&= \Szpp(z)\ZH(z)\ZH^\ast\brp{\frac{1}{z^\ast}} + \Szvv(z)
%20190130_invalid?%    && \text{by \prefp{cor:ZSxy}}
%20190130_invalid?%  \\&= \brs{\Szxx(z)+\Szuu(z)}\ZH(z)\ZH^\ast\brp{\frac{1}{z^\ast}} + \Szvv(z)
%20190130_invalid?%    && \text{by \prefp{cor:xvy}}
%20190130_invalid?%  \\
%20190130_invalid?%  \Swyy(\omega)
%20190130_invalid?%    &= \Swqq(\omega) + \Swvv(\omega)
%20190130_invalid?%    && \text{by \prefp{cor:xvy}}
%20190130_invalid?%  \\&= \Swpp(\omega)\abs{\FH(\omega)}^2 + \Swvv(\omega)
%20190130_invalid?%    && \text{by \prefp{cor:Swxy}}
%20190130_invalid?%  \\&= \brs{\Swxx(\omega)+\Swuu(\omega)}\abs{\FH(\omega)}^2 + \Swvv(\omega)
%20190130_invalid?%    && \text{by \prefp{cor:xvy}}
%20190130_invalid?%  \\
%20190130_invalid?%  \Szxy(z)
%20190130_invalid?%    &= \Szpq(z) - \Szuq(z)
%20190130_invalid?%    && \text{by \prefp{cor:sysH_addnoise}}
%20190130_invalid?%  \\&= \Szpp(z)\ZH^\ast\brp{\frac{1}{z^\ast}} - \Szuu(z)\ZH^\ast\brp{\frac{1}{z^\ast}}
%20190130_invalid?%    && \text{by \prefp{cor:ZSxy}}
%20190130_invalid?%  \\&= \brs{\Szxx(z)+\Szuu(z)}\ZH^\ast\brp{\frac{1}{z^\ast}}  - \Szuu(z)\ZH^\ast\brp{\frac{1}{z^\ast}}
%20190130_invalid?%    && \text{by \prefp{cor:xvy}}
%20190130_invalid?%  \\&= \Szxx(z)\ZH^\ast\brp{\frac{1}{z^\ast}}
%20190130_invalid?%  \\
%20190130_invalid?%  \Swxy(\omega)
%20190130_invalid?%    &= \brlr{\Szxy(z)}_{z=e^{-\omega}}
%20190130_invalid?%  \\&= \brlr{\Szxx(z)\ZH^\ast\brp{\frac{1}{z^\ast}}}_{z=e^{-\omega}}
%20190130_invalid?%    && \text{by previous result}
%20190130_invalid?%  \\&= \Swxx(\omega)\FH^\ast(\omega)
%20190130_invalid?%\end{align*}
%20190130_invalid?%\end{proof}

%=======================================
\section{Additive noise and dual operators}
%=======================================
\begin{figure}[h]
  \centering%
  \begin{tabular}{|c|c|}
     \hline
     \includegraphics{graphics/opT_opH_cnoise.pdf}%
    &\includegraphics{graphics/opT_opH_mnoise.pdf}%
   \\
     (A) dual communications additive noise system
    &(B) dual measurement    additive noise system
   \\\xref{cor:opT_opH_cnoise}&\xref{cor:opT_opH_mnoise}
   \\\hline
  \end{tabular}
\caption{\label{fig:opT_opH_noise}Dual Additive Noise Systems}
\end{figure}
%---------------------------------------
\begin{corollary}
\label{cor:GHz}
\label{cor:GHw}
\label{cor:opT_opH_cnoise}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{fig:opT_opH_noise} (A).
%\hfill\tbox{\includegraphics{graphics/xGy_xHw_addnoise.pdf}}
\corbox{
  \brb{\begin{array}{FMMD}
      (A).& $\fg(n)$  is               &\prope{LTI}       & and
    \\(B).& $\rvx(n)$ is               &\prope{WSS}       & and
    \\(C).& $\rvu$ and $\rvv$ are      &\prope{zero-mean} & and
    \\(D).& $\rvx$, $\rvu$, $\rvv$ are &\mc{2}{D}{\prope{uncorrelated}}
  \end{array}}
  \implies
  \brb{\begin{array}{FrclD}
    (1).& \Szsy(z)      &=& \ZH(z)     \brs{\Szxy(z)     +\Szuy(z)}      & and\\
    (2).& \Swsy(\omega) &=& \FH(\omega)\brs{\Swxy(\omega)+\Swuy(\omega)} &
  \end{array}}
  }
\end{corollary}
\begin{proof}
\begin{align*}
  \Szsy(z)
    &= \Szrq(z)
    && \text{by \prefp{cor:dual_addnoise}}
    && \text{and (B), (C) and (D)}
  \\&= \ZH(z)\Szpq(z)
    && \text{by \prefp{thm:xGw_xHy}}
    && \text{and (A)}
  \\&= \ZH(z)\brs{\Szxy(z) + \Szuy(z)}
    && \text{by \prefp{thm:sysT_addnoise_u}}
    && \text{and (A)}
  \\
  \Swsy(\omega)
    &= \Swrq(\omega)
    && \text{by \prefp{cor:dual_addnoise}}
    && \text{and (B), (C) and (D)}
  \\&= \FH(\omega)\Swpq(\omega)
    && \text{by \prefp{thm:xGw_xHy}}
    && \text{and (A)}
  \\&= \FH(\omega)\brs{\Swxy(\omega) + \Swuy(\omega)}
    && \text{by \prefp{thm:sysT_addnoise_u}}
    && \text{and (A)}
\end{align*}
\end{proof}

%---------------------------------------
\begin{corollary}
\label{cor:GHz}
\label{cor:GHw}
\label{cor:opT_opH_mnoise}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated in \prefpp{fig:opT_opH_noise} (B).
\corbox{
  \brb{\begin{array}{FMMD}
      (A).& $\fg(n)$  is               &\prope{LTI}       & and
    \\(B).& $\rvx(n)$ is               &\prope{WSS}       & and
    \\(C).& $\rvu$ and $\rvv$ are      &\prope{zero-mean} & and
    \\(D).& $\rvp$, $\rvu$, $\rvv$ are &\prope{uncorrelated}
  \end{array}}
  \implies
  \brb{\begin{array}{FrclD}
      (1).& \Szsy(z)      &=& \ZH(z)     \Szxy(z)      & and
    \\(2).& \Swsy(\omega) &=& \FH(\omega)\Swxy(\omega) &
  \end{array}}
  }
\end{corollary}
\begin{proof}
\begin{align*}
  \Szsy(z)
    &= \Szrq(z)
    && \text{by \prefp{cor:dual_addnoise}}
    && \text{and (B), (C) and (D)}
  \\&= \ZH(z)\Szpq(z)
    && \text{by \prefp{thm:xGw_xHy}}
    && \text{and (A)}
  \\&= \ZH(z)\brs{\Szxy(z) - \Szuy(z)}
    && \text{by \prefp{thm:sysT_addnoise_u}}
    && \text{and (A)}
  \\&= \ZH(z)\brs{\Szxy(z) - \cancelto{0}{\Szuy(z)}}
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{and (C)}
  \\
  \Swsy(\omega)
    &= \brlr{\Szsy(z)}_{z=e^{i\omega}}
    && \text{by definition of $\opZ$}
    && \text{\xref{def:opZ}}
  \\&= \brlr{\ZH(z)\Szxy(z)}_{z=e^{i\omega}}
    && \text{by previous result}
    && \text{(1)}
  \\&= \FH(\omega)\Swxy(\omega)
\end{align*}
\end{proof}

