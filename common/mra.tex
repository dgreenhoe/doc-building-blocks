%============================================================================
% Daniel J. Greenhoe
% LaTeX File
%============================================================================


%======================================
%\chapter{Multiresolution Analysis Structures}
\chapter{MRA Structures}
%======================================


%=======================================
\section{Introduction}
%=======================================
%In Fourier analysis, \prope{continuous} {dilations} \xref{def:opD} of the \fncte{complex exponential} \xref{def:exp}
%form a  \structe{basis} \xref{def:basis_schauder} for the \structe{space of square integrable functions} $\spLLR$ \xref{def:spLLR} 
%such that
%  \\\indentx$\ds\spLLR=\linspan\set{\opDil_\omega e^{ix}}{\scy\omega\in\R}$.
%
%In Fourier series analysis \xref{thm:opFSi}, \prope{discrete} dilations of the complex exponential 
%form a  basis for $\spLL{\intoo{0}{2\pi}}$ such that
%  \\\indentx$\ds\spLL{\intoo{0}{2\pi}}=\linspan\setjZ{\opDil_j e^{ix}}$.
%
%In Wavelet analysis, for some \fncte{mother wavelet} \xref{def:wavelet} $\fpsi(x)$,
%  \\\indentx$\ds\spLLR=\linspan\set{\opDil_\omega\opTrn_\tau \fpsi(x)}{\omega,\tau\in\R}$.
%
%However, the ranges of parameters $\omega$ and $\tau$ can be much reduced to the countable set $\Z$ resulting in
%a \prope{dyadic} wavelet basis such that for some mother wavelet $\fpsi(x)$,
%  \\\indentx$\ds\spLLR=\linspan\set{\opDil^j\opTrn^n \fpsi(x)}{j,n\in\Z}$.\\
%This text deals almost exclusively with dyadic wavelets. 
%Wavelets that are both \prope{dyadic} and \prope{compactly supported} have the attractive feature 
%that they can be easily implemented in hardware or software by use of the 
%\structe{Fast Wavelet Transform} \xref{fig:fwt}.
%
\begin{minipage}{\tw-65mm}
  In 1989, St{/'e}phane G. Mallat introduced the \structe{Multiresolution Analysis} (MRA, \prefp{def:mra})
  method for wavelet construction. The MRA has become the dominate wavelet construction method.
  This text uses the MRA method extensively, 
  and combines the MRA ``scaling subspaces" \xref{def:mra} with ``wavelet subspaces" \xref{def:seqWn} 
  to form a subspace structure as represented by the 
  \structe{Hasse diagram} to the right.
  The \structe{Fast Wavelet Transform} combines both sets of subspaces as well, 
  providing the results of projections onto both wavelet and MRA subspaces.
  %The MRA is not the only method of wavelet construction,
  Moreover, P.G. Lemari{/'e} has proved that all wavelets with \prope{compact support} are generated by an MRA.\footnotemark
\end{minipage}\hfill%
\tbox{\includegraphics{graphics/latwav.pdf}}
\footnotetext{
  \citor{lemarie1990},
  \citerpg{mallat}{240}{012466606X}
  }

%=======================================
%\section{Analyses}
%=======================================
The MRA is an \hib{analysis} of the linear space $\spLLR$.
An analysis of a linear space $\spX$ is any sequence $\seq{\spV_j}{j\in\Z}$ of linear subspaces of $\spX$.
%A sequence $\seq{\spV_j}{j\in\Z}$ of linear subspaces of a linear space $\spX$
%        is an \hib{analysis} of $\spX$.
        %if  $\seq{\spV_j}{j\in\Z}$ is a partition of $\spX$.
        The partial or complete reconstruction of $\spX$ from $\seq{\spV_j}{j\in\Z}$ is a \hib{synthesis}.%
        \footnote{%
          The word \hie{analysis} comes from the Greek word
          {\fntagreek{>av'alusis}},
          meaning ``dissolution" (\citerpc{perschbacher1990}{23}{entry 359}),
          which in turn means
          ``the resolution or separation into component parts"
          (\citer{collins2009}, \scs\url{http://dictionary.reference.com/browse/dissolution})
          }
  An analysis is completely \hie{characterized} by a \hie{transform}.
  For example, a Fourier analysis is a sequence of subspaces with sinusoidal bases.
  Examples of subspaces in a Fourier analysis include $\spV_1=\linspan\setn{e^{ix}}$, 
  $\spV_{2.3}=\linspan\setn{e^{i2.3x}}$, $\spV_{\sqrt{2}}=\linspan\setn{e^{i\sqrt{2}x}}$, etc.
  A \hib{transform} is loosely defined as a function that maps a family of functions
  into an analysis.
  A very useful transform (a ``\hie{Fourier transform}") for Fourier Analysis is \xref{def:opFT}
  \\\indentx$\ds\brs{\opFT\ff}(\omega) \eqd \frac{1}{\sqrt{2\pi}} \int_\R \ff(x) e^{-i\omega x} \dx$


%  \item A sequence $\opT$ in $\clFxy$ is a \hib{transform} \label{item:wavstrct_T}
%        if each element in the sequence is a projection operator in $\clFxy$.
%        An example of a transform is the \hib{cosine transform} $\opT$ in $\clFrr$ such that
%        \begin{align*}
%          \opT\fx(t) &\eqd \seq{\opP_j}{j\in\Z}
%             \\&\eqd \seq{\int_{t\in\R} \fx(t)\,\mcom{\cos(nt)}{kernel} \dt}{n\in\Z}
%             \\&\eqd \seqn{\cdots,\,
%                           %\int_{t\in\R} \cos\brs{(-2)t}\,\fx(t) \dt,\,
%                           \int_{t\in\R} \fx(t)\,\cos\brs{(-1)t} \dt,\,
%                           \int_{t\in\R} \fx(t)\,                \dt,\,
%                           \int_{t\in\R} \fx(t)\,\cos\brs{( 1)t} \dt,\,
%                           %\int_{t\in\R} \cos\brs{(-2)t}\,\fx(t) \dt,\,
%                           \cdots
%                          }
%        \end{align*}
%        Further examples of transforms include the \hie{Fourier Transform} and various \hie{Wavelet Transforms}.
% it is a \hib{sequence} of projection operators on $\A function $\opT$ in $\clFxy$ is a \hib{transform} if with domain $\clFxy$ and range $\clF{\setA}{\setB}$ if

%20171226%    \begin{minipage}{\tw-65mm}%
%20171226%      An analysis can be partially characterized by its order structure with respect
%20171226%      to an order relation such as the set inclusion relation $\subseteq$.
%20171226%      Most transforms have a very simple M-$n$ order structure,
%20171226%      as illustrated to the right.
%20171226%      The M-$n$ lattices for $n\ge3$ are \prope{modular} but not \prope{distributive}.
%20171226%      Analyses typically have one subspace that is a \hie{scaling} subspace;
%20171226%      and this subspace is often simply a family of constants
%20171226%      (as is the case with \hi{Fourier Analysis}).
%20171226%    \end{minipage}%
%20171226%    \hfill\tbox{\includegraphics{graphics/latmn.pdf}}%
%20171226%
%20171226%    \begin{minipage}{\tw-55mm}%
%20171226%      A special characteristic of wavelet analysis is that there is not just one
%20171226%      scaling subspace,
%20171226%      %(as is with the case of Fourier and other analyses),
%20171226%      but an entire sequence of scaling subspaces.
%20171226%      These scaling subspaces are \prope{linearly ordered} with respect to the
%20171226%      ordering relation $\subseteq$. In wavelet theory, this structure is called a \structe{multiresolution analysis},
%20171226%      or \structe{MRA} \xref{def:mra}.
%20171226%
%20171226%     The MRA was introduced by St{/'e}phane G. Mallat in 1989.
%20171226%     The concept of a scaling space was perhaps first introduced by Taizo Iijima in 1959 in Japan,
%20171226%    and later as the \structe{Gaussian Pyramid} by Burt and Adelson in the 1980s in the West.\footnotemark
%20171226%    \end{minipage}%
%20171226%    \footnotetext{%
%20171226%      \citorp{mallat89}{70},
%20171226%      \citor{iijima1959},
%20171226%      \citor{burt1983},
%20171226%      \citor{adelson1981},
%20171226%      \citer{lindeberg1993},
%20171226%      \citer{alvertez1993},
%20171226%      \citer{guichard2012},
%20171226%      \citerc{weickert1999}{historical survey}
%20171226%      }
%20171226%    \hfill\tbox{\includegraphics{graphics/latmra.pdf}}%
%20171226%
%20171226%    \begin{minipage}{\tw-65mm}%
%20171226%      A second special characteristic of wavelet analysis is that it's order structure
%20171226%      with respect to the $\subseteq$ relation is not a simple M-$n$ lattice 
%20171226%     (as is with the case of Fourier and other analyses).
%20171226%      Rather, it is a lattice of the form illustrated to the right.
%20171226%      This lattice is \prope{non-complemented}, \prope{non-distributive},
%20171226%      \prope{non-modular}, and \prope{non-Boolean} \xref{prop:order_wavstrct}.
%20171226%    \end{minipage}%
%20171226%    \hfill\tbox{\includegraphics{graphics/latwav.pdf}}%
%20171226%
%20171226%    \begin{minipage}{\tw-65mm}%
%20171226%      The wavelet subspace structure is similar in form to that of the \structe{Primorial numbers},\footnotemark
%20171226%      illustrated to the right by a \hie{Hasse diagram}.
%20171226%      %In the world of mathematical structures,
%20171226%      %there is circumstantial evidence that the order structure of wavelet analyses is quite rare,
%20171226%      %if not outright unique.
%20171226%      %For example, suppose we replace the wavelet subspaces with prime numbers
%20171226%      %and the scaling subspaces with their products as illustrated to the right.
%20171226%      %The resulting sequence $\seqn{1,\,2,\,6,\,30,\,210}$ as of 2011 July 30
%20171226%      %has no matches in Neil J.A. Sloane's  \emph{Online Encyclopedia of Integer Sequences}
%20171226%      %(hosted by \emph{AT\&T Research}).\footnotemark
%20171226%    \end{minipage}%
%20171226%    \citetblt{%
%20171226%      \citeoeis{A002110}%
%20171226%      }%
%20171226%    \hfill\tbox{\includegraphics{graphics/latp_1235711.pdf}}%
%20171226%
%20171226%  An analysis can be represented using three different structures:
%20171226%    %\paragraph{Equivalence of lattice representations.}
%20171226%    %So far we have discussed representing a wavelet analysis using three different structures:
%20171226%\\\begin{tabular}{@{\qquad}ll}
%20171226%  \circOne    & sequence of subspaces             \\
%20171226%  \circTwo    & sequence of basis coefficients         \\
%20171226%  \circThree  & sequence of basis vectors
%20171226%\end{tabular}\\
%20171226%These structures are isomorphic to each other, and can therefore be used interchangeably.
%20171226%%(see \prefp{thm:VPb_isomorphic}).
%20171226%%(see \prefp{fig:wav_VPb_isomorphic}).
%20171226%%That is, a ``\hie{wavelet analysis}" can be described using any of these structures.
%20171226%%However, sometimes when introducing theorems about wavelets,
%20171226%%it is convenient to use elements from not just one, but from multiple lattices;
%20171226%%and so it is convenient to have a ``collection" of wavelet analysis elements
%20171226%%all assembled together into one formally defined tuple.
%20171226%%\pref{def:wavsys} (next) does just that---it defines a \hie{wavelet analysis} in terms of a tuple with elements
%20171226%%extracted from the four wavelet structures.
%20171226%
%20171226%%---------------------------------------
%20171226%% isomorphic lattices
%20171226%%---------------------------------------
%20171226%\mbox{}\hfill
%20171226%  \tbox{\includegraphics{graphics/latp_VW.pdf}}\qquad{\Large$\thapprox$}\qquad
%20171226%  \tbox{\includegraphics{graphics/latp_hg.pdf}}\qquad{\Large$\thapprox$}\qquad
%20171226%  \tbox{\includegraphics{graphics/latp_pp.pdf}}
%20171226%\hfill\mbox{}
%20171226%
%20171226%
%20171226%\prefpp{fig:analyses} illustrate the order structures of some analyses,
%20171226%        including two wavelet analyses:
%20171226%\begin{figure}[th]
%20171226%  \centering%
%20171226%  \begin{tabular}{|c|c|}%
%20171226%    \hline%
%20171226%    \mc{1}{B}{Cosine analysis  (even Fourier series)}&\mc{1}{B}{Cosine polynomial analysis}%
%20171226%    \\\includegraphics{graphics/baslat_cosh.pdf}&\includegraphics{graphics/baslat_cose.pdf}%
%20171226%    \\\hline%
%20171226%    \mc{1}{|B|}{Chebyshev polynomial analysis\cittrp{rivlin1974}{4}}&\mc{1}{|B|}{Hadamard-3 analysis}%
%20171226%    \\\includegraphics{graphics/baslat_cheby.pdf}&\includegraphics{graphics/baslat_h3.pdf}%
%20171226%    \\\hline
%20171226%    \mc{1}{|B|}{Haar/Daubechies-$p1$ wavelet analysis} & \mc{1}{B|}{Daubechies-$p2$ wavelet analysis}%
%20171226%    \\\includegraphics{graphics/baslat_d1.pdf}&\includegraphics{graphics/baslat_d2.pdf}%
%20171226%    \\\hline%
%20171226%  \end{tabular}%
%20171226%  \caption{examples of the order structures of some analyses\label{fig:analyses}}
%20171226%\end{figure}


%=======================================
%\section{Multiresolution analysis}
%=======================================
%=======================================
\section{Definition}
%=======================================
\ifdochasnot{transop}{%
Much of the wavelet theory developed in this section is constructed using the \opb{translation operator} $\opTrn$
and the \opb{dilation operator} $\opDil$ (next).
%These operators are illustrated below.
%and in \prefp{fig:haar-jn} for the \hie{Haar} MRA\cittr{haar1910}.
%
%---------------------------------------
\begin{definition}
\footnote{
  \citerppgc{walnut2002}{79}{80}{0817639624}{Definition 3.39},
  \citerppg{christensen2003}{41}{42}{0817642951},
  \citerpgc{wojtaszczyk1997}{18}{0521578949}{Definitions 2.3,2.4},
  \citerpg{kammler2008}{A-21}{0521883407},
  \citerpg{bachman2000}{473}{0387988998},
  \citerpg{packer2004}{260}{0821834029}, %{section 3.1}\\
  \citerpg{zayed2004}{}{0817643044},
  \citerpgc{heil2011}{250}{0817646868}{Notation 9.4},
  \citerpg{casazza1998}{74}{0817639594},
  \citerp{goodman1993}{639},
  \citerp{dai1996}{81},
  \citerpg{dai1998}{2}{0821808001}
  %\citerpg{dai1998}{21}{0821808001}
  }
\label{def:opT}
\label{def:opD}
\label{def:opTD}
%---------------------------------------
%Let $\spX\eqd\spLLR$ be the space of all \structe{square Lebesgue integrable functions} \xref{def:spLLR}.
%Let $\opTrn$ and $\opDil$ be operators in $\clOxx$.
%Let $\C$ be the set of complex numbers,
%and $\hxs{\spLLR}$ the set of all functions with range $\C$ and domain $\C$.
\defbox{\begin{array}{Frc>{\ds}lMlC}
    1. & \mc{6}{M}{$\hxs{\opTrn}$ is the \opd{translation operator} on $\spCC$ defined as}\\
       & \indentx\hxs{\opTrn_\tau}  \ff(x) &\eqd&         \ff(x-\tau) &and& \hxs{\opTrn}\eqd\opTrn_1 & \forall \ff\in\spCC
       \\
    2. & \mc{6}{M}{$\hxs{\opDil}$ is the \opd{dilation operator} on $\spCC$ defined as}\\
       & \indentx\hxs{\opDil_\alpha} \ff(x) &\eqd& \ff(\alpha x) &and& \opDil\eqd\sqrt{2}\opDil_2 & \forall \ff\in\spCC
\end{array}}
\end{definition}

\begin{center}\begin{tabular}{cc}
  \includegraphics{graphics/opTrn.pdf}&\includegraphics{graphics/opDil.pdf}%
\end{tabular}\end{center}
}



A multiresolution analysis provides ``coarse" approximations of a function in a linear space $\spLLR$ at multiple
``scales" or ``resolutions".
%\paragraph{Scaling function.}
Key to this process is a sequence of \hie{scaling functions}.
Most traditional transforms feature a single \hie{scaling function} $\fphi(x)$
set equal to one ($\fphi(x)=1$).
This allows for convenient representation of the most basic functions, such as constants.\footnote{\citePp{jawerth}{8}}
A multiresolution system, on the other hand, uses a generalized form of the scaling concept:
\begin{dingautolist}{"AC}
  \item Instead of the scaling function simply being set \emph{equal to unity} ($\fphi(x)=1$),
        a multiresolution system \xref{def:mrasys} is often constructed in such a way that the scaling function 
        $\fphi(x)$ forms a \hie{partition of unity} \xref{def:pun} such that
        $\sum_{n\in\Z} \opTrn^n\fphi(x) = 1$.
  \item Instead of there being \emph{just one} scaling function, there
        is an entire sequence of scaling functions $\seqjZ{\opDil^j\fphi(x)}$, 
        each corresponding to a different ``\hie{resolution}".
\end{dingautolist}

%--------------------------------------
\begin{definition}% [multiresolution system]
\footnote{
  \citerpg{hernandez1996}{44}{0849382742},
  \citerpgc{mallat}{221}{012466606X}{Definition 7.1},
  \citorp{mallat89}{70},
  \citorpgc{meyer1992}{21}{0521458692}{Definition 2.2.1},
  \citerpgc{christensen2003}{284}{0817642951}{Definition 13.1.1},
  \citerppgc{bachman2000}{451}{452}{0387988998}{Definition 7.7.6},
  \citerppgc{walnut2002}{300}{301}{0817639624}{Definition 10.16},
 %\citerppgc{vidakovic}{51}{52}{0471293652}{Riesz basis: footnote on page 52}\\
  \citerppgc{dau}{129}{140}{0898712742}{Riesz basis: page 139}
  %\citerppgc{christensen2003}{73}{74}{0817642951}{Definition 3.8.2}\\
  %\citerpgc{heil2011}{371}{0817646868}{Definition 12.8}\\
  %\citerpgc{walter}{38}{1584882271}{3.1 Multiresolution Analysis}
  }
\label{def:seqVn}
\label{def:mra}
\label{def:wavstrct_phi}
%--------------------------------------
%Let $\spLLR$ be the space of all \structe{square Lebesgue integrable functions} \xref{def:spLLR}.
Let $\seqjZ{\spV_j}$ be a sequence of subspaces on $\spLLR$ \xref{def:spLLR}.  %be a \prope{separable} \structe{Hilbert space}.
Let $\clsA$ be the \structe{closure} of a set $\setA$.
\\\defboxt{
  The sequence $\seqjZ{\spV_j}$ is a \structd{multiresolution analysis} on $\spLLR$ if
  \\
  $\begin{array}{@{\qquad}F>{\ds}lCDD}
   %1. & \spV_j \text{ is a linear subspace of $\spX$}\qquad \forall \spV_j\in\seqjZ{\spV_j}
    %\cnto & \mc{2}{M}{$\spLLR$ is \prope{complete}}                       & ($\spLLR$ is a \structe{Hilbert Space})         & and
    %\cntn & \mc{2}{M}{$\spLLR$ is \prope{separable}}                      &                                               & and
      1.  & \spV_j          = \cls{\spV_j}              & \forall j\in\Z                 & (\prope{closed})                              & and 
    \\2.  & \spV_j          \subset \spV_{j+1}          & \forall j\in\Z                 & (\prope{linearly ordered})                    & and 
    \\3.  & \clsp{\Setu_{j\in\Z} \spV_j} = \spLLR         &                                & (\prope{dense} in $\spLLR$)    & and 
   %\cntn & \Seti_{j\in\Z} \spV_j = \setn{\vzero}       &                                & (\structe{greatest lower bound} is $\spZero$) & and 
    \\4.  & \ff\in\spV_j \iff    \opDil\ff\in\spV_{j+1} & \forall j\in\Z,\,\ff\in\spLLR  & (\prope{self-similar})                        & and
   %\cntn & \ff\in\spV_j \iff    \opTrn\ff\in\spV_j     & \forall n\in\Z,\,\ff\in\spLLR  & (\prope{translation invariant})               & and 
    \\5.  & \mc{3}{l}{\ds\exists \fphi \st \setxZ{\opTrn^n\fphi} \text{ is a \structe{Riesz basis} for $\spV_0$.}}                       & 
  \end{array}$
  \\
  A \structe{multiresolution analysis} is also called an \hid{MRA}.\\
  An element $\spV_j$ of $\seqjZ{\spV_j}$ is a \hid{scaling subspace} of the space $\spLLR$.\\
  The pair $\hxs{\MRAspaceLLRV}$ is a \hid{multiresolution analysis space}, or \hid{MRA space}.\\
  The function $\hxs{\fphi}$ is the \hid{scaling function} of the \structe{MRA space}.
  }
\end{definition}

The traditional definition of the \structe{MRA} also includes the following:
  \\\indentx$\begin{array}{F>{\ds}lCD}
      \cntn & \ff\in\spV_j \iff    \opTrn^n\ff\in\spV_j     & \forall n,j\in\Z,\,\ff\in\spLLR  & (\prope{translation invariant})
      \cntn & \Seti_{j\in\Z} \spV_j = \setn{\vzero}         &                                  & (\structe{greatest lower bound} is $\spZero$)
  \end{array}$\\
However, \pref{prop:mra_transinvar} (next) demonstrates that
both of these follow from the \structe{MRA} as defined in \pref{def:mra}.

%--------------------------------------
\begin{proposition}
\footnote{
  \citerpgc{hernandez1996}{45}{0849382742}{Theorem 1.6},
  \citerppgc{wojtaszczyk1997}{19}{28}{0521578949}{Proposition 2.14},
  \citerppgc{pinsky2002}{313}{314}{0534376606}{Lemma 6.4.28}
  }
\label{prop:mra_transinvar}
\label{prop:mra_glb}
%--------------------------------------
\propbox{
  \brbr{\begin{array}{N}
    $\seqjZ{\spV_j}$ is an \structe{MRA}\\
    \xref{def:mra}
  \end{array}}
  \implies
  \brbl{\begin{array}{F>{\ds}lCD}
    1. & \ff\in\spV_j \iff    \opTrn^n\ff\in\spV_j   & \forall n,j\in\Z,\,\ff\in\spLLR  &(\prope{translation invariant}) and\\
    2. & \Seti_{j\in\Z} \spV_j = \setn{\vzero}       &                                  & (\structe{greatest lower bound} is $\spZero$)
  \end{array}}
  }
\end{proposition}
\begin{proof}
%\begin{enumerate}
Proof for (1):
\begin{align*}
  &\opTrn^n\ff\in\spV_j
  \\&\iff \opTrn^n\ff\in\linspan\set{\opDil^j\opTrn^m\fphi}{\scy m\in\Z}
          &&
          && \text{by definition of $\setn{\fphi}$} && \text{\xref{def:mra}}
  \\&\iff \exists \seqxZ{\alpha_n} \st \opTrn^n\ff(x)
          &&= \sum_{k\in\Z}\alpha_k\opDil^j\opTrn^k\fphi(x)
          && \text{by definition of $\setn{\fphi}$} && \text{\xref{def:mra}}
  \\&\iff \exists \seqxZ{\alpha_n} \st \ff(x)
          &&= \opTrn^{-n}\sum_{k\in\Z}\alpha_k\opDil^j\opTrn^k\fphi(x)
          && \text{by definition of $\opTrn$} && \text{\xref{def:opT}}
  \\&     &&= \sum_{k\in\Z}\alpha_k\opTrn^{-n}\opDil^j\opTrn^k\fphi(x)
          %&& \text{by \prefp{prop:opTD_sum}}
  \\&     &&= \sum_{k\in\Z}\alpha_k\opDil^j\opTrn^{k-2n}\fphi(x)
          && \text{by \thme{commutator relation}} && \text{\xref{prop:DTTD}}
  \\&     &&= \sum_{\ell\in\Z}\alpha_{\ell+2n}\opDil^j\opTrn^{\ell}\fphi(x)
          && \text{where $\ell\eqd k-2n\implies$} &&k=\ell+2n
  \\&     &&= \sum_{\ell\in\Z}\beta_{\ell}\opDil^j\opTrn^{\ell}\fphi(x)
          && \text{where $\beta_{\ell}\eqd\alpha_{\ell+2n}$}
  \\&     &&\iff \quad\ff\in\spV_j
          && \text{by def. of $\setn{\opTrn^n\fphi}$} && \text{\xref{def:mra}}
\end{align*}

Proof for (2):
\begin{enumerate}
  \item Let $\opP_j$ be the \ope{projection operator} that generates the scaling subspace $\spV_j$ such that \label{idef:mra_glb_Pj}
    \\\indentx$\ds\opV_j=\set{\opP_j\ff}{\ff\in\spLLR}$

  \item lemma: Functions with \prope{compact support} are \prope{dense} in $\spLLR$.
        \label{ilem:mra_glb_dense}
        Therefore, we only need to prove that the proposition is true for functions with support in $\intcc{-R}{R}$, for all $R>0$.

  \item For some function $\ff\in\spLLR$, let $\seqxZ{\ff_n}$ be a sequence of functions in $\spLLR$ 
        with \prope{compact support} such that
        \\\indentx
        $\support\ff_n\subseteq\intcc{-R}{R}$ for some $R>0$
        \quad and\quad
        $\ds\ff(x)=\lim_{n\to\infty}\seqn{\ff_n(x)}$.
        \label{idef:mra_glb_ffn}

  \item lemma: $\ds\Seti\spV_j=\setn{\vzero}\quad\iff\quad\lim_{j\to-\infty}\norm{\opP_j\ff}=0\quad{\scy\forall\ff\in\spLLR}$. Proof:  \label{ilem:mra_glb_VjPj}
    \begin{align*}
      \Seti_{j\in\Z}\spV_j 
        &= \Seti_{j\in\Z}\set{\opP_j\ff}{\ff\in\spLLR}
        && \text{by definition of $\spV_j$} && \text{\xref{idef:mra_glb_Pj}}
      \\&= \lim_{j\to-\infty}\set{\opP_j\ff}{\ff\in\spLLR}
        && \text{by definition of $\seti$} && \text{\ifxref{setstrct}{def:setop}}
      \\&= \vzero
      \iff \lim_{j\to-\infty}\norm{\opP_j\ff}=0
        && \text{by \prope{nondegenerate} property of $\normn$} && \text{\xref{def:norm}}
    \end{align*}
  
  \item lemma: $\ds\lim_{j\to-\infty}\norm{\opP_j\ff}=0\quad{\scy\forall\ff\in\spLLR}$. Proof:\\
        Let $\setindAx$ be the \fncte{set indicator function} \xref{def:setind} \label{ilem:mra_glb_norm}
    \begin{align*}
      &\lim_{j\to-\infty}\norm{\opP_j\ff}^2
      \\&=   \lim_{j\to-\infty}\norm{\opP_j\lim_{n\to\infty}\seqn{\ff_n}}^2
        &&   \text{by \prefp{idef:mra_glb_ffn}}
      \\&\le \lim_{j\to-\infty}B\sum_{n\in\Z}\abs{\inprod{\opP_j\lim_{n\to\infty}\seqn{\ff_n}}{\opDil^j\opTrn^n\fphi}}^2
        &&   \text{by \prope{frame property}} && \text{\xref{prop:rbasis_frame}}
      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\abs{\inprod{\lim_{n\to\infty}\seqn{\ff_n}}{\opDil^j\opTrn^n\fphi}}^2
        &&   \text{by definition of $\opP_j$} && \text{\xref{idef:mra_glb_Pj}}
      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\abs{\inprod{\setind_\intcc{-R}{R}(x)\lim_{n\to\infty}\seqn{\ff_n}}{\opDil^j\opTrn^n\fphi(x)}}^2
        &&   \text{by definition of $\seqn{\ff_n}$}&& \text{\xref{idef:mra_glb_ffn}}
      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\abs{\inprod{\lim_{n\to\infty}\seqn{\ff_n}}{\setind_\intcc{-R}{R}(x)\opDil^j\opTrn^n\fphi(x)}}^2
        &&   \text{prop. of $\inprodn$ in $\spLLR$}&& \text{ \xref{def:spLLR}}
      \\&\le \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\lim_{n\to\infty}\seqn{\ff_n}}^2\norm{\setind_\intcc{-R}{R}(x)\opDil^j\opTrn^n\fphi(x)}^2
        &&   \text{by \thme{CS Inequality}}&& \text{\ifxref{vsinprod}{thm:cs}}
      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\setind_\intcc{-R}{R}(x)\opDil^j\opTrn^n\fphi(x)}^2
        &&   \text{by definition of $\seqn{\ff_n}$}&& \text{\xref{idef:mra_glb_ffn}}
      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\brs{\mcom{\opDil^j\opDil^{-j}}{$\opI$}\setind_\intcc{-R}{R}(x)}\brs{\opDil^j\opTrn^n\fphi(x)}}^2
        &&   \text{by property of $\opDil$} && \text{\xref{prop:opDi}}
      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{2^{j/2}\opDil^j\brb{\brs{\opDil^{-j}\setind_\intcc{-R}{R}(x)}\brs{\opTrn^n\fphi(x)}}}^2
        &&   \mathrlap{\text{by \prefp{prop:DjTnfg}}}
      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\opDil^j\brb{2^{j/2}2^{-j/2}\setind_\intcc{-R}{R}(2^{-j}x)\brs{\opTrn^n\fphi(x)}}}^2
        &&   \text{by property of $\opDil$} && \text{\xref{prop:opDi}}
      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\opDil^j\brb{\brs{\mcom{\opTrn^n\opTrn^{-n}}{$\opI$}\setind_\intcc{-R}{R}(2^{-j}x)}\brs{\opTrn^n\fphi(x)}}}^2
        &&   \text{by property of $\opTrn$} && \text{\xref{prop:opTi}}
      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\opDil^j\brb{\brs{\opTrn^n\setind_\intcc{-R}{R}(2^{-j}x+n)}\brs{\opTrn^n\fphi(x)}}}^2
        &&   \text{by property of $\opTrn$} && \text{\xref{prop:opTi}}
      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\opDil^j\opTrn^n\brb{\setind_\intcc{-R}{R}(2^{-j}x+n)\fphi(x)}}^2
        &&   \text{by property of $\opDil$} && \text{\xref{prop:opDi}}
      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\setind_\intcc{-R}{R}(2^{-j}x+n)\fphi(x)}^2
        &&   \text{by \prope{unitary} prop.} && \text{\xref{thm:TD_unitary}}
      \\&=   B\norm{\ff}^2\sum_{n\in\Z}\lim_{j\to-\infty}\norm{\setind_\intcc{-2^jR+n}{2^jR+n}(u)\fphi(2^{-j}(u-n))}^2
        &&   \text{$u\eqd 2^jx+n\implies$} && x=2^{-j}(u-n)
      \\&=   B\norm{\ff}^2\sum_{n\in\Z}\lim_{j\to-\infty}\int_{-2^jR+n}^{2^jR+n}\abs{\fphi(2^{-j}(u-n))}^2\du
      \\&=   B\norm{\ff}^2\sum_{n\in\Z}\int_{n}^{n}\abs{\fphi(0)}^2\du
      \\&=   0
    \end{align*}

  \item Final step in proof that $\ds\Seti\spV_j=\setn{\vzero}$: by \prefp{ilem:mra_glb_VjPj} and \prefp{ilem:mra_glb_norm}
%\end{enumerate}
\end{enumerate}
\end{proof}



%---------------------------------------
\begin{proposition}
\citetbl{
  \citerppgc{wojtaszczyk1997}{28}{31}{0521578949}{Proposition 2.15}
  }
\label{prop:mra_UVj}
%--------------------------------------
%Let $\spO\eqd\mrasys$.
Let a \structe{Riesz sequence} be defined as in \prefp{def:rieszseq}.
\propbox{
  \brb{\begin{array}{FMD}
    (1). & $\seqn{\opTrn^n\fphi}$ is a \structe{Riesz sequence} &  and \\
    (2). & $\Fphi(\omega)$ is \prope{continuous} at $0$         &  and \\
    (3). & $\Fphi(0)\neq0$                                      &  
  \end{array}}
  \implies
  \brb{\begin{array}{>{\ds}lD}
     \cls{\brp{\Setu_{j\in\Z} \spV_j}} = \spLLR  & (\prope{dense} in $\spLLR$) 
  \end{array}}
  }
\end{proposition}
\begin{proof}
\begin{enumerate}
  \item Let $\opP_j$ be the \ope{projection operator} that generates the scaling subspace $\spV_j$ such that \label{item:mra_UVj_Pj}
    \\\indentx$\ds\opV_j=\set{\opP_j\ff}{\ff\in\spH}$

  \item definition: Choose $\ff\in\spLLR$ such that $\ff\orthog\Setu_{j\in\Z}\spV_j$.
        Let $\Ff(\omega)$ be the \ope{Fourier Transform} \xref{def:opFT} of $\ff(x)$.
        \label{idef:mra_UVj_f}

  \item lemma: The function $\ff$ \xref{idef:mra_UVj_f} \emph{exists} because the set of functions that 
        can be chosen to be $\ff$ at least contains $0$ (it is not the emptyset). Proof:
        \label{ilem:mra_UVj_fexists}
        \begin{align*}
          \ff(x)=0
            &\implies \inprodr{\ff}{\set{\fh\in\spLLR}{\fh\in\Setu_{j\in\Z}\spV_j}}
          \\&= \inprodr{0}{\set{\fh\in\spLLR}{\fh\in\Setu_{j\in\Z}\spV_j}}
          \\&= 0
          \\&\implies\quad \ff\orthog\Setu_{j\in\Z}\spV_j
          \\&\implies\quad \text{$\ff$ exists}
        \end{align*}

  \item lemma: $\norm{\opP_j\ff}=0\quad{\scy\forall j\in\Z}$. Proof:
        \label{ilem:mra_UVj_Pf}
    \begin{align*}
      \norm{\opP_j\ff}
        &= \norm{0}
        && \text{by definition of $\ff$} &&\text{\xref{idef:mra_UVj_f}}
      \\&= 0
        && \text{by \prope{nondegenerate} property of $\normn$} && \text{\ifxref{vsnorm}{def:norm}}
    \end{align*}

  \item definition: Choose some function $\fg\in\spLLR$ such that $\Fg(\omega)=\Ff(\omega)\setind_\intcc{-R}{R}$ \xref{def:setind} 
        for some $R>0$ 
        and such that $\norm{\ff-\fg}<\varepsilon$.
        Let $\Fg(\omega)$ be the \ope{Fourier Transform} \xref{def:opFT} of $\fg(x)$.
        \label{idef:mra_UVj_g}

  \item lemma: The function $\fg$ \xref{idef:mra_UVj_g} \emph{exists}. Proof: For some (possibly very large) $R$,
        \label{idef:mra_UVj_gexists}
    \begin{align*}
      \varepsilon
        &> \norm{\Ff(\omega)-\Fg(\omega)}
        && \text{by definition of $\fg$} && \text{\xref{idef:mra_UVj_g}}
      \\&= \norm{\opFT\ff(x)-\opFT\fg(x)}
        && \text{by definition of $\Ff$ and $\Fg$} && \text{\xref{idef:mra_UVj_f}, \xref{idef:mra_UVj_g}}
      \\&= \norm{\opFT\brs{\ff(x)-\fg(x)}}
        && \text{by \prope{linearity} of $\opFT$} && \text{\xref{def:linop}}
      \\&= \norm{\ff(x)-\fg(x)}
        && \text{by \prope{unitary} property of $\opFT$} && \text{ \xref{thm:ft_unitary}}
      \\&\implies\quad\text{$\fg$ exists}
        && \mathrlap{\text{because it's possible to satisfy \prefp{idef:mra_UVj_g}}}
    \end{align*}

  \item lemma: $\norm{\opP_j\fg}<\varepsilon\quad{\scy\forall j\in\Z}$ for sufficiently large $R$. Proof:
        \label{ilem:mra_UVj_ge}
    \begin{align*}
      \varepsilon
        &>   \norm{\ff-\fg}
        &&   \text{by definition of $\fg$} && \text{\xref{idef:mra_UVj_g}}
      \\&\ge \norm{\opP_j\brs{\ff-\fg}}
        &&   \text{by property of \ope{projection operator}s} && \text{\xref{def:opP}}
      \\&=   \norm{\opP_j\ff-\opP_j\fg}
        &&   \text{by \prope{additive} property of $\opP_j$} && \text{\ifxref{operator}{def:linop}}
      \\&\ge \abs{\norm{\opP_j\ff}-\norm{\opP_j\fg}}
        &&   \text{by \thme{Reverse Triangle Inequality}} && \text{\ifxref{vsnorm}{thm:rti}}
      \\&=   \abs{0-\norm{\opP_j\fg}}
        &&   \text{by \xref{ilem:mra_UVj_Pf}}
      \\&=   \norm{\opP_j\fg}
        &&   \text{by \prope{strictly positive} property of $\normn$} && \text{\xref{def:norm}}
    \end{align*}

  \item  lemma: $\fg=0$. Proof: \label{ilem:mra_UVj_g0}
    \begin{align*}
       0
        &=   \lim_{j\to\infty}\norm{\opP_j\fg}^2
        &&   \text{by \prefp{ilem:mra_UVj_ge}}
      \\&\ge \lim_{j\to\infty}A\sum_{n\in\Z}\abs{\inprod{\opP_j\fg}{\opDil^j\opTrn^n\fphi}}^2
        &&   \text{by \prope{frame property}} && \text{ \xref{prop:rbasis_frame}}
      \\&=   \lim_{j\to\infty}A\sum_{n\in\Z}\abs{\inprod{\fg}{\opDil^j\opTrn^n\fphi}}^2
        &&   \text{by definition of $\opP_j$} && \text{ \xref{item:mra_UVj_Pj}}
      \\&=   \lim_{j\to\infty}A\sum_{n\in\Z}\abs{\inprod{\opFT\fg}{\opFT\opDil^j\opTrn^n\fphi}}^2
        &&   \text{by \prope{unitary} property of $\opFT$} && \text{ \xref{thm:ft_unitary}}
      \\&=   \lim_{j\to\infty}A\sum_{n\in\Z}\abs{\inprod{\Fg(\omega)}{2^{-j/2}e^{-i2^{-j}\omega n}\Fphi(2^{-j}\omega)}}^2
        &&   \text{by \prefp{prop:FTDf}}
      \\&=   \lim_{j\to\infty}A\sum_{n\in\Z}\abs{\inprod{\Fg(\omega)\Fphi^\ast(2^{-j}\omega)}{2^{-j/2}e^{-i2^{-j}\omega n}}}^2
        &&   \text{by property of $\inprodn$ in $\spLLR$}
      \\&=   \lim_{j\to\infty}A\norm{\Fg(\omega)\Fphi^\ast(2^{-j}\omega)}^2
        &&   \text{by \thme{Parseval's Identity}} && \text{\xref{thm:fst}}
      \\&=   A\norm{\Fg(\omega)\Fphi^\ast(0)}^2
        &&   \text{by left hypothesis (2)}
      \\&=   A\abs{\Fphi^\ast(0)}^2\,\norm{\Fg(\omega)}^2
        &&   \text{by \prope{homogeneous} property of $\normn$} && \text{\ifxref{vsnorm}{def:norm}}
      \\&=   A\abs{\Fphi(0)}^2\,\norm{\fg}^2
        &&   \text{by \prope{unitary} property of $\opFT$} && \text{\xref{thm:ft_unitary}}
      \\&\implies \norm{\fg}=0
        &&   \text{by left hypothesis (3)}
      \\&\iff     \fg=0
        &&   \text{by \prope{nondegenerate} property of $\normn$} && \text{\ifxref{vsnorm}{def:norm}}
      %\\&\implies  \cls{\brp{\Setu_{j\in\Z}\spV_j}}=\spLLR
    \end{align*}

  \item Final step in proof that $\ds\cls{\brp{\Setu_{j\in\Z} \spV_j}} = \spLLR$:
    \begin{align*}
      \fg
        &=0
        && \text{by \prefp{ilem:mra_UVj_g0}}
      \\&\implies\ff=0
        && \text{by definition of $\fg$} && \text{\xref{idef:mra_UVj_g}}
      \\&\implies \cls{\brp{\Setu_{j\in\Z} \spV_j}} = \spLLR
    \end{align*}
\end{enumerate}
\end{proof}

%=======================================
%\subsection{Separable Hilbert Space}
%=======================================
\pref{def:mra} defines an MRA on the space $\spLLR$, which is a special case of a \structe{separable Hilbert space}.
A Hilbert space\ifsxrefs{seq}{def:hilbert}is a \structe{linear space}\ifsxrefs{vector}{def:vspace}that is 
equipped with an \structe{inner product}\ifsxref{vsinprod}{def:inprod},
is \prope{complete}\ifsxrefs{seq}{def:complete}with respect to the 
\structe{metric}\ifsxrefs{metric}{def:metric}induced by the inner product,
and contains a subset that is \prope{dense}\ifsxrefs{topology}{def:dense}in $\spLLR$.

An \structe{inner product} on a linear space endows the linear space with a \structe{topology}\ifsxref{topology}{def:topology}.
The sum such as $\sum_{n=1}^\xN \alpha_n \ff_n$ is finite and thus suitable for a finite linear space only.
An infinite space requires an infinite sum $\sum_{n=1}^\infty \alpha_n \fphi_n$, and an infinite sum is defined
in terms of a limit \xref{def:suminf}.
%  \\\indentx$\ds\sum_{n=1}^\infty \alpha_n \fphi_n \eqd \lim_{\xN\to\infty}\mcom{\ds\sum_{n=1}^\xN \alpha_n \fphi_n}{partial sum}$.\\
The limit, in turn, is defined in terms of a \structe{topology}\ifsxref{topology}{def:topology}.
The \structe{inner product}\ifsxrefs{vsinprod}{def:inprod} induces a \structe{norm} \xref{def:norm} which induces a 
\structe{metric}\ifsxrefs{metric}{def:metric} which induces a topology\ifsxref{metric}{thm:(X,d)->(X,t)}.

%A common example of a separable Hilbert space is the space of square integrable functions, $\spLLR$.
%And in fact, for the design examples in this book, the reader may simply set $\spLLR=\spLLR$.

%%---------------------------------------
%\begin{proposition}
%\label{prop:Vn_separable}
%%---------------------------------------
%Let $\MRAspaceLLRV$ be an \structe{MRA space}.
%\propbox{
%  \text{$\spV_j$ is \prope{separable}}\qquad\scy\forall j\in\Z
%  }
%\end{proposition}
%\begin{proof}
%\begin{enume}
%  \item By \pref{def:mra}, $\spLLR$ is \prope{separable}.
%  \item So by \prefp{thm:XdYd_separable}, each $\spV_j$ is \prope{separable} as well.
%\end{enume}
%\end{proof}
%


%=======================================
%\subsection{Closure properties}
%=======================================
\pref{def:mra} defines each subspace $\spV_j$ to be \prope{closed} ($\spV_j=\cls{\spV_j}$) in $\spLLR$.
As one might imagine, the properties of \prope{completeness}\ifsxrefs{seq}{def:complete}and 
\prope{closure}\ifsxrefs{topology}{def:clsA}%, \prefp{def:subspace_closed}
are closely related. % (see next proposition).
Moreover, Every \prope{complete} sequence is also \prope{bounded}\ifsxref{metric}{def:bounded},
and so each subspace $\spV_j$ is \prope{bounded} as well. % (see \prefp{prop:Vn_bounded}).
%Both are topological properties. Completeness is defined on sequences \xref{def:sequence}; %closure is defined on sets.



%%---------------------------------------
%\begin{proposition}
%%---------------------------------------
%Let $\MRAspaceLLRV$ be an \structe{MRA space}.
%\propbox{
%  \mcom{\spLLR=\cls\spLLR}{$\spLLR$ is \prope{closed}.}
%  }
%\begin{proof}
%        The limit of an expansion (if the limit exists) may be inside the linear space or outside. \label{item:mra_Hcomplete}
%        We would like it to be inside. That is, we would like the space $\spLLR$ to contain all its 
%        \structe{limit points} \xref{def:limitpnt}.
%        The space $\spLLR$ does contain all its limit points because by definition, it is \propb{complete} \xref{def:complete}.
%        Any metric space (which includes all inner product spaces) that is \prope{complete} is also \prope{closed}
%        \xref{thm:comcls}.
%        And a metric space is \prope{closed} if and only if it contains all its limit points \xref{thm:cst}.
%        An inner product space that is \prope{complete} is called a \structe{Hilbert space} \xref{def:hilbert}.
%\end{proof}

%---------------------------------------
\begin{proposition}
\label{prop:Vn_complete}
%---------------------------------------
Let $\MRAspaceLLRV$ be an \structe{MRA space}.
\propbox{
  \text{Each subspace $\spV_j$ is \prope{complete}.}
  }
\end{proposition}
\begin{proof}
\begin{enume}
  \item By definition \pref{def:mra}, $\spLLR$ is \prope{complete}. 
  \item In any metric space, (which includes all inner product spaces such as $\spLLR$),
        a \prope{closed} subspace of a \prope{complete} metric space is itself also \prope{complete}\ifsxref{seq}{thm:comcls}.
  \item In any \prope{complete} metric space $\spX$ (which includes all Hilbert spaces such as $\spLLR$), 
        the two properties coincide---that is, a subspace is complete \emph{if and only if} 
        it is closed in the space $\spX$\ifsxref{seq}{cor:comcomcls}.
  \item So because $\spLLR$ is \prope{complete} and each $\spV_j$ is \prope{closed}, then each $\spV_j$ is also \prope{complete}.
\end{enume}
\end{proof}

%%---------------------------------------
%\begin{proposition}
%\label{prop:Vn_bounded}
%%---------------------------------------
%Let $\MRAspaceLLRV$ be an \structe{MRA space}.
%\propbox{\begin{array}{MMC}
%  $\spLLR$   & is \prope{bounded}.\\
%  $\spV_j$ & is \prope{bounded} & \forall n\in\Z .
%\end{array}}
%\end{proposition}
%\begin{proof}
%\begin{enume}
%  \item Every \prope{complete} metric space is \prope{bounded}\ifsxref{seq}{thm:convergent==>cauchy}.
%  \item $\spLLR$ is \prope{complete}, so it is also \prope{bounded} \xref{def:mra}.
%  \item Each $\spV_j$ is \prope{complete}, so each $\spV_j$ is also \prope{bounded} \xref{prop:Vn_complete}.
%\end{enume}
%\end{proof}

%=======================================
\section{Order structure}
%=======================================

\begin{minipage}{\tw-58mm}%
  A \structe{multiresolution analysis} \xref{def:mra} together with the set inclusion relation $\subseteq$
  forms the \hie{linearly ordered set} \ifdochas{order}{\xref{def:toset}}
  $\hxs{\opair{\seqn{\spV_j}}{\subseteq}}$, illustrated to the right by a \structe{Hasse diagram}\ifsxref{order}{def:hasse}.
  Subspaces $\spV_j$ increase in ``size" with increasing $j$.
  That is, they contain more and more vectors (functions) for larger and larger $j$---%
  with the upper limit of this sequence being $\spLLR$.
  %and the subspace $\spZero$ (smallest $n$) containing only the $\vzero$ vector.
  Alternatively, we can say that approximation within a subspace $\spV_j$ 
  yields greater ``\hie{resolution}" for increasing $j$.
  %In general, the number of subspaces in such a sequence can be countably infinite (e.g. $n\in\Z$).
\end{minipage}%
\hfill\tbox{\includegraphics{graphics/latmra.pdf}}%

The \structe{least upper bound} (\structe{l.u.b.}) of the linearly ordered set $\opair{\seqn{\spV_j}}{\subseteq}$ is $\spLLR$ \xref{def:mra}:
  \\\indentx
   $\ds\clsp{\Setu_{j\in\Z} \spV_j} = \spLLR$.
   %$\ds\lim_{\xN\to\infty}\spV_j \eqd \clsp{\Setu_{j\in\Z} \spV_j} = \spLLR$.
  \\

%      \propb{upper bounded}:
%  Furthermore, the property $\clsp{\Setu_{j\in\Z} \spV_j} = \spLLR$
%  demonstrates that the sequence of scaling subspaces $\seqn{\spV_j}$ is \prope{upper bounded} by $\spLLR$. % \xref{def:complete_set}.
%  Because the subspaces are nested (or linearly ordered with respect to $\subset$) such that $\spV_j\subset\spV_{j+1}$,
%  we could define the least upper bound (or the limit) of such a sequence 
%  as\citetbl{Many thanks to William Elliot, David C. Ullrich, and Seymour J. Shmuel Metz for help with this topic.
%             %\url{https://groups.google.com/forum/\#!topic/sci.math/YD4N58JH5to}
%            }

The \structe{greatest lower bound} (\structe{g.l.b.}) of the linearly ordered set $\opair{\seqn{\spV_j}}{\subseteq}$ is $\spZero$ \xref{prop:mra_glb}:
  \\\indentx
    $\ds\Seti_{j\in\Z}\spV_j = \spZero$.
  \\

All linear subspaces contain the zero vector\ifsxref{subspace}{prop:subspace_prop}.
So the intersection of any two subspaces must at least contain $\vzero$.
If the intersection of any two linear subspaces $\spX$ and $\spY$ is exactly $\setn{\vzero}$, 
then for any vector in
the sum of those subspaces ($\vu\in\spX\adds\spY$) there are \propb{unique} vectors $\ff\in\spX$ and 
$\fg\in\spY$ such that $\vu=\ff+\fg$.
This is \emph{not} necessarily true if the intersection contains more than just $\setn{\vzero}$
\ifsxref{subspace}{thm:XY0_unique}.


%%=======================================
%\subsection{Bases for wavelet system}
%%=======================================
%%%A linear space is a separable Hilbert space if and only if it has a complete basis.
%%Note that \pref{def:mra} does not require $\lim_{\xN\to\infty}\spV_j$ to be equal to $\spLLR$, 
%%it is only requires it to be \prope{dense} in $\spLLR$
%%(just as the rationals are dense in the real numbers).
%%In the set of real numbers, a countable union of closed sets is called a $\symx{\setFsigma}$ set
%%($\setF$ stands for the French word \hie{ferm/'e} or \prope{closed}, and $\sigma$ stands for the French word \hie{somme} or sum).\citetbl{
%%  \citerpg{carothers2000}{130}{0521497566}\\
%%  \citerpg{givant2009}{270}{0387402934}
%%  }                                                                             
%
%\prefp{def:mra} defines an MRA on the space $\spLLR$.
%The space $\spLLR$ is an example of a Hilbert space. % $\spLLR$. 
%A Hilbert space is a linear space equipped with an inner product 
%and that is complete with respect to the topology induced by the inner product.
%
%\begin{enumerate}
%  \item A \structb{linear space} \ifsxrefs{vector}{def:vspace} supports the expansion of a vector $\ff$
%        (e.g. a function) in terms of a set of \structe{coordinates} $\setxn{\alpha_n}$ and a 
%        \structe{Hamel basis} $\setxn{\fphi_n}$\ifsxrefs{frames}{def:hamel}such that \label{item:mra_hamel}
%          \\\indentx$\ds \ff(x)=\sum_{n=1}^\xN \alpha_n \fphi_n(x)$.\\
%        If such coordinates exist for a vector $\ff$ and basis $\setxn{\fphi_n}$, 
%        then those coordinates are \prope{unique}\ifsxref{frames}{thm:hamel_unique}.
%
%  \item The Hamel basis described in \pref{item:mra_hamel} provides sufficient support for expansion in finite linear spaces, 
%        but is problematic in infinite spaces.                           
%        In an infinite linear space with a topology (such as a Banach space or a Hilbert space),
%        a \structe{Schauder basis}\ifsxrefs{frames}{def:schauder}is often used.
%        The Schauder basis is defined in terms of a special type of convergence called \prope{strong convergence}\ifsxref{seq}{def:strong_converge}.
%        Strong convergence is defined in terms of the norm induced by the inner product: \label{item:mra_strong}
%        \\\indentx$\ds  
%          \ff \eqs \sum_{n=1}^\infty\alpha_n\fphi_n
%              \eqd \lim_{\xN\to\infty}\sum_{n=1}^\xN\alpha_n\fphi_n
%              \implies
%              \mcom{\ds\lim_{\xN\to\infty}\norm{\ff-\sum_{n=1}^\xN\alpha_n\fphi_n}=0}{\prope{strong convergence}}
%        $.\\
%        %\\\indentx$\ds  
%        %  \ff \eqs \sum_{n=1}^\infty\inprod{\ff}{\fphi_n}\fphi_n
%        %      \eqd \lim_{\xN\to\infty}\sum_{n=1}^\xN\inprod{\ff}{\fphi_n}\fphi_n
%        %      \implies
%        %      \mcom{\ds\lim_{\xN\to\infty}\norm{\ff-\sum_{n=1}^\xN\inprod{\ff}{\fphi_n}\fphi_n}=0}{\prope{strong convergence}}
%        %$.\\
%        That is, the sum $\sum_{n=1}^\infty\alpha_n\fphi_n$ is by definition  
%        the limit of the partial sums
%        $\sum_{n=1}^\xN\alpha_n\fphi_n$\ifsxref{series}{def:suminf},
%        and that these sums \prope{converge strongly} (``$\eqs$",\ifsxref{seq}{def:strong_converge}) to a limit $\ff$
%        with respect to the topology induced by the norm $\normn$, which in turn is 
%        induced by the inner product $\inprodn$. % \xref{def:norm=inprod}.
%        The completeness property ensures that all of these limits $\ff$ are also in the space $\spLLR$.
% 
%  \item In an MRA space $\MRAspaceLLRV$, the space $\spLLR$ is separable \xref{def:mra}, and the subspaces $\spV_j$ are
%        separable as well. % \xref{prop:Vn_separable}.
%        The property of a space being separable is very important in analysis:
%    \begin{enumerate}
%      \item Every Banach space (which includes all Hilbert spaces such as $\spLLR$ and each $\spV_j$) with 
%            a Schauder basis is \prope{separable}\ifsxref{frames}{thm:Bschauder==>separable}.\label{item:mra_Bschauder_separable}
%      \item The converse is \emph{not} true---not every separable Banach space has a basis\ifsxrefpo{frames}{BasisProblem}.
%    \end{enumerate}
%
%  \item Besides providing a topology, the \structe{inner product} also supports 
%        the notion of a subspace geometry, 
%        including the property of \prope{orthogonality}\ifsxref{vsinprod}{def:orthog}.
%    \begin{enumerate}
%      \item Orthogonality supports the \structe{Fourier expansion}\ifsxrefs{frames}{def:hspace_fex}of a vector $\ff$ over an 
%        \structe{orthornormal basis} $\setxZp{\fphi_n}$ in the form \label{item:mra_inprod}
%        \\\indentx$\ds  
%          \ff \eqs \sum_{n=1}^\infty \mcom{\inprod{\ff}{\fphi_n}}{\structe{Fourier coefficient}}\fphi_n
%          $
%      \item In contrast to \pref{item:mra_Bschauder_separable}, life in Hilbert spaces is much simpler. 
%            A Hilbert space has a Schauder basis \emph{if and only if} it is 
%            separable \ifsxrefs{frames}{thm:schauder<==>separable}. 
%            And so $\spLLR$ and each $\spV_j$ \emph{have} Schauder bases\ifsxref{frames}{thm:schauder<==>separable}.
%      \item A special case of a Schauder basis is an orthonormal basis\ifsxref{frames}{def:basis_ortho}.
%            A Hilbert space has an orthonormal basis if and only if it is separable\ifsxref{frames}{thm:ortho<==>separable}.
%            And so $\spLLR$ and each $\spV_j$ \emph{have} orthonormal bases as well% 
%            \ifdochas{frames}{ (\xref{thm:schauder<==>separable}, \xref{thm:HV_orthobasis})}.
%      \item It is always possible to construct an orthonormal basis for a separable Hilbert space using the 
%            \thme{Graham Schmidt orthogonalization} procedure.
%    \end{enumerate} 
%
%
%
%\item 
%  %Note that the intersection of any two orthogonal subspaces contains the zero vector only \xref{thm:YoZ==>YZ0}.
%  A basis\ifsxrefs{frames}{sec:hspace_bases} $\setxn{\fphi_n}$ that is \prope{orthonormal}  possesses a number of useful properties
%  including the following:
%    \begin{enumerate}
%      \item The \thmb{Pathogorean Theorem} holds such that  $\norm{\sum_{n=1}^\xN \fphi_{n}}^2 = \sum_{n=1}^\xN \norm{\fphi_n}^2$\ifsxref{frames}{thm:pythag}.
%      \item The sequence $\setn{\fphi_n}$ is \prope{linearly independent}\ifsxref{frames}{thm:orthog==>linin}.
%      %\item \thmb{Bessel's equality} holds such that 
%      %      $\ds\norm{\ff-\sum_{i=n}^\xN \inprod{\ff}{\fphi_n} \fphi_n }^2 = \norm{\ff}^2 - \sum_{i=1}^\xN |\inprod{\ff}{\fphi_n}|^2$
%      \item \thmb{Bessel's inequality} holds such that 
%            $\ds\sum_{n=1}^\infty \abs{\inprod{\ff}{\fphi_n}}^2 \le \norm{\ff}^2$\ifsxref{frames}{thm:bessel_ineq}.
%      \item Every vector $\ff$ in $\spLLR$ has a \structe{Fourier expansion}\ifsxrefs{frames}{def:hspace_fex}such that \\
%            $\ds\ff\eqs\sum_{n=1}^\infty \inprod{\ff}{\fphi_n} \fphi_n$\ifsxref{frames}{prop:hspace_fex}.
%      \item \thmb{Parseval's identity} holds \textbf{if and only if} $\setn{\fphi_n}$ is an orthonormal basis:\\
%            $\ds\norm{\ff}^2 \eqs\sum_{n=1}^\infty \abs{\inprod{\ff}{\fphi_n}}^2  \quad\scy\forall\ff\in\setX$%
%            \ifsxref{frames}{thm:parsevalid}.
%      \item The \structe{Fourier expansion} of a vector $\ff$ in a Hilbert space $\spLLR$
%            on an orthonormal basis $\setn{\fphi_n}$ 
%            that spans a subspace $\spY\subseteq\spLLR$ is the best approximation of $\ff$ in $\spY$ with respect to
%            the metric induced by the inner product (\thme{Best Approximation Theorem}\ifsxref{frames}{thm:bat}).
%    \end{enumerate}
%
%
%  \item \structb{Riesz basis}: \pref{def:mra} does not explicitly require an orthonormal basis.
%         Instead, it only specifies the weaker (more general) constraint of a Riesz basis.
%         This constraint implies simply that there is a linear mapping between the Riesz basis and an orthonormal basis.
%         In particular, an orthonormal basis can be constructed from the Riesz basis.
%\end{enumerate}

%%--------------------------------------
%\begin{proposition}
%\label{thm:HV_orthobasis}
%%--------------------------------------
%Let $\MRAspaceLLRV$ be an MRA space.
%\propbox{\begin{array}{MMC}
%  $\spLLR$   & has an \structe{orthonormal basis}\\
%  $\spV_j$ & has an \structe{orthonormal basis} & \forall j\in\Z
%\end{array}}
%\end{proposition}
%\begin{proofns}
%\begin{enume}
%  %\item By \prefp{def:mra}, $\spLLR$ is \prope{separable}.
%  \item $\spLLR$ is \prope{separable}.
%  \item Therefore $\spLLR$ has an orthonormal basis\ifsxref{frames}{thm:ortho<==>separable}.
%  \item Therefore each $\spV_j$ is \prope{separable}\ifsxref{subspace}{prop:Vn_separable}.
%  \item So each $\spV_j$ has an orthonormal basis\ifsxref{frames}{thm:ortho<==>separable}.
%\end{enume}
%\end{proofns}

%=======================================
\section{Dilation equation}
%=======================================
Several functions in mathematics exhibit a kind of \prope{self-similar} or \prope{recursive} property:
\begin{listi}
  \item If a function $\ff(x)$ is \prope{linear}, then \xref{ex:TD_flinear}
        \\\indentx$\ds\ff(x) = \ff(1)x - \ff(0)\opTrn x$.   %{$\setn{x,\,\opTrn x}$ is a \structe{basis} for $\clLcc$}$.
  \item If a function $\ff(x)$ is sufficiently \prope{bandlimited}, then the \structe{Cardinal series} \xref{ex:TD_cardinalseries} demonstrates
        \\\indentx$\ds\ff(x) = \sum_{n=1}^\infty \ff(n) \opTrn^n\frac{\sin\brs{\pi(x)}}{\pi(x)}$.
  \item \fncte{B-splines} \xref{thm:bspline_recursion} are another example:
        \\\indentx$\ds\fN_n(x)   = \frac{1}{n}x\fN_{n-1}(x) - \frac{1}{n}x\opTrn\fN_{n-1}(x) + \frac{n+1}{n}\opTrn\fN_{n-1}(x)  \qquad\scy\forall n\in\Znn\setd\setn{1},\,  \forall x\in\R$.
\end{listi}

The scaling function $\fphi(x)$ \xref{def:mra} also exhibits a kind of \prope{self-similar} property.
By \prefp{def:mra}, the dilation $\opDil\ff$ of each vector $\ff$ in $\spV_0$ is in $\spV_1$.
If $\setxZ{\opTrn^n\fphi}$ is a basis for $\spV_0$,
then $\setxZ{\opDil\opTrn^n\fphi}$ is a basis for $\spV_1$,
$\setxZ{\opDil^2\opTrn^n\fphi}$ is a basis for $\spV_2$, \ldots;
and in general $\set{\opDil^j\opTrn^m\fphi}{j\in\Z}$ is a basis for $\spV_j$.
Also, if $\fphi$ is in $\spV_0$, then it is also in $\spV_1$ (because $\spV_0\subset\spV_1$).
And because $\fphi$ is in $\spV_1$ and because $\setxZ{\opDil\opTrn^n\fphi}$ is a basis for $\spV_1$,
$\fphi$ is a linear combination of the elements in $\setxZ{\opDil\opTrn^n\fphi}$.
That is, $\fphi$ can be represented as a linear combination of translated and dilated versions of itself.
The resulting equation is called the \hie{dilation equation} (\pref{def:dilation_eq}, next).\footnote{%
The property of \prope{translation invariance} is of particular significance in the theory of 
\structe{normed linear spaces} (a Hilbert space is a complete normed linear space equipped with an inner product)%
\ifdochas{vsnorm}{---see \prefp{lem:vsn_ti} and \prefp{thm:vsn_d2norm}}.
}

%--------------------------------------
\begin{definition}
\citetbl{
  \citerp{jawerth}{7}
  }
\label{def:dilation_eq}
%--------------------------------------
Let $\MRAspaceLLRV$ be a \structe{multiresolution analysis space} with scaling function $\fphi$ \xref{def:mra}.
Let $\seqxZ{\fh_n}$ be a \structe{sequence} \xref{def:seq} in $\spllR$ \xref{def:spllR}.
\defboxt{
  The \structe{equation} 
    \quad$\ds\brb{\fphi(x)=\sum_{n\in\Z} \fh_n \opDil \opTrn^n \fphi(x)\qquad\scy\forall x\in\R}$\quad
  is called the \equd{dilation equation}.\\
  It is also called the \equd{refinement equation},
  \equd{two-scale difference equation},\\and \equd{two-scale relation}.
  }
\end{definition}

%--------------------------------------
\begin{remark}
%--------------------------------------
\remboxt{
  The \eque{dilation equation} under the defintions of $\opT$ and $\opD$ evaluates to 
  \\\indentx$\ds\fphi(x)=\sum_{n\in\Z} \fh_n \fphi(2x-n)$.
  }
\end{remark}
\begin{proof}
  \begin{align*}
    \fphi(x)
      &= \sum_{n\in\Z} \fh_n \opDil \opTrn^n \fphi\brp{x}
    \\&= \sum_{n\in\Z} \fh_n \opDil \fphi\brp{x-n}
      && \text{by definition of $\opT$} && \text{\xref{def:opT}}
    \\&= \sum_{n\in\Z} \fh_n \fphi\brp{2x-n}
      && \text{by definition of $\opD$} && \text{\xref{def:opD}}
  \end{align*}
\end{proof}

%--------------------------------------
\begin{theorem}[\thmd{dilation equation}]
\label{thm:h->phi}
\label{thm:dilation_eq}
%--------------------------------------
%Let $\MRAspaceLLRV$ be a \structe{multiresolution analysis space} with scaling function $\fphi$ \xref{def:mra}.
%Let $\mrasys$ be an \structe{MRA system} \xref{def:mrasys}.
Let an \structe{MRA space} and \fncte{scaling function} be as defined in \prefp{def:mra}.
%Let $\Fphi(\omega)$ be the \fncte{Fourier transform}\ifsxrefs{harFour}{def:ft}of $\fphi(x)$.
%Let $\Dh(\omega)$ be the \fncte{Discrete time Fourier transform}\ifsxref{dsp}{def:dtft} of $\seqn{\fh_n}$.
%\\Let $\ds\prod_{n=1}^\infty x_n \eqd \lim_{\xN\to\infty}\prod_{n=1}^\xN x_n$.
\thmbox{
  \brb{\begin{array}{M}
    $\MRAspaceLLRV$ is an \structe{MRA space}\\ 
    with \structe{scaling function} $\fphi$
  \end{array}}
  \quad\implies\quad
  \mcom{\brb{\begin{array}{>{\ds}l}
    \scy\exists \seqxZ{\fh_n} \st\\
    \fphi(x)=\sum_{n\in\Z} \fh_n \opDil \opTrn^n \fphi(x)\qquad
    \scy\forall x\in\R
  \end{array}}}{\prope{dilation equation in ``time"}}
  }
\end{theorem}
\begin{proof}
  \begin{align*}
    \fphi &\in \spV_0
          && \text{by definition of \struct{MRA}} && \text{\xref{def:mra}}
        \\&\subseteq \spV_1
          && \text{by definition of \struct{MRA}} && \text{\xref{def:mra}}
        \\&\eqd \linspan\setxZ{\opDil\opTrn^n\fphi(x)}
          && \text{by definition of $\spV_j$}     && \text{\xref{def:mra}}
        \\&\implies 
           \exists \seqxZ{\fh_n} \st
              \fphi(x) = \sum_{n\in\Z}\fh_n \opDil \opTrn^n \fphi(x)
          && \text{by definition of $\linspan$}   && \text{\xref{def:linspan}}
  \end{align*}
\end{proof}

%--------------------------------------
\begin{lemma}
\citetbl{
  \citerpg{mallat}{228}{012466606X}
  }
\label{lem:Fphi}
%--------------------------------------
Let $\fphi(x)$ be a function in $\spLLR$ \xref{def:spLLR}.
Let $\Fphi(\omega)$ be the \fncte{Fourier transform}\ifsxrefs{harFour}{def:ft}of $\fphi(x)$.
Let $\Dh(\omega)$ be the \fncte{Discrete time Fourier transform}\ifsxref{dsp}{def:dtft} of a sequence $\seqnZ{\fh_n}$.
\lembox{
  \begin{array}{>{\ds}lc rc>{\ds}lCD}
  {\scy(A)}\quad\fphi(x)=\sum_{n\in\Z} \fh_n \opDil \opTrn^n \fphi(x)\quad{\scy \forall x\in\R} %{\prope{dilation equation in ``time" (A)}}
    &\iff&
    \Fphi\brp{\omega} &=& \cwt \: \Dh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
                        & \forall \omega\in\R
                        & (1)
  \\&\iff&
    \Fphi\brp{\omega} &=& \Fphi\brp{\frac{\omega}{2^\xN}} \prod_{n=1}^\xN \cwt\:\Dh\brp{\frac{\omega}{2^n}}
                        & \forall n\in\Zp,\,\omega\in\R
                        & (2)
  \end{array} 
  }
\end{lemma}
\begin{proof}
\begin{enumerate}
  \item Proof that (A)$\implies$(1): \label{item:Fphi_A1}
    \begin{align*}
      \Fphi\brp{\omega}
        &\eqd \opFT\fphi
      \\&= \opFT\sum_{n\in\Z}\fh_n \opDil \opTrn^n \fphi(x)
        && \text{by (A)}
      \\&= \sum_{n\in\Z}\fh_n \opFT\opDil\opTrn^n \fphi(x)
      \\&= \sum_{n\in\Z}\fh_n \mcom{\cwt e^{-i\frac{\omega}{2} n}\fphi\brp{\frac{\omega}{2}}}{$\opFT\opDil\opTrn^n \fphi(x)$}
        && \text{by \prefp{prop:FTDf}}
      \\&= \cwt \mcom{\brs{\sum_{n\in\Z}\fh_n e^{-i\frac{\omega}{2} n}}}{$\Dh(\omega/2)$} \Fphi\brp{\frac{\omega}{2}}
      \\&= \cwt\:\Dh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
        && \text{by definition of \ope{DTFT} \xref{def:dtft}}
    \end{align*}

  \item Proof that (A)$\impliedby$(1):
    \begin{align*}
      \fphi(x) 
        &= \opFTi\Fphi(\omega)
        && \text{by definition of $\Fphi(\omega)$}
      \\&= \opFTi\cwt\:\Dh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
        && \text{by (1)}
      \\&= \opFTi\cwt\:\sum_{n\in\Z}h_n e^{-i\frac{\omega}{2} n}\: \Fphi\brp{\frac{\omega}{2}}
        && \text{by definition of \ope{DTFT} \xref{def:dtft}}
      \\&= \cwt\:\sum_{n\in\Z}h_n \opFTi e^{-i\frac{\omega}{2} n}\: \Fphi\brp{\frac{\omega}{2}}
        && \text{by property of linear operators}
      \\&= \cwt\:\sum_{n\in\Z}h_n \opFTi \opFT\opDil\opTrn^n\fphi
        && \text{by \prefp{prop:FTDf}}
      \\&= \sum_{n\in\Z}\fh_n \opDil\opTrn^n \fphi(x)
        && \text{by definition of \ope{operator inverse}} && \text{\ifsxref{relation}{def:rel_inverse}}
    \end{align*}

  \item Proof that (1)$\implies$(2):
    \begin{enumerate}
      \item Proof for $\xN=1$ case:
        \begin{align*}
          \brlr{\Fphi\brp{\frac{\omega}{2^\xN}}\:\prod_{n=1}^\xN \cwt \Dh\brp{\frac{\omega}{2^n}}}_{\xN=1}
            &= \cwt\:\Dh\brp{\frac{\omega}{2}}\Fphi\brp{\frac{\omega}{2}}
          \\&= \Fphi(\omega)
            && \text{by (1)}
        \end{align*}

      \item Proof that [$\xN$ case]$\implies$[$\xN+1$ case]:
        \begin{align*}
          \Fphi\brp{\frac{\omega}{2^{\xN+1}}}\:\prod_{n=1}^{\xN+1} \cwt \Dh\brp{\frac{\omega}{2^n}}
            &= \brs{\prod_{n=1}^{\xN} \cwt \Dh\brp{\frac{\omega}{2^n}}}
               \mcom{\cwt \Dh\brp{\frac{\omega}{2^{N+1}}}\Fphi\brp{\frac{\omega}{2^{\xN+1}}}}{$\Fphi(\omega/2^\xN)$}
          \\&= \Fphi(\omega/2^\xN) \prod_{n=1}^{\xN} \cwt \Dh\brp{\frac{\omega}{2^n}}
          \\&= \Fphi(\omega)
            && \text{by [$\xN$ case] hypothesis}
        \end{align*}
    \end{enumerate}

  \item Proof that (1)$\impliedby$(2):
    \begin{align*}
      \Fphi(\omega)
        &= \brlr{\Fphi\brp{\frac{\omega}{2^{\xN}}}\:\prod_{n=1}^{\xN} \cwt \Dh\brp{\frac{\omega}{2^n}}}_{\xN=1}
        && \text{by (2)}
      \\&= \Fphi\brp{\frac{\omega}{2}}\cwt \Dh\brp{\frac{\omega}{2}}
      \\&= \cwt\Dh\brp{\frac{\omega}{2}}\Fphi\brp{\frac{\omega}{2}} 
    \end{align*}

\end{enumerate}
\end{proof}

%--------------------------------------
\begin{lemma}
\label{lem:Fphi_infty}
% 2013 August 09 Friday
% 2013 August 20 Monday: modified \implies relation
%--------------------------------------
Let $\fphi(x)$ be a function in $\spLLR$ \xref{def:spLLR}.
Let $\Fphi(\omega)$ be the \fncte{Fourier transform}\ifsxrefs{harFour}{def:ft}of $\fphi(x)$.
Let $\Dh(\omega)$ be the \fncte{Discrete time Fourier transform}\ifsxref{dsp}{def:dtft} of $\seqn{\fh_n}$.
Let $\ds\prod_{n=1}^\infty x_n \eqd \lim_{\xN\to\infty}\prod_{n=1}^\xN x_n$, with respect to the standard norm in $\spLLR$.

\lembox{
  \begin{array}{>{\ds}l c rc>{\ds}lCD}
    \brb{\begin{array}{M}
      $\Fphi\brp{\omega} = C\prod_{n=1}^\infty \cwt\:\Dh\brp{\frac{\omega}{2^n}}$\\
      $\scy\forall C>0,\,\omega\in\R$\qquad\qquad\scs(A)
    \end{array}}
      &\implies& \fphi(x)          &=& \sum_{n\in\Z} \fh_n \opDil \opTrn^n \fphi(x)
                                     & \forall x\in\R 
                                     & (1) %{\prope{dilation equation in ``time" (A)}}
    \\&\iff&     \Fphi\brp{\omega} &=& \cwt \: \Dh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
                                     & \forall \omega\in\R
                                     & (2)
  \\
      &\iff&     \Fphi\brp{\omega} &=& \Fphi\brp{\frac{\omega}{2^\xN}} \prod_{n=1}^\xN \cwt\:\Dh\brp{\frac{\omega}{2^n}}
                                     & \forall n\in\Zp,\,\omega\in\R
                                     & (3)
  \end{array}
  }
\end{lemma}
\begin{proof}
  \begin{enumerate}
    \item Proof that (1)$\iff$(2)$\iff$(3): by \prefp{lem:Fphi}
    \item Proof that (A)$\implies$(2):
      \begin{align*}
        \Fphi(\omega)
          &= C\:\prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega}{2^n}}
          && \text{by left hypothesis}
        \\&= C\:\cwt \Dh\brp{\frac{\omega}{2}} \prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega}{2^{n+1}}}
        \\&= C\:\cwt \Dh\brp{\frac{\omega}{2}} \prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega/2}{2^{n}}}
        \\&= \cwt \Dh\brp{\frac{\omega}{2}}\brs{C\prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega/2}{2^{n}}}}
        \\&= \cwt \Dh\brp{\frac{\omega}{2}} \Fphi\brp{\frac{\omega}{2}}
          && \text{by left hypothesis}
      \end{align*}
  \end{enumerate}
\end{proof}


%--------------------------------------
\begin{proposition}
\label{prop:Fphi}
%--------------------------------------
Let $\fphi(x)$ be a function in $\spLLR$ \xref{def:spLLR}.
Let $\Fphi(\omega)$ be the \fncte{Fourier transform}\ifsxrefs{harFour}{def:ft}of $\fphi(x)$.
Let $\Dh(\omega)$ be the \fncte{Discrete time Fourier transform}\ifsxref{dsp}{def:dtft} of $\seqn{\fh_n}$.
Let $\ds\prod_{n=1}^\infty x_n \eqd \lim_{\xN\to\infty}\prod_{n=1}^\xN x_n$, with respect to the standard norm in $\spLLR$.
\propbox{
  \brb{\begin{array}{M}
    $\Fphi(\omega)$ is\\
    \prope{continuous}\\ 
    at $\,\omega=0$
  \end{array}}
  \quad\implies\quad
  \brb{\begin{array}{c rc>{\ds}lCD}
        &
    \fphi(x)          &=& \sum_{n\in\Z} \fh_n \opDil \opTrn^n \fphi(x)
                        & \forall x\in\R 
                        & (1) %{\prope{dilation equation in ``time" (A)}}
  \\\iff&
    \Fphi\brp{\omega} &=& \cwt \: \Dh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
                        & \forall \omega\in\R
                        & (2)
  \\\iff&
    \Fphi\brp{\omega} &=& \Fphi\brp{\frac{\omega}{2^\xN}} \prod_{n=1}^\xN \cwt\:\Dh\brp{\frac{\omega}{2^n}}
                        & \forall n\in\Zp,\,\omega\in\R
                        & (3)
  \\\iff&
    \Fphi\brp{\omega} &=& \Fphi\brp{0} \prod_{n=1}^\infty \cwt\:\Dh\brp{\frac{\omega}{2^n}} 
                        & \omega\in\R
                        & (4)
  \end{array}}
  }
\end{proposition}
%\lembox{
%  \brb{\begin{array}{FMCD}
%    (A) & $\ds\fphi(x)=\sum_{n\in\Z} \fh_n \opDil \opTrn^n \fphi(x)$ & \forall x\in\R & and\\ % & {\prope{dilation equation}}\\
%    (B) & \mc{3}{M}{$\Fphi(\omega)$ is \prope{continuous} at $\omega=0$}
%  \end{array}}
%  \implies
%  \brb{\begin{array}{>{\ds}lCD}
%    \Fphi\brp{\omega} = \Fphi\brp{0} \prod_{n=1}^\infty \cwt\:\Dh\brp{\frac{\omega}{2^n}} & \forall \omega\in\R
%  \end{array}} 
%  }
%\end{lemma}
\begin{proof}
  \begin{enumerate}
    \item Proof that (1)$\iff$(2)$\iff$(3): by \prefp{lem:Fphi}
    \item Proof that (3)$\implies$(4):
      \begin{align*}
        \Fphi\brp{0}\:\prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega}{2^n}}
          &= \lim_{\xN\to\infty}\Fphi\brp{\frac{\omega}{2^{\xN}}}\:\prod_{n=1}^{\xN} \cwt \Dh\brp{\frac{\omega}{2^n}}
          && \text{by \prope{continuity} and definition of $\prod_{n=1}^\infty x_n$}
        \\&= \Fphi(\omega)
          && \text{by (3) and \prefp{lem:Fphi}}
      \end{align*}
    \item Proof that (2)$\impliedby$(4): by \prefp{lem:Fphi_infty}
      %\begin{align*}
      %  \Fphi(\omega)
      %    &= \Fphi\brp{0}\:\prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega}{2^n}}
      %    && \text{by (4)}
      %  \\&= \Fphi\brp{0}\:\cwt \Dh\brp{\frac{\omega}{2}} \prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega}{2^{n+1}}}
      %  \\&= \Fphi\brp{0}\:\cwt \Dh\brp{\frac{\omega}{2}} \prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega/2}{2^{n}}}
      %  \\&= \cwt \Dh\brp{\frac{\omega}{2}}\brs{ \Fphi\brp{0}\prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega/2}{2^{n}}}}
      %  \\&= \cwt \Dh\brp{\frac{\omega}{2}} \Fphi\brp{\frac{\omega}{2}}
      %    && \text{by (4)}
      %\end{align*}
  \end{enumerate}
\end{proof}



%\if 0


\pref{def:hn} (next) formally defines the coefficients that appear in \prefpp{thm:dilation_eq}.
%--------------------------------------
\begin{definition}%[subspace coefficients]
\label{def:hn}
\label{def:mrasys}
%--------------------------------------
Let $\MRAspaceLLRV$ be a multiresolution analysis space with scaling function $\fphi$.
Let $\seqxZ{\fh_n}$ be a sequence of coefficients such that $\fphi = \sum_{n\in\Z} \fh_n \opDil\opTrn^n \fphi$.
\defboxp{
  A \structd{multiresolution system} is the tuple $\mrasys$.
  The sequence $\seqxZ{\fh_n}$ is the \fnctd{scaling coefficient sequence}.
  A multiresolution system is also called an \structd{MRA system}.
  An \structe{MRA system} is an \structd{orthonormal MRA system} if $\setnZ{\opTrn^n\fphi}$ is \prope{orthonormal}.
  }
\end{definition}

%Examples of \hi{multiresolution analyses} are provided in
%\pref{ex:wavstrct_haar_sin} (next)
%-- \prefp{ex:sw_gh_bspline}.

%%--------------------------------------
%\begin{definition}
%\label{def:wavstrct_normcoef}
%%--------------------------------------
%Let $\mrasys$ be a {multiresolution system}, and $\opDil$ the dilation operator.
%\defboxp{
%  The \hid{normalization coefficient at resolution $n$} is the quantity 
%  \\\indentx$\norm{\opDil^j\fphi}$.
%  }
%\end{definition}


%--------------------------------------
\begin{theorem}
\label{thm:V0Vn}
%--------------------------------------
Let $\mrasys$ be an \structe{MRA system} \xref{def:mrasys}.\\
Let $\linspan\setA$ be the \structe{linear span} \xref{def:span} of a set $\setA$.
\thmbox{
  \mcom{\linspan\setxZ{\opTrn^n\fphi}=\spV_0}
       {$\setxZ{\opTrn^n\fphi}$ is a \structe{basis} for $\spV_0$}
  \qquad\implies\qquad
  \mcom{\linspan\setxZ{\opDil^j\opTrn^n\fphi}=\spV_j\quad{\scy\forall j\in\Znn}}
       {$\setxZ{\opDil^j\opTrn^n\fphi}$ is a \structe{basis} for $\spV_j$}
  }
\end{theorem}
\begin{proof} Proof is by induction:\citetbl{\citerpg{smith2011}{4}{1420063723}}
\begin{enumerate}
\item induction basis (proof for $j=0$ case):
      %$\setxZ{\opDil^0\opTrn^n\fphi}$ is a basis for $\spV_0$
      %\\\indentx$\ds \spV_0 = \set{\ff(x)}{\ff(x) = \sum_{n\in\Z} \fc_{n} \fphi(x-n)}.$
  \begin{align*}
    \brlr{\linspan\setxZ{\opDil^j\opTrn^n\fphi}}_{j=0}
      &= \linspan\setxZ{\opTrn^n\fphi}
    \\&= \spV_0
      && \text{by left hypothesis}
  \end{align*}

\item induction step (proof that $j$ case $\implies$ $j+1$ case):
      %$\setxZ{\opDil^j\opTrn^n\fphi}$ is a basis for $\spV_j$
      %$\implies$ $\setxZ{\opDil^{j+1}\opTrn^n\fphi}$ is a basis for $\spV_{j+1}$:
  \begin{align*}
    &\linspan\setxZ{\opDil^{j+1}\opTrn^n\fphi}
    \\&= \set{\ff\in\spLLR}{\exists \seqn{\alpha_n} \st \ff(x)=\sum_{n\in\Z}\alpha_n \opDil^{j+1}\opTrn^n\fphi}
      && \text{by definition of $\linspan$} &&\text{\xref{def:span}}
    \\&= \set{\ff\in\spLLR}{\exists \seqn{\alpha_n} \st \ff(x)=\opDil\sum_{n\in\Z}\alpha_n \opDil^{j}\opTrn^n\fphi}
    \\&= \set{\ff\in\spLLR}{\exists \seqn{\alpha_n} \st \opDili\ff(x)=\sum_{n\in\Z}\alpha_n \opDil^{j}\opTrn^n\fphi}
    \\&= \mathrlap{
         \set{\brs{\opDil\ff}\in\spLLR}{\exists \seqn{\alpha_n} \st \opDili\brs{\opDil\ff(x)}=\sum_{n\in\Z}\alpha_n \opDil^{j}\opTrn^n\fphi}
         }
    \\&= \opDil\set{\ff\in\spLLR}{\exists \seqn{\alpha_n} \st \ff(x)=\sum_{n\in\Z}\alpha_n \opDil^{j}\opTrn^n\fphi}
    \\&= \opDil\linspan\setxZ{\opDil^j\opTrn^n\fphi}
      && \text{by definition of $\linspan$} &&\text{\xref{def:span}}
    \\&= \opDil\spV_j
      && \text{by induction hypothesis}
    \\&= \spV_{j+1}
      && \text{by \prope{self-similar} property} &&\text{\xref{def:mra}}
  \end{align*}
\end{enumerate}
\end{proof}

%--------------------------------------
\begin{example}
\label{ex:wavstrct_haar_sin}
\exmx{Haar scaling function}
%--------------------------------------
\exbox{\begin{array}{rclm{54mm}} 
  \mc{4}{M}{In the \hie{Haar} MRA, the scaling function $\fphi(x)$ is the \hie{pulse function}}
  \\
  \fphi(x) &=& \brbl{\begin{array}{lM}
                       1  & for $x\in\intco{0}{1}$ \\
                       0  & otherwise.
                     \end{array}}
  &
  \includegraphics{graphics/pulse.pdf}
  \\
  \mc{4}{M}{In the subspace $\spV_j$ ($j\in\Z$) the scaling functions are}
  \\
  \opDil^j\fphi(x) &=& \brbl{\begin{array}{lM}
                               \brp{2}^{j/2}   & for $x\in\intco{0}{\brp{2^{-j}}}$ \\
                               0                  & otherwise.
                              \end{array}}
  &
  \includegraphics{graphics/pulse2.pdf}%
\end{array}}

The scaling subspace $\spV_0$ is the span $\spV_0\eqd\linspan\setxZ{\opTrn^n\fphi}$.
The scaling subspace $\spV_j$ is the span $\spV_j\eqd\linspan\set{\opDil^j\opTrn^n\fphi}{n\in\Z}$.
  %$\opDil^j\fphi$ such that
Note that $\norm{\opDil^j\opTrn^n\fphi}$ for each resolution $j$ and shift $n$ is unity:
  \begin{align*}
    \norm{\opDil^j\opTrn^n\fphi}^2
      &= \norm{\fphi}^2  
      && \text{by \prope{unitary} properties of $\opTrn$ and $\opDil$} && \text{\xref{thm:TD_unitary}}
   %\\&= \int_{\intco{0}{\brp{2^{-j}}} \abs{\brp{\sqrt{2}}^j}^2 \dx
    \\&= \int_0^1 \abs{1}^2 \dx
      && \text{by definition of $\normn$ on $\spLLR$} && \text{\xref{def:spLLR}}
    %\\&= \brp{2^{-j}\brp{2^j}
    \\&= 1
  \end{align*}

\begin{minipage}{\tw-64mm}
Let $\ff(x)=\sin(\pi x)$.
Suppose we want to project $\ff(x)$ onto the subspaces $\spV_0$, $\spV_1$, $\spV_2$, \ldots.
\end{minipage}%
\hfill\tbox{\includegraphics{graphics/sin_pi_t.pdf}}%
\\
\begin{minipage}{\tw-68mm}
\ragr
The values of the transform coefficients for the subspace $\spV_j$ are %illustrated in \prefp{fig:wavstrct_Haar_sin}
given by
\end{minipage}%
\hfill%
\tbox{%
%\begin{figure}[t]
  %\mbox{}\\%
  %\psset{unit=8mm}%
  %\input{../common/math/graphics/comb_123_pi.tex}%
  \includegraphics{graphics/haar0_sin_t.pdf}%  8mm
  }
\\
  \begin{align*}
    \brs{\opR_j\ff(x)}(n) 
      &=    \frac{1}{\norm{\opDil^j\opTrn^n\fphi}^2}\inprod{\ff(x)}{\opDil^j\opTrn^n\fphi} 
    %\\&=    \frac{1}{\cancelto{1}{\norm{\fphi}^2}}
    %        \inprod{\ff(x)}{\opDil^j\fphi\brp{x-n}}
    %  &&    \text{by definition of $\opTrn$ \xref{def:wav_opT}} 
    \\&=    \frac{1}{\cancelto{1}{\norm{\fphi}^2}}\inprod{\ff(x)}{2^{j/2}\fphi\brp{2^j x-n}} 
      &&    \text{by \prefp{prop:DjTn}}
    \\&=    2^{j/2} \inprod{\ff(x)}{\fphi\brp{2^j x-n}} 
    \\&=    2^{j/2} 
            \int_{2^{-j}n}^{2^{-j}(n+1)} \ff(x) \dx
    \\&=    2^{j/2} 
            \int_{2^{-j}n}^{2^{-j}(n+1)} \sin(\pi x) \dx
    \\&=    2^{j/2}
            \left. \brp{-\frac{1}{\pi}}\cos\brp{\pi x} \right|_{2^{-j} n}^{2^{-j}(n+1)}
    \\&=    \frac{2^{j/2}}{\pi}
            \brs{
              \cos\brp{{2^{-j}n\pi}} -
              \cos\brp{{2^{-j}(n+1)\pi}}  
              }
  \end{align*}



And the projection $\opA_n\ff(x)$ of the function $\ff(x)$ onto the subspace $\spV_j$ is
%(alternatively, the \hie{projection} of $\ff(x)$ \emph{onto} the space $\spV_j$ is) %\\
%\begin{minipage}{\tw-95mm}
  \begin{align*}
    \opA_j\ff(x) 
      &= \sum_{n\in\Z} \inprod{\ff(x)}{\opDil^j\opTrn^n\fphi} \opDil^j\opTrn^n\fphi 
    \\&= \frac{2^{j/2}}{\pi}
         \sum_{n\in\Z}
         \brs{
           \cos\brp{2^{-j}n\pi} -
           \cos\brp{2^{-j}(n+1)\pi}  
           } 2^{j/2}\fphi\brp{2^j x-n}
    \\&= \frac{2^j}{\pi}
         \sum_{n\in\Z}
         \brs{
           \cos\brp{2^{-j} n\pi} -
           \cos\brp{2^{-j}(n+1)\pi}  
           } \fphi\brp{2^j x-n}
  \end{align*}
%\end{minipage}%
%\hfill%
%\begin{minipage}{90mm}%
%  \mbox{}\\%
%  \psset{unit=8mm}%
%  %\input{../common/math/graphics/square_123_pi.tex}
%  \input{../common/wavelets/graphics/haar0_sin_a.tex}
%\end{minipage}

The transforms of $\sin(\pi x)$ into the subspaces $\spV_0$, $\spV_1$, and $\spV_2$,
as well as the approximations in those subspaces are as illustrated in \prefpp{fig:wavstrct_haar_sin}.
\end{example}
\begin{figure}
  \centering%
  \begin{tabular}{|l|l|l|}
    \hline
    \mc{1}{|c|}{subspace}&\mc{1}{c|}{transform}&\mc{1}{c|}{approximation}
    \\\hline\hline
    $\spV_0$
    & \includegraphics{graphics/haar0_sin_t.pdf}
    & \includegraphics{graphics/haar0_sin_a.pdf}
    \\\hline
    $\spV_1$
    & \includegraphics{graphics/haar1_sin_t.pdf}
    & \includegraphics{graphics/haar1_sin_a.pdf}
    \\\hline
    $\spV_2$
    & \includegraphics{graphics/haar2_sin_t.pdf}
    & \includegraphics{graphics/haar2_sin_a.pdf}
    \\\hline
  \end{tabular}
  \caption{
    Projections of $\sin(\pi x)$ on Haar subspaces
    \xref{ex:wavstrct_haar_sin}
    \label{fig:wavstrct_haar_sin}
    }
\end{figure}




%=======================================
\section{Necessary Conditions}
%=======================================
%Next we look at  two necessary conditions in the ``time domain" for scaling coefficient design.
%%They can be used in generating simultaneous equations for wavelet system design.
%\\\indentx
%  \begin{tabular}{@{\qquad}clll}
%    \imark & \hie{admissibility condition}: & \pref{thm:admiss}        & \xref{thm:admiss} \\
%    \imark & \hie{quadrature condition}:    & \pref{thm:wav_quadcon}   & \xref{thm:wav_quadcon}
%  \end{tabular}

%--------------------------------------
\begin{theorem}[\thmd{admissibility condition}]
\label{thm:admiss}
%--------------------------------------
%Let $\mrasys$ be a multiresolution system.
Let $\Zh(z)$ be the \fncte{Z-transform} \xref{def:opZ} and 
$\Dh(\omega)$ the \fncte{discrete-time Fourier transform} \xref{def:dtft} of a sequence $\seqxZ{\fh_n}$.
\thmbox{\begin{array}{M}
  %\brb{\begin{array}{M}$\mrasys$\\is an \structe{MRA system}\end{array}} &\impnotimpby&
  $\brb{\text{$\mrasys$ is an \structe{MRA system} \xref{def:mrasys}}}$
  \\$\ds\quad
  \impnotimpby \mcom{\brb{\sum_{n\in\Z} \fh_n  = \sqrt{2}}}{(1) \prope{admissibility} in ``time"}               
  \iff         \mcom{\brb{\Zh(z)\Big|_{z=1}   = \sqrt{2}}}{(2) \prope{admissibility} in ``z domain"}                  
  \iff         \mcom{\brb{\Dh(\omega)\Big|_{\omega=0} = \sqrt{2}}}{(3) \prope{admissibility} in ``frequency"}
  $
\end{array}}
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Proof that MRA system $\implies$ (1):
    \begin{align*}
      \sum_{n\in\Z}\fh_n
        &= \frac{\int_\R \fphi(x) \dx}{\int_\R \fphi(x) \dx} \sum_{n\in\Z}\fh_n
      \\&= \frac{1}{\int_\R \fphi(x) \dx} \int_\R \sum_{n\in\Z}\fh_n \fphi(x) \dx
      \\&= \frac{1}{\int_\R \fphi(x) \dx} \int_\R \sum_{n\in\Z}\fh_n \frac{\sqrt{2}}{\sqrt{2}}\fphi(2y-n) 2\dy
        && \text{let $y\eqd \frac{x+n}{2}\implies x=2y-n \implies \dx=2\dy$}
      \\&= \frac{2}{\sqrt{2}}\frac{1}{\int_\R \fphi(x) \dx} \int_\R \sum_{n\in\Z}\fh_n \opDil\opTrn^n\fphi(y)\dy
        && \text{by definitions of $\opTrn$ and $\opDil$ \xref{def:opT}}
      \\&= \sqrt{2} \frac{1}{\int_\R \fphi(x) \dx} \int_\R \fphi(y) \dy
        && \text{by \thme{dilation equation} \xref{thm:dilation_eq}}
      \\&= \sqrt{2}
    \end{align*}

  \item Alternate proof that MRA system $\implies$ (1):\\
    %Select a vector $\ff$ such that $\inprod{\fphi}{\ff}\ne 0$.
    Let $\ff(x)\eqd 1\quad\forall x\in\R$. % be a constant vector (e.g. $\ff(x)=1$). Then \ldots
    \begin{align*}
      \inprod{\fphi}{\ff}
        &= \inprod{\sum_{n\in\Z}\fh_n \opDil\opTrn^n \fphi}{\ff}
        && \text{by \thme{dilation equation}} && \text{\xref{thm:dilation_eq}}
      \\&= \sum_{n\in\Z}\fh_n \inprod{\opDil\opTrn^n \fphi}{\ff}
        && \text{by \prop{linearity} of $\inprodn$} && \text{\ifxref{vsinprod}{def:inprod}}
      \\&= \sum_{n\in\Z}\fh_n \inprod{ \fphi}{(\opDil\opTrn^n)^\ast\ff}
        && \text{by definition of operator adjoint} && \text{\ifxref{operator}{thm:op_star}}
      \\&= \sum_{n\in\Z}\fh_n \inprod{ \fphi}{(\opTrna)^n \opDila \ff}
        && \text{by property of operator adjoint} && \text{\ifxref{operator}{thm:op_star}}
      \\&= \sum_{n\in\Z}\fh_n \inprod{ \fphi}{(\opTrni)^n \opDili \ff}
        && \text{by unitary property of $\opTrn$ and $\opDil$} && \text{\xref{prop:TD_unitary}}
      \\&= \sum_{n\in\Z}\fh_n \inprod{ \fphi}{(\opTrni)^n \cwt  \ff}
        && \text{because $\ff$ is a constant hypothesis} &&\text{and by \prefp{prop:opDi}}
      \\&= \sum_{n\in\Z}\fh_n \inprod{ \fphi}{ \cwt \ff}
        && \text{by $\ff(x)=1$ definition}
      \\&= \sum_{n\in\Z}\fh_n \cwt \inprod{ \fphi}{ \ff}
        && \text{by property of $\inprodn$} && \text{\ifxref{vsinprod}{def:inprod}}
      \\&= \cwt \; \inprod{\fphi}{\ff}\; \sum_{n\in\Z}\fh_n
      \\&\implies \sum_{n\in\Z}\fh_n = \sqrt{2}
    \end{align*}

  \item Proof that (1) $\iff$ (2) $\iff$ (3): by \prefp{prop:tzf}.

  \item Proof for $\notimpliedby$ part: by \prefp{cnt:admiss}.
\end{enumerate}
\end{proof}

%--------------------------------------
\begin{counterex}
\label{cnt:admiss}
%--------------------------------------
Let $\mrasys$ be an \structe{MRA system} \xref{def:mrasys}.
\cntbox{\begin{array}{M}
  $\brb{\begin{array}{lm{28mm}}
     \seqn{\fh_n} \eqd \sqrt{2}\kdelta_{n-1} \eqd
       \brbl{\begin{array}{lD}
         \sqrt{2}     & for $n=1$  \\
         0            & otherwise.
       \end{array}}
    &\includegraphics{graphics/hn1.pdf}%
  \end{array}}
  \quad\implies\quad
  \brb{\fphi(x)=0}$
  \\
  which means
  \\
  $\ds\brb{\sum_{n\in\Z}\fh_n = \sqrt{2}} \quad\notimplies\quad \brb{\text{$\mrasys$ is an MRA system for $\spLLR$.}}$
\end{array}}
\end{counterex}
\begin{proof}
\begin{align*}
  \fphi(x)
    &= \sum_{n\in\Z}\fh_n \opDil\opTrn^n\fphi(x)
    && \text{by \thme{dilation equation}} &&\text{\xref{thm:dilation_eq}}
  \\&= \sum_{n\in\Z}\fh_n \fphi(2x-n)
    && \text{by definitions of $\opDil$ and $\opTrn$} &&\text{\xref{def:opT}}
  \\&= \sum_{n\in\Z} \mcom{\sqrt{2}\kdelta_{n-1}}{$\seqn{\fh_n}$} \fphi(2x-n)
    && \text{by definitions of $\seqn{\fh_n}$}
  \\&= \sqrt{2}\fphi(2x-1)
    && \text{by definition of $\fphi(x)$}
  \\\implies
  \fphi(x) &= 0
\end{align*}
This implies $\fphi(x)=0$, which implies that $\mrasys$ is \emph{not} an \structe{MRA system} for $\spLLR$ because
  \\\indentx$\ds \clsp{\Setu_{j\in\Z} \spV_j} = \clsp{\Setu_{j\in\Z} \linspan\set{\opDil^j\opTrn^n\fphi}{\scy n\in\Z}} \neq \spLLR$\\
(the \structe{least upper bound} is \emph{not} $\spLLR$).
\end{proof}




%--------------------------------------
\begin{theorem}[\thmd{Quadrature condition} in ``time"]
\label{thm:wav_quadcon}
\label{thm:wav_hh}
%--------------------------------------
Let $\mrasys$ be an \structe{MRA system} \xref{def:mrasys}.
\thmbox{
  \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fh_k^\ast \inprod{\fphi}{\opTrn^{2n-m+k} \fphi}
  =\inprod{\fphi}{\opTrn^n \fphi}
  \qquad\scy\forall n\in\Z
  }
\end{theorem}
\begin{proof}
\begin{align*}
  \inprod{\fphi}{\opTrn^n \fphi}
    &= \inprod{\sum_{m\in\Z}\fh_m \opDil \opTrn^m \fphi }{\opTrn^n \sum_{k\in\Z}\fh_k \opDil \opTrn^k \fphi}
    && \text{by \thme{dilation equation}} && \text{\xref{thm:dilation_eq}}
  \\&= \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fh_k^\ast \inprod{\opDil \opTrn^m \fphi }{\opTrn^n \opDil \opTrn^k \fphi}
    && \text{by properties of $\inprodn$} && \text{\ifxref{vsinprod}{def:inprod}}
  \\&= \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fh_k^\ast \inprod{\fphi }{\left(\opDil \opTrn^m \right)^\ast \opTrn^n \opDil \opTrn^k \fphi}
    && \text{by definition of operator adjoint} && \text{\ifxref{operator}{prop:op_adjoint}}
  \\&= \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fh_k^\ast \inprod{\fphi }{\left(\opDil \opTrn^m \right)^\ast \opDil \opTrn^{2n} \opTrn^k \fphi}
    && \text{by \prefp{prop:DTTD}}
  \\&= \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fh_k^\ast \inprod{\fphi }{\opTrna^m \opDila \opDil \opTrn^{2n} \opTrn^k \fphi}
    && \text{by operator star-algebra properties} && \text{\ifxref{operator}{thm:op_star}}
  \\&= \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fh_k^\ast \inprod{\fphi }{\opTrn^{-m} \opDil^{-1} \opDil \opTrn^{2n} \opTrn^k \fphi}
    && \text{by \prefp{prop:TD_unitary}}
  \\&= \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fh_k^\ast \inprod{\fphi }{\opTrn^{2n-m+k} \fphi}
\end{align*}
\end{proof}

%%---------------------------------------
%\begin{theorem}[Neumann Expansion Theorem]
%\index{Neumann Expansion Theorem}
%\thmx{Neumann Expansion Theorem}
%\label{thm:op_net2}
%\citep{michel1993}{415}
%%---------------------------------------
%Let $\opA\in\clFxx$ be an operator on a linear space $\spX$.
%Let $\opA^0\eqd \opI$.
%\thmbox{\begin{array}{ll}
%  \left.\begin{array}{lrclD}
%    1. & \opA          &\in& \oppB(\spX,\spX) & ($\opA$ is bounded) \\
%    2. & \normop{\opA} &<&   1
%  \end{array}\right\}
%  \implies
%  \left\{\begin{array}{lrc>{\ds}l}
%    1. & (\opI-\opA)^{-1} &&\text{ exists} \\
%    2. & \normop{(\opI-\opA)^{-1}} &\le& \frac{1}{1-\normop{\opA}} \\
%    3. & (\opI-\opA)^{-1} &=& \sum_{n=0}^\infty \opA^\xN  \\
%       & \mc{3}{c}{\text{ with uniform convergence}}
%  \end{array}\right.
%\end{array}}
%\end{theorem}
%
%
%
%
%
%
%
%%--------------------------------------
%\begin{theorem}
%\label{thm:wav_net}
%\thmx{$\sum_{n\in\Z} \abs{\fh_n} \ge 1$}
%%--------------------------------------
%Let $\wavsys$ be a \hi{wavelet system}.
%\thmbox{
%  \sum_{n\in\Z} \abs{\fh_n} \ge 1
%  }
%\end{theorem}
%\begin{proof}
%\begin{align*}
%  &&
%  \fphi &= \sum_{n\in\Z}\fh_n \opTrn^n \opDil \fphi
%  \\\implies&&
%  \left(\opI - \sum_{n\in\Z}\fh_n \opTrn^n \opDil \right)\fphi &= \vzero
%  \\\implies&&
%  \left(\opI - \sum_{n\in\Z}\fh_n \opTrn^n \opDil \right)^{-1} & \text{must not exist}
%  \\\implies&&
%  \normop{\sum_{n\in\Z}\fh_n \opTrn^n \opDil} & \ge 1
%    && \text{by Neumann Expansion Theorem \xref{thm:op_net2}}
%  \\\implies&&
%  1
%      &\le \normop{\sum_{n\in\Z}\fh_n \opTrn^n \opDil}
%     &&    %\text{by Neumann Expansion Theorem \xref{thm:op_net2}}
%  \\&&&\le \sum_{n\in\Z}  \normop{\fh_n \opTrn^n \opDil}
%     &&    \text{by generalized triangle inequality \ifdochas{vsnorm}{\xref{thm:norm_tri}}}
%  \\&&&=   \sum_{n\in\Z}  \abs{\fh_n}\; \cancelto{1}{\normop{ \opTrn^n \opDil}}
%     &&    \text{by homogeneous property of norm \ifdochas{vsnorm}{\xref{def:norm}}}
%  \\&&&=   \sum_{n\in\Z}  \abs{\fh_n}
%     &&    \ifdochas{operator}{\text{by \prefp{prop:op_unitary_UV} and \prefp{thm:unitary_prop}}}
%\end{align*}
%\end{proof}




\pref{thm:gen_quadcon} (next) presents the \structe{quadrature necessary conditions} of a \structe{wavelet system}.
These relations simplify dramatically in the special case of an
\structe{orthonormal wavelet system} \xref{thm:oquadcon}.
%--------------------------------------
\begin{theorem}[\thmd{Quadrature condition} in ``frequency"]
\citetbl{
  \citerp{chui}{135},
  \citerp{goswami}{110}
  }
\label{thm:Sphi}
%--------------------------------------
Let $\mrasys$ be an \structe{MRA system} \xref{def:mrasys}.
Let $\Fx(\omega)$ be the \fncte{discrete time Fourier transform}\ifsxrefs{dsp}{def:dtft}for a sequence $\seqxZ{x_n}$ in $\spllR$.
Let $\Swphi(\omega)$ be the \fncte{auto-power spectrum} \xref{def:Swfg} of $\fphi$.
\thmbox{\begin{array}{>{\ds}lc>{\ds}l}
   \abs{\Dh\left(\omega     \right)}^2 \rnode[b]{noteSphi1}{\Sphi}(\omega) + \abs{\Dh\brp{\omega+\pi }}^2 \rnode[b]{noteSphi2}{\Sphi}(\omega+\pi) &=& 2\rnode[b]{noteSphi3}{\Sphi}(2\omega)
\end{array}}
\hfill
\rnode[bl]{noteSphi}{\footnotesize$\brp{\begin{array}{N}
  Note: $\Sphi(\omega)=1$\\% $\iff$ $\setxZ{\opTrn^n\fphi}$\\
  for \prope{orthonormal} MRA\\
  \xref{lem:oms_quadcon}
\end{array}}$}
\ncarc[arcangle=30,linewidth=0.5pt,linecolor=red,linestyle=dashed]{->}{noteSphi}{noteSphi1}
\ncarc[arcangle=30,linewidth=0.5pt,linecolor=red,linestyle=dashed]{->}{noteSphi}{noteSphi2}
\ncarc[arcangle=30,linewidth=0.5pt,linecolor=red,linestyle=dashed]{->}{noteSphi}{noteSphi3}
\end{theorem}
\begin{proof}
%\begin{enumerate}
%  \item First note that $\Dh(\omega)$ and $\Dg(\omega)$ are periodic with period $2\pi$ such that\ifsxrefs{dsp}{prop:dtft_2pi} 
%  \label{item:qc1}
%    \\\indentx$\begin{array}{rclC}
%         \Dh(\omega+2\pi n) &=& \Dh(\omega) & \forall n\in\Z   \\
%         \Dg(\omega+2\pi n) &=& \Dg(\omega) & \forall n\in\Z   
%       \end{array}$
%
%\item Proof for theorem statement:
\begin{align*}
   &2\Sphi(2\omega)
   \\&= 2\brp{2\pi}\sum_{n\in\Z} \left|\Fphi(2\omega+2\pi n)\right|^2
     && \text{by \prefp{thm:Swfg}}
   \\&= 2\brp{2\pi}\sum_{n\in\Z} \left|\cwt \Dh\left(\frac{2\omega+2\pi n}{2}\right)\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2
     && \text{by \prefp{lem:Fphi}}
   \\&= \mathrlap{
          {2\pi}\sum_{n\in\Ze} \left|\Dh\left(\frac{2\omega+2\pi n}{2}\right)\right|^2\left|\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2 +
          {2\pi}\sum_{n\in\Zo} \left|\Dh\left(\frac{2\omega+2\pi n}{2}\right)\right|^2\left|\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2
          }
   \\&= \mathrlap{
          2\pi\sum_{n\in\Z} \left|\Dh\left(\omega+2\pi n\right)\right|^2\left|\Fphi\left(\omega+2\pi n\right)\right|^2 +
          2\pi\sum_{n\in\Z} \left|\Dh\left(\omega+2\pi n+\pi \right)\right|^2\left|\Fphi\left(\omega+2\pi n+ \pi \right)\right|^2
          }
   \\&= 2\pi\sum_{n\in\Z} \left|\Dh\left(\omega\right)\right|^2\left|\Fphi\left(\omega+2\pi n\right)\right|^2 +
        2\pi\sum_{n\in\Z} \left|\Dh\left(\omega+\pi \right)\right|^2\left|\Fphi\left(\omega+2\pi n+ \pi \right)\right|^2
     && \text{by \prefp{prop:dtft_2pi}}
        %\indentx\text{by (\prefp{item:qc1})}
   \\&= \left|\Dh\left(\omega     \right)\right|^2 \brp{2\pi\sum_{n\in\Z} \left|\Fphi\left(\omega    +2\pi n\right)\right|^2} +
        \left|\Dh\left(\omega+\pi \right)\right|^2 \brp{2\pi\sum_{n\in\Z} \left|\Fphi\left(\omega+\pi+2\pi n\right)\right|^2}
   \\&= \left|\Dh\left(\omega     \right)\right|^2 \Sphi(\omega) +
        \left|\Dh\left(\omega+\pi \right)\right|^2 \Sphi(\omega+\pi)
     && \text{by \prefp{thm:Swfg}}
\end{align*}

%\end{enumerate}
\end{proof}


%=======================================
\section{Sufficient conditions}
%=======================================
\pref{thm:mra_rdc} (next) gives a set of \emph{sufficient} conditions on the \fncte{scaling function} \xref{def:mra} 
$\fphi$ to generate an \structe{MRA}.
\ifdochas{ortho}{\prefpp{thm:h_ns} provides a set of sufficient conditions on the \fncte{scaling coefficients} \xref{def:hn} $\seqnZ{\fh_n}$ 
to generate an \structe{MRA}; howbeit, this set results in the more restrictive \prope{orthonormal} MRA.}
%---------------------------------------
\begin{theorem}
\citetbl{
  \citerpgc{wojtaszczyk1997}{28}{0521578949}{Theorem 2.13},
  \citerpgc{pinsky2002}{313}{0534376606}{Theorem 6.4.27}
  }
\label{thm:mra_rdc}
\label{thm:mra_sufficient_phi}
%--------------------------------------
%Let an \structe{MRA} be defined as in \prefp{def:mra}.
%Let a \structe{Riesz sequence} be defined as in \prefp{def:rieszseq}.
Let $\spV_j\eqd\linspan\setxZ{\opTrn\fphi(x)}$ \xref{def:span}.
\thmbox{
  \brb{\begin{array}{FMD}
    (1). & $\seqn{\opTrn^n\fphi}$ is a \structe{Riesz sequence} \xref{def:rieszseq}    & and \\
    (2). & $\ds\exists \seqn{\fh_n} \st \fphi(x)=\sum_{n\in\Z}h_n\opDil\opTrn^n\fphi(x)$ & and \\
    (3). & $\Fphi(\omega)$ is \prope{continuous} at $0$                                & and \\
    (4). & $\Fphi(0)\neq0$
  \end{array}}
  \implies
  \brb{\begin{array}{N}
    $\seqjZ{\spV_j}$ is an \structe{MRA}\\
    \xref{def:mra}
  \end{array}}
  }
\end{theorem}
\begin{proof}
For this to be true, each of the conditions in the definition of an \structe{MRA} \xref{def:mra} must be satisfied:
\begin{enumerate}
  \item Proof that each $\spV_j$ is \prope{closed}: by definition of $\linspan$

  \item Proof that $\seqn{\spV_j}$ is \prope{linearly ordered}: 
    \begin{align*}
      \spV_j\subseteq\spV_{j+1}
        &\iff \linspan\setn{\opDil^j\opTrn^n\fphi}\subseteq\linspan\setn{\opDil^{j+1}\opTrn^n\fphi}
        &\iff (2)
    \end{align*}

  \item Proof that $\ds\Setu_{j\in\Z}\spV_j$ is \prope{dense} in $\spLLR$: by \prefp{prop:mra_UVj}
  
  \item Proof of \prope{self-similar} property:
    \begin{align*}
      \brb{\ff\in\spV_j\iff\opDil\ff\in\spV_{j+1}}
        &\iff \ff\in\linspan\setn{\opTrn^n\fphi}\iff\opDil\ff\in\linspan\setn{\opDil\opTrn^n\fphi}
        &\iff (2)
    \end{align*}

  \item Proof for \structe{Riesz basis}: by (1) and \prefp{prop:mra_UVj}.
\end{enumerate}
\end{proof}

%=======================================
\section{Support size}
%=======================================
The \hie{support} of a function is what it's non-zero part ``sits" on.
If the support of the scaling coefficients $\seqn{\fh_n}$ goes from say
$[0,3]$ in $\Z$, what is the support of the scaling function $\fphi(x)$?
The answer is $[0,3]$ in $\R$---essentially the same
as the support of $\seqn{\fh_n}$ except that the two functions have different
domains ($\Z$ versus $\R$).
This concept is defined in \pref{def:support} (next definition),
and proven in \pref{thm:mra_support} (next theorem).
%and illustrated in \prefpp{sec:examples_pounity}\ifdochas{compactp}{ and \prefpp{sec:examples_Dp}}.
%\pref{ex:sw_gh_d2} -- \pref{ex:sw_gh_bspline} (\prefpo{ex:sw_gh_d2} -- \prefpo{ex:sw_gh_bspline}).

%--------------------------------------
\begin{definition}
\index{support}
\label{def:support}
%--------------------------------------
Let $\mrasys$ be an \structe{MRA system} \xref{def:mrasys}.
Let $\cls{\setX}$ represent the \ope{closure} of a set $\setX$ in $\spLLR$, 
$\hxs{\join}\setX$ the \vale{least upper bound} of an \structe{ordered set} $\opair{\setX}{\orel}$,
$\hxs{\meet}\setX$ the \vale{greatest lower bound} of $\opair{\setX}{\orel}$,
and
\\\indentx$\begin{array}{lclCD}
  \hxs{\floor{x}} &\eqd& \joinop\set{n\in\Z}{n\le x} & \forall x\in\R & (\vale{floor} of $x$)\\
  \hxs{\ceil{x}}  &\eqd& \meetop\set{n\in\Z}{n\ge x} & \forall x\in\R & (\vale{ceiling} of $x$).
\end{array}$
\defboxt{
  The set $\support\ff$ of a function $\ff\in\clFxy$ is the \structd{support} of $\ff$ if
  \\\indentx$\ds
    \support\ff \eqd
    \brbl{\begin{array}{>{\ds}lMDD}
      \cls{\set{x\in\R}{\ff(x)\ne 0}}
        & for $\setX=\R$ 
        & (domain of $\ff$ is $\R$)
        & and
      \\
      \cls{\set{x\in\R}{\ff\brp{\floor{x}}\ne0 \text{ and } \ff\brp{\ceil{x}}\ne0}}
        & for $\setX=\Z$
        & (domain of $\ff$ is $\Z$)
        & .
    \end{array}}
  $
  }
\end{definition}

%--------------------------------------
\begin{theorem}[\thmd{support size}]
\citetbl{
  \citerppg{mallat}{243}{244}{012466606X}
  }
\label{thm:mra_support}
\thmx{support size}
%--------------------------------------
Let $\mrasys$ be an \structe{MRA system} \xref{def:mrasys}.\\
Let $\support\ff$ be the support of a function $\ff$ \xref{def:support}.
\thmbox{
  %\begin{array}{>{\ds}rc>{\ds}l}
  \support\fphi = \support\fh
  %\\
  %\xN\in\Zo \text{ and } \fg_n  = \pm(-1)^\xN\fh(\xN-n) \quad\implies\quad
  %\support\fpsi &=& \left[ \frac{\xN-(n_2-n_1)}{2}, \frac{\xN+(n_2-n_1)}{2} \right]
  %\end{array}$
  }
\end{theorem}
\begin{proof}
\begin{enumerate}

  \item Definitions:\quad \label{item:mra_support_def}
    $\begin{array}[t]{rcl}
      \support\fphi &\eqd& [a,b] \\
      \support\fh   &\eqd& [k,m].
     \end{array}$

  \item lemma:\quad \label{ilem:mra_support_lemma}
    $\support\fphi(x)=\brs{a,b} \quad\iff\quad \support\fphi(2x)=\brs{\frac{a}{2},\frac{b}{2}}$

  \item lemma:\quad \label{ilem:mra_support_mpy}
    $\support\brs{\lambda\fphi(x)}=\support\brs{\fphi(x)}\quad\forall\lambda\in\R\setd0$

  \item Proof that $k=a$:
    \begin{align*}
      a
        &= \meetop\support\fphi(x)
        && \text{by definition of $a$} && \text{\xref{item:mra_support_def}}
      \\&\eqd \meetop\support \brs{ \sum_{n\in\Z}\fh_n \opDil\opTrn^n\fphi(x) }
        && \text{by \thme{dilation equation}} && \text{\xref{thm:dilation_eq}}
      \\&= \meetop\support \brs{\sqrt{2}\sum_{n\in\Z} \fh_n \fphi(2x-n)}
        && \text{by definition of $\opTrn$ and $\opDil$} && \text{\xref{def:opTD}}
      \\&= \meetop\support \brs{\sum_{n\in\Z} \fh_n \fphi(2x-n)}
        && \text{by \pref{ilem:mra_support_mpy}}
      \\&= \meetop\support \brs{\fh_{k} \fphi\brp{2x-k}}
        && \mathrlap{\text{because $n={k}$ is the \vale{least value} of $n$ for which $\fh_n\neq0$}}
      \\&= \meetop\support \brs{\fphi\brp{2x-k}}
        && \text{by \pref{ilem:mra_support_mpy}}
        && \text{\mbox{}\hspace{45mm}\mbox{}}
      \\&= \meetop\support \brs{\fphi\brp{2\brs{x-\frac{k}{2}}}}
      \\&= \meetop\set{t}{\fphi\brp{2\brs{x-\frac{k}{2}}}\neq0}
        && \text{by definition of $\support$} && \text{\xref{def:support}}
      \\&= x \st  x-\frac{k}{2} = \frac{a}{2}
        && \text{by \pref{ilem:mra_support_lemma}}
      \\&= \frac{k}{2} + \frac{a}{2}
      \\&\implies &\qquad\frac{k}{2} = a - \frac{a}{2}
      \\&\iff &\qquad k = a
    \end{align*}

  \item Proof that $m=b$:
    \begin{align*}
      b
        &= \joinop\support\fphi(x)
        && \text{by definition of $b$} && \text{\xref{item:mra_support_def}}
      \\&\eqd \joinop\support \brs{ \sum_{n\in\Z}\fh_n \opDil\opTrn^n\fphi(x) }
        && \text{by \thme{dilation equation}} && \text{\xref{thm:dilation_eq}}
      \\&= \joinop\support \brs{\sqrt{2}\sum_{n\in\Z} \fh_n \fphi(2x-n)}
        && \text{by definition of $\opTrn$ and $\opDil$} && \text{\xref{def:opTD}}
      \\&= \joinop\support \brs{\sum_{n\in\Z} \fh_n \fphi(2x-n)}
        && \text{by \pref{ilem:mra_support_mpy}}
      \\&= \joinop\support \brs{\fh_{m} \fphi\brp{2x-m}}
        && \mathrlap{\text{because $n={m}$ is the \vale{greatest value} of $n$ for which $\fh_n\neq0$}}
      \\&= \joinop\support \brs{\fphi\brp{2x-m}}
        && \text{by \pref{ilem:mra_support_mpy}}
      \\&= \joinop\support \brs{\fphi\brp{2\brs{x-\frac{m}{2}}}}
      \\&= \joinop\set{t}{\fphi\brp{2\brs{x-\frac{m}{2}}}\neq0}
        && \text{by definition of $\support$} && \text{\xref{def:support}}
      \\&= x \st  x-\frac{m}{2} = \frac{b}{2}
        && \text{by \pref{ilem:mra_support_lemma}}
      \\&= \frac{m}{2} + \frac{b}{2}
      \\&\implies \qquad\frac{m}{2} = b - \frac{b}{2}
      \\&\iff \qquad m = b
    \end{align*}

\end{enumerate}
\end{proof}

%--------------------------------------
\begin{example}
%--------------------------------------
\exbox{\begin{array}{NNN}
    \includegraphics{graphics/n1_h.pdf}
   &\includegraphics{graphics/n2_h.pdf}
   %&\includegraphics{graphics/d2_phi_h.pdf}
   &\includegraphics{graphics/d3_phi_h.pdf}
  \\\fncte{B-spline $\fN_1(x)$}
   &\fncte{B-spline $\fN_2(x)$}
   %&\fncte{Daubechies-2 scaling function}
   &\fncte{Daubechies-3 scaling function}
  \\\xref{ex:bspline_N1}&\xref{ex:bspline_N2}&\xref{ex:dau-p3}
\end{array}}
\end{example}

















%20171226%%=======================================
%20171226%\section{Wavelet analysis}
%20171226%%=======================================
%20171226%%=======================================
%20171226%\subsection{Definition}
%20171226%%=======================================
%20171226%The term ``wavelet" comes from the French word ``\hie{ondelette}", meaning ``small wave". 
%20171226%And in essence, wavelets are ``small waves" (as opposed to the ``long waves" of Fourier analysis) 
%20171226%that form a basis for the Hilbert space $\spLLR$.\citetbl{
%20171226%  \citerpg{strang1996}{ix}{0961408871},
%20171226%  \citerpg{atkinson2009}{191}{1441904581}
%20171226%  }
%20171226%%---------------------------------------
%20171226%\begin{definition}
%20171226%\citetbl{
%20171226%  \citerpgc{wojtaszczyk1997}{17}{0521578949}{Definition 2.1}
%20171226%  }
%20171226%\label{def:wavelet}
%20171226%\label{def:seqWn}
%20171226%\label{def:wavstrct_psi}
%20171226%%---------------------------------------
%20171226%%Let $\MRAspaceLLRV$ be an \structe{multiresolution space} \xref{def:mra}.
%20171226%Let $\opTrn$ and $\opDil$ be as defined in \prefp{def:opT}.
%20171226%\defboxp{
%20171226%  A function $\fpsi(x)$ in $\spLLR$ is a \fnctd{wavelet function} for $\spLLR$ if
%20171226%  \\\indentx$\set{\opDil^j\opTrn^n\fpsi}{\scy j,n\in\Z}$ is a \structe{Riesz basis} for $\spLLR$.\\
%20171226%  In this case, $\fpsi$ is also called the \fnctd{mother wavelet} of the basis $\set{\opDil^j\opTrn^n\fpsi}{\scy j,n\in\Z}$.
%20171226%  The sequence of subspaces $\seqjZ{\spW_j}$ is the \structd{wavelet analysis} induced by $\fpsi$, 
%20171226%  where each subspace $\spW_j$ is defined as
%20171226%  \\\indentx$\spW_j\eqd\linspan\setnZ{\opDil^j\opTrn^n\fpsi}$ .
%20171226%  }
%20171226%\end{definition}
%20171226%
%20171226%%---------------------------------------
%20171226%%\begin{definition}
%20171226%%---------------------------------------
%20171226%%Let $\MRAspaceLLRV$ be an \structe{multiresolution space} \xref{def:mra}.
%20171226%%Let the operation $\adds$ represent \hie{Minkowski addition} on $\spLLR$\ifsxref{subspace}{def:sub_add}.%
%20171226%%\defboxt{
%20171226%%  %The \hid{wavelet subspace} $\spW_j$ is the orthogonal complement of $\spV_j$ in $\spV_{j+1}$ such that
%20171226%%  %  \\\indentx$\spV_j \adds \spW_j = \spV_{j+1}$
%20171226%%  %  \\
%20171226%%  The sequence $\seqjZ{\spW_j}$ is a \hid{wavelet analysis} on $\MRAspaceLLRV$ if
%20171226%%  \\\indentx$\begin{array}{FMCD}
%20171226%%    1. & $\spV_{j+1} = \mcom{\spV_j \adds \spW_j}{\hi{Minkowski addition}}$
%20171226%%       & \forall \spW_j \in \seqxZ{\spW_j}\text{ and }\spV_j\in\seqjZ{\spV_j}
%20171226%%       & and
%20171226%%     %\qquad\text{\scriptsize ($\spW_j$ is the complement of $\spV_j$ in $\spV_{j+1}$)}
%20171226%%    \\
%20171226%%    2. & \mc{2}{M}{There exists $\fpsi\in\spLLR$ such that $\seqxZ{\opTrn^n\fpsi}$ is a \structe{Riesz basis} for $\spW_0$.}
%20171226%%  \end{array}$
%20171226%%  }
%20171226%%\end{definition}
%20171226%
%20171226%%%---------------------------------------
%20171226%%\begin{proposition}[complemented subspaces]
%20171226%%%---------------------------------------
%20171226%%Let $\MRAspaceLLRV$ be an \structe{MRA space}.
%20171226%%Let $\spV_j^\orthog$ be the \structe{orthogonal complement} \xref{def:sub_ocomp} of $\spV_j$.
%20171226%%\propbox{
%20171226%%  \spV_j^{\orthog\orthog}=\spV_j \qquad\scy\forall n\in\Z \qquad\scs\text{\prope{involutory}}
%20171226%%  }
%20171226%%\end{proposition}
%20171226%%\begin{proof}
%20171226%%\begin{enume}
%20171226%%  \item By \pref{def:mra}, $\spV_j$ is \prope{closed} in $\spLLR$ ($\spV_j=\cls\spV_j$).
%20171226%%  \item By \prefpp{thm:inprod_orthog}, $\spV_j^{\orthog\orthog}=\spV_j$.
%20171226%%\end{enume}
%20171226%%\end{proof}
%20171226%
%20171226%A \structe{wavelet analysis} $\seqn{\spW_j}$ is often constructed from a \structe{multiresolution anaysis} \xref{def:mra}
%20171226%$\seqn{\spV_j}$ under the relationship
%20171226%\\\indentx$\ds\spV_{j+1} = \spV_j \adds \spW_j$,\qquad where $\adds$ is subspace addition (\ope{Minkowski addition}).\\
%20171226%By this relationship alone, $\seqn{\spW_j}$ is in no way uniquely defined 
%20171226%in terms of a multiresolution analysis $\seqn{\spV_j}$.
%20171226%In general there are many possible complements of a subspace $\spV_j$.
%20171226%To uniquely define such a wavelet subspace, one or more additional constraints are required.
%20171226%One of the most common additional constraints is \hie{orthogonality}, such that
%20171226%$\spV_j$ and $\spW_j$ are orthogonal to each other\ifdochas{ortho}{ (see \prefp{chp:ortho})}.
%20171226%
%20171226%
%20171226%
%20171226%
%20171226%%=======================================
%20171226%\subsection{Dilation equation}
%20171226%%=======================================
%20171226%Suppose $\seqxZ{\opTrn^n\fpsi}$ is a basis for $\spW_0$.
%20171226%By \prefp{def:seqWn}, the wavelet subspace $\spW_0$ is contained in the 
%20171226%scaling subspace $\spV_1$.
%20171226%By \prefp{def:mra}, the sequence $\seqxZ{\opDil\opTrn^n\fphi}$ is a basis for $\spV_1$.
%20171226%Because $\spW_0$ is contained in $\spV_1$,
%20171226%the sequence $\seqxZ{\opDil\opTrn^n\fphi}$ is also a basis for $\spW_0$.
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{theorem}
%20171226%\label{thm:g->psi}
%20171226%%--------------------------------------
%20171226%Let $\mrasys$ be a multiresolution system
%20171226%and $\seqjZ{\spW_j}$ a wavelet analysis with respect to $\mrasys$ and with wavelet function $\fpsi$.
%20171226%\thmbox{
%20171226%  \begin{array}{l rc>{\ds}l @{\qquad}D}
%20171226%    \exists \seqxZ{\fg_n} \st
%20171226%      & \fpsi &=& \sum_{n\in\Z} \fg_n \opDil \opTrn^n \fphi
%20171226%      & 
%20171226%  \end{array}}
%20171226%\end{theorem}
%20171226%\begin{proof}
%20171226%\begin{align*}
%20171226%  \fpsi &\in \spW_0
%20171226%        && \text{by \prefp{def:seqWn}}
%20171226%      \\&\subseteq \spV_1
%20171226%        && \text{by \prefp{def:seqWn}}
%20171226%      \\&= \linspan\seqxZ{\opDil\opTrn^n\fphi(x)}
%20171226%        && \text{by \prefp{def:mra} (MRA)}
%20171226%      \\&\implies 
%20171226%         \exists \seqxZ{\fg_n} \st
%20171226%            \fpsi = \sum_{n\in\Z} \fg_n \opDil \opTrn^n \fphi
%20171226%\end{align*}
%20171226%
%20171226%%\item Proof that $\fpsi(x) = \sqrt{2} \sum_{n\in\Z} \fg_n  \fphi(2x-n)$:
%20171226%%\begin{align*}
%20171226%%              &  \set{\fphi(2x-n)}{n\in\Z} \text{ spans } \spV_1
%20171226%%              && \text{by (1)}
%20171226%%  \\
%20171226%%              &  \set{\fpsi(x-n)}{n\in\Z} \text{ spans } \spW_0
%20171226%%  \\ \implies & \fpsi(x)\in \spW_0 \subset \spV_1
%20171226%%  \\ \implies & \text{$\fpsi(x)$ can be represented as a linear combination of $\fphi(2x-n)$}.
%20171226%%\end{align*}
%20171226%%\end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%A \structe{wavelet system} (next definition) consists of two subspace sequences: 
%20171226%\begin{liste}
%20171226%  \item A \structb{multiresolution analysis} $\seqn{\spV_j}$ \xref{def:mra}
%20171226%     provides ``coarse" approximations of a function in $\spLLR$ at different ``scales" or resolutions.
%20171226%  \item A \structb{wavelet analysis} $\seqn{\spW_j}$
%20171226%     provides the ``detail" of the function missing from the approximation provided by a given scaling subspace
%20171226%     \xref{def:seqWn}.
%20171226%\end{liste}
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{definition}
%20171226%\label{def:wavsys}
%20171226%\label{def:gn}
%20171226%%--------------------------------------
%20171226%Let $\mrasys$ be a \structe{multiresolution system} \xref{def:mra}
%20171226%and $\seqjZ{\spW_j}$ a wavelet analysis \xref{def:seqWn}
%20171226%with respect to $\seqjZ{\spV_j}$.
%20171226%Let $\seqxZ{\fg_n}$ be a sequence of coefficients.
%20171226%\defbox{\begin{array}{M}
%20171226%  A \structd{wavelet system} is the tuple \quad$\ds\wavsys$\\
%20171226%  and the sequence $\seqxZ{\fg_n}$ that satisfies the equation
%20171226%  $\ds\fpsi = \sum_{n\in\Z} \fg_n \opDil \opTrn^n \fphi$\\
%20171226%  is the \structd{wavelet coefficient sequence}.
%20171226%\end{array}}
%20171226%\end{definition}
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{remark}
%20171226%%--------------------------------------
%20171226%The pair of coefficient sequences $\opair{\seqn{\fh_n}}{\seqn{\fg_n}}$ generates 
%20171226%the scaling function $\fphi(x)$ \xref{def:wavstrct_phi} 
%20171226%and the wavelet function $\fpsi(x)$ \xref{def:wavstrct_psi}.
%20171226%These functions in turn generate 
%20171226%the multiresolution analysis $\seqn{\spV_j}$ \xref{def:seqVn}
%20171226%and the wavelet analysis $\seqn{\spW_j}$ \xref{def:seqWn}.
%20171226%Therefore, the coefficient sequence pair $\opair{\seqn{\fh_n}}{\seqn{\fg_n}}$ 
%20171226%totally defines a wavelet system $\wavsys$ \xref{def:wavsys}.
%20171226%
%20171226%Furthermore, especially in the case of orthonormal wavelets, the wavelet coefficient
%20171226%sequence $\seqxZ{\fg_n}$ is often defined in terms of the 
%20171226%scaling coefficient sequence $\seqxZ{\fh_n}$
%20171226%in a very simple and straightforward manner.
%20171226%Therefore, in the case of an orthonormal wavelet system, the coefficient
%20171226%scaling sequence $\seqxZ{\fh_n}$ often totally defines the entire wavelet system.
%20171226%And in this case, designing a wavelet system is only a matter of finding a handful of
%20171226%scaling coefficients $\seqn{\fh_1,\,h_2,\,\ldots,\,h_n}$\ldots because once you have these,
%20171226%you can generate everything else.
%20171226%\end{remark}
%20171226%
%20171226%
%20171226%%%---------------------------------------
%20171226%%\begin{definition}
%20171226%%\label{def:wav_lat_coef}
%20171226%%%---------------------------------------
%20171226%%Let $\seqxZ{\fh_n}$ be a sequence of scaling coefficients and
%20171226%%    $\seqxZ{\fg_n}$ be the associated sequence of wavelet coefficients.
%20171226%%%    $\subseteq$ the set inclusion relation,
%20171226%%%    $\setu$ the set union operation, and
%20171226%%%    $\seti$ the set intersection operation.
%20171226%%\defbox{\begin{array}{l}
%20171226%%  \text{The tupple }
%20171226%%  \qquad \wavlatcoef \\
%20171226%%  \text{is called the \hid{lattice of wavelet bases coefficients}.}
%20171226%%\end{array}}
%20171226%%\end{definition}
%20171226%
%20171226%
%20171226%
%20171226%%\begin{figure}[t]
%20171226%%\setlength{\unitlength}{8mm}
%20171226%%\begin{center}
%20171226%%\begin{tabular}{cc}
%20171226%%   \includegraphics*[width=6\tw/16, height=6\tw/16, clip=true]{../common/wavelets/haar_sj.eps} &
%20171226%%   \includegraphics*[width=6\tw/16, height=6\tw/16, clip=true]{../common/wavelets/haar_sk.eps} \\
%20171226%%   \footnotesize varying dilation, constant translation   &
%20171226%%   \footnotesize varying translation, constant dilation
%20171226%%\end{tabular}
%20171226%%\caption{
%20171226%%   \label{fig:haar-jn}
%20171226%%   Haar scaling function at varying dilations and translations.
%20171226%%   }
%20171226%%\end{center}
%20171226%%\end{figure}
%20171226%
%20171226%
%20171226%
%20171226%%=======================================
%20171226%\subsection{Order structure}
%20171226%%=======================================
%20171226%%The axioms of \prefp{def:mra} generate a subspace architecture.
%20171226%%These transform representation sequences may be \hie{ordered} with \hie{ordering relations}
%20171226%%as follows:%
%20171226%%\footnote{\hie{projection operator ordering}: \prefp{def:operator_lattice}}
%20171226%
%20171226%\begin{minipage}{\tw-70mm}\raggedright
%20171226%The \structe{wavelet system} $\wavsys$ \xref{def:wavsys} together with the 
%20171226%set inclusion relation $\subseteq$ 
%20171226%forms an \structe{ordered set}\ifsxref{order}{def:poset}, 
%20171226%illustrated to the right by a \hie{Hasse diagram}\ifsxref{order}{def:hasse}.%\ifdochas{order}{\footnotemark}
%20171226%%Under these three order relations, wavelet system generate three isomorphic lattices such 
%20171226%%as are illustrated in \prefp{fig:wav_VPb_isomorphic} 
%20171226%%and in the figure to the right.
%20171226%\end{minipage}%
%20171226%\hfill\tbox{\includegraphics{graphics/latwav.pdf}}%
%20171226%
%20171226%%---------------------------------------
%20171226%\begin{proposition}
%20171226%\label{prop:order_wavstrct}
%20171226%%---------------------------------------
%20171226%Let $\wavsys$ be a wavelet system with order relation $\subseteq$.
%20171226%The lattice $\latL\eqd\lattice{\seqn{\spV_j},\seqn{\spW_j}}{\subseteq}{\join}{\meet}$ has 
%20171226%the following properties:
%20171226%\propbox{\begin{array}{FM}
%20171226%      1.  & $\latL$ is \prope{nondistributive}.
%20171226%    \\2.  & $\latL$ is \prope{nonmodular}.
%20171226%    %\cntn & $\latL$ is \prope{complemented}.
%20171226%    %\cntn & $\latL$ is \prope{not uniquely complemented}.
%20171226%    %\cntn & $\latL$ is \prope{nonorthocomplemented}.
%20171226%    \\3.  & $\latL$ is \prope{noncomplemented}.
%20171226%    \\4.  & $\latL$ is \prope{nonBoolean}.
%20171226%\end{array}}
%20171226%\end{proposition}
%20171226%\begin{proof}
%20171226%%\mbox{}\hspace{20mm}
%20171226%%  \latmatlw{4}{0.5}
%20171226%%    {
%20171226%%           &       & \null                 \\  
%20171226%%           & \null                         \\  
%20171226%%     \null &       & \null &       & \null \\  
%20171226%%           &       & \null                   
%20171226%%    }
%20171226%%    {\ncline{1,3}{2,2}\ncline{2,2}{3,1}
%20171226%%     \ncline{1,3}{3,5}
%20171226%%     \ncline{2,2}{3,3}
%20171226%%     \ncline{4,3}{3,1}\ncline{4,3}{3,3}\ncline{4,3}{3,5}
%20171226%%    }
%20171226%%    {\nput{ 90}{1,3}{$1$}
%20171226%%     \nput{135}{2,2}{$v$}
%20171226%%     \nput{0}{3,1}{$x$}
%20171226%%     \nput{ 67}{3,3}{$y$}
%20171226%%     \nput{  0}{3,5}{$z$}
%20171226%%     \nput{-90}{4,3}{$0$}
%20171226%%    }
%20171226%\begin{enumerate}
%20171226%  \item Proof that $\latL$ is \prope{nondistributive}: \label{item:wavprop_nondistrib}
%20171226%    \begin{enumerate}
%20171226%      \item $\latL$ contains the $N5$ lattice\ifsxref{latm}{def:lat_N5}.
%20171226%      \item Because $\latL$ contains the $N5$ lattice, $\latL$ is \prope{nondistributive}\ifdochas{latm}{ by \prefp{thm:latd_char_n5m3}}.
%20171226%    \end{enumerate}
%20171226%
%20171226%  \item Proof that $\latL$ is \prope{nonmodular} and \prope{nondistributive}: 
%20171226%    \begin{enumerate}
%20171226%      \item $\latL$ contains the $N5$ lattice\ifsxref{latm}{def:lat_N5}.
%20171226%      \item Because $\latL$ contains the $N5$ lattice, $\latL$ is \prope{nonmodular}\ifdochas{latm}{ by \prefp{thm:lat_mod_iff_N5}}.
%20171226%    \end{enumerate}
%20171226%
%20171226%  \item Proof that $\latL$ is \prope{noncomplemented}:
%20171226%    \begin{minipage}{50mm}
%20171226%      \begin{align*}
%20171226%          x' &= y' = v' = z
%20171226%        \\z' &= \setn{x,y,v}
%20171226%        \\x''&= \brp{x'}'
%20171226%           \\&= z'
%20171226%           \\&= \setn{x,y,v}
%20171226%           \\&\ne  x
%20171226%      \end{align*}
%20171226%    \end{minipage}\qquad\tbox{\includegraphics{graphics/lat6_plat_xyzv10.pdf}}%
%20171226%
%20171226%  %\item Proof that $\latL$ is \prope{not uniquely complemented}:\\
%20171226%  %   For example, subspace $\spW_2$ in \prefp{fig:wav_VPb_isomorphic} is complemented
%20171226%  %   by $\spV_1$, $\spV_2$, and $\spW_1$.
%20171226%  %\item Proof that $\latL$ is \prope{orthomodular}:
%20171226%  %  \begin{enumerate}
%20171226%  %    \item $\latL$ does \emph{not} contain the $O_6$ lattice\ifdochas{ortholat}{ \xref{def:latoc_omod}}.
%20171226%  %    \item Because $\latL$ does not contain the $O_6$ lattice, $\latL$ is \prope{orthomodular}\ifdochas{ortholat}{ by \prefp{thm:latoc_omod}}.
%20171226%  %  \end{enumerate}
%20171226%
%20171226%  \item Proof that $\latL$ is \prope{nonBoolean}:
%20171226%    \begin{enumerate}
%20171226%      \item $\latL$ is \prope{nondistributive} (\pref{item:wavprop_nondistrib}).
%20171226%      \item Because $\latL$ is \prope{nondistributive}, it is \prope{nonBoolean}\ifdochas{boolean}{ by \prefp{def:booalg}}.
%20171226%    \end{enumerate}
%20171226%\end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%
%20171226%
%20171226%
%20171226%%=======================================
%20171226%\subsection{Subspace algebraic structure}
%20171226%%=======================================
%20171226%%--------------------------------------
%20171226%\begin{theorem}
%20171226%\label{thm:mra_subalg}
%20171226%%--------------------------------------
%20171226%Let $\wavsys$ be a \structe{wavelet system} \xref{def:wavsys}.
%20171226%Let $\spV_1 \adds \spV_2$ represent \fncte{Minkowski addition} of two subspaces $\spV_1$ and $\spV_2$ of a Hilbert space $\spH$.
%20171226%\thmbox{\begin{array}{rc>{\ds}l D}
%20171226%    \spLLR &=& \lim_{j\to\infty}\spV_j                 
%20171226%             & ($\spLLR$ is equivalent to one very large scaling subspace)\\
%20171226%           &=& \spV_j \adds \spW_j \adds \spW_{j+1} \adds \spW_{j+2} \adds\, \cdots 
%20171226%             & $\brp{\begin{array}{D}$\spLLR$ is equivalent to one scaling space\\
%20171226%                                       and a sequence of wavelet subspaces\end{array}} $\\
%20171226%           &=& \cdots\,\adds \spW_{-2} \adds \spW_{-1} \adds \spW_0 \adds \spW_1 \adds \spW_2 \adds\,\cdots        
%20171226%             & ($\spLLR$ is equivalent to a sequence of wavelet subspaces)
%20171226%  \end{array}}
%20171226%\end{theorem}
%20171226%\begin{proof}
%20171226%\begin{enumerate}
%20171226%  \item Proof for (1):
%20171226%    \begin{align*}
%20171226%      \spLLR 
%20171226%        &= \lim_{j\to\infty}\spV_j                 
%20171226%        && \text{by \prefp{def:mra}}
%20171226%    \end{align*}
%20171226%
%20171226%  \item Proof for (2):
%20171226%    \begin{align*}
%20171226%      \mcom{\spV_j \adds \spW_j}{$\spV_{j+1}$} \adds \spW_{j+1} \adds \spW_{j+2} \adds \cdots
%20171226%        &= \mcom{\spV_{j+1} \adds \spW_{j+1}}{$\spV_{j+2}$} \adds \spW_{j+2} \adds \spW_{j+3} \adds \cdots
%20171226%      \\&= \mcom{\spV_{j+2} \adds \spW_{j+2}}{$\spV_{j+3}$} \adds \spW_{j+3} \adds \spW_{j+4} \adds \cdots
%20171226%      \\&= \mcom{\spV_{j+3} \adds \spW_{j+3}}{$\spV_{j+4}$} \adds \spW_{j+4} \adds \spW_{j+5} \adds \cdots
%20171226%      \\&= \mcom{\spV_{j+5} \adds \spW_{j+5}}{$\spV_{j+5}$} \adds \spW_{j+6} \adds \spW_{j+6} \adds \cdots
%20171226%      \\&= \lim_{j\to\infty}\spV_{j+5} \adds \spW_{j+5} \adds \spW_{j+6} \adds \spW_{j+6} \adds \cdots
%20171226%      \\&= \spLLR
%20171226%    \end{align*}
%20171226%
%20171226%  \item Proof for (3):
%20171226%    \begin{align*}
%20171226%      \spLLR &= \mcom{\spV_0}{$\spV_{-1}\adds\spW_{-1}$} \adds \spW_0 \adds \spW_1 \adds \spW_2 \adds \spW_3 \adds \cdots
%20171226%             && \text{by (2)}
%20171226%           \\&= \mcom{\spV_{-1}}{$\spV_{-2}\adds\spW_{-2}$} \spW_{-1} \adds \spW_0 \adds \spW_1 \adds \spW_2 \adds \spW_3 \adds \cdots
%20171226%           \\&= \mcom{\spV_{-2}}{$\spV_{-3}\adds\spW_{-3}$} \spW_{-2} \adds \spW_{-1} \adds \spW_0 \adds \spW_1 \adds \spW_2 \adds \spW_3 \adds \cdots
%20171226%           \\&= \mcom{\spV_{-3}}{$\spV_{-4}\adds\spW_{-4}$} \spW_{-3} \adds \spW_{-2} \adds \spW_{-1} \adds \spW_0 \adds \spW_1 \adds \spW_2 \adds \spW_3 \adds \cdots
%20171226%           \\&\vdots
%20171226%           \\&= \cdots \adds \spW_{-3} \adds \spW_{-2} \adds \spW_{-1} \adds \spW_0 \adds \spW_1 \adds \spW_2 \adds \spW_3 \adds \cdots
%20171226%    \end{align*}
%20171226%\end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{remark}
%20171226%%--------------------------------------
%20171226%In the special case that two subspaces $\spW_1$ and $\spW_2$ are \prope{orthogonal} to each other, then 
%20171226%the \fncte{subspace addition} operation $\spW_1\adds\spW_2$ is frequently expressed as
%20171226%$\spW_1\oplus\spW_2$.
%20171226%In the case of an \structe{orthonormal wavelet system}\ifsxref{ortho}{def:ows}, 
%20171226%the expressions in \prefpp{thm:mra_subalg} could be expressed as
%20171226%\\\indentx$\begin{array}{rc>{\ds}l}
%20171226%    \spLLR &=& \lim_{j\to\infty}\spV_j                 \\
%20171226%           &=& \spV_j \oplus \spW_j \oplus \spW_{j+1} \oplus \spW_{j+2} \oplus\, \cdots \\
%20171226%           &=& \cdots\,\oplus \spW_{-2} \oplus \spW_{-1} \oplus \spW_0 \oplus \spW_1 \oplus \spW_2 \oplus\,\cdots .       
%20171226%  \end{array}$
%20171226%\end{remark}.
%20171226%
%20171226%
%20171226%%=======================================
%20171226%\subsection{Necessary conditions}
%20171226%%=======================================
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{theorem}[\thmd{quadrature condition}s in ``time"]
%20171226%\label{thm:wavsys_quadcon}
%20171226%%--------------------------------------
%20171226%Let $\wavsys$ be a wavelet system \xref{def:wavsys}.
%20171226%\thmbox{\begin{array}{F>{\ds}rc>{\ds}lC}
%20171226%  1. & \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fh_k^\ast \inprod{\fphi}{\opTrn^{2n-m+k} \fphi} &=& \inprod{\fphi}{\opTrn^n \fphi} & \forall n\in\Z\\
%20171226%  2. & \sum_{m\in\Z}\fg_m \sum_{k\in\Z}\fg_k^\ast \inprod{\fphi}{\opTrn^{2n-m+k} \fphi} &=& \inprod{\fpsi}{\opTrn^n \fpsi} & \forall n\in\Z\\
%20171226%  3. & \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fg_k^\ast \inprod{\fphi}{\opTrn^{2n-m+k} \fphi} &=& \inprod{\fphi}{\opTrn^n \fpsi} & \forall n\in\Z
%20171226%\end{array}}
%20171226%\end{theorem}
%20171226%\begin{proof}
%20171226%\begin{enumerate}
%20171226%  \item Proof for (1): by \prefp{thm:wav_quadcon}.
%20171226%  \item Proof for (2): 
%20171226%    \begin{align*}
%20171226%      &\inprod{\fpsi}{\opTrn^n \fpsi}
%20171226%      \\&= \inprod{\sum_{m\in\Z}\fg_m \opDil \opTrn^m \fphi }{\opTrn^n \sum_{k\in\Z}\fg_k \opDil \opTrn^k \fphi}
%20171226%        && \text{by \prefp{thm:g->psi}}
%20171226%      \\&= \sum_{m\in\Z}\fg_m \sum_{k\in\Z}\fg_k^\ast \inprod{\opDil \opTrn^m \fphi }{\opTrn^n \opDil \opTrn^k \fphi}
%20171226%        && \text{by properties of $\inprodn$ \ifxref{vsinprod}{def:inprod}}
%20171226%      \\&= \sum_{m\in\Z}\fg_m \sum_{k\in\Z}\fg_k^\ast \inprod{\fphi }{\left(\opDil \opTrn^m \right)^\ast \opTrn^n \opDil \opTrn^k \fphi}
%20171226%        && \text{by definition of operator adjoint \ifxref{operator}{prop:op_adjoint}}
%20171226%      \\&= \sum_{m\in\Z}\fg_m \sum_{k\in\Z}\fg_k^\ast \inprod{\fphi }{\left(\opDil \opTrn^m \right)^\ast \opDil \opTrn^{2n} \opTrn^k \fphi}
%20171226%        && \text{by \prefp{prop:DTTD}}
%20171226%      \\&= \sum_{m\in\Z}\fg_m \sum_{k\in\Z}\fg_k^\ast \inprod{\fphi }{\opTrna^m \opDila \opDil \opTrn^{2n} \opTrn^k \fphi}
%20171226%        && \text{by operator star-algebra properties \ifxref{operator}{thm:op_star}}
%20171226%      \\&= \sum_{m\in\Z}\fg_m \sum_{k\in\Z}\fg_k^\ast \inprod{\fphi }{\opTrn^{-m} \opDil^{-1} \opDil \opTrn^{2n} \opTrn^k \fphi}
%20171226%        && \text{by \prefp{prop:TD_unitary}}
%20171226%      \\&= \sum_{m\in\Z}\fg_m \sum_{k\in\Z}\fg_k^\ast \inprod{\fphi }{\opTrn^{2n-m+k} \fphi}
%20171226%    \end{align*}
%20171226%
%20171226%  \item Proof for (3): 
%20171226%    \begin{align*}
%20171226%      &\inprod{\fphi}{\opTrn^n \fpsi}
%20171226%      \\&= \inprod{\sum_{m\in\Z}\fh_m \opDil \opTrn^m \fphi }{\opTrn^n \sum_{k\in\Z}\fg_k \opDil \opTrn^k \fphi}
%20171226%        && \text{by \prefp{thm:dilation_eq} and \prefp{thm:g->psi}}
%20171226%      \\&= \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fg_k^\ast \inprod{\opDil \opTrn^m \fphi }{\opTrn^n \opDil \opTrn^k \fphi}
%20171226%        && \text{by properties of $\inprodn$ \ifxref{vsinprod}{def:inprod}}
%20171226%      \\&= \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fg_k^\ast \inprod{\fphi }{\left(\opDil \opTrn^m \right)^\ast \opTrn^n \opDil \opTrn^k \fphi}
%20171226%        && \text{by definition of operator adjoint \ifxref{operator}{prop:op_adjoint}}
%20171226%      \\&= \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fg_k^\ast \inprod{\fphi }{\left(\opDil \opTrn^m \right)^\ast \opDil \opTrn^{2n} \opTrn^k \fphi}
%20171226%        && \text{by \prefp{prop:DTTD}}
%20171226%      \\&= \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fg_k^\ast \inprod{\fphi }{\opTrna^m \opDila \opDil \opTrn^{2n} \opTrn^k \fphi}
%20171226%        && \text{by operator star-algebra properties \ifxref{operator}{thm:op_star}}
%20171226%      \\&= \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fg_k^\ast \inprod{\fphi }{\opTrn^{-m} \opDil^{-1} \opDil \opTrn^{2n} \opTrn^k \fphi}
%20171226%        && \text{by \prefp{prop:TD_unitary}}
%20171226%      \\&= \sum_{m\in\Z}\fh_m \sum_{k\in\Z}\fg_k^\ast \inprod{\fphi }{\opTrn^{2n-m+k} \fphi}
%20171226%    \end{align*}
%20171226%\end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%
%20171226%
%20171226%%=======================================
%20171226%%\subsection{Fourier properties}
%20171226%%=======================================
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{proposition}
%20171226%\label{prop:vsmra_real_Fpsi}
%20171226%\label{prop:psi_g_phi}
%20171226%%--------------------------------------
%20171226%Let $\wavsys$ be a wavelet system.
%20171226%Let $\Fphi(\omega)$ and $\Fpsi(\omega)$ be the \fncte{Fourier transform}s\ifsxrefs{harFour}{def:ft}of $\fphi(x)$ and $\fpsi(x)$, respectively.
%20171226%Let $\Dg(\omega)$ be the \fncte{Discrete time Fourier transform}\ifsxrefs{dsp}{def:dtft}of $\seqn{\fg_n}$.
%20171226%%  $\begin{array}[t]{rc>{\ds}l c>{\ds}l D}
%20171226%%    \Fpsi\brp{\omega}
%20171226%%      &\eqd& \opFT\fpsi
%20171226%%      &\eqd& \frac{1}{\sqrt{2\pi}}\int_t \fpsi(x) e^{-i\omega t} \dx
%20171226%%      &      (\structe{Fourier transform}, \prefp{def:ft})
%20171226%%      \\
%20171226%%    \Dg(\omega)
%20171226%%      &\eqd& \opDTFT\seqn{\fg_n}
%20171226%%      &\eqd& \sum_{n\in\Z}\fg_n e^{-i\omega n}
%20171226%%      &      (\structe{Discrete-time Fourier Transform}).
%20171226%%  \end{array}$
%20171226%\propbox{
%20171226%  \Fpsi\brp{\omega}
%20171226%    %\eqd
%20171226%    %\mcom{\opFT\fpsi = \brp{\opDili \opDTFT\seqn{\fg_n}} \; \brp{\opDili \opFT\fphi}}
%20171226%    %     {operator notation}
%20171226%    =
%20171226%    {\cwt \: \Dg\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}}
%20171226%    %     {traditional notation}
%20171226%  }
%20171226%\end{proposition}
%20171226%\begin{proof}
%20171226%\begin{align*}
%20171226%  \Fpsi\brp{\omega}
%20171226%    &\eqd \opFT\fpsi
%20171226%  \\&= \opFT\sum_{n\in\Z}\fg_n \opDil \opTrn^n \fphi
%20171226%    && \text{by \prefp{thm:g->psi}}
%20171226%  \\&= \sum_{n\in\Z}\fg_n \opFT\opDil \opTrn^n \fphi
%20171226%  \\&= \sum_{n\in\Z}\fg_n \opDili \opFT\opTrn^n \fphi
%20171226%    && \text{by \prefp{cor:wavstrct_FTD}}
%20171226%  \\&= \sum_{n\in\Z}\fg_n \opDili e^{-i\omega n} \opFT\fphi
%20171226%    && \text{by \prefp{cor:wavstrct_FTD}}
%20171226%  \\&= \sum_{n\in\Z}\fg_n \sqrt{2}\brp{\opDili e^{-i\omega n}} \brp{\opDili\opFT\fphi}
%20171226%    && \text{by \prefp{prop:DjTnfg}}
%20171226%  \\&= \sqrt{2}\brp{\opDili \sum_{n\in\Z}\fg_n e^{-i\omega n}} \; \brp{\opDili \opFT\fphi}
%20171226%  \\&= \sqrt{2}\brp{\opDili \opDTFT\seqn{\fg_n}} \; \brp{\opDili \opFT\fphi}
%20171226%    && \text{by definition of $\opDTFT$}
%20171226%  \\&= \sqrt{2}\cwt \: \Dg\brp{\frac{\omega}{2}}\: \cwt \Fphi\brp{\frac{\omega}{2}}
%20171226%    && \text{by property of $\opDil$} && \text{\xref{prop:opDi}}
%20171226%  \\&= \cwt \: \Dg\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
%20171226%\end{align*}
%20171226%%
%20171226%%\begin{align*}
%20171226%%  \Fpsi\brp{\omega}
%20171226%%    &= \opF\fpsi
%20171226%%  \\&= \opFT\sum_{n\in\Z}\fg_n \opDil \opTrn^n \fphi
%20171226%%    && %\text{by dilation equation \xref{thm:dilation_eq}}
%20171226%%  \\&= \sum_{n\in\Z}\fg_n \opFT\opDil \opTrn^n \fphi
%20171226%%  \\&= \sum_{n\in\Z}\fg_n \opDili \opFT\opTrn^n \fphi
%20171226%%    && \text{by \prefp{prop:vsmra_real_FD}}
%20171226%%  \\&= \sum_{n\in\Z}\fg_n \opDili e^{-i\omega n} \opFT\fphi
%20171226%%    && \text{by \prefp{prop:vsmra_real_FT}}
%20171226%%  \\&= \brp{\opDili \sum_{n\in\Z}\fg_n e^{-i\omega n}} \; \brp{\opDili \opFT\fphi}
%20171226%%  \\&= \brp{\opDili \opDTFT\seqn{\fg_n}} \; \brp{\opDili \opFT\fphi}
%20171226%%  \\&= \fscale \: \Dg\brp{\frac{\omega}{2}}\: \fscale \Fphi\brp{\frac{\omega}{2}}
%20171226%%    && \text{by property of $\opDil$} && \text{\xref{prop:opDi}}
%20171226%%  \\&= \frac{1}{2}\: \Dh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
%20171226%%\end{align*}
%20171226%\end{proof}
%20171226%
%20171226%%=======================================
%20171226%%\section{Immediate results}
%20171226%%=======================================
%20171226%
%20171226%
%20171226%
%20171226%%=======================================
%20171226%%\subsection{Power Spectrum}
%20171226%%=======================================
%20171226%%%--------------------------------------
%20171226%%\begin{definition}
%20171226%%\citep{chui}{134}
%20171226%%\label{def:wav_S}
%20171226%%\index{scaling power spectrum function         }
%20171226%%\index{wavelet power spectrum function         }
%20171226%%\index{scaling wavelet power spectrum function }
%20171226%%\index{Laurent polynomial}
%20171226%%%--------------------------------------
%20171226%%Let $\wavsys$ be a \hi{wavelet system}.
%20171226%%Let $\Szfg(z)$ be the \fncte{complex cross-power spectrum} of $\ff$ and $\fg$ \xref{def:Szfg} in $\spLLR$
%20171226%%and $\Swfg(\omega)$ be the \fncte{cross-power spectrum} of $\ff$ and $\fg$ \xref{def:Swfg} in $\spLLR$.
%20171226%%\defbox{\begin{array}{>{\ds}rc>{\ds}lM}
%20171226%%    \Szphi(z)  &\eqd&  \left.\Szfg(z)\right|_{\ff=\fg=\fphi} &is the \hid{scaling power spectrum function}.
%20171226%%    \Szpsi(z)  &\eqd&  \left.\Szfg(z)\right|_{\ff=\fg=\fpsi} &is the \hid{wavelet power spectrum function}.
%20171226%%    \Szpsi(z)  &\eqd&  \Szfg(z) &is the \hid{scaling power spectrum function}.
%20171226%%    \\
%20171226%%    \Spsi(\omega) &\eqd&  \sum_{n\in\Z} \Rpsi(n) \fkernea{n}{\omega}
%20171226%%    &is the \hid{wavelet power spectrum function}.
%20171226%%    \\
%20171226%%    \Shs (\omega) &\eqd&  \sum_{n\in\Z} \Rhs (n) \fkernea{n}{\omega}
%20171226%%    &is the \hid{scaling wavelet power spectrum function}.
%20171226%%\end{array}}
%20171226%%%\\The Laurent polynomial $\Sphi(\omega)$ is also called the \hid{Euler-Frobenius polynomial}.
%20171226%%\end{definition}
%20171226%
%20171226%
%20171226%%In this chapter, we don't assume the special case of orthonormality.
%20171226%%But good things happen if we do happen to have orthonormality.
%20171226%%One of them is that the power spectrum equations in \prefp{lem:SSS}
%20171226%%simplify to constants \xref{lem:SSSo}.
%20171226%
%20171226%\pref{thm:gen_quadcon} (next) presents the \structe{quadrature} necessary conditions of a \hi{wavelet system}.
%20171226%These relations simplify dramatically in the special case of an
%20171226%\structe{orthonormal wavelet system} \xref{thm:oquadcon}.
%20171226%%--------------------------------------
%20171226%\begin{theorem}[\thmd{Quadrature conditions} in ``frequency"]
%20171226%\citetbl{
%20171226%  \citerp{chui}{135},
%20171226%  \citerp{goswami}{110}
%20171226%  }
%20171226%\label{thm:gen_quadcon}
%20171226%%--------------------------------------
%20171226%Let $\wavsys$ be a \hi{wavelet system}.
%20171226%Let $\Fx(\omega)$ be the \fncte{discrete time Fourier transform}\ifsxrefs{dsp}{def:dtft}for a sequence $\seqxZ{x_n}$ in $\spllR$.
%20171226%Let $\Swphi(\omega)$ be the \fncte{auto-power spectrum} \xref{def:Swfg} of $\fphi$,
%20171226%    $\Swpsi(\omega)$ be the \fncte{auto-power spectrum} of $\fpsi$,
%20171226%and $\Shs(\omega)$ be the \fncte{cross-power spectrum} of $\fphi$ and $\fpsi$.
%20171226%\thmbox{\begin{array}{F>{\ds}lc>{\ds}l}
%20171226%   1. & \abs{\Dh\left(\omega     \right)}^2 \Sphi(\omega) + \abs{\Dh\brp{\omega+\pi }}^2 \Sphi(\omega+\pi) &=& 2\Sphi(2\omega)
%20171226%\\ 2. & \abs{\Dg\left(\omega     \right)}^2 \Sphi(\omega) + \abs{\Dg\brp{\omega+\pi }}^2 \Sphi(\omega+\pi) &=& 2\Spsi(2\omega)
%20171226%\\ 3. & \Dh(\omega)\Dg^\ast(\omega)         \Sphi(\omega) + \Dh(\omega +\pi)\Dg^\ast(\omega +\pi)\Sphi(\omega+\pi) &=& 2\Shs(2\omega)
%20171226%\end{array}}
%20171226%\end{theorem}
%20171226%\begin{proof}
%20171226%\begin{enumerate}
%20171226%  %\item First note that $\Dh(\omega)$ and $\Dg(\omega)$ are periodic with period $2\pi$ such that\ifsxrefs{dsp}{prop:dtft_2pi}
%20171226%  %  \\$\begin{array}{rclC}
%20171226%  %       \Dh(\omega+2\pi n) &=& \Dh(\omega) & \forall n\in\Z   \\
%20171226%  %       \Dg(\omega+2\pi n) &=& \Dg(\omega) & \forall n\in\Z   
%20171226%  %     \end{array}$
%20171226%
%20171226%\item Proof for (1): by \prefp{thm:Sphi}.
%20171226%
%20171226%\item Proof for (2):
%20171226%\begin{align*}
%20171226%   2\Spsi(2\omega)
%20171226%     &\eqd 2\brp{2\pi}\sum_{n\in\Z} \left|\Fpsi(2\omega+2\pi n)\right|^2
%20171226%   \\&= 2\brp{2\pi}\sum_{n\in\Z} \left|\cwt \Dg\left(\frac{2\omega+2\pi n}{2}\right)\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2
%20171226%        \indentx\text{by \prefp{lem:Fphi}}
%20171226%   \\&= 2\pi
%20171226%        \sum_{n\in\Ze} \left|\Dg\left(\frac{2\omega+2\pi n}{2}\right)\right|^2\left|\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2 +
%20171226%     \\&\qquad 2\pi
%20171226%        \sum_{n\in\Zo} \left|\Dg\left(\frac{2\omega+2\pi n}{2}\right)\right|^2\left|\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2
%20171226%   \\&= 2\pi\sum_{n\in\Z} \abs{\Dg\brp{\omega+2\pi n     }}^2 \abs{\Fphi\brp{\omega+2\pi n       }}^2 +
%20171226%        2\pi\sum_{n\in\Z} \abs{\Dg\brp{\omega+2\pi n+\pi }}^2 \abs{\Fphi\brp{\omega+2\pi n + \pi }}^2  
%20171226%   \\&= 2\pi\sum_{n\in\Z} \abs{\Dg\brp{\omega            }}^2 \abs{\Fphi\brp{\omega+2\pi n       }}^2 +
%20171226%        2\pi\sum_{n\in\Z} \abs{\Dg\brp{\omega+\pi        }}^2 \abs{\Fphi\brp{\omega+2\pi n + \pi }}^2  
%20171226%   \\&= \abs{\Dg\brp{\omega     }}^2 \brp{2\pi\sum_{n\in\Z} \abs{\Fphi\brp{\omega+2\pi n       }}^2 +}
%20171226%        \abs{\Dg\brp{\omega+\pi }}^2 \brp{2\pi\sum_{n\in\Z} \abs{\Fphi\brp{\omega+\pi+2\pi n   }}^2  }
%20171226%   \\&= \abs{\Dg\brp{\omega     }}^2\Sphi(\omega) +
%20171226%        \abs{\Dg\brp{\omega+\pi }}^2 \Sphi(\omega+\pi)
%20171226%        \indentx\text{by \prefp{thm:Swfg}}
%20171226%\end{align*}
%20171226%
%20171226%
%20171226%\item Proof for (3):
%20171226%\begin{align*}
%20171226%  2\Shs(2\omega)
%20171226%    &=  2\brp{2\pi}\sum_{n\in\Z} \Fphi(2\omega+2\pi n) \Fpsi^\ast(2\omega+2\pi n)
%20171226%  \\&=  2\brp{2\pi}\sum_{n\in\Z}
%20171226%        \cwt 
%20171226%        \Dh  \left(\omega +\pi n \right)
%20171226%        \Fphi\left(\omega +\pi n \right)
%20171226%        \cwt 
%20171226%        \Dg^\ast  \left(\omega +\pi n \right)
%20171226%        \Fphi^\ast\left(\omega +\pi n \right)
%20171226%        \quad\text{by \prefp{lem:Fphi}}
%20171226%  \\&=  2\pi
%20171226%        \sum_{n\in\Z}
%20171226%        \Dh  \left(\omega +\pi n \right)
%20171226%        \Dg^\ast  \left(\omega +\pi n \right)
%20171226%        \left| \Fphi\left(\omega +\pi n \right) \right|^2
%20171226%  \\&=  2\pi
%20171226%        \sum_{n\in\Zo}
%20171226%        \Dh  \left(\omega +\pi n \right)
%20171226%        \Dg^\ast  \left(\omega +\pi n \right)
%20171226%        \left| \Fphi\left(\omega +\pi n \right) \right|^2
%20171226%      \\&\qquad+ 2\pi\sum_{n\in\Ze}
%20171226%        \Dh  \left(\omega +\pi n \right)
%20171226%        \Dg^\ast  \left(\omega +\pi n \right)
%20171226%        \left| \Fphi\left(\omega +\pi n \right) \right|^2
%20171226%  \\&=  2\pi\sum_{n\in\Z}
%20171226%        \Dh  \left(\omega +2\pi n+\pi \right)
%20171226%        \Dg^\ast  \left(\omega +2\pi n+\pi \right)
%20171226%        \left| \Fphi\left(\omega +2\pi n+\pi \right) \right|^2
%20171226%      \\&\qquad+ 2\pi\sum_{n\in\Z}
%20171226%        \Dh  \left(\omega +2\pi n\right)
%20171226%        \Dg^\ast  \left(\omega +2\pi n\right)
%20171226%        \left| \Fphi\left(\omega +2\pi n\right) \right|^2
%20171226%  \\&=  2\pi
%20171226%        \sum_{n\in\Z}
%20171226%        \Dh  \left(\omega +\pi \right)
%20171226%        \Dg^\ast  \left(\omega +\pi \right)
%20171226%        \left| \Fphi\left(\omega +2\pi n+\pi \right) \right|^2
%20171226%      + 2\pi\sum_{n\in\Z}
%20171226%        \Dh  \left(\omega \right)
%20171226%        \Dg^\ast  \left(\omega \right)
%20171226%        \left| \Fphi\left(\omega +2\pi n\right) \right|^2
%20171226%  \\&=  \Dh  \left(\omega \right)
%20171226%        \Dg^\ast  \left(\omega \right)
%20171226%        \brp{2\pi\sum_{n\in\Z} \left| \Fphi\left(\omega +2\pi n\right) \right|^2}
%20171226%      \\&\qquad+ \Dh  \left(\omega +\pi \right)
%20171226%        \Dg^\ast  \left(\omega +\pi \right)
%20171226%        \brp{2\pi\sum_{n\in\Z}\left| \Fphi\left(\omega +\pi+2\pi n\right) \right|^2}
%20171226%  \\&=  \Dh(\omega)
%20171226%        \Dg^\ast(\omega)
%20171226%        \brp{2\pi\sum_{n\in\Z} \left| \Fphi(\omega +2\pi n) \right|^2}
%20171226%      + \Dh  (\omega +\pi)
%20171226%        \Dg^\ast (\omega +\pi)
%20171226%        \brp{2\pi\sum_{n\in\Z}\left| \Fphi(\omega +\pi+2\pi n) \right|^2}
%20171226%  \\&=  \Dh(\omega     ) \Dg^\ast(\omega     )\Sphi(\omega)
%20171226%      + \Dh(\omega +\pi) \Dg^\ast(\omega +\pi)\Sphi(\omega+\pi)
%20171226%        \indentx\text{by \prefp{thm:Swfg}}
%20171226%\end{align*}
%20171226%
%20171226%\end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%%%=======================================
%20171226%%\begin{definition}
%20171226%%%=======================================
%20171226%%Let $\wavsys$ be a wavelet system.
%20171226%%Let $\oppS\seqn{\fphi}_m$ be the \hid{span} of the basis vectors $\seqn{\fphi}_m$.
%20171226%%We define the following order relations. 
%20171226%%\defbox{\begin{array}{rcll}
%20171226%%%  \opP_m         &\orel&  \opP_n         & \quad\text{if}\quad \opP_m\opP_n=\opP_n\opP_m=\opP_m \\
%20171226%%  \spV_m         &\orela& \spV_j         & \quad\text{if}\quad \spV_m \subseteq \spV_j \\
%20171226%%  \seqn{\fphi}_m &\orelb& \seqn{\fphi}_n & \quad\text{if}\quad \oppS\seqn{\fphi}_m \subseteq \oppS\seqn{\fphi}_n %\qquad\text{where $\oppS$ is the span}
%20171226%%\end{array}}
%20171226%%\end{definition}
%20171226%%
%20171226%
%20171226%
%20171226%
%20171226%%The sequences of subspaces discussed in this section together with
%20171226%%set relations $\subseteq$, $\setu$, and $\seti$,
%20171226%%for a lattice.
%20171226%%This ``\hie{lattice of wavelet subspaces}" is defined next.
%20171226%%%---------------------------------------
%20171226%%\begin{definition}
%20171226%%\label{def:wav_lat_subspace}
%20171226%%%---------------------------------------
%20171226%%Let $\seqjZ{\spV_j}$ be a sequence of scaling subspaces and
%20171226%%    $\seqjZ{\spW_j}$ be a sequence of wavelet subspaces.
%20171226%%%    $\subseteq$ the set inclusion relation,
%20171226%%%    $\odot$ the set union operation, and
%20171226%%%    $\seti$ the set intersection operation.
%20171226%%\defbox{\begin{array}{l}
%20171226%%  \text{The tupple }
%20171226%%  \qquad \wavlatsubs \\
%20171226%%  \text{is called the \hid{lattice of wavelet subspaces}.}
%20171226%%\end{array}}
%20171226%%\end{definition}
%20171226%
%20171226%
%20171226%%=======================================
%20171226%\subsection{Sufficient condition}
%20171226%%=======================================
%20171226%In this text, an often used sufficient condition for designing the \structe{wavelet coefficient sequence} 
%20171226%$\seqn{\fg_n}$ \xref{def:gn} is the \prope{conjugate quadrature filter condition} \xref{def:cqf}. 
%20171226%It expresses the sequence $\seqn{\fg_n}$ in terms of the \structe{scaling coefficient sequence} \xref{def:hn}
%20171226%and a ``shift" integer $\xN$ as $\fg_n = \pm(-1)^n h^\ast_{\xN-n}$.
%20171226%The \structe{CQF condition} has the following ``nice" properties:
%20171226%\\\indentx\begin{tabular}{>{\scs}rp{\tw-30mm}}
%20171226%    1. & Given a \structe{scaling coefficient sequence} $\seqn{\fh_n}$ \xref{def:hn}, 
%20171226%         it is extremely simple to compute the \structe{wavelet coefficient sequence} $\seqn{\fg_n}$ \xref{def:gn}.
%20171226%  \\2. & If $\setn{\opTrn\fphi}$ of a \structe{wavelet system} $\wavsys$ \xref{def:wavsys} is \prope{orthonormal} and 
%20171226%         $\otriple{\seqn{\fg_n}}{\seqn{\fh_n}}{\xN}$ satisfies the \prope{CQF condition}, 
%20171226%         then $\setn{\opTrn^n\fpsi}$ is also \prope{orthnormal}\ifsxref{ortho}{thm:ortho_qmr}.
%20171226%  \\3. & If $\setn{\opTrn\fphi}$ of a \structe{wavelet system} $\wavsys$ \xref{def:wavsys} is \prope{orthonormal} and 
%20171226%         $\otriple{\seqn{\fg_n}}{\seqn{\fh_n}}{\xN}$ satisfies the \prope{CQF condition}, 
%20171226%         then the \structe{wavelet subspace} $\spW_0$ is 
%20171226%         \prope{orthnormal} to the \structe{scaling subspace} $\spV_0$ ($\spW_0\orthog\spV_0$)\ifsxref{ortho}{thm:ortho_qmr}.
%20171226%\end{tabular}
%20171226%
%20171226%%---------------------------------------
%20171226%\begin{theorem}
%20171226%%\label{thm:cqf}
%20171226%%---------------------------------------
%20171226%Let $\wavsys$ be a \structe{wavelet system} \xref{def:wavsys}.
%20171226%Let $\Dg(\omega)$ be the \ope{DTFT} \xref{def:dtft} and $\Zg(z)$ the \ope{Z-transform} \xref{def:opZ} of $\seqn{\fg_n}$.
%20171226%\thmbox{
%20171226%  \begin{array}{>{\ds}rc >{\ds}rcl @{\qquad}D}
%20171226%  \mcom{\fg_n = \pm(-1)^n h^\ast_{\xN-n},\,{\scy\xN\in\Z}}{\structe{conjugate quadrature filter}}
%20171226%      &\iff&     \Dg(\omega)                   &=& \pm (-1)^\xN e^{-i\omega\xN} \Dh^\ast(\omega+\pi)\Big|_{\omega=\pi}   & (1)
%20171226%    \\&\implies& \sum_{n\in\Z} (-1)^n\fg_n      &=& \sqrt{2}                                                              & (2)
%20171226%    \\&\iff&     \Zg(z)\Big|_{z=-1}            &=& \sqrt{2}                                                              & (3)
%20171226%    \\&\iff&     \Dg(\omega)\Big|_{\omega=\pi} &=& \sqrt{2}                                                              & (4)
%20171226%  \end{array}}
%20171226%\end{theorem}
%20171226%\begin{proof}
%20171226%  \begin{enumerate}
%20171226%    \item Proof that CQF$\iff$(1): by \prefp{thm:cqf}
%20171226%
%20171226%    \item Proof that CQF$\implies$(4):
%20171226%      \begin{align*}
%20171226%        \Dg(\pi)
%20171226%          &= \Dg(\omega)\Big|_{\omega=\pi}
%20171226%        \\&= \pm (-1)^\xN e^{-i\omega\xN} \Dh^\ast(\omega+\pi)\Big|_{\omega=\pi}
%20171226%          && \text{by \prefp{thm:cqf}}
%20171226%        \\&= \pm (-1)^\xN e^{-i\pi\xN} \Dh^\ast(2\pi)
%20171226%        \\&= \pm (-1)^\xN (-1)^\xN \Dh^\ast(0)
%20171226%          && \text{by \prefp{prop:dtft_2pi}}
%20171226%        \\&= \sqrt{2}
%20171226%          && \text{by \thme{admissibility condition} \xref{thm:admiss}}
%20171226%      \end{align*}
%20171226%
%20171226%    \item Proof that (2)$\iff$(3)$\iff$(4): by \prefp{prop:dsp_zminone}
%20171226%  \end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%
%20171226%%=======================================
%20171226%\section{Examples}
%20171226%%=======================================
%20171226%%Under the very general constraints of this chapter, I know of no wavelet examples.
%20171226%No examples of wavelets are presented in this section. 
%20171226%Examples begin in the next chapter which is about a property called the \prope{partition of unity}.
%20171226%%The very minimal of requirements, it seems is a \prope{partition of unity} \xref{chp:pounity}.
%20171226%Other design constraints leading to wavelets with more ``powerful" properties include 
%20171226%\prope{vanishing moments} \xref{chp:vanish}, \prope{orthonormality}\ifsxref{ortho}{chp:ortho},
%20171226%\prope{compact support}\ifsxref{compactp}{chp:compactp}, and \prope{minimum phase} \xref{def:ztr_minphase}.
%20171226%
%20171226%Here are some examples of \structe{wavelet systems} \xref{def:wavsys}:
%20171226%\begin{longtable}{|l||ll||c|c|c|c|c|}
%20171226%  \hline
%20171226%  Name   & \mc{2}{||c|}{Reference} & \rotatebox{75}{\prope{partition of unity}} 
%20171226%                                   & \rotatebox{75}{\prope{vanishing moments}} 
%20171226%                                   & \rotatebox{75}{\prope{orthonormality}} 
%20171226%                                   & \rotatebox{75}{\prope{compact support}}
%20171226%                                   & \rotatebox{75}{\prope{minimum phase}}
%20171226%%         &          &       & \xref{chp:pounity}         & \xref{chp:vanish}         & \xref{chp:ortho}       & \xref{chp:compactp}
%20171226%  \\\hline
%20171226%  %Haar             & \scs\pref{ex:pun_n=2}       & \scs\prefpo{ex:pun_n=2}       & $\checkmark$ & 1 & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
%20171226%  %order 1 B-spline & \scs\pref{ex:sw_gh_tent}    & \scs\prefpo{ex:sw_gh_tent}    & $\checkmark$ & 2 & $          $ & $          $ & $          $ \\
%20171226%  %order 3 B-spline & \scs\pref{ex:sw_gh_bspline} & \scs\prefpo{ex:sw_gh_bspline} & $\checkmark$ & 4 & $          $ & $          $ & $          $ \\
%20171226%  order 0 B-spline & \pref{ex:N0_hg}                          & \prefpo{ex:N0_hg} & $\checkmark$ & 1 & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
%20171226%  order 1 B-spline & \pref{ex:N1_hg}                          & \prefpo{ex:N1_hg} & $\checkmark$ & 2 & $          $ & $          $ & $          $ \\
%20171226%  order 2 B-spline & \pref{ex:N2_hg}                          & \prefpo{ex:N2_hg} & $\checkmark$ & 4 & $          $ & $          $ & $          $ \\
%20171226%  Daubechies-p2    & \ifdochas{compactp}{\pref{ex:dau-p2}}    & \ifdochas{compactp}{\prefpo{ex:dau-p2}}        & $\checkmark$ & 2 & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
%20171226%  Daubechies-p3    & \ifdochas{compactp}{\pref{ex:dau-p3}}    & \ifdochas{compactp}{\prefpo{ex:dau-p3}}        & $\checkmark$ & 3 & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
%20171226%  Symlet-p4        & \ifdochas{compactp}{\pref{ex:symlet_p4}} & \ifdochas{compactp}{\prefpo{ex:symlet_p4}}     & $\checkmark$ & 4 & $\checkmark$ & $\checkmark$ & $          $ \\
%20171226%  \hline
%20171226%\end{longtable}
%20171226%
%20171226%
%20171226%
%20171226%
%20171226%%================================================================================
%20171226%%================================================================================
%20171226%%================================================================================
%20171226%%================================================================================
%20171226%%================================================================================
%20171226%
%20171226%%\paragraph{Fourier Transform.}
%20171226%%One of the most widely used transforms is the Fourier transform.
%20171226%%The Fourier Transform is an integral operator with an exponential kernel.
%20171226%%And what is so special about exponential kernels?
%20171226%%Is it just that they were discovered sooner than other kernels with other transforms?
%20171226%%The answer in general is ``no".
%20171226%%The exponential has two properties that makes it extremely special:
%20171226%%  \begin{liste}
%20171226%%    \item The exponential is an eigenvalue of any LTI operator \xref{thm:Le=he}
%20171226%%    \item The exponential generates a continuous point spectrum for the differential operator
%20171226%%          \xref{thm:spec_D}
%20171226%%  \end{liste}
%20171226%%
%20171226%%\thmbox{
%20171226%%  \left.\begin{array}{ll}
%20171226%%    1. & \text{$\opL$ is linear and} \\
%20171226%%    2. & \text{$\opL$ is time-invariant}
%20171226%%  \end{array}\right\}
%20171226%%  \qquad\implies\qquad
%20171226%%    \opL \lkerne{t}{s}
%20171226%%    =
%20171226%%    \mcomr{\Lh^\ast(-s)}{eigenvalue} \mcoml{\lkerne{t}{s}}{eigenvector}
%20171226%%  }
%20171226%%
%20171226%%
%20171226%%What makes wavelet system unique from other analysis systems
%20171226%%(such as Fourier analysis) is its \hie{subspace architecture}.
%20171226%%In this section, we present this architecture using four representations:
%20171226%%
%20171226%%\begin{tabular}{lp{\tw/2}ll}
%20171226%%  \circOne   & lattice of subspaces             \dotfill&\pref{sec:wav_lat_subspace} & \xref{sec:wav_lat_subspace} \\
%20171226%%  \circTwo   & lattice of projection operators  \dotfill&\pref{sec:wav_lat_op}       & \xref{sec:wav_lat_op} \\
%20171226%%  \circThree & lattice of bases vectors         \dotfill&\pref{sec:wav_lat_bases}    & \xref{sec:wav_lat_bases} \\
%20171226%%  \circFour  & lattice of bases coefficients    \dotfill&\pref{sec:wav_lat_coef}     & \xref{sec:wav_lat_coef} \\
%20171226%%\end{tabular}
%20171226%%
%20171226%%\prefp{thm:wav_lat_iso} will show that all four of these representations are
%20171226%%essentially equivalent (are isomorphisms).
%20171226%%The wavelet system itself is simply a collection of the projection operators
%20171226%%\xref{def:wav_transform} found in the wavelet operator lattice.
%20171226%
%20171226%
%20171226%