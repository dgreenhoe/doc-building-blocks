%============================================================================
% LaTeX File
% Daniel J. Greenhoe
%============================================================================
%======================================
%\section{Expectation operator}
%\label{chp:stats}
%======================================
%---------------------------------------
\begin{definition}
%\footnote{
  \citerpgc{papoulis1984}{104}{0070484686}{``5-3 {\scshape Mean and variance}"},
  \citerpgc{bendat1980}{30}{0471058874}{``2.2.1 Expected Values and Moments"\ldots(2.11)},
  \citerpgc{bendat2010}{49}{1118210824}{``3.1.2 Expected Values"\ldots(3.8)}
%  }
\label{def:pE}
%---------------------------------------
Let $\ps$ be a \structe{probability space} and
$\rvX$ a \fncte{random variable} on $\ps$ with
\fncte{probability density function} $\ppx$.
\defboxt{
  The \opd{expectation operator} $\pEx$ on $\rvX$ is defined as
  \quad\quad$\ds\pEx\rvX \eqd \int_{x\in\F} x \ppx(x) \dx$.
}
\end{definition}

%---------------------------------------
\begin{proposition}[\thme{Linearity of $\pE$}]
%\footnote{
  \citerpgc{papoulis1984}{107}{0070484686}{``{\itshape Linearity}\ldots(5-31)"},
  \citerpgc{bendat1980}{30}{0471058874}{``2.2.1 Expected Values and Moments"\ldots(2.12)},
%  }
\label{prop:pE_linop}
%---------------------------------------
Let $\rvX$ be a \fncte{random variable} on a \structe{probability space} $\ps$.
\thmbox{\begin{array}{>{\ds}rc>{\ds}lCD}
    \pEx(a\rvX+b\rvY+c)&=& \brp{a\pEx\rvX} + \brp{b\pEx\rvY} + c& \forall a,b,c\in\R & (\prope{linear})
\end{array}}
\end{proposition}
\begin{proof}
\begin{align*}
  \pExy(a\rvX+b\rvY + c)
    &\eqd \int_{x\in\R}\int_{y\in\R}\brs{ax+by+c} \pdfxy(x,y)  \dy\dx
    \qquad\text{by definition of $\pE$ \xref{def:pE}}
  \\&= \int_{x\in\R}\int_{y\in\R} ax \pdfxy(x,y)  \dy\dx
     + \int_{x\in\R}\int_{y\in\R} by \pdfxy(x,y)  \dy\dx
     + \int_{x\in\R}\int_{y\in\R} c  \pdfxy(x,y)  \dy\dx
     %&& \text{by \prope{lineararity} of $\int\int\dy\dx$}
     %&& \text{\xref{def:linop}}
  \\&=  \int_{x\in\R} ax \mcom{\int_{y\in\R}\pdfxy(x,y)  \dy}{$\pdfx(x)$}\dx
     +  \int_{y\in\R} by \mcom{\int_{x\in\R}\pdfxy(x,y)  \dx}{$\pdfy(y)$}\dy
     + c\mcom{\int_{y\in\R}\int_{x\in\R}\pdfxy(x,y)  \dx\dy}{$1$}
     %&& \text{by \prope{lineararity} of $\int\int\dy\dx$}
     %&& \text{\xref{def:linop}}
  \\&= a\mcom{\int_{x\in\R} x \pdfx(x) \dx}{$\pE\rvX$}
     + b\mcom{\int_{y\in\R} y \pdfy(y) \dy}{$\pE\rvY$}
     + c
  \\&= \brp{a\pEx\rvX} + \brp{b\pEy\rvY} + c
\end{align*}
\end{proof}

