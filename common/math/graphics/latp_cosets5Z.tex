%============================================================================
% Daniel J. Greenhoe
% LaTeX file
% wavelet subspace lattice with prime number illustration
%============================================================================
  \begin{pspicture}(-3,-0.40)(3,3.60)%
  \psset{
    boxsize=0.40\psunit,
    linearc=0.40\psunit,
    }%
  \fns%
      %---------------------------------
      % nodes
      %---------------------------------
      \Cnode( 0,0){glb}%    0
      \Cnode( 0,3){Z}%    1
      \Cnode(-1,1){p3}% 
      \Cnode( 0,1){p5}%
      \Cnode( 1,1){p7}%
      \Cnode( 2,1){p11}%
      \Cnode(-2,1){p2}%
      \Cnode(-1.5,1.5){q6}% q6
      \Cnode(-1,2){q30}% q30
      \Cnode(-0.5,2.5){q210}% q30
      %---------------------------------
      % node labels
      %---------------------------------
      \uput{1.5mm}[0](Z)  {$\Z=y_3\setu y_4$}%
      \uput{1.5mm}[0](q210) {$y_3\eqd y_2\setu(3+5\Z)$}%
      \uput{1.5mm}[0](q30) {$y_2\eqd y_1\setu(2+5\Z)$}%
      \uput{1.5mm}[0](q6) {$y_1\eqd(0+5\Z)\setu(1+5\Z)$}%
      \uput{1.5mm}[-90]{-45}(p2) {$0+5\Z$}%
      \uput{1.5mm}[-90]{-45}(p3) {$1+5\Z$}%
      \uput{1.5mm}[-90]{-45}(p5) {$2+5\Z$}%
      \uput{1.5mm}[-90]{-45}(p7) {$3+5\Z$}%
      \uput{1.5mm}[-90]{-45}(p11){$4+5\Z$}%
      \uput{1.5mm}[-90](glb)  {$\emptyset$}%
      %---------------------------------
      % node connections
      %---------------------------------
      \ncline{glb}  {p2}%  0    --> p2
      \ncline{glb}  {p3}%  0    --> p3
      \ncline{glb}  {p5}%  0    --> p5
      \ncline{glb}  {p7}%  0    --> p7
      \ncline{glb}  {p11}% 0    --> W_{n-1}
      \ncline{p11}{Z}%   Wn-1 --> 1
      \ncline{p2} {q6}%  p2   --> q6
      \ncline{p3} {q6}%  p3   --> q6
      \ncline{q6} {q30}%  q6   --> q30
      \ncline{q30} {q210}%  
      \ncline{q210} {Z}%  
      %\rput{45}(-50,250){{\color{blue}\Large$\cdots$}}%
      %\rput[c]{ 0}(100,100){{\color{blue}\Large$\cdots$}}%
      \ncline{p5}{q30}%   p5 --> q30
      \ncline{p7}{q210}%   p5 --> q30
      %---------------------------------
      % discriptions
      %---------------------------------
      \ncbox[nodesep=.25\psunit,linestyle=dotted,linecolor=red]{p2}{p11}%
      %\ncbox[nodesep=.25\psunit,linestyle=dotted,linecolor=red]{p2}{Z}%
      \pnode[0,-.40](p11){wavsubbox}%  
      \pnode[0,.60](q30){scalesubbox}%
      %\ncline[linecolor=red]{->}{wavsublabel}{wavsubbox}%
      %\ncline[linecolor=red]{->}{scalesublabel}{scalesubbox}%
      \rput[b](0,1.1){\rnode{wavsublabel}{cosets/partition of $\Z$}}%
      %\rput[bl]{45}(-2.4,1.6){\rnode{scalesublabel}{}}%
      %---------------------------------
      % debug support
      %---------------------------------
%      \psgrid[unit=10\psunit](-30,-10)(30,40)%
      %\psgrid[unit=100\psunit](-3,-1)(3,4)%
  \end{pspicture}%
