%============================================================================
% Daniel J. Greenhoe
% LaTeX File
%============================================================================

%=======================================
\chapter{Partition of Unity Constraint}
%=======================================

%=======================================
\section{Definition and motivation}
%=======================================
\begin{figure}[ht] \color{figcolor}
\begin{center}
  \psset{
    doubleline=true,
    nodesep=2mm,
    }
  \begin{tabular}{ccc}
                                & \rnode{pounityp}{partition of unity} &\\
  \rnode{pounityq}{quadrature}  & \parbox[][30mm][]{30mm}{\mbox{}}     & \rnode{pounityz}{zero at $z=-1$}\\
                                & \rnode{pounityo}{orthonormality}
  \end{tabular} %{thm:pun_zero}
  \ncline{->}{pounityo}{pounityp}
  \ncline{->}{pounityo}{pounityq}
  \ncline{->}{pounityo}{pounityz}
  \ncline{->}{pounityq}{pounityz}
  \ncline{->}{pounityq}{pounityp}
  \ncline{<->}{pounityp}{pounityz}
\end{center}
\caption{
   Implications of scaling function properties
   \label{fig:phi_prop}
   }
\end{figure}

A very common property of scaling functions \xrefP{def:mra} is the \prope{partition of unity} property \xrefP{def:pun}.
The partition of unity is a kind of generalization of \prope{orthonormality}\ifsxref{vsinprod}{def:orthog};
that is, \emph{all} orthonormal scaling functions form a partition of unity\ifsxref{ortho}{thm:quad=>zero_unity}.
But the partition of unity property is not just a consequence of orthonormality, but
also a generalization of orthonormality, in that if you remove the
orthonormality constraint, the partition of unity is still a
reasonable constraint in and of itself.

There are two reasons why the partition of unity property is a reasonable
constraint on its own:
\begin{liste}
   \item Without a partition of unity, it is difficult to represent a function as simple as a
         constant.\footnote{\citePp{jawerth}{8}}

  \item For a multiresolution system $\mrasys$, the partition of unity property is equivalent to
        $\sum_{n\in\Z} (-1)^n h_n = 0$ \xrefP{thm:pun_zero}.
        As viewed from the perspective of \hi{discrete time signal processing} \xref{app:dsp},
        %\footnote{\hie{discrete time signal processing}: see \prefpp{app:dsp}.}
        this implies that the scaling coefficients form a ``\structe{lowpass filter}";
        lowpass filters provide a kind of ``coarse approximation"
        of a function. And that is what the scaling function is ``supposed" to do---to provide a coarse approximation
        at some resolution or ``scale" \xrefP{def:mra}.
\end{liste}

%-------------------------------------
\begin{definition}
\index{partition of unity}
\footnote{
  \citerpg{kelley1955}{171}{0387901256},
  \citerpg{munkres2000}{225}{0131816292},
  \citerpg{klaus1984}{116}{0387908927},
  \citerpc{willard1970}{152}{item 20C},
  \citerpgc{willard2004}{152}{0486434796}{item 20C}
  }
\label{def:pun}
%-------------------------------------
\defbox{\begin{array}{M}
  {A function $\ff\in\spRR$ forms a \hid{partition of unity} if}
  \\\indentx$\ds\sum_{n\in\Z} \opTrn^n\ff(x) = 1 \qquad \forall x\in\R$.
\end{array}}
\end{definition}

%=======================================
\section{Scaling functions with partition of unity}
%=======================================

%\ifdochaselse{sequence}{\prefpp{prop:twz} demonstrates that the}{The}
The $Z$ transform \xrefP{def:opZ} of a sequence $\seqn{h_n}$
with sum $\sum_{n\in\Z} (-1)^n\fh_n=0$ has a zero at $z=-1$.
Somewhat surprisingly, the \prope{partition of unity} and
\prope{zero at $z=-1$} properties are actually equivalent (next theorem).

\begin{center}
\begin{tabular}{cc}
  \includegraphics{../common/math/graphics/pdfs/pounityz.pdf}%
 &\includegraphics{../common/math/graphics/pdfs/Fhw.pdf}
\end{tabular}
\end{center}

%--------------------------------------
\begin{theorem} %[Partition of unity]
\footnote{
  \citePp{jawerth}{8},
  \citerp{chui}{123}
  }
\label{thm:pun_zero}
\index{zero at $z=-1$}
\index{partition of unity}
\index{sum of even}
\index{sum of odd}
%--------------------------------------
Let $\mrasys$ be a \structe{multiresolution system} \xref{def:mrasys}. % wavelet system.
Let $\opFT\ff(\omega)$ be the \fncte{Fourier transform} \xref{def:opFT} of a function $\ff\in\spLLR$.
Let $\kdelta_n$ be the \fncte{Kronecker delta function}\ifsxref{frames}{def:kdelta}.
Let $c$ be some contant in $\R\setd0$.
\thmbox{
  \mcom{\sum_{n\in\Z} \opTrn^n \fphi = c}
       {(1) \prope{partition of unity}}
  \quad\iff\quad
  \mcom{\sum_{n\in\Z} (-1)^n\fh_n=0}
       {(2) \prope{zero at $z=-1$}}
  \quad\iff\quad
  \mcom{\sum_{n\in\Z}\fh_{2n} = \sum_{n\in\Z}\fh_{2n+1} = \cwt}
       {(3) sum of even = sum of odd = $\cwt$}
  }
\end{theorem}
\begin{proof}
Let $\Ze$ be the set of even integers and $\Zo$ the set of odd integers.
\begin{enumerate}
\item Proof that (1)$\impliedby$(2):
\begin{align*}
  \sum_{n\in\Z} \opTrn^n \fphi
    &= \sum_{n\in\Z} \opTrn^n \brs{\sum_{m\in\Z}\fh_m \opDil \opTrn^m \fphi}
    && \text{by \thme{dilation equation}} && \text{\xref{thm:dilation_eq}}
  \\&= \sum_{m\in\Z}\fh_m \sum_{n\in\Z} \opTrn^n \opDil \opTrn^m \fphi
  \\&= \sum_{m\in\Z}\fh_m \sum_{n\in\Z} \opDil \opTrn^{2n} \opTrn^m \fphi
    && \text{by \thme{commutator relation}} && \text{\xref{prop:DTTD}}
  \\&= \opDil \sum_{m\in\Z}\fh_m \sum_{n\in\Z} \opTrn^{2n} \opTrn^m \fphi
    %&& \text{by \prefp{prop:opTD_sum}}
  \\&= \opDil \sum_{m\in\Z}\fh_m \brs{\sqrt{\frac{2\pi}{2}}\opFSi\opS_2\opFT\brp{\opTrn^m \fphi}}
    && \text{by \thme{PSF}} && \text{\xref{thm:psf}}
  \\&= \sqrt{\pi} \opDil \sum_{m\in\Z}\fh_m \opFSi\opS_2 e^{-i\omega m}\opFT\fphi
    && \text{by \prefp{cor:FTD}}
  \\&= \sqrt{\pi} \opDil \sum_{m\in\Z}\fh_m \opFSi e^{-i\frac{2\pi}{2}k m}\opS_2 \opFT\fphi
    && \text{by definition of $\opS$}
    && \text{\xref{def:opS}}
  \\&= \sqrt{\pi} \opDil \sum_{m\in\Z}\fh_m \opFSi \brp{-1}^{km} \opS_2 \opFT\fphi
  \\&= \sqrt{\pi} \opDil \sum_{m\in\Z}\fh_m \brs{\cwt \sum_{k\in\Z} \brp{-1}^{km} \brp{\opS_2 \opFT\fphi} e^{i\frac{2\pi}{2}kx}}
    && \text{by definition of $\opFSi$} && \text{\xref{thm:opFSi}}
  \\&= \frac{\sqrt{2\pi}}{2} \opDil \sum_{k\in\Z}  \brp{\opS_2 \opFT\fphi} e^{i\pi kx}\sum_{m\in\Z} \brp{-1}^{km}\fh_m
  \\&=\mathrlap{%
        \frac{\sqrt{2\pi}}{2} \opDil \sum_{k\in\Ze} \brp{\opS_2 \opFT\fphi} e^{i\pi kx}\sum_{m\in\Z} \brp{-1}^{km}\fh_m
       +\frac{\sqrt{2\pi}}{2} \opDil \sum_{k\in\Zo}  \brp{\opS_2 \opFT\fphi} e^{i\pi kx}\sum_{m\in\Z} \brp{-1}^{km}\fh_m
       }%
  \\&=\mathrlap{
        \frac{\sqrt{2\pi}}{2} \opDil \sum_{k\in\Ze} \brp{\opS_2 \opFT\fphi} e^{i\pi kx} \mcom{\sum_{m\in\Z}\fh_m}{$\sqrt{2}$}
       +\frac{\sqrt{2\pi}}{2} \opDil \sum_{k\in\Zo}  \brp{\opS_2 \opFT\fphi} e^{i\pi kx} \mcom{\sum_{m\in\Z} \brp{-1}^m\fh_m }{$0$}
       }%
  \\&= \sqrt{\pi} \opDil \sum_{k\in\Ze} \brp{\opS_2 \opFT\fphi} e^{i\pi kx}
    && \text{by \prefpp{thm:admiss}}&& \text{and right hypothesis}
  \\&= \sqrt{\pi} \opDil \sum_{k\in\Ze} \Fphi\brp{\frac{2\pi}{2}k} e^{i\pi kx}
    && \text{by definitions of $\opFT$ and $\opS_2$}
  \\&= \sqrt{\pi} \opDil \sum_{k\in\Z} \Fphi\brp{2\pi k} e^{i2\pi kx}
    && \text{by definition of $\Ze$}
  \\&= \frac{1}{\sqrt{2}}\opDil \brb{\sqrt{2\pi} \sum_{k\in\Z} \Fphi\brp{2\pi k} e^{i2\pi kx}}
  \\&= \frac{1}{\sqrt{2}}\opDil \sum_{n\in\Z}\fphi(x+n)
    && \text{by \thme{PSF}} && \text{\xref{thm:psf})}
  \\&= \frac{1}{\sqrt{2}}\opDil \sum_{n}\opTrn^n\fphi
    && \text{by definition of $\opTrn$} && \text{\xref{def:opT}}
\end{align*}

The above equation sequence demonstrates that
  \\\indentx$\ds\opDil\sum_n\opTrn^n\fphi = \sqrt{2}\sum_n\opTrn^n\fphi$\\
(essentially that $\sum_n\opTrn^n\fphi$ is equal to it's own dilation).
This implies that $\sum_n\opTrn^n\fphi$ is a constant \xref{prop:opD_constant}.

\item Proof that (1)$\implies$(2):
\begin{align*}
  c &= \sum_{n\in\Z} \opTrn^n \fphi
    && \text{by left hypothesis}
  \\&= \sqrt{2\pi}\: \opFSi \opS \opFT \fphi
    && \text{by \thme{PSF}} && \text{\xref{thm:psf}}
  \\&= \sqrt{2\pi}\: \opFSi \opS
       \mcom{\sqrt{2}
         \brp{\opDili\sum_{n\in\Z}\fh_n e^{-i\omega n}}\:
         \brp{\opDili \opFT \fphi}
       }{$\opFT\fphi$}
    && \text{by \prefp{lem:Fphi}}
  \\&= 2\sqrt{\pi}\: \opFSi
       \brp{\opS\opDili\sum_{n\in\Z}\fh_n e^{-i\omega n}}\:
       \brp{\opS \opFT\opDil \fphi}
    && \text{by \prefp{cor:FTD}}
  \\&= 2\sqrt{\pi}\: \opFSi
       \brp{\opS\frac{1}{\sqrt{2}}\sum_{n\in\Z}\fh_n e^{-i\frac{\omega}{2} n}}\:
       \brp{\opS \opFT\opDil \fphi}
    && \text{by evaluation of $\opDili$} && \text{\xref{prop:opDi}}
  \\&= \sqrt{2\pi}\: \opFSi
       \brp{\sum_{n\in\Z}\fh_n e^{-i\frac{2\pi k}{2} n}}\:
       \brp{\opS \opFT\opDil \fphi}
    && \text{by definition of $\opS$}
    && \text{\xref{def:opS}}
  \\&= \sqrt{2\pi}\: \opFSi
       \brp{\sum_{n\in\Z}\fh_n (-1)^{kn}}\:
       \brp{\opS \opDili\opF \fphi}
  \\&= \sqrt{2\pi}\: \opFSi
       \brp{\sum_{n\in\Z}\fh_n (-1)^{kn}}\:
       \brp{\opS\frac{1}{\sqrt{2}}\Fphi\brp{\frac{\omega}{2}}}
    && \text{by definition of $\opS$} %&& \text{\xref{thm:psf}}
    && \text{\xref{def:opS}}
  \\&= \sqrt{2\pi}\: \opFSi
       \brp{\sum_{n\in\Z}\fh_n (-1)^{kn}}\:
       \brp{\frac{1}{\sqrt{2}}\Fphi\brp{\frac{2\pi k}{2}}}
  %\\&= \sqrt{\pi}\: \opFSi
  %     \brp{\sum_{n\in\Z}\fh_n (-1)^{kn}}\:
  %     \brp{\Fphi\brp{\frac{2\pi k}{2}}}
  \\&= \sqrt{\pi}\: \sum_{k\in\Z}
       \sum_{n\in\Z}\fh_n (-1)^{kn}\:
       \Fphi\brp{\pi k}
       e^{i 2\pi kx}
    && \text{by definition of $\opFSi$} && \text{\xref{thm:opFSi}}
  \\&= \mathrlap{%
       \sqrt{\pi}
       \sum_{\text{$k$ even}}
       \sum_{n\in\Z}\fh_n (-1)^{kn}\:
       \Fphi\brp{\pi k}
       e^{i 2\pi kx}
       +
       \sqrt{\pi}
       \sum_{\text{$k$ odd}}
       \sum_{n\in\Z}\fh_n (-1)^{kn}\:
       \Fphi\brp{\pi k}
       e^{i 2\pi kx}
       }
  \\&= \mathrlap{%
       \sqrt{\pi}
       \sum_{\text{$k$ even}}
       \brp{\cancelto{\sqrt{2}}{\sum_{n\in\Z}\fh_n}} \:
       \Fphi\brp{\pi k}
       e^{i 2\pi kx}
       +
       \sqrt{\pi}
       \sum_{\text{$k$ odd}}
       \brp{\sum_{n\in\Z}\fh_n (-1)^{n}}\:
       \Fphi\brp{\pi k}
       e^{i 2\pi kx}
       }
  \\&= \mathrlap{%
       \sqrt{\pi}\sum_{k\in\Z}
       \sqrt{2} \:
       \Fphi\brp{\pi 2k}
       e^{i 2\pi 2k x}
       +
       \sqrt{\pi}\sum_{k\in\Z}
       \brp{\sum_{n\in\Z}\fh_n (-1)^{n}}\:
       \Fphi\brp{\pi [2k+1]}
       e^{i 2\pi [2k+1] x}
       \quad\text{by \prefp{thm:admiss}}
       }
  \\&= \frac{\sqrt{2\pi}}{\sqrt{2\pi}}
       \Fphi\brp{0}
       %e^{0}
       +
       \sqrt{\pi}e^{i 2\pi x}\sum_{n\in\Z}\fh_n (-1)^{n}\:
       \sum_{k\in\Z}
       \Fphi\brp{\pi [2k+1]}
       e^{i 4\pi kx}
    && \mathrlap{\text{by left hypothesis and \prefp{thm:pounity_freq}}}
%
%
%
%  \\&= \sqrt{\pi}\sum_{k\in\Z}\brs{
%       \sqrt{2}
%       \Fphi\brp{2\pi k}
%       +
%       \brp{\sum_{n\in\Z}\fh_n (-1)^{n}}\:
%       \Fphi\brp{\pi [2k+1]}
%       e^{i 2\pi x}
%       }e^{i 4\pi kx}
%  \\&= \sqrt{\pi}\brs{
%       \sqrt{2}
%       \Fphi(0)
%       +
%       \brp{\sum_{n\in\Z}\fh_n (-1)^{n}}\:
%       \Fphi(\pi)
%       e^{i 2\pi x}
%       }
%    && \text{$k$ must be $0$ to make real constant for all $t$}
  \\&\implies \qquad \brp{\sum_{n\in\Z}\fh_n (-1)^{n}}=0
    && \mathrlap{\text{because the right side must equal $c$}}
\end{align*}

%\end{enumerate}
%\end{proof}
%
%
%%-------------------------------------
%\begin{theorem}
%\label{thm:zero_unity_evenodd}
%\footnote{
%  \citerp{chui}{123}
%  }
%\index{zero at $z=-1$}
%\index{partition of unity}
%\index{sum of even}
%\index{sum of odd}
%%-------------------------------------
%Let $\wavsys$ be a \hi{wavelet system}.
%\thmbox{
%  \mcom{\sum_{n\in\Z} \fphi(x-n)=\int_\R\fphi(x)\dx }
%       {(1) partition of unity}
%  \iff
%  \mcom{\sum_{n\in\Z} (-1)^n \fh_n  = 0 }
%       {(2) zero at $z=-1$}
%  \iff
%  \mcom{\sum_{n\in\Z} \fh_{2n} = \sum_{n\in\Z} \fh_{2n+1} = \frac{1}{\sqrt{2}}}
%       {(3) sum of even = sum of odd = $\cwt $}
%  }
%\end{theorem}
%\begin{proof}
%Let $\Fh(\omega)\eqd\sum_{n\in\Z} \fh_n \fkernea{x}{\omega}$.
%\begin{enumerate}
%
%%\item Proof that $\sum_n(-1)^n \fh_n =0 \implies \sum_n\fphi(x-n)=\int_t\fphi(x)\dt$:
%%\[\begin{array}{rclllllll}
%%  \Fphi(\omega) &=& \frac{1}{\sqrt{2}}\Fh(\omega/2) \Fphi(\omega/2) \\
%%  \Fphi(2\pi k) &=& \frac{1}{\sqrt{2}}\Fh(\pi k) \Fphi(\pi k) \\
%%  \Fphi(2\pi 0) &=& \frac{1}{\sqrt{2}}\Fh(\pi 0) \Fphi(\pi 0)
%%                &=& \frac{1}{\sqrt{2}}\sqrt{2}   \int_t\fphi(x)\dt
%%                &=& \int_t\fphi(x)\dt \\
%%  \Fphi(2\pi 1) &=& \frac{1}{\sqrt{2}}\Fh(\pi ) \Fphi(\pi )
%%                &=& \frac{1}{\sqrt{2}} 0 \Fphi(\pi )
%%                &=& 0 \\
%%  \Fphi(2\pi 2) &=& \frac{1}{\sqrt{2}}\Fh(2\pi ) \Fphi(2\pi )
%%                &=& \frac{1}{\sqrt{2}}\Fh(2\pi ) 0
%%                &=& 0 \\
%%  \Fphi(2\pi 3) &=& \frac{1}{\sqrt{2}}\Fh(3\pi ) \Fphi(3\pi )
%%                &=& \frac{1}{\sqrt{2}}\Fh(\pi ) \Fphi(3\pi )
%%                &=& \frac{1}{\sqrt{2}} 0 \Fphi(3\pi )
%%                &=& 0 \\
%%  \Fphi(2\pi 4) &=& \frac{1}{\sqrt{2}}\Fh(4\pi ) \Fphi(4\pi )
%%                &=& \frac{1}{\sqrt{2}}\Fh(4\pi ) 0
%%                &=& 0 \\
%%  \vdots \\
%%  \Fphi(2\pi k) &=& \kdelta_k \int_t\fphi(x)\dt
%%\end{array}\]
%%$\ds \implies \sum_{n\in\Z} \fphi(x-n)=\int_t\fphi(x)\dt$
%%(by \prefp{thm:pounity_freq}).
%
%\item Proof that (2) $\implies$ (1):
%\begin{align*}
%  \sum_{n\in\Z} \fphi(x-n)
%    &= \sum_{n\in\Z} \left[ \sqrt{2} \sum_{m\in\Z}\fh_m \fphi(2t-2n-m) \right]
%    && \text{by \thme{dilation equation} (\prefpo{thm:h->phi})}
%  \\&= \sqrt{2} \sum_{m\in\Z}\fh_m \sum_{n\in\Z} \fphi(2t-2n-m)
%  \\&= \sqrt{2}\sum_{m\in\Z}\fh_m \frac{1}{2}\sum_{k\in\Z} \Fphi\left(\frac{2\pi k}{2}\right) e^{i\frac{2\pi}{2}k(2x-m)}
%    && \text{by \thme{PSF} (\prefpo{thm:psf})}
%  \\&= \cwt  \sum_{k\in\Z} \Fphi(\pi k) e^{i2\pi kx} \sum_{m\in\Z}\fh_m e^{-i\pi km}
%  \\&= \cwt  \sum_{k\in\Z} \Fphi(\pi k) e^{i2\pi kx} \sum_{m\in\Z}\fh_m (-1)^{km}
%  \\&= \cwt  \sum_{\text{$k$ even}} \Fphi(\pi k) e^{i2\pi kx} \sum_{m\in\Z}\fh_m (-1)^{km}
%    \\&\qquad+ \cwt  \sum_{\text{$k$ odd}}  \Fphi(\pi k) e^{i2\pi kx} \sum_{m\in\Z}\fh_m (-1)^{km}
%  \\&= \cwt  \sum_{k\in\Z}  \Fphi(\pi 2k   ) e^{i2\pi 2kx}    \cancelto{\sqrt{2}}{\sum_{m\in\Z}\fh_m }
%     \\&\qquad+ \cwt  \sum_{k\in\Z}  \Fphi(\pi[2k+1]) e^{i2\pi(2k+1)x} \cancelto{0}{\sum_{m\in\Z} (-1)^m\fh_m }
%  \\&= \sum_{k\in\Z}  \Fphi(2\pi k) e^{i4\pi kx}
%    && \text{by left hypothesis}
%  \\&= \Fphi(0) + \mcom{\sum_{k\ne 0}  \Fphi(2\pi k) e^{i4\pi kx}}{0 because no imaginary part $\forall x$}
%    && \text{because $\sum_{n\in\Z} \fphi(x-n)$ has no imag. part}
%  \\&= \Fphi(0)
%  \\&= \left.\int_t \fphi(x) \fkernea{x}{\omega} \dt \right|_{\omega=0}
%  \\&= \int_t \fphi(x) \dt
%\end{align*}
%
%\item Proof that (2) $\impliedby$ (1):
%\begin{align*}
%  \sum_n(-1)^n \fh_n
%    &= \Fh(\pi)
%    && \text{by Proposition~\ref{prop:twz} }
%  \\&= \sqrt{2} \frac{\Fphi(2\pi)}{\Fphi(\pi)}
%    && \text{by \prefp{lem:Fphi}}
%  \\&= \sqrt{2} \frac{\kdelta_1}{\Fphi(\pi)}
%    && \text{by right hypothesis and \prefp{thm:pounity_freq}}
%  \\&= \sqrt{2} \frac{0}{\Fphi(\pi)}
%  \\&= 0
%\end{align*}

\item Proof that (2)$\implies$(3):
  \begin{align*}
    \sum_{n\in\Ze}\fh_n = \sum_{n\in\Zo}\fh_n
      &= \frac{1}{2}\sum_{n\in\Z}\fh_n
      && \text{by (2) and \prefp{prop:dsp_zminone}}
    \\&= \cwt
      && \text{by \thme{admissibility condition} \xref{thm:admiss}}
  \end{align*}

\item Proof that (2)$\impliedby$(3):
\begin{align*}
  \cwt
    &= \mcom{\sum_{n\in\Ze} (-1)^n \fh_n}{even terms}
      +\mcom{\sum_{n\in\Zo} (-1)^n \fh_n}{odd terms}
    && \text{by (3)}
  \\&\implies \sum_{n\in\Z} (-1)^n\fh_n = 0
    && \text{by \prefp{prop:dsp_zminone}}
\end{align*}
\end{enumerate}

\end{proof}



Not every function that forms a \prope{partition of unity} is a \structe{basis} for an \structe{MRA},
as formerly stated next and demonstrated by
\prefpp{cnt:pun_sin2} and \prefpp{cnt:pun_rsin}.
%---------------------------------------
\begin{proposition}
%---------------------------------------
\propbox{
  \text{$\fphi(x)$ generates a \prope{partition of unity}}
  \qquad\notimplies\qquad
  \text{$\fphi(x)$ generates an \structe{MRA} system.}
  }
\end{proposition}
\begin{proof}
  By \prefpp{cnt:pun_sin2} and \prefpp{cnt:pun_rsin}.
\end{proof}



%=======================================
\section{Counter Examples}
%\label{sec:examples_pounity}
%=======================================
There are functions that form a \prope{partition of unity}, but yet do \emph{not} satisfy
the \prope{dilation equation} \xref{thm:dilation_eq} \ldots and as such are \emph{not} scaling functions \xrefP{def:mra}.
This section gives some of these counter examples.
%-------------------------------------
\begin{counterex}
\label{cnt:pun_sin2}
%-------------------------------------
Let a function $\fphi$ be defined in terms of the sine function \xref{def:sin} as follows:
\cntbox{\begin{array}{m{\tw-85mm-18mm}m{85mm}}
      $\fphi(x) \eqd \brbl{%
       \begin{array}{>{\ds}lM}
          \sin^2\brp{\frac{\pi}{2}x}  & for $x\in\intcc{0}{2}$  \\
          0    & otherwise
       \end{array}}$
&\includegraphics{../common/math/graphics/pdfs/sinsin02.pdf}
\\Then $\int_\R\fphi(x)\dx=1$ and $\fphi$ induces a \structe{partition of unity}
&\includegraphics{../common/math/graphics/pdfs/sinsin02_pun.pdf}
\\\textbf{but} $\setxZ{\opTrn^n\fphi}$ does \textbf{not} generate an \structe{MRA}.
\end{array}}
\end{counterex}
\begin{proof}
Let $\setind_\setA(x)$ be the \fncte{set indicator function} \xref{def:setind} on a set $\setA$.
\begin{enumerate}
  \item Proof that $\int_\R\fphi(x)\dx=1$:  by \prefpp{ex:pun_sin2}
    %\begin{align*}
    %  \int_\R \fphi(x) \dx
    %    &= \int_\R \sin^2\brp{\frac{\pi}{2}x}\setind_\intcc{0}{2}(x) \dx
    %    && \text{by definition of $\fphi(x)$}
    %  \\&= \int_0^2 \sin^2\brp{\frac{\pi}{2}x} \dx
    %    && \text{by definition of $\setindAx$ \xref{def:setind}}
    %  \\&= \int_0^2 \frac{1}{2}\brs{1-\cos\brp{\pi x}} \dx
    %    && \text{by \prefp{thm:trig_sq}}
    %  \\&= \frac{1}{2}\brs{x-\frac{1}{\pi}\sin\brp{\pi x}}_0^2
    %  \\&= \frac{1}{2}\brs{2-0-0-0}
    %  \\&= 1
    %\end{align*}

  \item Proof that $\fphi(x)$ forms a \prope{partition of unity}: by \prefpp{ex:pun_sin2}
    %\begin{align*}
    %  \sum_{n\in\Z} \opTrn^n\fphi(x)
    %    &= \sum_{n\in\Z} \opTrn^n\sin^2\brp{\frac{\pi}{2}x}\setind_\intcc{0}{2}(x)
    %    && \text{by definition of $\fphi(x)$}
    %  \\&= \sum_{n\in\Z} \opTrn^n\sin^2\brp{\frac{\pi}{2}x}\setind_\intco{0}{2}(x)
    %    && \text{because $\sin^2\brp{\frac{\pi}{2}x}=0$ when $x=2$}
    %  \\&= \sum_{m\in\Z} \opTrn^{m-1}\sin^2\brp{\frac{\pi}{2}x}\setind_\intco{0}{2}(x)
    %    && \text{where $m\eqd n+1$ $\implies$ $n=m-1$}
    %  \\&= \sum_{m\in\Z} \sin^2\brp{\frac{\pi}{2}(x-m+1)}\setind_\intco{0}{2}(x-m+1)
    %    && \text{by definition of $\opTrn$ \xref{def:opT}}
    %  \\&= \sum_{m\in\Z} \sin^2\brp{\frac{\pi}{2}(x-m)+\frac{\pi}{2}}\setind_\intco{-1}{1}(x-m)
    %  \\&= \sum_{m\in\Z} \cos^2\brp{\frac{\pi}{2}(x-m)}\setind_\intco{-1}{1}(x-m)
    %    && \text{by \prefp{thm:trig_sq}}
    %  \\&= \sum_{m\in\Z} \opTrn^m\cos^2\brp{\frac{\pi}{2}x}\setind_\intco{-1}{1}(x)
    %    && \text{by definition of $\opTrn$ \xref{def:opT}}
    %  \\&= \sum_{m\in\Z} \opTrn^m\cos^2\brp{\frac{\pi}{2}x}\setind_\intcc{-1}{1}(x)
    %    && \text{because $\cos^2\brp{\frac{\pi}{2}x}=0$ when $x=1$}
    %  \\&= 1
    %    && \text{by \prefp{ex:pun_cos2}}
    %\end{align*}

  \item Proof that $\fphi(x)\notin\linspan\setxZ{\opDil\opTrn^n\fphi(x)}$ (and so does not generate an \structe{MRA}):
    \begin{enumerate}
      \item Note that the \prope{support} \xref{def:support} of $\fphi$ is $\support\fphi=\intcc{0}{2}$.
      \item Therefore, the \prope{support} of $\seqn{h_n}$ is $\support\seqn{h_n}=\setn{0,1,2}$ \xref{thm:mra_support}.
      \item So if $\fphi(x)$ \emph{is} an \structe{MRA}, we only need to compute $\setn{h_0,h_1,h_2}$ (the rest would be $0$).
            \\\indentx\includegraphics{../common/math/graphics/pdfs/sinsin02hn.pdf}\\
            Here would be the values of $\setn{h_1,h_2,h_3}$:\label{item:sinsin02hn_fig}
        \begin{align*}
          \fphi(x)
            &= \sum_{n\in\Z}\fh_n \opDil\opTrn^n\fphi(x)
          \\&= \sum_{n\in\Z}\fh_n \opDil\opTrn^n\sin^2\brp{\frac{\pi}{2}x}\setind_\intcc{0}{2}(x)
          \\&= \sum_{n\in\Z}\fh_n \sin^2\brp{\frac{\pi}{2}(2x-n)}\setind_\intcc{0}{2}(2x-n)
          \\&= \sum_{n=0}^2\fh_n  \sin^2\brp{\frac{\pi}{2}(2x-n)}\setind_\intcc{0}{2}(2x-n)
            && \text{by \prefp{thm:mra_support}}
        \end{align*}

      \item The values of $\seqn{h_0,h_1,h_2}$ can be conveniently calculated at the knot locations $x=\frac{1}{2}$, $x=1$, and $x=\frac{3}{2}$ (see the diagram in \prefp{item:sinsin02hn_fig}):
        \begin{align*}
          \cwt \cdot\frac{1}{2}
            &= \cwt \brp{\frac{1}{\sqrt{2}}}^2
          \\&= \cwt \sin^2\brp{\frac{\pi}{4}}
          \\&\eqd \cwt \fphi\brp{\frac{1}{2}}
          \\&= \cwt \sqrt{2}\sum_{n\in\Z}\fh_n \sin^2\brp{\frac{\pi}{2}(1-n)}\setind_\intcc{0}{2}(1-n)
          \\&=\fh_0 \sin^2\brp{\frac{\pi}{2}(1-0)}\setind_\intcc{0}{2}(1-0)
             +\fh_1 \sin^2\brp{\frac{\pi}{2}(1-1)}\setind_\intcc{0}{2}(1-1)
             \\&\qquad+\fh_2 \sin^2\brp{\frac{\pi}{2}(1-2)}\setind_\intcc{0}{2}(1-2)
          \\&=\fh_0 \cdot1\cdot1
             +\fh_1 \cdot0\cdot1
             +\fh_2 (-1)\cdot0
          \\&=\fh_0
          \\\\
          \cwt \cdot1
            &= \cwt \brp{1}^2
          \\&= \cwt \sin^2\brp{\frac{\pi}{2}}
          \\&\eqd \cwt \fphi\brp{1}
          \\&= \cwt \sqrt{2}\sum_{n\in\Z}\fh_n \sin^2\brp{\frac{\pi}{2}(2-n)}\setind_\intcc{0}{2}(2-n)
          \\&=\fh_0 \sin^2\brp{\frac{\pi}{2}(2-0)}\setind_\intcc{0}{2}(2-0)
             +\fh_1 \sin^2\brp{\frac{\pi}{2}(2-1)}\setind_\intcc{0}{2}(2-1)
             \\&\qquad+\fh_2 \sin^2\brp{\frac{\pi}{2}(2-2)}\setind_\intcc{0}{2}(2-2)
          \\&=\fh_0 \cdot0\cdot1
             +\fh_1 \cdot1\cdot1
             +\fh_2 \cdot0\cdot1
          \\&=\fh_1
          \\\\
          \cwt \cdot\frac{1}{2}
            &= \cwt \brp{\frac{1}{-\sqrt{2}}}^2
          \\&= \cwt \sin^2\brp{\frac{3\pi}{4}}
          \\&\eqd \cwt \fphi\brp{\frac{3}{2}}
          \\&= \cwt \sqrt{2}\sum_{n\in\Z}\fh_n \sin^2\brp{\frac{\pi}{2}(3-n)}\setind_\intcc{0}{2}(3-n)
          \\&=\fh_0 \sin^2\brp{\frac{\pi}{2}(3-0)}\setind_\intcc{0}{2}(3-0)
             +\fh_1 \sin^2\brp{\frac{\pi}{2}(3-1)}\setind_\intcc{0}{2}(3-1)
             \\&\qquad+\fh_2 \sin^2\brp{\frac{\pi}{2}(3-2)}\setind_\intcc{0}{2}(3-2)
          \\&=\fh_0 \cdot(-1)\cdot0
             +\fh_1 \cdot0\cdot1
             +\fh_2 1\cdot1
          \\&=\fh_2
        \end{align*}
      \item These values for $\seqn{h_0,h_1,h_2}$ are valid for the knot locations $x=\frac{1}{2}$, $x=1$, and $x=\frac{3}{2}$,
            \textbf{but} they don't satisfy the \fncte{dilation equation} \xref{thm:dilation_eq}. In particular,
            \\\indentx$\ds\fphi(x) \neq \sum_{n\in\Z}\fh_n \opDil\opTrn^n \fphi(x)$
            \\(see the diagram in \prefp{item:sinsin02hn_fig})
    \end{enumerate}
\end{enumerate}
\end{proof}



%-------------------------------------
\begin{counterex}[\exmd{raised sine}]
\label{cnt:pun_rsin}
\footnote{
  \citerppg{proakis}{560}{561}{0-07-232111-3}
  }
%-------------------------------------
Let a function $\ff$ be defined in terms of a shifted cosine function \xref{def:cos} as follows:
%\exbox{\begin{array}{m{58mm}m{\tw-76mm}}
%\cntbox{\begin{array}{m{85mm-15mm}m{85mm}}
\cntbox{\begin{array}{l}
  \begin{array}{l}
  \fphi(x) \eqd \brbl{%
   \begin{array}{>{\ds}lM>{\ds}l}
      \left.\left.\frac{1}{2}\right\{1 + \cos\brs{\pi\brp{\abs{x-1}}}\right\}
        & for & 0 \le x < 2
        \\
      0    & \mc{2}{M}{otherwise}
   \end{array}}
   \end{array}\quad\tbox{\includegraphics{../common/math/graphics/pdfs/rsin.pdf}}%
   \\
   \begin{array}{M}
     Then $\fphi$ forms a \prope{partition of unity}:
   \end{array}\quad\tbox{\includegraphics{../common/math/graphics/pdfs/rsin_pun.pdf}}%
   \\
   \begin{array}{M}
     \textbf{but} $\setxZ{\opTrn^n\fphi}$ does \textbf{not}\\
     generate an \structe{MRA}.
   \end{array}\quad\tbox{\includegraphics{../common/math/graphics/pdfs/rsin02hn.pdf}}%
%\\\mc{2}{M}{Note that $\ds\Ff(\omega)= \frac{1}{2\sqrt{2\pi}}\Big[{\mcom{\frac{2\sin\omega}{\omega}}{$2\sinc(\omega)$}+\mcom{\frac{\sin(\omega-\pi)}{(\omega-\pi)}}{$\sinc(\omega-\pi)$} + \mcom{\frac{\sin(\omega+\pi)}{(\omega+\pi)}}{$\sinc(\omega+\pi)$}}\Big]$}
%\\and so $\Ff(2\pi n)=\frac{1}{\sqrt{2\pi}}\kdelta_n$:
%&\psset{xunit=7mm,yunit=14mm}\input{../common/math/graphics/coscos11ft.tex}
\end{array}}
\end{counterex}
\begin{proof}
Let $\setind_\setA(x)$ be the \fncte{set indicator function} \xref{def:setind} on a set $\setA$.
\begin{enumerate}
  \item Proof that $\fphi(x)$ forms a \prope{partition of unity}:
    \begin{align*}
      \sum_{n\in\Z} \opTrn^n\fphi(x)
        &= \sum_{n\in\Z} \opTrn^n\fphi(x+1)
        && \text{by \prefp{prop:opT_periodic}}
      \\&= \sum_{n\in\Z} \fphi(x+1-n)
        && \text{by \prefp{def:opT}}
        %&& \text{by definition of $\opTrn$ \xref{def:opT}}
      \\&= \sum_{n\in\Z} \frac{1}{2}\brb{1 + \cos\brs{\pi\brp{\abs{x-1+1-n}}}}\setind_\intco{0}{2}(x+1-n)
        && \text{by definition of $\fphi(x)$}
      \\&= \sum_{n\in\Z} \frac{1}{2}\brb{1 + \cos\brs{\pi\brp{\abs{x-n}}}}\setind_\intco{-1}{1}(x-n)
        && \text{by \prefp{def:setind}}
       %&& \text{by definition of $\setind$ \xref{def:setind}}
      \\&= \sum_{n\in\Z} \mcom{\left.\frac{1}{2}\brb{1 + \cos\brs{\frac{\pi}{\beta}\brp{\abs{x-n}-\frac{1-\beta}{2}}}}\setind_\intco{-1}{1}(x-n)\right|_{\beta=1}}
                {\exme{raised cosine} \xref{ex:pun_rcos} with $\beta=1$}
      \\&= 1
        && \text{by \prefp{ex:pun_rcos}}
        %&& \text{by \exme{raised cosine} example \xref{ex:rcos}}
    \end{align*}

  \item Proof that $\fphi(x)\notin\linspan\setxZ{\opDil\opTrn^n\fphi(x)}$ (and so does not generate an \structe{MRA}):
    \begin{enumerate}
      \item Note that the \prope{support} \xref{def:support} of $\fphi$ is $\support\fphi=\intcc{0}{2}$.
      \item Therefore, the \prope{support} of $\seqn{h_n}$ is $\support\seqn{h_n}=\setn{0,1,2}$ \xref{thm:mra_support}.
      \item So if $\fphi(x)$ \emph{is} an \structe{MRA}, we only need to compute $\setn{h_0,h_1,h_2}$ (the rest would be $0$).
            %\\\indentx\psset{unit=20mm}\input{../common/math/graphics/sinsin02hn.tex}\\
            Here would be the values of $\setn{h_1,h_2,h_3}$:
        \begin{align*}
          \fphi(x)
            &= \sum_{n\in\Z}\fh_n \opDil\opTrn^n\fphi(x)
          \\&= \sum_{n\in\Z}\fh_n \opDil\opTrn^n\left.\left.\frac{1}{2}\right\{1 + \cos\brs{\pi\brp{\abs{x-1}}}\right\}\setind_\intcc{0}{2}(x)
            && \text{by definition of $\fphi(x)$}
          \\&= \sum_{n\in\Z}\fh_n \left.\left.\cwt \right\{1 + \cos\brs{\pi\brp{\abs{2x-1-n}}}\right\}\setind_\intcc{0}{2}(2x-n)
            && \text{by \prefp{def:opT}}
          \\&= \sum_{n=0}^2 \fh_n \left.\left.\cwt \right\{1 + \cos\brs{\pi\brp{\abs{2x-1-n}}}\right\}\setind_\intcc{0}{2}(2x-n)
            && \text{by \prefp{thm:mra_support}}
        \end{align*}

      \item The values of $\seqn{h_0,h_1,h_2}$ can be conveniently calculated at the knot locations $x=\frac{1}{2}$, $x=1$, and $x=\frac{3}{2}$ (see the diagram in \prefp{item:sinsin02hn_fig}):
        \begin{align*}
          \frac{1}{2}
            &= \left.\sum_{n=0}^2 \fh_n \left.\left.\cwt \right\{1 + \cos\brs{\pi\brp{\abs{2x-1-n}}}\right\}\setind_\intcc{0}{2}(2x-n)\right|_{x=\frac{1}{2}}
          \\&=\fh_0 \left.\left.\cwt \right\{1 + \cos\brs{1-1-0}\right\}
          \\&=\fh_0 \sqrt{2}
          \\&\implies\fh_0 = \frac{\sqrt{2}}{4}
          \\
          \\
          1
            &= \left.\sum_{n=0}^2 \fh_n \left.\left.\cwt \right\{1 + \cos\brs{\pi\brp{\abs{2x-1-n}}}\right\}\setind_\intcc{0}{2}(2x-n)\right|_{x=1}
          \\&=\fh_1 \left.\left.\cwt \right\{1 + \cos\brs{2-1-1}\right\}
          \\&=\fh_1 \sqrt{2}
          \\&\implies\fh_1 = \cwt
          \\
          \\
          \frac{1}{2}
            &= \left.\sum_{n=0}^2 \fh_n \left.\left.\cwt \right\{1 + \cos\brs{\pi\brp{\abs{2x-1-n}}}\right\}\setind_\intcc{0}{2}(2x-n)\right|_{x=\frac{3}{2}}
          \\&=\fh_2 \left.\left.\cwt \right\{1 + \cos\brs{1-1-0}\right\}
          \\&=\fh_2 \sqrt{2}
          \\&\implies\fh_2 = \frac{\sqrt{2}}{4}
        \end{align*}

      \item These values for $\seqn{h_0,h_1,h_2}$ are valid for the knot locations $x=\frac{1}{2}$, $x=1$, and $x=\frac{3}{2}$,
            \textbf{but} they don't satisfy the \fncte{dilation equation} \xref{thm:dilation_eq}. In particular (see diagram),
            \\\indentx$\ds\fphi(x) \neq \sum_{n\in\Z}\fh_n \opDil\opTrn^n \fphi(x)$ .
    \end{enumerate}
\end{enumerate}
\end{proof}

%=======================================
\section{Examples}
%\label{sec:examples_pounity}
%=======================================
Under a very weak set of constraints, the B-spline $\fN_0(x)$
naturally results (next example).
%--------------------------------------
\begin{example}[\exmd{2 coefficient case}/\exmd{Haar wavelet system}/\exmd{order 0 B-spline wavelet system}]
\footnote{
  \citor{haar1910},
  \citerppgc{wojtaszczyk1997}{14}{15}{0521578949}{``Sources and comments"}
  }
\label{ex:pun_n=2}
%--------------------------------------
\\Let $\wavsys$ be a \structe{wavelet system}.
\exbox{
  \brb{\begin{array}{FMMD}
      1. & $\support\fphi(x)=\intcc{0}{1}$ & \xref{thm:mra_support}  & and
    \\2. & \prope{admissibility condition} & \xref{thm:admiss}       & and
    \\3. & \prope{partition of unity}      & \xref{thm:pun_zero}     &
  \end{array}}
  \implies
  \brb{\begin{array}{r|r}%
    n  & \fh_{n}\\  %& g_n\\
    \hline
    0            & \ds \cwt\\   %& \ds \cwt   \\
    1            & \ds \cwt\\   %& \ds -\cwt  \\
    \text{other} & 0          %& 0
  \end{array}}
  }
\\\indentx\tbox{\includegraphics{../common/math/graphics/pdfs/n0_pz.pdf}}
  \indentx\tbox{\includegraphics{../common/math/graphics/pdfs/n0_h.pdf}}
  \indentx\tbox{\includegraphics{../common/math/graphics/pdfs/b0_g.pdf}}
\end{example}
\begin{proof}
\begin{enumerate}
  \item Proof that (1) $\implies$ that only $h_0$ and $h_1$ are non-zero: by \prefp{thm:mra_support}.

  \item Proof for values of $h_0$ and $h_1$:
        Under the constraint of two non-zero scaling coefficients,
        a scaling function design is fully constrained using the \hie{admissibility equation} \xref{thm:admiss}
        and the \hie{partition of unity} constraint\ifsxref{partuni}{def:pun}.
        The partition of unity formed by $\fphi(x)$ is illustrated in \prefpp{ex:n0_pounity}. %\prefp{ex:pounity_squarepulse}.
  \item Here are the equations:
        \\\indentx$\ds\begin{array}{rcl@{\qquad}MMM}
         \fh_0 +\fh_1 &=& \sqrt{2}    & (admissibility equation          & \pref{thm:admiss}   & \prefpo{thm:admiss}) \\
         \fh_0 -\fh_1 &=& 0           & (partition of unity/zero at $-1$ & \pref{thm:pun_zero} & \prefpo{thm:pun_zero})
        \end{array}$
        \\
  \item Here are the calculations for the coefficients:
        \begin{align*}
          (h_0+h_1)+(h_0-h_1) &= 2h_0 &&= \sqrt{2}         &&\text{(add two equations together)}\\
          (h_0+h_1)-(h_0-h_1) &= 2h_1 &&= \sqrt{2}         &&\text{(subtract second from first)} \\
        \end{align*}

\ifdochas{compactp}{
  \item Note: $h_0$ and $h_1$ can also be produced using other systems of equations including the following:
    \begin{dingautolist}{"AC}
      \item \prope{admissibility condition} and \prope{orthonormality} \xref{ex:ortho_n=2}
      \item \fncte{Daubechies-$p1$} wavelets computed using spectral techniques\ifsxref{compactp}{ex:dau-p1}
    \end{dingautolist}
  }
    \end{enumerate}

%\item Proof for values of $g_0$ and $g_1$: by \prefp{thm:wavstrct_cqf}.
\end{proof}

%--------------------------------------
\begin{example}
\label{ex:h_1_3_2}
%--------------------------------------
Let $\wavsys$ be a \structe{wavelet system}.
\exbox{
  \brb{\begin{array}{FMMD}
      1. & $\support\fphi(x)=\intcc{0}{2}$ & \xref{thm:mra_support}  & and
    \\2. & \prope{admissibility condition} & \xref{thm:admiss}       & and
    \\3. & \prope{partition of unity}      & \xref{thm:pun_zero}     & and
    \\4. & $\Zh(z)$ has a root at $z=-2$   &                         &
  \end{array}}
  \implies
  \brb{\begin{array}{|r|r|}%
    n  & \fh_{n}
    \\\hline
      0 & \frac{\sqrt{2}}{6}\cdot1
    \\1 & \frac{\sqrt{2}}{6}\cdot3
    \\2 & \frac{\sqrt{2}}{6}\cdot2
    \\\text{other} & 0
  \end{array}}
  }
  \\\indentx\tbox{\includegraphics{../common/math/graphics/pdfs/h_1_3_2_pz.pdf}}
    \indentx\tbox{\includegraphics{../common/math/graphics/pdfs/h_1_3_2_phi_h.pdf}}
    \indentx\tbox{\includegraphics{../common/math/graphics/pdfs/h_1_3_2_psi_g.pdf}}
\end{example}
\begin{proof}
\begin{enumerate}
  \item By (1) and \prefpp{thm:mra_support}, there are 3 non-zero coefficients.
  \item By (3), $\Zh(z)$ has a zero at $z=-1$ and as such has a factor $(z+1)$.
  \item By (4), $\Zh(z)$ has a zero at $z=-1/2$ and as such has a factor $(z+2)$.
  \item By (2), $\sum h_n=\sqrt{2}$.
  \item Putting it all together \ldots
  \begin{align*}
    \Zh(z) &= c\frac{\brp{z+1}\brp{z+2}}{z^2}
                      = c\frac{z^2 + 3z + 2}{z^2}
                      = c\brs{1 + 3z^{-1} + 2z^{-2}}
                      = \frac{\sqrt{2}}{6}\brs{1 + 3z^{-1} + 2z^{-2}}
  \end{align*}
\end{enumerate}
\end{proof}

%--------------------------------------
\begin{example}
\label{ex:h_2_3_1}
%--------------------------------------
Let $\wavsys$ be a \structe{wavelet system}.
\exbox{
  \brb{\begin{array}{FMMD}
      1. & $\support\fphi(x)=\intcc{0}{2}$ & \xref{thm:mra_support}  & and
    \\2. & \prope{admissibility condition} & \xref{thm:admiss}       & and
    \\3. & \prope{partition of unity}      & \xref{thm:pun_zero}     & and
    \\4. & $\Zh(z)$ has a root at $z=-0.5$ &                         &
  \end{array}}
  \implies
  \brb{\begin{array}{|r|r|}%
    n  & \fh_{n}
    \\\hline
      0 & \frac{\sqrt{2}}{6}\cdot2
    \\1 & \frac{\sqrt{2}}{6}\cdot3
    \\2 & \frac{\sqrt{2}}{6}\cdot1
    \\\text{other} & 0
  \end{array}}
  }
  \\\indentx\tbox{\includegraphics{../common/math/graphics/pdfs/h_2_3_1_pz.pdf}}
    \indentx\tbox{\includegraphics{../common/math/graphics/pdfs/h_2_3_1_phi_h.pdf}}
    \indentx\tbox{\includegraphics{../common/math/graphics/pdfs/h_2_3_1_psi_g.pdf}}
\\Note that in contrast to \pref{ex:h_1_3_2}, the zero of condition (4) is \emph{inside}
the unit circle, making $\Zh(z)$ \prope{minimum phase} \xref{def:minphase} and,
in agreement with \thme{Robinson's Energy Delay Theorem}\ifsxref{dsp}{thm:redt},
pushing the energy of the resulting $\fphi(x)$ more towards the origin.
\end{example}
\begin{proof}
\begin{enumerate}
  \item By (1) and \prefpp{thm:mra_support}, there are 3 non-zero coefficients.
  \item By (3), $\Zh(z)$ has a zero at $z=-1$ and as such has a factor $(z+1)$.
  \item By (4), $\Zh(z)$ has a zero at $z=-1/2$ and as such has a factor $(z+1/2)$.
  \item By (2), $\sum h_n=\sqrt{2}$.
  \item Putting it all together \ldots
  \begin{align*}
    \Zh(z) &= c\frac{\brp{z+1}\brp{z+\frac{1}{2}}}{z^2}
                      = c\frac{z^2 + \frac{3}{2}z + \frac{1}{2}}{z^2}
                      = c\brs{1 + \frac{3}{2}z^{-1} + \frac{1}{2}z^{-2}}
                      = \frac{\sqrt{2}}{3}\brs{1 + \frac{3}{2}z^{-1} + \frac{1}{2}z^{-2}}
  \end{align*}
\end{enumerate}
\end{proof}

%--------------------------------------
\begin{example}
\label{ex:h_1_1_1o128}
%--------------------------------------
Let $\wavsys$ be a \structe{wavelet system}.
\exbox{
  \brb{\begin{array}{FMMD}
      1. & $\support\fphi(x)=\intcc{0}{2}$ & \xref{thm:mra_support}  & and
    \\2. & \prope{admissibility condition} & \xref{thm:admiss}       & and
    \\3. & \prope{partition of unity}      & \xref{thm:pun_zero}     & and
    \\4. & $\Zh(z)$ has a root at $z=1/128$ &                         &
  \end{array}}
  \implies
  \brb{\begin{array}{|r|r|}%
    n  & \fh_{n}
    \\\hline
    %  0 & \frac{\sqrt{2}}{6}\cdot2
    %\\1 & \frac{\sqrt{2}}{6}\cdot3
    %\\2 & \frac{\sqrt{2}}{6}\cdot1
    \\\text{other} & 0
  \end{array}}
  }
  \\\indentx\tbox{\includegraphics{../common/math/graphics/pdfs/h_1_1_1o128_pz.pdf}}
    \indentx\tbox{\includegraphics{../common/math/graphics/pdfs/h_1_1_1o128_phi_h.pdf}}
    \indentx\tbox{\includegraphics{../common/math/graphics/pdfs/h_1_1_1o128_psi_g.pdf}}
\end{example}
