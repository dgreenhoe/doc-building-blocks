%============================================================================
% Daniel J. Greenhoe
% XeLaTeX file
%============================================================================
%=======================================
\chapter{Interpolation}
%=======================================
%=======================================
\section{Polynomial interpolation}
%=======================================
%=======================================
\subsection{Lagrange interpolation}
%=======================================
%--------------------------------------
\begin{definition}
\footnote{
  \citePp{waring1779}{60},
  \citePpc{euler1783}{165}{\textsection. 10. Problema 2. Corollarium 3.},
  \citeP{gauss1866},
  \citeP{lagrange1877},
  \citerp{matthews}{206},
  \citePc{meijering2002}{historical background}
  }
\label{def:Ln(x)}
\label{def:lagpoly}
\label{def:laginterp}
\index{polynomial!Lagrange}
%--------------------------------------
The \structd{Lagrange polynomial} $L_{P,n}(x)$ with respect to the $n+1$ points \\
$P=\set{(x_k,y_k)}{k=0,1,2,\ldots,n}$ is defined as
\defbox{
  L_{P,n}(x) \eqd \sum_{k=0}^n y_k \prod_{m\ne n} \frac{x-x_m}{x_k-x_m}
  }
\end{definition}

%--------------------------------------
\begin{proposition}
%--------------------------------------
Let $L_{P,n}(x)$ be the Lagrange polynomial with respect to the points\\
$P=\set{(x_k,y_k)}{k=0,1,2,\ldots,n}$.
\propbox{\begin{tabular}{ll}
  1.& $L_{P,n}(x)$ is an $n$th order polynomial. \\
  2.& $L_{P,n}(x)$ intersects all $n+1$ points in $P$.
\end{tabular}}
\end{proposition}

%--------------------------------------
\begin{example}[Lagrange interpolation]
%--------------------------------------
The {Lagrange polynomial} $L_{P,3}(x)$ with respect to the $4$ points\\
$P=\{(-2,1),\; (-1,3),\; (3,2),\; (5,4)\}$ is
\exbox{
  L_{P,3}(x) = \frac{   79}{840} x^3
             + \frac{- 378}{840} x^2
             + \frac{-   7}{840} x
             + \frac{ 2970}{840}
  }
\end{example}
\begin{proof}
\begin{align*}
  L_{P,3}(x)
    &= \sum_{k=0}^n y_k \prod_{m\ne n} \frac{x-x_m}{x_k-x_m}
    \qquad\text{by \prefp{def:Ln(x)}}
  \\&=  y_0\frac{(x+1)(x-3)(x-5)}{(x_0-x_1)(x_0-x_2)(x_0-x_3)} +
        y_1\frac{(x+2)(x-3)(x-5)}{(x_1-x_0)(x_1-x_2)(x_1-x_3)}
  \\&\quad+
        y_2\frac{(x+2)(x+1)(x-5)}{(x_2-x_0)(x_2-x_1)(x_2-x_3)} +
        y_3\frac{(x+2)(x+1)(x-3)}{(x_3-x_0)(x_3-x_1)(x_3-x_2)}
%
  \\&=  1\frac{(x+1)(x-3)(x-5)}{(-2+1)(-2-3)(-2-5)} +
        3\frac{(x+2)(x-3)(x-5)}{(-1+2)(-1-3)(-1-5)}
  \\&\quad+
        2\frac{(x+2)(x+1)(x-5)}{(3+2)(3+1)(3-5)}    +
        4\frac{(x+2)(x+1)(x-3)}{(5+2)(5+1)(5-3)}
  \\&=  1\mcom{\frac{x^3-7x^2+7x+15}{-35} }{roots=$-1,3,5$}   +
        3\mcom{\frac{x^3-6x^2-x+30}{24}  }{roots=$-2,3,5$}   +
        2\mcom{\frac{x^3-2x^2-13x-10}{-40}}{roots=$-2,-1,5$}  +
        4\mcom{\frac{x^3-7x-6}{84}        }{roots=$-2,-1,3$}
  \\&= -  \frac{x^3-7x^2+7x+15}{35}
       +  \frac{x^3-6x^2-x+30}{8}
       -  \frac{x^3-2x^2-13x-10}{20}
       +  \frac{x^3-7x-6}{21}
  \\&=   x^3 \left(
         \frac{-8\cdot20\cdot21 +35\cdot20\cdot21 - 35\cdot8\cdot21 + 35\cdot8\cdot20}
              {35 \cdot 8 \cdot 20 \cdot 21}
             \right)
  \\&\quad
         +x^2 \left(
         \frac{7\cdot8\cdot20\cdot21 -6\cdot35\cdot20\cdot21+ 2\cdot35\cdot8\cdot21+0\cdot35\cdot8\cdot20}
              {35 \cdot 8 \cdot 20 \cdot 21}
             \right)
  \\&\quad
         +x \left(
         \frac{-7\cdot8\cdot20\cdot21 -35\cdot20\cdot21+13\cdot35\cdot8\cdot21-7\cdot35\cdot8\cdot20}
              {35 \cdot 8 \cdot 20 \cdot 21}
             \right)
  \\&\quad
         + \left(
         \frac{-15\cdot8\cdot20\cdot21 +30\cdot35\cdot20\cdot21+10\cdot35\cdot8\cdot21-6\cdot35\cdot8\cdot20}
              {35 \cdot 8 \cdot 20 \cdot 21}
             \right)
  \\&=   \frac{ 11060}{117600} x^3
       + \frac{-52920}{117600} x^2
       + \frac{-  980}{117600} x
       + \frac{415800}{117600}
  \\&=   \frac{   79}{840} x^3
       + \frac{- 378}{840} x^2
       + \frac{-   7}{840} x
       + \frac{ 2970}{840}
\end{align*}
\end{proof}


%--------------------------------------
\begin{definition}
\footnote{
  \citeI{newton1711},
  \citeIppc{fraser1919}{9}{17}{Methodus differentialis: ``A photographic reproduction of the original Latin text"},
  \citeIppc{fraser1919}{18}{25}{Methodus differentialis: English translation},
  \citerppc{fraser1919}{1}{8}{historical background and notes},
  \citePc{meijering2002}{historical background},
  \citerp{matthews}{220}
  }
\label{def:Nn(x)}
\label{def:newpoly}
\label{def:newinterp}
\index{polynomial!Newton}
%--------------------------------------
The \structd{Newton polynomial} $N_{P,n}(x)$ with respect to the $n+1$ points\\
$P=\set{(x_k,y_k)}{k=0,1,2,\ldots,n}$ is defined as
\defbox{
  N_{P,n}(x) \eqd \sum_{k=0}^n \alpha_k \prod_{m=0}^k (x-x_m)
  }
\end{definition}


%--------------------------------------
\begin{proposition}
%--------------------------------------
Let $N_{P,n}(x)$ be the Newton polynomial with respect to the points\\
$P=\set{(x_k,y_k)}{k=0,1,2,\ldots,n}$.
\propbox{\begin{tabular}{ll}
  1.& $N_{P,n}(x)$ is an $n$th order polynomial. \\
  2.& $N_{P,n}(x)$ intersects all $n+1$ points in $P$.
\end{tabular}}
\end{proposition}

%--------------------------------------
\begin{example}[Newton polynomial interpolation]
\index{polynomial!Newton}
%--------------------------------------
\exboxt{
The {Newton polynomial} $N_{P,3}(x)$ with respect to the $4$ points
\\\indentx$P=\setn{(-2,1),\; (-1,3),\; (3,2),\; (5,4)}$ is
$
  N_{P,3}(x) = \frac{   79}{840} x^3
             + \frac{- 378}{840} x^2
             + \frac{-   7}{840} x
             + \frac{ 2970}{840}
$
  }
\end{example}
\begin{proof}
\begin{align*}
  N_{P,3}(x)
    &= \sum_{k=0}^n \alpha_k \prod_{m=1}^k (x-x_m)
  \\&= \alpha_0 + \alpha_1(x-x_0) + \alpha_2(x-x_0)(x-x_1) + \alpha_3(x-x_0)(x-x_1)(x-x_2)
  \\&= \alpha_0 + \alpha_1(x+2) + \alpha_2(x+2)(x+1) + \alpha_3(x+2)(x+1)(x-3)
  \\&= \alpha_0 + \alpha_1(x+2) + \alpha_2(x^2+3x+2) + \alpha_3(x^3-7x-6)
  \\&= x^3(\alpha_3) + x^2(\alpha_2) + x(-7\alpha_3+3\alpha_2+\alpha_1)
      +(-6\alpha_3 + 2\alpha_2 + 2\alpha_1 + \alpha_0)
  \\&= \Big[ \alpha_0 \; \alpha_1 \; \alpha_2 \; \alpha_3 \Big]
       \brs{\begin{array}{rrrr}
          1  &   0  & 0  & 0  \\
          2  &   1  & 0  & 0  \\
          2  &   3  & 1  & 0  \\
         -6  &  -7  & 0  & 1
       \end{array}}
       \brs{\begin{array}{l}
         1   \\
         x   \\
         x^2 \\
         x^3
       \end{array}}
  \\
  \\
  \brs{\begin{array}{l}
     1  \\
     3  \\
     2  \\
     4
  \end{array}}
    &= \brs{\begin{array}{l}
         y_0 \\
         y_1 \\
         y_2 \\
         y_3
       \end{array}}
  \\&= \brs{\begin{array}{llll}
         1 & 0         & 0                  & 0                           \\
         1 & (x_1-x_0) & 0                  & 0                           \\
         1 & (x_2-x_0) & (x_2-x_0)(x_2-x_1) & 0                           \\
         1 & (x_3-x_0) & (x_3-x_0)(x_3-x_1) & (x_3-x_0)(x_3-x_1)(x_3-x_2)
       \end{array}}
       \brs{\begin{array}{l}
         \alpha_0 \\
         \alpha_1 \\
         \alpha_2 \\
         \alpha_3
       \end{array}}
  \\&= \brs{\begin{array}{llll}
         1 & 0     & 0          & 0                           \\
         1 & (-1+2)& 0          & 0                           \\
         1 & (3+2) & (3+2)(3+1) & 0                           \\
         1 & (5+2) & (5+2)(5+1) & (5+2)(5+1)(5-3)
       \end{array}}
       \brs{\begin{array}{l}
         \alpha_0 \\
         \alpha_1 \\
         \alpha_2 \\
         \alpha_3
       \end{array}}
  \\&= \brs{\begin{array}{llll}
         1 & 0     & 0          & 0                           \\
         1 & 1     & 0          & 0                           \\
         1 & 5     & 20         & 0                           \\
         1 & 7     & 42         & 84
       \end{array}}
       \brs{\begin{array}{l}
         \alpha_0 \\
         \alpha_1 \\
         \alpha_2 \\
         \alpha_3
       \end{array}}
  \end{align*}

  \begin{align*}
  \brs{\begin{array}{*{8}{r}}
    1 & 0 & 0  & 0  & 1 & 0 & 0 & 0 \\
    1 & 1 & 0  & 0  & 0 & 1 & 0 & 0 \\
    1 & 5 & 20 & 0  & 0 & 0 & 1 & 0 \\
    1 & 7 & 42 & 84 & 0 & 0 & 0 & 1
  \end{array}}
    &= \brs{\begin{array}{*{8}{r}}
         1 & 0 & 0  & 0  & 1 & 0 & 0 & 0 \\
         0 & 1 & 0  & 0  &-1 & 1 & 0 & 0 \\
         0 & 5 & 20 & 0  &-1 & 0 & 1 & 0 \\
         0 & 7 & 42 & 84 &-1 & 0 & 0 & 1
       \end{array}}
  \\&= \brs{\begin{array}{*{8}{r}}
         1 & 0 & 0  & 0  & 1 & 0 & 0 & 0 \\
         0 & 1 & 0  & 0  &-1 & 1 & 0 & 0 \\
         0 & 0 & 20 & 0  & 4 &-5 & 1 & 0 \\
         0 & 0 & 42 & 84 & 6 &-7 & 0 & 1
       \end{array}}
  \\&= \brs{\begin{array}{*{8}{r}}
         1 & 0 & 0  & 0  & 1 & 0 & 0 & 0 \\
         0 & 1 & 0  & 0  &-1 & 1 & 0 & 0 \\
         0 & 0 & 1  & 0  &\frac{1}{5} &-\frac{1}{4} & \frac{1}{20} & 0 \\
         0 & 0 & 42 & 84 & 6 &-7 & 0 & 1
       \end{array}}
  \\&= \brs{\begin{array}{*{8}{r}}
         1 & 0 & 0  & 0  & 1 & 0 & 0 & 0 \\
         0 & 1 & 0  & 0  &-1 & 1 & 0 & 0 \\
         0 & 0 & 1  & 0  &\frac{1}{5} &-\frac{1}{4} & \frac{1}{20} & 0 \\
         0 & 0 & 0  & 84 & 6-\frac{42}{5} &-7+\frac{42}{4} & -\frac{42}{20} & 1
       \end{array}}
  \\&= \brs{\begin{array}{*{8}{r}}
         1 & 0 & 0  & 0  & 1 & 0 & 0 & 0 \\
         0 & 1 & 0  & 0  &-1 & 1 & 0 & 0 \\
         0 & 0 & 1  & 0  &\frac{1}{5} &-\frac{1}{4} & \frac{1}{20} & 0 \\
         0 & 0 & 0  & 84 & -\frac{12}{5} &\frac{14}{4} & -\frac{42}{20} & 1
       \end{array}}
  \\&= \brs{\begin{array}{*{8}{r}}
         1 & 0 & 0  & 0  & 1 & 0 & 0 & 0 \\
         0 & 1 & 0  & 0  &-1 & 1 & 0 & 0 \\
         0 & 0 & 1  & 0  &\frac{4}{20} &-\frac{5}{20} & \frac{1}{20} & 0 \\
         0 & 0 & 0  & 84 & -\frac{24}{10} &\frac{35}{10} & -\frac{21}{10} & \frac{10}{10}
       \end{array}}
  \\&= \brs{\begin{array}{*{8}{r}}
         1 & 0 & 0  & 0  & 1 & 0 & 0 & 0 \\
         0 & 1 & 0  & 0  &-1 & 1 & 0 & 0 \\
         0 & 0 & 1  & 0  &\frac{4}{20} &-\frac{5}{20} & \frac{1}{20} & 0 \\
         0 & 0 & 0  & 1  & -\frac{24}{840} &\frac{35}{840} & -\frac{21}{840} & \frac{10}{840}
       \end{array}}
  \end{align*}

  \begin{align*}
  \brs{\begin{array}{l}
    \alpha_0 \\
    \alpha_1 \\
    \alpha_2 \\
    \alpha_3
  \end{array}}
    &= \brs{\begin{array}{*{4}{r}}
          1 & 0 & 0 & 0 \\
         -1 & 1 & 0 & 0 \\
         \frac{4}{20} &-\frac{5}{20} & \frac{1}{20} & 0 \\
          -\frac{24}{840} &\frac{35}{840} & -\frac{21}{840} & \frac{10}{840}
       \end{array}}
       \brs{\begin{array}{l}
         1 \\
         3 \\
         2 \\
         4
       \end{array}}
  \\&= \brs{\begin{array}{l}
         1 \\
         2 \\
         -\frac{9}{20} \\
         \frac{79}{840}
       \end{array}}
  \\
  \\
  \\
  N_{P,3}(x)
    &= \Big[ \alpha_0 \; \alpha_1 \; \alpha_2 \; \alpha_3 \Big]
       \brs{\begin{array}{rrrr}
          1  &   0  & 0  & 0  \\
          2  &   1  & 0  & 0  \\
          2  &   3  & 1  & 0  \\
         -6  &  -7  & 0  & 1
       \end{array}}
       \brs{\begin{array}{l}
         1   \\
         x   \\
         x^2 \\
         x^3
       \end{array}}
  \\&= \brs{\begin{array}{c|c|c|c}
         1 & 2 & -\frac{9}{20} & \frac{79}{840}
       \end{array}}
       \brs{\begin{array}{rrrr}
          1  &   0  & 0  & 0  \\
          2  &   1  & 0  & 0  \\
          2  &   3  & 1  & 0  \\
         -6  &  -7  & 0  & 1
       \end{array}}
       \brs{\begin{array}{l}
         1   \\
         x   \\
         x^2 \\
         x^3
       \end{array}}
  \\&= \brs{\begin{array}{c|c|c|c}
          1 + 4 - \frac{9}{10} - \frac{79}{140}  &
          2 - \frac{27}{20} -\frac{79}{120}      &
          -\frac{9}{20}                          &
          \frac{79}{840}
       \end{array}}
       \brs{\begin{array}{l}
         1   \\
         x   \\
         x^2 \\
         x^3
       \end{array}}
  \\&= \frac{79}{840}x^3 - \frac{378}{840}x^2 - \frac{7}{840}x + \frac{2970}{840}
\end{align*}
\end{proof}




%---------------------------------------
\begin{example}[\exmd{Least squares polynomial interpolation}]
\footnote{
  \citerpgc{overschee2012}{14}{1461304652}{Table 1.1; historical perspective as relates to ``subspace identification"}
  }
\index{polynomial!least squares}
\index{least squares}
\label{ex:ls}
%---------------------------------------
The best 3rd order polynomial in the \hib{least squares} $S_{P,3}(x)$ sense
with respect to the $4$ points\\
$P=\{(-2,1),\; (-1,3),\; (3,2),\; (5,4)\}$ is
\exbox{
  S_{P,3}(x) = \frac{   79}{840} x^3
             + \frac{- 378}{840} x^2
             + \frac{-   7}{840} x
             + \frac{ 2970}{840}
  }
\end{example}
\begin{proof}
%The {\em least squares} technique is presented in
%Section~\ref{sec:ls} (page~\pageref{sec:ls}).
\[
  \vx
    =
    \brs{\begin{array}{l}
       x_0  \\
       x_1  \\
       x_2  \\
       x_3
    \end{array}}
    =
    \brs{\begin{array}{r}
       -2   \\
       -1   \\
        3   \\
        5
    \end{array}}
   \qquad\qquad
   \vy
     =
     \brs{\begin{array}{r}
         1   \\
         3   \\
         2   \\
         4   \\
     \end{array}}
     =
     \brs{\begin{array}{l}
         1   \\
         3   \\
         2   \\
         4   \\
     \end{array}}
\]

We want to find a third order polynomial
  \[ d x^3 + c x^2 + bx + a \]
that best approximates
the 4 points in the least squares sense.
We define the matrix $U$ (known) and vector $\estn$ (to be computed)
as follows:
\[
   U^H \eqd
   \brs{\begin{array}{llll}
      1  & x_0 & x_0^2 & x_0^3  \\
      1  & x_1 & x_1^2 & x_1^3  \\
      1  & x_2 & x_2^2 & x_2^3  \\
      1  & x_3 & x_3^2 & x_3^3
   \end{array}}
   \qquad\qquad
   \estn \eqd
   \brs{\begin{array}{l}
      a  \\
      b  \\
      c  \\
      d
   \end{array}}
\]
Then, using \thme{Least squares}\ifsxref{estimate}{thm:ls}, the best coefficients for the polynomial are
\begin{align*}
  \estn
    &= \brs{\begin{array}{l}
          a  \\
          b  \\
          c  \\
          d
       \end{array}}
  \\&= R^{-1}W
  \\&= (UU^H)^{-1}\; (U\vy)
  \\&= \left(
   \brs{\begin{array}{llll}
      1  & x_0 & x_0^2 & x_0^3  \\
      1  & x_1 & x_1^2 & x_1^3  \\
      1  & x_2 & x_2^2 & x_2^3  \\
      1  & x_3 & x_3^2 & x_3^3
   \end{array}}^H
   \brs{\begin{array}{llll}
      1  & x_0 & x_0^2 & x_0^3  \\
      1  & x_1 & x_1^2 & x_1^3  \\
      1  & x_2 & x_2^2 & x_2^3  \\
      1  & x_3 & x_3^2 & x_3^3
   \end{array}}
       \right)^{-1}
       \left(
   \brs{\begin{array}{llll}
      1  & x_0 & x_0^2 & x_0^3  \\
      1  & x_1 & x_1^2 & x_1^3  \\
      1  & x_2 & x_2^2 & x_2^3  \\
      1  & x_3 & x_3^2 & x_3^3
   \end{array}}^H
       \brs{\begin{array}{l}
          y_0  \\
          y_1  \\
          y_2  \\
          y_3
       \end{array}}
       \right)
  \\&= \left(
   \brs{\begin{array}{rrrr}
      1  & (-2) & (-2)^2 & (-2)^3  \\
      1  & (-1) & (-1)^2 & (-1)^3  \\
      1  & (3) & (3)^2 & (3)^3  \\
      1  & (5) & (5)^2 & (5)^3
   \end{array}}^H
   \brs{\begin{array}{rrrr}
      1  & (-2) & (-2)^2 & (-2)^3  \\
      1  & (-1) & (-1)^2 & (-1)^3  \\
      1  & (3) & (3)^2 & (3)^3  \\
      1  & (5) & (5)^2 & (5)^3
   \end{array}}
       \right)^{-1}
       \left(
   \brs{\begin{array}{rrrr}
      1  & (-2) & (-2)^2 & (-2)^3  \\
      1  & (-1) & (-1)^2 & (-1)^3  \\
      1  & (3) & (3)^2 & (3)^3  \\
      1  & (5) & (5)^2 & (5)^3
   \end{array}}^H
       \brs{\begin{array}{l}
          1  \\
          3  \\
          2  \\
          4
       \end{array}}
       \right)
  \\&= \left(
   \brs{\begin{array}{rrrr}
      1  & -2 &  4 &  -8  \\
      1  & -1 &  1 &  -1  \\
      1  &  3 &  9 &  27  \\
      1  &  5 & 25 & 125
   \end{array}}^H
   \brs{\begin{array}{rrrr}
      1  & -2 &  4 &  -8  \\
      1  & -1 &  1 &  -1  \\
      1  &  3 &  9 &  27  \\
      1  &  5 & 25 & 125
   \end{array}}
       \right)^{-1}
       \left(
   \brs{\begin{array}{rrrr}
      1  & -2 &  4 &  -8  \\
      1  & -1 &  1 &  -1  \\
      1  &  3 &  9 &  27  \\
      1  &  5 & 25 & 125
   \end{array}}^H
       \brs{\begin{array}{l}
          1  \\
          3  \\
          2  \\
          4
       \end{array}}
       \right)
\\&= \brs{\begin{array}{r}
       2970   \\
         -7   \\
       -378   \\
         79
     \end{array}}
\end{align*}
\end{proof}

%=======================================
\section{Hermite interpolation}
\label{sec:interpo_hermite}
%=======================================
\begin{figure}[h]
\begin{scriptsize}
\begin{center}
\color[rgb]{0.2,0.2,0.2}
\begin{fsL}
\setlength{\unitlength}{0.3mm}
\begin{picture}(335,150)(-10,-30)
  %\graphpaper[10](-100,0)(300,150)
  \thicklines
  \put(   0,   0 ){\line(1,0){240} }
  \put(   0,   0 ){\line(0,1){120} }

  \qbezier[10](100,50)(100, 25)( 100,0)
  \qbezier[40](0,100)(100,100)( 200,100)

  {\color{blue}
    \qbezier(   0, 100)(  60, 100)( 100,  50)
    \qbezier( 100,  50)( 140,   0)( 200,   0)
    \put( 130,  25 ){\makebox(0,0)[l]{$\leftarrow (1-y)^p \fP(y)$} }
    \put(   5, 105 ){\makebox(0,0)[lb]{$\downarrow$ first $p-1$ derivatives are zero at $y=0$} }
    \put( 200,   5 ){\makebox(0,0)[lb]{$\downarrow$ first $p-1$ derivatives are zero at $y=1$} }
    }

  {\color{red}
    \qbezier(   0,   0)(  60,   0)( 100,  50)
    \qbezier( 100,  50)( 140, 100)( 200, 100)
    \put( 130,  75 ){\makebox(0,0)[l]{$\leftarrow y^p \fP(1-y)$} }
    \put(   5,  -3 ){\makebox(0,0)[lt]{$\uparrow$ first $p-1$ derivatives are zero at $y=0$} }
    \put( 200,  95 ){\makebox(0,0)[lt]{$\uparrow$ first $p-1$ derivatives are zero at $y=1$} }
    }

  \put( 100,   3 ){\makebox(0,0)[b]{$\frac{\pi}{2}$} }
  \put( 260,   0 ){\makebox(0,0)[l]{$\omega$} }
  \put( -10, 100 ){\makebox(0,0)[r]{$1$} }
\end{picture}
\end{fsL}
\end{center}
\end{scriptsize}
\caption{
  Polynomial quadrature condition low-pass and high-pass terms
  \label{fig:lphp}
  }
\end{figure}

%---------------------------------------
\begin{definition}
\label{def:minpoly}
%---------------------------------------
\defboxt{
  The \fnctd{minimal polynomial} $\fP_m(x)$ is defined as
  \\\indentx$\ds\fP_m(x)= \sum_{k=0}^{p-1} \bcoef{p-1+k}{k} x^k$
  }
\end{definition}

%---------------------------------------
\begin{definition}
\label{def:minpoly}
%---------------------------------------
\defbox{\begin{array}{Mrcl}
  The low pass Hermite interpolation function is defined as  &\ds\fh_l &\eqd&\ds (1-x)^p \sum_{k=0}^{p-1}\bcoef{p+k-1}{k} x^k\\
  The high pass Hermite interpolation function is defined as &\ds\fh_h &\eqd&\ds     x^p \sum_{k=0}^{p-1}\bcoef{p+k-1}{k} (1-x)^k 
\end{array}}
\end{definition}

%---------------------------------------
\begin{example}
\footnote{
  \citerpg{pinsky2002}{333}{9780534376604},
  \citerpgc{pinsky2008}{333}{9780534376604}{Exercise 6.5.11: $P_1(y)$, $P_2(y)$, \ldots, $P_6(y)$},
  \citeO{oeisA000580}{A000580} %{a(n) = binomial coefficient C(n,7)}
  }
\label{ex:min_poly}
%---------------------------------------
Here are some examples of the minimal polynomial $\fP_m(x)$ for varying number
of vanishing moments $p$:
\footnotesize
\exbox{
\renewcommand{\arraystretch}{1}
\renewcommand{\arraycolsep}{0.4ex}
\begin{array}{r|@{\hs{2ex}}*{20}{r}}
   p & \mc{19}{l}{\fP_m(x)= \sum_{k=0}^{p-1} \bcoef{p-1+k}{k} x^k}
\\ \hline
   1 & 1
\\ 2 & 1 &+&  2x
\\ 3 & 1 &+&  3x &+&  6x^2
\\ 4 & 1 &+&  4x &+& 10x^2 &+& 20x^3
\\ 5 & 1 &+&  5x &+& 15x^2 &+& 35x^3 &+&  70x^4
\\ 6 & 1 &+&  6x &+& 21x^2 &+& 56x^3 &+& 126x^4 &+& 252x^5
\\ 7 & 1 &+&  7x &+& 28x^2 &+& 84x^3 &+& 210x^4 &+& 462x^5 &+&  924x^6
\\ 8 & 1 &+&  8x &+& 36x^2 &+&120x^3 &+& 330x^4 &+& 792x^5 &+& 1716x^6 &+& 3432x^7
\\ 9 & 1 &+&  9x &+& 45x^2 &+&165x^3 &+& 495x^4 &+&1287x^5 &+& 3003x^6 &+& 6435x^7 &+& 12870x^8
\\10 & 1 &+& 10x &+& 55x^2 &+&220x^3 &+& 715x^4 &+&2002x^5 &+& 5005x^6 &+&11440x^7 &+& 24310x^8 &+& 48620x^9
\end{array}}
\end{example}



%--------------------------------------
\begin{example}
%\label{tbl:P_lp}
\footnote{
  \citerpgc{ebert2003}{347}{9781558608481}{$3t^2 - 2t^3$ and $6t^5 - 15t^4 + 10t^3$},
  \citePc{perlin2002}{$3t^2 - 2t^3$ and $6t^5 - 15t^4 + 10t^3$},
  \citeO{oeisA091811}{A091811} %{Array read by rows: T(n,k) = binomial(n+k-2,k-1)*binomial(2*n-1,n-k)},
  \citeO{oeisA327809}{A327809} %{Regular triangle, coefficients of the polynomial P(n)(x) = (-1)^(n+1)*(2*n+1)*binomial(2*n, n)*Sum_{i=0..n} x^i*binomial(n, i)/(n+i+1)}
  }
%--------------------------------------
Low-pass term $(1-y)^p\fP_m(y)$:
{\footnotesize
\exbox{
  \renewcommand{\arraystretch}{1}
  \renewcommand{\arraycolsep}{0.4ex}
  \begin{array}{r|@{\qquad}*{13}{r}}
     p & \mc{13}{l}{\ds(1-x)^p\fP_m(x)= (1-x)^p \sum_{k=0}^{p-1} {p-1+k\choose k} x^k}
  \\ \hline
     1 & 1 &-&    x
  \\ 2 & 1 &-&   3x^2 &+&    2x^3
  \\ 3 & 1 &-&  10x^3 &+&   15x^4 &-&    6x^5
  \\ 4 & 1 &-&  35x^4 &+&   84x^5 &-&   70x^6 &+&    20x^7
  \\ 5 & 1 &-& 126x^5 &+&  420x^6 &-&  540x^7 &+&   315x^8 &-&    70x^9
  \\ 6 & 1 &-& 462x^6 &+& 1980x^7 &-& 3465x^8 &+&  3080x^9 &-&  1386x^{10} &+& 252x^{11}
  \end{array}}
}
\end{example}

%--------------------------------------
\begin{theorem}[\thme{Hermite Interpolation}]
\label{thm:interpo_hermite}
%--------------------------------------
\thmbox{\begin{array}{*{3}{>{\ds}l}D}
  \left.\deriv{^n}{x^n} \brs{
        (1-x)^p \sum_{k=0}^{p-1}{p+k-1\choose k} x^k
        }\right|_{x=0}
    &=& \kdelta_n
    &   for $n=0,1,2,\ldots,p-1$
  \\
  \left.\deriv{^n}{x^n} \brs{
        (1-x)^p \sum_{k=0}^{p-1} {p+k-1\choose k} x^k
        }\right|_{x=1}
    &=& 0
    &   for $n=0,1,2,\ldots,p-1$
  \\
  \left.\deriv{^n}{x^n} \brs{
        x^p \sum_{k=0}^{p-1}{p+k-1\choose k} (1-x)^k
        }\right|_{x=0}
    &=& 0
    &   for $n=0,1,2,\ldots,p-1$
  \\
  \left.\deriv{^n}{x^n} \brs{
        x^p \sum_{k=0}^{p-1} {p+k-1\choose k} (1-x)^k
        }\right|_{x=1}
    &=& \kdelta_n
    &   for $n=0,1,2,\ldots,p-1$
  \end{array}}
\end{theorem}
\begin{proof}
Let
\begin{align*}
  \ff(x) &\eqd (1-x)^p \sum_{n=0}^{p-1} {p-1+n \choose n} x^n      \\
  \fg(x) &\eqd x^p     \sum_{n=0}^{p-1} {p-1+n \choose n} (1-x)^n  \\
  q      &\eqd p-1
\end{align*}
%\begin{enumerate}
%  \item Proofs for $\ff^{(n)}(0)$:
  \begin{enumerate}
  \item Proof that $\ff(0)=1$:
  \begin{align*}
  \ff(0)
    &= \left.(1-x)^p \sum_{m=0}^{p-1} {p-1+m\choose m} x^m \right|_{x=0}
  \\&= \left.(1-x)^p \brs{{p-1 \choose 0} + \sum_{m=1}^{p-1} {p-1+m\choose m} x^m}\right|_{x=0}
  \\&= 1
  \end{align*}

  \item Proof that
      $\ds\ff(x)=
       p \sum_{n=0}^{2p-1}
       \brs{\sum_{k=\max(0,n-q)}^{\min(n,p)} (-1)^k \frac{(p+n-k-1)!}{(p-k)!(n-k)!\,k!}}
       x^n$:
  \begin{align*}
  (1-x)^p \fP_m(x)
    &= \sum_{n=0}^p     {p\choose n} (-1)^n x^n
       \sum_{m=0}^{p-1} {p-1+m\choose m} x^m
  \\&= \sum_{n=0}^{2p-1} \sum_{k=\max(0,n-q)}^{\min(n,p)}
       {p\choose k} (-1)^k {p-1+n-k\choose n-k} x^n
    && \text{by \prefp{thm:polymult}}
  \\&= \sum_{n=0}^{2p-1} \sum_{k=\max(0,n-q)}^{\min(n,p)}
       (-1)^k \frac{p!}{(p-k)!k!} \frac{(p-1+n-k)!}{(p-1)!(n-k)!} x^n
  \\&= p \sum_{n=0}^{2p-1}
       \brs{\sum_{k=\max(0,n-q)}^{\min(n,p)} (-1)^k \frac{(p+n-k-1)!}{(p-k)!(n-k)!\,k!}}
       x^n
  \end{align*}

  \item Proof that $\ff^{(n)}(0)=\kdelta_n$ for $n=0,1,2,\ldots,p-1$:
  \begin{align*}
  \left.\deriv{^n}{x^n}\brs{ (1-x)^p \fP_m(x) }\right|_{x=0}
    &= \left.
       \deriv{^n}{x^n}\brs{
         p \sum_{m=0}^{2p-1}
         \brs{\sum_{k=\max(0,m-q)}^{\min(m,p)} (-1)^k \frac{(p+m-k-1)!}{(p-k)!(m-k)!\,k!}}
         x^m
       }
       \right|_{x=0}
    && \text{by 1.}
  \\&= \left. p
       \sum_{m=n}^{2p-1} \sum_{k=\max(0,m-q)}^{\min(m,p)}
       (-1)^k \frac{(p-1+m-k)!}{(p-k)!(m-k)!k!} \frac{m!}{(m-n)!}x^{m-n}
       \right|_{x=0}
  \\&= p \sum_{k=\max(0,n-q)}^{\min(n,p)}
       (-1)^k \frac{(p-1+n-k)!}{(p-k)!} \frac{n!}{(n-k)!k!}
  \\&= p \sum_{k=0}^n
       (-1)^k {n\choose k} \frac{(p+n-k-1)!}{(p-k)!}
  \\&\eqq \kdelta_n \qquad\text{for } n=0,1,2,\ldots,p-1
  \end{align*}

  \item Proof that $\ff^{(n)}(0)=\kdelta_n$ for $n=0,1,2,\ldots,p-1$:
  \begin{align*}
  &\left.\deriv{^n}{x^n}\brs{ (1-x)^p \fP_m(x) }\right|_{x=0}
  \\&= \left.
       \sum_{k=0}^n {n\choose k}
       \brs{\deriv{^{n-k}}{x^{n-k}} (1-x)^p }
       \brs{\deriv{^k}{x^k}\fP_m(x) }
       \right|_{x=0}
    \qquad\text{by \pref{lem:LGPR} (Leibnitz rule)}
  \\&= \left.
       \sum_{k=0}^n {n\choose k}
       \brs{\deriv{^{n-k}}{x^{n-k}} (1-x)^p }
       \brs{\deriv{^k}{x^k} \sum_{m=0}^{p-1}{p-1+m \choose m} x^m }
       \right|_{x=0}
    \quad\text{by definition of $\fP_m(x)$}
  \\&= \left.
       \sum_{k=0}^n {n\choose k}
       \brs{(-1)^{n-k}\frac{p!}{(p-n+k)!} (1-x)^{(p-n+k)} }
       \brs{\sum_{m=k}^{p-1}{p-1+m \choose m} \frac{m!}{(m-k)!}x^{m-k} }
       \right|_{x=0}
  \\&= \sum_{k=0}^n {n\choose k}
       \brs{(-1)^{n-k}\frac{p!}{(p-n+k)!}}
       \brs{{p-1+k \choose k} k! }
  \\&= \sum_{k=0}^n {n\choose k}
       \brs{(-1)^{n-k}\frac{p!}{(p-n+k)!}}
       \brs{\frac{(p-1+k)!}{(p-1)!k!}\; k! }
  \\&= (-1)^n p
       \sum_{k=0}^n {n\choose k}
       (-1)^k\frac{(p+k-1)!}{(p+k-n)!}
  \\&\eqq \kdelta_n \qquad \text{for } k=0,1,2,\ldots,p-1
  \end{align*}

  \item Proof that $\ff^{(n)}(1)=0$ for $n=0,1,2,\ldots,p-1$:
  \begin{align*}
  \left.\deriv{^n}{x^n}\brs{ (1-x)^p \fP_m(x) }\right|_{x=1}
    &= \left.
       \sum_{k=0}^n {n\choose k}
       \brs{\deriv{^k}{x^k} (1-x)^p }
       \fP_m^{(n-k)}(x)
       \right|_{x=1}
    && \text{by \pref{lem:LGPR} (Leibnitz rule)}
  \\&= \left.
       \sum_{k=0}^n {n\choose k}
       \brs{(-1)^k\frac{p!}{(p-k)!} (1-x)^{p-k} }
       \fP_m^{(n-k)}(x)
       \right|_{x=1}
  \\&= \left.
       \sum_{k=0}^n {n\choose k} \; 0\cdot
       \fP_m^{(n-k)}(x)
       \right|_{x=1}
    && \text{by \pref{lem:LGPR}}
  \\&= 0 \qquad \text{for } k=0,1,2,\ldots,p-1
  \end{align*}
\end{enumerate}
%\end{enumerate}
\end{proof}


\ifdochasnot{sampling}{\input{../common/pwspace.tex}}




