%============================================================================
% Daniel J. Greenhoe
% LaTeX file
% linear congruential (LCG) pseudo-random number generator (PRNG) mappings
% x_{n+1} = (7x_n+5)mod 9
% y_{n+1} = (y_n+2)mod 5
%============================================================================
\begin{pspicture}(-2.25,-2.25)(11.5,2.25)%
  %---------------------------------
  % options
  %---------------------------------
  \psset{%
    radius=1.25ex,
    labelsep=2.5mm,
    linecolor=blue,%
    }%
  %---------------------------------
  % LCG PRNG graph G
  % x_{n+1} = (7x_n+5)mod 9
  %   n  0   1   2   3   4   5   6   7   8  ;  9
  % x_n  1   3   8   7   0   5   4   6   2  ;  1
  %---------------------------------
  \rput(0,0){\psset{unit=1.5\psunit}%
    \rput{   0}(0,0){\rput(1,0){\Cnode[fillstyle=solid,fillcolor=snode](0,0){G1}}}%
    \rput{  40}(0,0){\rput(1,0){\Cnode[fillstyle=solid,fillcolor=snode](0,0){G3}}}%
    \rput{  80}(0,0){\rput(1,0){\Cnode[fillstyle=solid,fillcolor=snode](0,0){G8}}}%
    \rput{ 120}(0,0){\rput(1,0){\Cnode[fillstyle=solid,fillcolor=snode](0,0){G7}}}%
    \rput{ 160}(0,0){\rput(1,0){\Cnode[fillstyle=solid,fillcolor=snode](0,0){G0}}}%
    \rput{ 200}(0,0){\rput(1,0){\Cnode[fillstyle=solid,fillcolor=snode](0,0){G5}}}%
    \rput{ 240}(0,0){\rput(1,0){\Cnode[fillstyle=solid,fillcolor=snode](0,0){G4}}}%
    \rput{ 280}(0,0){\rput(1,0){\Cnode[fillstyle=solid,fillcolor=snode](0,0){G6}}}%
    \rput{ 320}(0,0){\rput(1,0){\Cnode[fillstyle=solid,fillcolor=snode](0,0){G2}}}%
    \rput(0,0){$\ocsG_9$}%
    }%
  \rput(G8){$8$}%
  \rput(G7){$7$}%
  \rput(G6){$6$}%
  \rput(G5){$5$}%
  \rput(G4){$4$}%
  \rput(G3){$3$}%
  \rput(G2){$2$}%
  \rput(G1){$1$}%
  \rput(G0){$0$}%
  %          
  \ncline{G1}{G3}%
  \ncline{G3}{G8}%
  \ncline{G8}{G7}%
  \ncline{G7}{G0}%
  \ncline{G0}{G5}%
  \ncline{G5}{G4}%
  \ncline{G4}{G6}%
  \ncline{G6}{G2}%
  \ncline{G2}{G1}%
  %
  \uput[  0](G1){$\frac{1}{9}$}
  \uput[ 40](G3){$\frac{1}{9}$}
  \uput[ 80](G8){$\frac{1}{9}$}
  \uput[120](G7){$\frac{1}{9}$}
  \uput[160](G0){$\frac{1}{9}$}
  \uput[200](G5){$\frac{1}{9}$}
  \uput[240](G4){$\frac{1}{9}$}
  \uput[280](G6){$\frac{1}{9}$}
  \uput[320](G2){$\frac{1}{9}$}
  %
  %
  %---------------------------------
  %---------------------------------
  %---------------------------------
  \rput(5,0){% shaped outcomes spaces
  %---------------------------------
  %---------------------------------
  %---------------------------------
  %
  %
  %---------------------------------
  % distribution shaping mapping y_n=s(x_n) to 5 element set
  %   n  0   1   2   3   4   5   6   7   8  ;  9
  % x_n  1   3   8   7   0   5   4   6   2  ;  1
  % y_n  1   3   0   2   4 ; 0   3   4   4  ;  1
  %---------------------------------
  \rput( 0,0){%\psset{unit=2\psunit}%
    \rput{288}(0,0){\rput(1,0){\Cnode(0,0){S4}}}%
    \rput{216}(0,0){\rput(1,0){\Cnode(0,0){S2}}}%
    \rput{144}(0,0){\rput(1,0){\Cnode(0,0){S0}}}%
    \rput{ 72}(0,0){\rput(1,0){\Cnode[fillstyle=solid,fillcolor=snode](0,0){S3}}}%
    \rput{  0}(0,0){\rput(1,0){\Cnode(0,0){S1}}}%
    \rput(0,0){$\ocsG$}%
    }
  \rput(S4){$4$}%
  \rput(S3){$3$}%
  \rput(S2){$2$}%
  \rput(S1){$1$}%
  \rput(S0){$0$}%
  %
  %\ncline{S4}{S0}
  \ncline{S4}{S1}\ncline{S3}{S4}%
  \ncline{S2}{S4}%
  \ncline{S0}{S2}%
  \ncline{S3}{S0}%
  \ncline{S1}{S3}%
  %
  \uput[288](S4){$\frac{3}{9}$}
  \uput[ 72](S3){$\frac{2}{9}$}
  \uput[216](S2){$\frac{1}{9}$}
  \uput[  0](S1){$\frac{1}{9}$}
  \uput[144](S0){$\frac{2}{9}$}
  %
  \ncarc[arcangle= 22,linewidth=0.75pt,linecolor=red]{->}{G8}{S0}%
  \ncarc[arcangle= 67,linewidth=0.75pt,linecolor=red]{->}{G7}{S2}%
  \ncarc[arcangle=-45,linewidth=0.75pt,linecolor=red]{->}{G6}{S4}%
  \ncarc[arcangle=-22,linewidth=0.75pt,linecolor=red]{->}{G5}{S0}%
  \ncarc[arcangle=-22,linewidth=0.75pt,linecolor=red]{->}{G4}{S3}%
  \ncarc[arcangle= 22,linewidth=0.75pt,linecolor=red]{->}{G3}{S3}%
  \ncarc[arcangle=-22,linewidth=0.75pt,linecolor=red]{->}{G2}{S4}%
  \ncarc[arcangle= 10,linewidth=0.75pt,linecolor=red]{->}{G1}{S1}%
  \ncarc[arcangle= 22,linewidth=0.75pt,linecolor=red]{->}{G0}{S4}%
  %%---------------------------------
  %% random variable mapping Y from S to integer line 
  %%---------------------------------
  %\rput(0,3){%\psset{unit=0.75\psunit}%
  %  \pnode(3,0){YB}%
  %  \Cnode(2,0){Y4}%
  %  \Cnode[fillstyle=solid,fillcolor=snode](1,0){Y3}%
  %  \Cnode[fillstyle=solid,fillcolor=snode](0,0){Y2}%
  %  \Cnode(-1,0){Y1}%
  %  \Cnode(-2,0){Y0}%
  %  \pnode(-3,0){YA}%
  %  }
  %\rput(Y4){$4$}%
  %\rput(Y3){$3$}%
  %\rput(Y2){$2$}%
  %\rput(Y1){$1$}%
  %\rput(Y0){$0$}%
  %%
  %\ncline[linestyle=dotted]{Y4}{YB}%
  %\ncline{Y3}{Y4}%
  %\ncline{Y2}{Y3}%
  %\ncline{Y1}{Y2}%
  %\ncline{Y0}{Y1}%
  %\ncline[linestyle=dotted]{Y0}{YA}%
  %%
  %\uput[ 0](YB){$\Z$}
  %\uput[90](Y4){$\frac{3}{9}$}
  %\uput[90](Y3){$\frac{2}{9}$}
  %\uput[90](Y2){$\frac{1}{9}$}
  %\uput[90](Y1){$\frac{1}{9}$}
  %\uput[90](Y0){$\frac{2}{9}$}
  %%
  %\ncarc[arcangle=-45,linewidth=0.75pt,linecolor=red]{->}{S4}{Y4}%
  %\ncarc[arcangle= 22,linewidth=0.75pt,linecolor=red]{->}{S3}{Y3}%
  %\ncarc[arcangle= 45,linewidth=0.75pt,linecolor=red]{->}{S2}{Y2}%
  %\ncarc[arcangle=-22,linewidth=0.75pt,linecolor=red]{->}{S1}{Y1}%
  %\ncarc[arcangle= 22,linewidth=0.75pt,linecolor=red]{->}{S0}{Y0}%
  %---------------------------------
  % random variable mapping Z from S to ring-like structure 
  %---------------------------------
  \rput( 5,0){%\psset{unit=2\psunit}%
    \rput{288}(0,0){\rput(1,0){\Cnode(0,0){Z4}}}%
    \rput{216}(0,0){\rput(1,0){\Cnode(0,0){Z2}}}%
    \rput{144}(0,0){\rput(1,0){\Cnode(0,0){Z0}}}%
    \rput{ 72}(0,0){\rput(1,0){\Cnode[fillstyle=solid,fillcolor=snode](0,0){Z3}}}%
    \rput{  0}(0,0){\rput(1,0){\Cnode(0,0){Z1}}}%
    \rput(0,0){$\omsH$}%
    }
  \rput(Z4){$4$}%
  \rput(Z3){$3$}%
  \rput(Z2){$2$}%
  \rput(Z1){$1$}%
  \rput(Z0){$0$}%
  %
  %\ncline{Z4}{Z0}
  \ncline{Z4}{Z1}\ncline{Z2}{Z4}\ncline{Z3}{Z4}%
  \ncline{Z2}{Z4}%
  \ncline{Z0}{Z2}%
  \ncline{Z3}{Z0}%
  \ncline{Z1}{Z3}%
  %
  \uput[288](Z4){$\frac{3}{9}$}%
  \uput[ 72](Z3){$\frac{2}{9}$}%
  \uput[216](Z2){$\frac{1}{9}$}%
  \uput[  0](Z1){$\frac{1}{9}$}%
  \uput[144](Z0){$\frac{2}{9}$}%
  %
  \ncarc[arcangle=-22,linewidth=0.75pt,linecolor=green]{->}{S4}{Z4}%
  \ncarc[arcangle= 22,linewidth=0.75pt,linecolor=green]{->}{S3}{Z3}%
  \ncarc[arcangle=-10,linewidth=0.75pt,linecolor=green]{->}{S2}{Z2}%
  \ncarc[arcangle= 10,linewidth=0.75pt,linecolor=green]{->}{S1}{Z1}%
  \ncarc[arcangle=-10,linewidth=0.75pt,linecolor=green]{->}{S0}{Z0}%
  %%---------------------------------
  %% random variable mapping X from S to real line
  %%---------------------------------
  %\rput(0,-3){%\psset{unit=0.5\psunit}%
  %  \psline{<->}(-2.5,0)(2.5,0)%
  %  \multirput(-2,0)(1,0){5}{\psline(0,-0.1)(0,0.1)}%
  %  \pnode(2.5,0){XB}%
  %  \pnode( 2,0){X4}%
  %  \pnode( 1,0){X3}%
  %  \pnode(0.4,0){X240}%
  %  \pnode(0.33,0){X233}%
  %  \pnode( 0,0){X2}%
  %  \pnode(-1,0){X1}%
  %  \pnode(-2,0){X0}%
  %  \pnode(-2.5,0){XA}%
  %  }
  %%
  %\rput(X240){\pscircle[fillstyle=solid,linecolor=snode,fillcolor=snode](0,0){1ex}}%
  %\rput(X233){\pscircle[fillstyle=none,linecolor=red,fillcolor=red](0,0){1ex}}%
  %%
  %\uput{1.5mm}[-90](X4){$\frac{3}{9}$}%
  %\uput{1.5mm}[-90](X3){$\frac{2}{9}$}%
  %\uput{1.5mm}[-90](X2){$\frac{1}{9}$}%
  %\uput{1.5mm}[-90](X1){$\frac{1}{9}$}%
  %\uput{1.5mm}[-90](X0){$\frac{2}{9}$}%
  %%
  %\uput[0](XB){$\R$}%
  %\uput{1.5mm}[90](X4){$4$}%
  %\uput{1.5mm}[90](X3){$3$}%
  %\uput{1.5mm}[90](X2){$2$}%
  %\uput{1.5mm}[90](X1){$1$}%
  %\uput{1.5mm}[90](X0){$0$}%
  %%
  %\ncarc[arcangle= 22,linewidth=0.75pt,linecolor=purple]{->}{S4}{X4}%
  %\ncarc[arcangle= 67,linewidth=0.75pt,linecolor=purple]{->}{S3}{X3}%
  %\ncarc[arcangle=-22,linewidth=0.75pt,linecolor=purple]{->}{S2}{X2}%
  %\ncarc[arcangle= 45,linewidth=0.75pt,linecolor=purple]{->}{S1}{X1}%
  %\ncarc[arcangle=-22,linewidth=0.75pt,linecolor=purple]{->}{S0}{X0}%
  %---------------------------------
  % labels
  %---------------------------------
  %\rput(0,1.9){$\rvY(\cdot)$}%
  %\rput(0,-1.9){$\rvX(\cdot)$}%
  \rput(2.75,0){$\rvZ(\cdot)$}%
  %\ncline[linestyle=dotted,nodesep=1pt]{->}{xzlabel}{xz}%
  %\ncline[linestyle=dotted,nodesep=1pt]{->}{ylabel}{y}%
  }%
  \rput(2.75,0){$\fs(x_n)$}%
\end{pspicture}%