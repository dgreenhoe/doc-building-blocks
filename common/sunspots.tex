%============================================================================
% LaTeX File
% Daniel J. Greenhoe
%============================================================================

Sunspot data:\footnote{\citer{wdcsilo_sunspot_20210524}}
%\\\includegraphics[width=\tw-10mm,height=50mm]{../common/math/graphics/pdfs/sunspots_1749-2004.pdf}\footnote{\url{https://d32ogoqmya1dw8.cloudfront.net/files/introgeo/teachingwdata/examples/GreenwichSSNvstime.txt}}
\\\includegraphics[width=\tw]{../common/math/graphics/pdfs/sunspots.pdf}
\\The period the sunspot activity can be estimated using several methods\ldots

%---------------------------------------
\begin{example}[\exmd{Sunspot period estimation using ACF}]
\label{ex:sunspots}
\label{ex:sunspot_period_ACF}
%---------------------------------------
Period estimation using an estimated \fncte{auto-correlation function} (ACF);
Here other than at lag=0, the greatest\footnote{$20\log_{10}\brp{\frac{0.5918556724}{0.3730703718}}\eqa4.01$dB greater}
 correlation occurs at 10.42 years \ldots implying a sunspot oscillation with estimated period 10.42 years.
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_acf.pdf}
\end{example}

%---------------------------------------
\begin{example}[\exmd{Sunspot period estimation using PSD}]
\label{ex:sunspot_period_PSD}
%---------------------------------------
Period estimation using the \fncte{power spectral density} (PSD) of sunspot data, PSD estimated in turn using the \ope{Welch Method}:
\\\indentx$\brbr{\begin{array}{|r|l|r|}
  \hline
  \mc{1}{|N}{number of} & \mc{1}{|N}{peak frequency} & \mc{1}{|N|}{period}\\
  \mc{1}{|N}{segments}  & \mc{1}{|N}{(samples/year)} & \mc{1}{|N|}{(years)}
  \\\hline
     2 & 0.08812729 & 11.34722222
  \\ 3 & 0.08823529 & 11.33333333
  \\ 4 & 0.08823529 & 11.33333333
  \\ 5 & 0.09202454 & 10.86666667
  \\ 6 & 0.08823529 & 11.33333333
  \\ 7 & 0.10300429 &  9.70833333
  \\ 8 & 0.08823529 & 11.33333333
  \\ 9 & 0.09944751 & 10.05555556
  \\10 & 0.11042945 &  9.05555556
  \\\hline
\end{array}} \begin{array}{MclM}
               mode   period &\eqa& 11.3 & years\\
               median period &\eqa& 11.3 & years\\
               mean   period &\eqa& 10.7 & years
             \end{array}$
\\Here is a plot using Welch Method with number of segments = 4:
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_psd.pdf}
\end{example}

%---------------------------------------
\begin{example}[\exmd{Sunspot period estimation using DFT}]
\label{ex:sunspot_period_DFT}
%---------------------------------------
DFT analysis: The basis vectors are sampled sinusoids.
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_dft_basis.pdf}
\\Coefficients can be calculated by projecting scaled zero-mean sunspot data onto sinusoidal basis using DFT/FFT
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_dft_coefs_Real.pdf}
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_dft_coefs_Imag.pdf}
\\ACF of the coefficients
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_dft_acf.pdf}
\\Synthesis
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_dft_syn.pdf}
\end{example}

%---------------------------------------
\begin{example}[\exmd{Sunspot period estimation using Eigen system}]
\label{ex:sunspot_period_Eigen}
%---------------------------------------
Eigen analysis;
\begin{enumerate}
\item The DFT primary frequencies of the first 10 of these eigen values are \ldots
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_eigen.pdf}
\\$\begin{array}{|r|r|r|r|MlM|}
  \hline
     n & \lambda_n  & \mc{1}{N|}{$f$ (Hz)} & \mc{1}{N|}{$T$ (years)} & \mc{3}{N|}{Weighted period using $1$--$n$ (years)}
  \\\hline
     1 & 253.543147 &  0.089955 & 11.116667 & weighted period using 1    : & 11.11666667 & years
  \\ 2 & 250.981384 &  0.089955 & 11.116667 & weighted period using 1--2 : & 11.11666667 & years
  \\ 3 & 119.265072 &  0.095952 & 10.421875 & weighted period using 1--3 : & 10.98382640 & years
  \\ 4 & 119.253338 &  0.095952 & 10.421875 & weighted period using 1--4 : & 10.89363702 & years
  \\ 5 &  96.288166 &  0.101949 &  9.808824 & weighted period using 1--5 : & 10.76918709 & years
  \\ 6 &  95.069013 &  0.083958 & 11.910714 & weighted period using 1--6 : & 10.88532991 & years
  \\ 7 &  73.982222 &  0.011994 & 83.375000 & weighted period using 1--7 : & 16.20369641 & years
  \\ 8 &  67.216471 &  0.011994 & 83.375000 & weighted period using 1--8 : & 20.40137489 & years
  \\ 9 &  51.990321 &  0.083958 & 11.910714 & weighted period using 1--9 : & 20.00989172 & years
  \\10 &  50.999349 &  0.083958 & 11.910714 & weighted period using 1--10: & 19.65942777 & years
  \\11 &  34.936578 &  0.017991 & 55.583333 & weighted period using 1--11: & 20.69365308 & years
  \\12 &  33.830843 &  0.017991 & 55.583333 & weighted period using 1--12: & 21.63993254 & years
  \\\hline
\end{array}$

\item Coefficients calculated by projecting data onto eigen vectors:
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_eigen_coefs.pdf}

\item Eigen synthesis using 1, 6, and 105 coefficients:
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_eigen_syn.pdf}

\item The ACF of the eigen coefficient sequence demonstrates that
      it is much whiter than the original sunspot data sequence:
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_coefs_acf.pdf}

\end{enumerate}
\end{example}

%---------------------------------------
\begin{example}[\exmd{Sunspot period estimation using Walsh sequence}]
\label{ex:sunspot_period_Walsh}
%---------------------------------------
Walsh Sequence analysis;
Basis vectors:
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_walsh_0.pdf}
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_walsh_1.pdf}
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_walsh_2.pdf}
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_walsh_3.pdf}
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_walsh_4.pdf}
\\Coefficients
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_walsh_coefs.pdf}
\\Synthesis
\\\includegraphics[width=\tw-12mm]{../common/math/graphics/pdfs/sunspots_walsh_syn.pdf}
\end{example}
