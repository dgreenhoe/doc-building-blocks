%============================================================================
% Daniel J. Greenhoe
% LaTeX file
% N_3(x) B-spline
% nominal unit = 10mm
%============================================================================
\begin{pspicture}(-1,-0.5)(4,1.5)
  %-------------------------------------
  % axes
  %-------------------------------------
  \psaxes[linewidth=0.75pt,linecolor=axis,yAxis=false,ticks=none,labels=none]{<->}(0,0)(-1,0)(4,1.5)% x axis
  \psaxes[linewidth=0.75pt,linecolor=axis,xAxis=false,ticks=none,labels=none]{->}(0,0)(-1,0)(4,1.5)%  y axis
  %-------------------------------------
  % annotation
  %-------------------------------------
  \psline[linestyle=dashed,linewidth=0.75pt,linecolor=axis](1.5,0)(1.5,0.75)%
  \psline[linestyle=dashed,linewidth=0.75pt,linecolor=axis](0,0.75)(1.5,0.75)%
  \psline[linestyle=dashed,linewidth=0.75pt,linecolor=axis](0,0.5)(2,0.5)%
  \psline[linestyle=solid,linewidth=0.75pt,linecolor=black](3,0.1)(3,-0.1)%
  \psline[linestyle=solid,linewidth=0.75pt,linecolor=black](2,0.1)(2,-0.1)%
  \psline[linestyle=solid,linewidth=0.75pt,linecolor=black](1.5,0)(1.5,-0.1)%
  \psline[linestyle=solid,linewidth=0.75pt,linecolor=black](1,0.1)(1,-0.1)%
  \psline[linestyle=solid,linewidth=0.75pt,linecolor=black](0,0.1)(0,-0.1)%
  \uput[180](0,0.75){$\sfrac{3}{4}$}%
  \uput[180](0,0.50){$\sfrac{1}{2}$}%
  \rput[t](0,-5pt){%
    \rput[t](1.5,0){$\sfrac{3}{2}$}%
    \rput[t](0,0){$0$}%
    \rput[t](1,0){$1$}%
    \rput[t](2,0){$2$}%
    \rput[t](3,0){$3$}%
    }%
  %-------------------------------------
  % N2(x)
  %-------------------------------------
  \psplot[plotpoints=64]{0}{1}{ 0.5 x 2 exp mul}%                       0.5 x^2             for 0 <= x <= 1
  \psplot[plotpoints=64]{1}{2}{-1.0 x 2 exp mul 3 x mul add 1.5 sub}%      -x^2 + 3x - 1.5  for 1 <= x <= 2
  \psplot[plotpoints=64]{2}{3}{ 0.5 x 2 exp mul 3 x mul sub 4.5 add}%   0.5 x^2 - 3x + 4.5  for 2 <= x <= 3
  \psline(0,0)(-0.5,0)\psline[linestyle=dotted](-0.5,0)(-0.75,0)%                    0    for x <= 0
  \psline(3,0)(3.5,0)\psline[linestyle=dotted](3.5,0)(3.75,0)%                       0    for x >= 0
  %-------------------------------------
  % h_k coefficients
  %        sqrt(2) (n+1)
  % h_k = -------- (   ) = (0.17677669529663688110021109052...) x {1, 3, 3, 1}
  %        2^(n+1) ( k )
  %-------------------------------------
  \pnode(0, 0.17677669529663688110021109052621){h0}%
  \pnode(1, 0.53033008588991064330063327157864){h1}%
  \pnode(2, 0.53033008588991064330063327157864){h2}%
  \pnode(3, 0.17677669529663688110021109052621){h3}%
  \psline[linecolor=red]{-o}(0,0)(h0)%
  \psline[linecolor=red]{-o}(1,0)(h1)%
  \psline[linecolor=red]{-o}(2,0)(h2)%
  \psline[linecolor=red]{-o}(3,0)(h3)%
  \uput{2pt}[20](h0){$\scy\frac{\sqrt{2}}{8}=0.176\cdots$}%
  \uput{3pt}[90](h1){$\scy\frac{3\sqrt{2}}{8}$}%
  \uput{3pt}[60](h2){$\scy\frac{3\sqrt{2}}{8}=0.530\cdots$}%
  \uput{2pt}[20](h3){$\scy\frac{\sqrt{2}}{8}$}%
\end{pspicture}
