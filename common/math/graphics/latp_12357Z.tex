%============================================================================
% Daniel J. Greenhoe
% LaTeZ file
% wavelet subspace lattice
% nominal unit = 10mm
%============================================================================
\begin{pspicture}(-2.6,0.2)(2.6,3.4)%
  \psset{
    boxsize=0.40\psunit,
    linearc=0.40\psunit,
    }%
  %---------------------------------
  % nodes
  %---------------------------------
  \Cnode(0,3){Z}%    1
  \pnode(-0.25,2.75){qdots}%
  \Cnode(-0.50,2.5){q210}%
  \Cnode(-1,2){q30}% q30
  \Cnode(-1.50,1.5){q6}% q6
  \Cnode(-2,1){p2}\Cnode(-1,1){p3}\Cnode( 0,1){p5}\Cnode( 1,1){p7}\pnode(1.5,1){pdots}\Cnode(2,1){P}%
  \Cnode( 0,0.5){p1}%    0
  %---------------------------------
  % node labels
  %---------------------------------
  \uput{1.5mm}[0](Z)  {$\Z$}%
  \rput{45}(qdots) {{\color{blue}\Large$\cdots$}}%
  \uput{1.5mm}[0](q210) {$\setn{\mathbf{210},\cdots}$}%
  \uput{1.5mm}[0](q30) {$\brb{\begin{tabstr}{0.75}\begin{array}{l}\mathbf{30},27,25,24,20,18,16,15,12,\\10,9,8,6,5,4,2,3,1\end{array}\end{tabstr}}$}%
  \uput{1.5mm}[0](q6) {$\setn{\mathbf{6},4,3,2,1}$}%
  \uput{1.5mm}[180](p2) {$2$}%
  \uput{1.5mm}[180](p3) {$3$}%
  \uput{1.5mm}[  0](p5) {$5$}%
  \uput{1.5mm}[  0](p7) {$7$}%
  \rput[0](pdots){{\color{blue}\Large$\cdots$}}%
  %\uput{1.5mm}[  0](P){}%
  \uput{1.5mm}[-90](p1)  {$1$}%
  %---------------------------------
  % node connections
  %---------------------------------
  \ncline{Z}{P}%   Wn-1 --> 1
  \ncline{q210}{q30}\ncline{q210}{p7}%
  \ncline{q30}{q6}\ncline{q30}{p5}%
  \ncline{q6}{p2}\ncline{q6}{p3}%
  \ncline{p1}{p2}\ncline{p1}{p3}\ncline{p1}{p5}\ncline{p1}{p7}\ncline{p1}{P}%
  %---------------------------------
  % discriptions
  %---------------------------------
  \ncbox[nodesep=0.25\psunit,linestyle=dotted,linecolor=red]{p2}{P}%
  \ncbox[nodesep=0.25\psunit,linestyle=dotted,linecolor=red]{p2}{Z}%
  %\ncbox[nodesep=7pt,linestyle=dotted,linecolor=red]{p3}{p7}%
  %\ncbox[nodesep=7pt,linestyle=dotted,linecolor=red]{p2}{Z}%
  %\rnode{wavsubbox}  {\ncbox[nodesep=50\psunit,linestyle=dotted,linecolor=red]{p3}{p7}}%
  %\rnode{scalesubbox}{\ncbox[nodesep=50\psunit,linestyle=dotted,linecolor=red]{p2}{Z}}%
  \pnode[0,-0.40](p7){wavsubbox}%  
  \pnode[0,0.60](q30){scalesubbox}%
  %\rput[ 0](  5,10){\psellipse[fillstyle=none,linestyle=dashed,linecolor=red](0,0)(20,5)}%
  %\rput{45}(-12,22){\psellipse[fillstyle=none,linestyle=dashed,linecolor=red](0,0)(25,6)}%
  \rput[tl](0.8,0.5){\rnode{wavsublabel}{prime numbers}}%
  %\psline[linecolor=red]{->}(24,24)(20,14)%
  \rput[b]{45}(-1.4,2.4){\rnode{scalesublabel}{factors of primes}}%
 %\psline[linecolor=red]{->}(-15,36)(-15,26)%
  %\ncline[linecolor=red]{->}{wavsublabel}{wavsubbox}%
  %\ncline[linecolor=red]{->}{scalesublabel}{scalesubbox}%
\end{pspicture}%
