%============================================================================
% Daniel J. Greenhoe
% LaTeX file
% nominal unit = 10mm
% dyadic decomposition of n=1 order B-spline N1(x)
%          1  n+1 (n+1)             1  n+1 (2)         
% N1(x) = --- SUM (   ) Nn(2x-k) = --- SUM ( ) N1(2x-k)
%         2^n k=0 ( k )             2  k=0 (k)         
%============================================================================
\begin{pspicture}(-1,-0.5)(4,1.25)
  %-------------------------------------
  % axes
  %-------------------------------------
  \psaxes[linewidth=0.75pt,linecolor=axis,yAxis=false,ticks=none,labels=none]{<->}(0,0)(-1,0)(4,1.25)% x axis
  \psaxes[linewidth=0.75pt,linecolor=axis,xAxis=false,ticks=none,labels=none]{->}(0,0)(-1,0)(4,1.25)%  y axis
  %-------------------------------------
  % annotation
  %-------------------------------------
  %\multirput(0.5,0)(0.5,0){7}{% x-tics
  %  \psline[linecolor=axis,linewidth=0.5pt,linestyle=dashed](0,-0.1)(0,0.1)%
  %  }%
  %\multirput(0,0.5)(0,0.5){2}{% y-tics
  %  \psline[linecolor=axis,linewidth=0.5pt,linestyle=dashed](-0.1,0)(0.1,0)%
  %  }%
  \psline[linestyle=dotted,linewidth=0.5pt,linecolor=axis](1.5,0)(1.5,0.75)%
  \psline[linestyle=dotted,linewidth=0.5pt,linecolor=axis](0,0.75)(1.5,0.75)%
  \psline[linestyle=dotted,linewidth=0.5pt,linecolor=axis](0,0.5625)(1.75,0.5625)%
  \psline[linestyle=dotted,linewidth=0.5pt,linecolor=axis](1.25,0)(1.25,0.5625)%
  \psline[linestyle=dotted,linewidth=0.5pt,linecolor=axis](1.75,0)(1.75,0.5625)%
  \psline[linestyle=dotted,linewidth=0.5pt,linecolor=axis](0,0.1875)(2.25,0.1875)%
  \psline[linestyle=dotted,linewidth=0.5pt,linecolor=axis](0.75,0)(0.75,0.1875)%
  \psline[linestyle=dotted,linewidth=0.5pt,linecolor=axis](2.25,0)(2.25,0.1875)%
  \rput[r](-2pt,0){%
    \rput[r](0,0.75){$\sfrac{3}{4}$}%
    \rput[r](0,0.5625){$\sfrac{9}{16}$}%
    \rput[r](0,0.1875){$\sfrac{3}{16}$}%
    }%
  \rput[t](0,-2pt){%
    \rput[t](0.75,0){$\sfrac{3}{4}$}%
    \rput[t](1.25,0){$\sfrac{5}{4}$}%
    %\rput[t](1.5,0){$\frac{3}{2}$}%
    \rput[t](1.75,0){$\sfrac{7}{4}$}%
    \rput[t](2.25,0){$\sfrac{9}{4}$}%
    \rput[t](0,0){$0$}%
    %\rput[t](0.5,0){$\sfrac{1}{2}$}%
    %\rput[t](1,0){$1$}%
    %\rput[t](1.5,0){$\sfrac{3}{2}$}%
    %\rput[t](2,0){$2$}%
    %\rput[t](2.5,0){$\sfrac{5}{2}$}%
    \rput[t](3,0){$3$}%
    }%
  %\uput[135](0.5,0.5){$\fN_1(2x-0)$}%
  %\uput[-90](1,1){$\fN_1(2x-1)$}%
  %\uput[45](1.5,0.5){$\fN_1(2x-2)$}%
  %-------------------------------------
  % N2(x)
  %-------------------------------------
  \psplot[plotpoints=64]{0}{1}{ 0.5 x 2 exp mul}%                       0.5 x^2             for 0 <= x <= 1
  \psplot[plotpoints=64]{1}{2}{-1.0 x 2 exp mul 3 x mul add 1.5 sub}%      -x^2 + 3x - 1.5  for 1 <= x <= 2
  \psplot[plotpoints=64]{2}{3}{ 0.5 x 2 exp mul 3 x mul sub 4.5 add}%   0.5 x^2 - 3x + 4.5  for 2 <= x <= 3
  \psline(0,0)(-0.5,0)\psline[linestyle=dotted](-0.5,0)(-0.75,0)%                    0    for x <= 0
  \psline(3,0)(3.5,0)\psline[linestyle=dotted](3.5,0)(3.75,0)%                       0    for x >= 0
  %-------------------------------------
  % N2(2x-k)
  %-------------------------------------
  \psset{linestyle=solid,linecolor=red,xunit=0.5\psxunit}%
  \rput(0,0){% N2(2x-0)
    \psset{yunit=0.25\psyunit}%
    \psplot[plotpoints=64]{0}{1}{ 0.5 x 2 exp mul}%                       0.5 x^2             for 0 <= x <= 1
    \psplot[plotpoints=64]{1}{2}{-1.0 x 2 exp mul 3 x mul add 1.5 sub}%      -x^2 + 3x - 1.5  for 1 <= x <= 2
    \psplot[plotpoints=64]{2}{3}{ 0.5 x 2 exp mul 3 x mul sub 4.5 add}%   0.5 x^2 - 3x + 4.5  for 2 <= x <= 3
    \psline(0,0)(-0.5,0)\psline[linestyle=dotted](-0.5,0)(-0.75,0)%                    0    for x <= 0
    \psline(3,0)(3.5,0)\psline[linestyle=dotted](3.5,0)(3.75,0)%                       0    for x >= 0
    }%
  \rput(1,0){% N2(2x-1)
    \psset{yunit=0.75\psyunit}%
    \psplot[plotpoints=64]{0}{1}{ 0.5 x 2 exp mul}%                       0.5 x^2             for 0 <= x <= 1
    \psplot[plotpoints=64]{1}{2}{-1.0 x 2 exp mul 3 x mul add 1.5 sub}%      -x^2 + 3x - 1.5  for 1 <= x <= 2
    \psplot[plotpoints=64]{2}{3}{ 0.5 x 2 exp mul 3 x mul sub 4.5 add}%   0.5 x^2 - 3x + 4.5  for 2 <= x <= 3
    \psline(0,0)(-0.5,0)\psline[linestyle=dotted](-0.5,0)(-0.75,0)%                    0    for x <= 0
    \psline(3,0)(3.5,0)\psline[linestyle=dotted](3.5,0)(3.75,0)%                       0    for x >= 0
    }%
  \rput(2,0){% N2(2x-2)
    \psset{yunit=0.75\psyunit}%
    \psplot[plotpoints=64]{0}{1}{ 0.5 x 2 exp mul}%                       0.5 x^2             for 0 <= x <= 1
    \psplot[plotpoints=64]{1}{2}{-1.0 x 2 exp mul 3 x mul add 1.5 sub}%      -x^2 + 3x - 1.5  for 1 <= x <= 2
    \psplot[plotpoints=64]{2}{3}{ 0.5 x 2 exp mul 3 x mul sub 4.5 add}%   0.5 x^2 - 3x + 4.5  for 2 <= x <= 3
    \psline(0,0)(-0.5,0)\psline[linestyle=dotted](-0.5,0)(-0.75,0)%                    0    for x <= 0
    \psline(3,0)(3.5,0)\psline[linestyle=dotted](3.5,0)(3.75,0)%                       0    for x >= 0
    }%
  \rput(3,0){% N2(2x-3)
    \psset{yunit=0.25\psyunit}%
    \psplot[plotpoints=64]{0}{1}{ 0.5 x 2 exp mul}%                       0.5 x^2             for 0 <= x <= 1
    \psplot[plotpoints=64]{1}{2}{-1.0 x 2 exp mul 3 x mul add 1.5 sub}%      -x^2 + 3x - 1.5  for 1 <= x <= 2
    \psplot[plotpoints=64]{2}{3}{ 0.5 x 2 exp mul 3 x mul sub 4.5 add}%   0.5 x^2 - 3x + 4.5  for 2 <= x <= 3
    \psline(0,0)(-0.5,0)\psline[linestyle=dotted](-0.5,0)(-0.75,0)%                    0    for x <= 0
    \psline(3,0)(3.5,0)\psline[linestyle=dotted](3.5,0)(3.75,0)%                       0    for x >= 0
    }%
\end{pspicture}%
