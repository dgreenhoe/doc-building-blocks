%============================================================================
% LaTeX File
% Daniel J. Greenhoe
%============================================================================


%=======================================
\section{Introduction}
%=======================================
In the literature, there are varying and in general incompatible definitions of
\fncte{cross-correlation} functions $\Rxy(n,m)$ and its \ope{wide-sense stationary} special case $\Rxy(m)$. % \xxref{def:Rxynm}{def:Rxym}.
The choice of definitions has consequences for results involving the \fncte{cross-spectral density} function 
$\Swxy(\omega)$, %\xref{def:Swxy}.
which is defined as the \ope{Discrete-time Fourier Transform} of $\Rxy(m)$,
as well as the more general $\Szxy(z)$, 
which is defined as the \ope{Z-Transform} of $\Rxy(m)$:
\begin{definition}\label{def:Swxy}\label{def:Szxy}
\defbox{
  \Swxy(\omega) \eqd \opDTFT\Rxy(m) \eqd \sum_{m\in\Z}\Rxy(m) e^{-i\omega m}
  \qquad\qquad
  \Szxy(z)       \eqd \opZ\Rxy(m) \eqd \sum_{m\in\Z}\Rxy(m) z^{-m}
  }
\end{definition}

%======================================
\section{Definitions}
%======================================
Here is a very limited overview of the definitions of $\Rxy(m)$:
\\\defbox{\begin{array}{lM>{\ds}rc>{\ds}l}
  \mc{5}{M}{References that put conjugate $\conj$ on $\rvy$:}
  \\&\citerpg{papoulis1984}{263}{0070484686} & R_{xy}(m) &\eqd& E\brb{\rvx(m)\rvy^\ast(0)}
  \\&\citerpg{cadzow}{341}{0023180102}       & r_{xy}(m) &\eqd& E\brs{\rvx(m)\rvy^\ast(0)}
  \\&\citeP{matlab_xcorr}                    & R_{xy}(m) &\eqd& E\setn{x_{n+m}y_n^\ast}
  \\&\citeP{matlab_cpsd}                     & R_{xy}(m) &\eqd& E\setn{x_{n+m}y_n^\ast}
  \\
  \mc{5}{M}{References that put conjugate $\conj$ on $\rvx$:}
  \\&\citerpg{kay1988}{52}{8131733564}                    & r_{xy}[m] &\eqd& \mathcal{E}\brb{x^\ast[0]y[m]}
  \\&\citerpg{weisstein2002}{594}{1420035223}\footnotemark& f\star g  &\eqd& \int_{-\infty}^{\infty}\bar{f}(\tau)g(t+\tau)\dtau
  \\&\citePpc{leuridan1986}{2}{(7)}                       & GXY_1     &\eqd& \sum X_1^\ast Y
  \\
  \mc{5}{M}{References that use no conjugate $\conj$:}
  \\&\citerpg{bendat2010}{111}{1118210824}          & R_{xy}(m)            &\eqd& E\brs{\rvx(0)\rvy(m)}
  \\&\citerpg{helstrom1991}{369}{0023535717}        & \Rxy(t_1,t_2)        &\eqd& E[\rvx(t_1)\rvy(t_2)]
  \\&\citerpg{proakis1996}{A4}{0133737624}          & \gamma_{xy}(t_1,t_2) &\eqd& E(X_{t_1}Y_{t_2})
  \\&\citerpg{shin2008}{280}{0470725648}            & R_{xy}(\tau)         &\eqd& E[x(t)y(t+\tau)]
  \\&\citerpg{bracewell1978}{46}{007007013X}\footnotemark & g^\ast\star h  &\eqd& \int_{-\infty}^{\infty}g^\ast(u)h(u+x)\du   %{Pentagram notation for cross correlation}
\end{array}}
\addtocounter{footnote}{-1}
\footnotetext{
  Bracewell and Weisstein here use the \ope{integral operator} $\int_{\R}\!\dx$ rather than the 
  \ope{expectation operator} $\pE$. 
  That is, they use a \ope{time average} rather than an \ope{ensemble average}. 
  But in essence, the two types of operators are ``the same" because both types represent
  \ope{inner product}s. 
  That is, $\int_{x\in\R}\ff(x)\fg^\ast(x)\dx\eqd\inprod{\ff(x)}{\fg(x)}_1$ and
  $\pE\brs{\rvx(t)\rvy^\ast(t)}\eqd\inprod{\rvx(t)}{\rvy(t)}_2$
  (both are inner products, but operate in perpendicular orientations across the ensemble plane).
  }
\stepcounter{footnote}
\footnotetext{
  Note that Bracewell's ``\ope{Pentagram notation for cross correlation}"
  $g^\ast\star h =\int_{-\infty}^{\infty}g^\ast(u)h(u+x)\du$ 
  implies
  $g\star h =\int_{-\infty}^{\infty}g(u)h(u+x)\du$ 
  (and hence in the ``References that use no conjugate" category).
  }
%\end{definition}

In terms of the expectation operator $\pE$, 
there are a total of eight different ways of defining the cross-correlation $\Rxy(m)$ of
\prope{complex-valued} \prope{wide-sense stationary} sequences $\rvx(n)$ and $\rvy(n)$.
There are eight because each sequence may be defined with or without the conjugate operator $\ast$,
and $\rvx$ may lead or lag $\rvy$
($2\times2\times2=8$).

Here is a formalized list of the eight definitions.
%---------------------------------------
\begin{definition}
\label{def:Rxym}
%---------------------------------------
\defbox{\begin{array}{FM   >{\ds}r  c     l *{4}{@{\hspace{0pt}}l}         }
    (1).&\fnctd{Papoulis}:        & \Rxy(m) &\eqd& \pE[\rvx     &(m)&\rvy^\ast&(0&)]
  \\(2).&\fnctd{Kay}:             & \Rxy(m) &\eqd& \pE[\rvx^\ast&(0)&\rvy     &(m&)]
  \\(3).&\fnctd{y-star-m}:        & \Rxy(m) &\eqd& \pE[\rvx     &(0)&\rvy^\ast&(m&)]
  \\(4).&\fnctd{x-star-m}:        & \Rxy(m) &\eqd& \pE[\rvx^\ast&(m)&\rvy     &(0&)]
  \\(5).&\fnctd{Bendat}:          & \Rxy(m) &\eqd& \pE[\rvx     &(0)&\rvy     &(m&)]
  \\(6).&\fnctd{alt-Bendat}:      & \Rxy(m) &\eqd& \pE[\rvx     &(m)&\rvy     &(0&)]
  \\(7).&\fnctd{Bendat-star}:     & \Rxy(m) &\eqd& \pE[\rvx^\ast&(0)&\rvy^\ast&(m&)]
  \\(8).&\fnctd{alt-Bendat-star}: & \Rxy(m) &\eqd& \pE[\rvx^\ast&(m)&\rvy^\ast&(0&)]
\end{array}}
\end{definition}

%=======================================
\section{Results}
%=======================================
Depending on which one of the eight definitions of $\Rxy(m)$ we select:
\\\indentx$\begin{array}{FMM}
  \imark & We get four different results for $\Szxy(z)$ & \xref{prop:RxySzxy}\\
  \imark & We get four different results for $\Swxy(\omega)$ & \xref{prop:RxySwxy}\\
  \imark & If $\rvx$ and $\rvy$ are \prope{real-valued}, we get two different results for $\Swxy(\omega)$ & \xref{prop:RxySwxy_real}
\end{array}$
%---------------------------------------
\begin{proposition}
\label{prop:RxySzxy}
%---------------------------------------
%\propbox{
Let (1)--(8) below correspond to the eight definitions of $\Rxy(m)$ in \pref{def:Rxym}.
\\
$\begin{array}{Fc        l         c l       @{\hspace{0pt}}l        @{\hspace{0pt}}l         D    l         c  l       *{3}{@{\hspace{0pt}}l}                                 c  l       *{5}{@{\hspace{0pt}}l}}
    (1) &      \implies& \Szxy(z) &=&\ZH^\ast&\brp{\frac{1}{z^\ast}} &\Szxx(z)               &and& \Szyy(z) &=& \ZH     &(z)               &\Szxy     &(z)                    &=& \ZH     &(z)               &\ZH^\ast&\brp{\frac{1}{z^\ast}} &\Szxx     &(z)
  \\(2) &      \implies& \Szxy(z) &=&\ZH     &(z)                    &\Szxx(z)               &and& \Szyy(z) &=& \ZH     &(z)               &\Szxy^\ast&\brp{\frac{1}{z^\ast}} &=& \ZH     &(z)               &\ZH^\ast&\brp{\frac{1}{z^\ast}} &\Szxx^\ast&\brp{\frac{1}{z^\ast}}
  \\(3) &      \implies& \Szxy(z) &=&\ZH^\ast&\brp{z^\ast}           &\Szxx^\ast\brp{z^\ast} &and& \Szyy(z) &=& \ZH^\ast&\brp{z^\ast}      &\Szxy     &\brp{\frac{1}{z}}      &=& \ZH^\ast&\brp{z^\ast}      &\ZH^\ast&\brp{\frac{1}{z^\ast}} &\Szxx^\ast&\brp{\frac{1}{z^\ast}}
  \\(4) &      \implies& \Szxy(z) &=&\ZH     &\brp{\frac{1}{z}}      &\Szxx(z)               &and& \Szyy(z) &=& \ZH     &\brp{\frac{1}{z}} &\Szxy^\ast&\brp{\frac{1}{z^\ast}} &=& \ZH     &\brp{\frac{1}{z}} &\ZH^\ast&\brp{z^\ast}           &\Szxx^\ast&\brp{\frac{1}{z^\ast}}
  \\(5) &      \implies& \Szxy(z) &=&\ZH     &(z)                    &\Szxx(z)               &and& \Szyy(z) &=& \ZH     &(z)               &\Szxy^\ast&\brp{\frac{1}{z^\ast}} &=& \ZH     &(z)               &\ZH^\ast&\brp{\frac{1}{z^\ast}} &\Szxx^\ast&\brp{\frac{1}{z^\ast}}
  \\(6) &      \implies& \Szxy(z) &=&\ZH     &\brp{\frac{1}{z}}      &\Szxx(z)               &and& \Szyy(z) &=& \ZH     &\brp{\frac{1}{z}} &\Szxy^\ast&\brp{\frac{1}{z^\ast}} &=& \ZH     &\brp{\frac{1}{z}} &\ZH^\ast&\brp{z^\ast}           &\Szxx^\ast&\brp{\frac{1}{z^\ast}}
  \\(7) &      \implies& \Szxy(z) &=&\ZH^\ast&\brp{z^\ast}           &\Szxx(z)               &and& \Szyy(z) &=& \ZH^\ast&\brp{z^\ast}      &\Szxy^\ast&\brp{\frac{1}{z^\ast}} &=& \ZH^\ast&\brp{z^\ast}      &\ZH     &\brp{\frac{1}{z}}      &\Szxx^\ast&\brp{\frac{1}{z^\ast}}
  \\(8) &      \implies& \Szxy(z) &=&\ZH     &\brp{\frac{1}{z}}      &\Szxx(z)               &and& \Szyy(z) &=& \ZH     &\brp{\frac{1}{z}} &\Szxy^\ast&\brp{\frac{1}{z^\ast}} &=& \ZH     &\brp{\frac{1}{z}} &\ZH^\ast&\brp{z^\ast}           &\Szxx^\ast&\brp{\frac{1}{z^\ast}}
\end{array}$
%}
\end{proposition}
\begin{proof}
\begin{align*}
\intertext{1. If we follow Papoulis $\brp{\Rxy(m)\eqd\pE\brs{\rvx(m)\rvy^\ast(0)}}$, then\ldots}
    \Szyt(z)
      &\eqd \opZ\Ryt(m)
      && \text{by definition of $\Szty(z)$}                                    && \text{\xref{def:Szxy}}
    \\&\eqd \opZ\pE\brs{\rvy(m)\rvt^\ast(0)}
      && \text{by Papoulis' definition of $\Rty(m)$}                           && \text{\xref{def:Rxym}}
    \\&=    \opZ\pE\brs{\brp{\sum_{k\in\Z} \fh(k)\rvx(m-k)}\rvt^\ast(0)}       
      && \text{by \prope{LTI} property}                                        && 
    \\&=    \opZ        \sum_{k\in\Z} \fh(k) \pE\brs{\rvx(m-k)\rvt^\ast(0)}
      && \text{by \prope{linearity} of $\opE$}                                 && \text{\xref{thm:pE_linop}}
    \\&\eqd \opZ        \sum_{k\in\Z} \fh(k) \Rxt(m-k)
      && \text{by this definition of $\Rxy(m)$}                                && 
    \\&= \opZ\brs{\fh(m) \convd \Rxt(m)}       
      && \text{by definition of \ope{convolution}}                             && \text{\xref{def:convd}}
    \\&= \brs{\opZ\fh(m)} \brs{\opZ\Rxt(m)}                              
      && \text{by \thme{convolution theorem}}                                  && \text{\xref{thm:conv}}
    \\&= \boxed{\ZH(z) \Szxt(z)} 
      && \text{by property of the \ope{Z-transform}}                           && \text{by \xref{thm:opZ}}
\end{align*}


%\begin{align*}
%    \Szty(z)
%      &\eqd \opZ\pE\Rty(m)
%      && \text{by definition of $\Szty(z)$}                                    && \text{\xref{def:Szxy}}
%    \\&\eqd \opZ\pE\brs{\rvt(m)\rvy^\ast(0)}
%      && \text{by Papoulis' definition of $\Rty(m)$}                           && \text{\xref{def:Rxym}}
%    \\&=    \opZ\pE\brs{\rvt(m)\brp{\sum_{k\in\Z} \fh(k)\rvx(0-k)}^\ast}       
%      && \text{by \prope{LTI} property}                                        && 
%    \\&=    \opZ\pE\brs{\rvt(m) \sum_{k\in\Z} \fh^\ast(k)      \rvx^\ast(0-k)}
%      && \text{by \prope{distributive} property of \structd{$\invo$-algebra}s} && \text{\xref{def:staralg}}
%    \\&=    \opZ        \sum_{k\in\Z} \fh^\ast(k) \pE\brs{\rvt(m)\rvx^\ast(0-k)}
%      && \text{by \prope{linearity} of $\opE$}                                 && \text{\xref{thm:pE_linop}}
%    \\&=    \opZ        \sum_{k\in\Z} \fh^\ast(k) \pE\brs{\rvt(0)\rvx^\ast(-m-k)}
%      &&    \text{by \prope{wide sense stationary} property}                   && 
%    \\&=    \opZ        \sum_{k\in\Z} \fh^\ast(k) \brp{\pE\brs{\rvx(-m-k)\rvt^\ast(0)}}^\ast
%      && \text{by \prope{distributive} property of \structd{$\invo$-algebra}s} && \text{\xref{def:staralg}}
%    \\&\eqd \opZ        \sum_{k\in\Z} \fh^\ast(k) \Rxt^\ast(-m-k)
%      && \text{by this definition of $\Rxy(m)$}                                && 
%    \\&= \opZ        \sum_{k\in\Z} \fh^\ast(k) \Rxt(m+k)
%      && \text{by \prope{conjugate symmetric} property of $\Rxy(m)$}           && \text{\xref{cor:Rxym}}
%    \\&= \opZ\brs{\fh^\ast(-m) \convd \Rxt(m)}                              
%      && \text{by property of \ope{convolution}}                               && \text{\xref{prop:conv_knk}}
%    \\&= \brs{\opZ\fh^\ast(-m)} \brs{\opZ\Rxt(m)}                              
%      && \text{by \thme{convolution theorem}}                                  && \text{\xref{thm:conv}}
%    \\&= \boxed{\ZH^\ast\brp{\frac{1}{z^\ast}} \Szxt\brp{z}}                   
%      && \text{by property of the \ope{Z-transform}}                           && \text{by \xref{thm:opZ}}
%    \\
%    \Szxy(z)
%      &\eqd \brlr{\Szty(z)}_{\rvt\eqd\rvx}
%    \\&=    \brlr{\ZH^\ast\brp{\frac{1}{z^\ast}} \Szxt\brp{z}}_{\rvt\eqd\rvx}
%    \\&=    \boxed{\ZH^\ast\brp{\frac{1}{z^\ast}} \Szxx\brp{z}}
%    \\
%    \Szyy(z)
%      &\eqd \brlr{\Szty(z)}_{\rvt\eqd\rvy}
%    \\&=    \brlr{ \ZH^\ast\brp{\frac{1}{z^\ast}} \Szxt\brp{z}}_{\rvt\eqd\rvy}
%    \\&=    \boxed{\ZH^\ast\brp{\frac{1}{z^\ast}} \Szxy\brp{z}}
%    \\&=    \boxed{\ZH^\ast\brp{\frac{1}{z^\ast}} \ZH^\ast\brp{\frac{1}{z^\ast}} \Szxx\brp{z}}
%\\
%    \Szxy(z)
%      &\eqd \opZ\Rxy(m)
%      && \text{by definition of $\Szxy(z)$}                               && \text{\xref{def:Szxy}}
%    \\&\eqd \opZ\pE\brs{\rvx(m)\rvy^\ast(0)}
%      && \text{by Papoulis' definition of $\Rxy(m)$}                           && \text{\xref{def:Rxym}}
%    \\&=    \opZ\pE\brs{\rvx(m)\brp{\sum_{k\in\Z} \fh(k)\rvx(0-k)}^\ast}       
%      && \text{by \prope{LTI} property}                                        && 
%    \\&=    \opZ\pE\brs{\rvx(m) \sum_{k\in\Z} \fh^\ast(k)      \rvx^\ast(0-k)}
%      && \text{by \prope{distributive} property of \structd{$\invo$-algebra}s} && \text{\xref{def:staralg}}
%    \\&=    \opZ        \sum_{k\in\Z} \fh^\ast(k) \pE\brs{\rvx(m)\rvx^\ast(0-k)}
%      && \text{by \prope{linearity} of $\opE$}                                 && \text{\xref{thm:pE_linop}}
%    \\&=    \opZ        \sum_{k\in\Z} \fh^\ast(k) \pE\brs{\rvx(0)\rvx^\ast(-m-k)}
%      &&    \text{by \prope{wide sense stationary} property}                   && 
%    \\&=    \opZ        \sum_{k\in\Z} \fh^\ast(k) \brp{\pE\brs{\rvx(-m-k)\rvx^\ast(0)}}^\ast
%      && \text{by \prope{distributive} property of \structd{$\invo$-algebra}s} && \text{\xref{def:staralg}}
%    \\&\eqd \opZ        \sum_{k\in\Z} \fh^\ast(k) \Rxx^\ast(-m-k)
%      && \text{by this definition of $\Rxy(m)$}                                && 
%    \\&= \opZ        \sum_{k\in\Z} \fh^\ast(k) \Rxx(m+k)
%      && \text{by \prope{conjugate symmetric} property of $\Rxy(m)$}           && \text{\xref{cor:Rxym}}
%    \\&\eqq \opZ\brs{\fh^\ast(-m) \convd \Rxx(m)}                              
%      && \text{by property of \ope{convolution}}                               && \text{\xref{prop:conv_knk}}
%    \\&= \opZ\brs{\fh^\ast(-m) \convd \Rxx(m)}                                 
%      && \text{by \prope{conjugate symmetric} property of $\Rxy(m)$}           && \text{\xref{cor:Rxym}}
%    \\&= \brs{\opZ\fh^\ast(-m)} \brs{\opZ\Rxx(m)}                              
%      && \text{by \thme{convolution theorem}}                                  && \text{\xref{thm:conv}}
%    \\&= \boxed{\ZH^\ast\brp{\frac{1}{z^\ast}} \Szxx\brp{z}}                   
%      && \text{by property of the \ope{Z-transform}}                           && \text{by \xref{thm:opZ}}
%    \\
%    \Szyy(z)
%      &\eqd \opZ\Ryy(m)
%    \\&\eqd \opZ\pE\brs{\rvy(m)\rvy^\ast(0)}
%    \\&=    \opZ\pE\brs{\brp{\sum_{k\in\Z} \fh(k)\rvx(m-k)}\rvy^\ast(0)}
%    \\&=    \opZ\brp{\sum_{k\in\Z} \fh(k)\pE\brs{\rvx(m-k)\rvy^\ast(0)}}
%    \\&\eqd \opZ\brp{\sum_{k\in\Z} \fh(k)\Rxy(m-k)}
%    \\&\eqd \opZ\brp{\fh(m)\convd\Rxy(m)}
%    \\&=    \brs{\opZ\fh(m)}\brs{\opZ\Rxy(m)}
%    \\&\eqd \boxed{\ZH(z) \Szxy(z)}
%    \\&&&&&=    \boxed{\ZH(z)\ZH^\ast\brp{\frac{1}{z^\ast}} \Szxx\brp{z}}
%\end{align*}
%
%\begin{align*}
%    \Szyy(z)
%      &\eqd \opZ\Ryy(m)
%     &&\eqd \opZ\pE\brs{\rvy(m)\rvy^\ast(0)}
%     &&=    \opZ\pE\brs{\brp{\fh(m)\convd\rvx(m)}\rvy^\ast(0)}
%    \\&=    \opZ\pE\brs{\brp{\sum_{k\in\Z} \fh(k)\rvx(m-k)}\rvy^\ast(0)}
%     &&=    \opZ\brp{\sum_{k\in\Z} \fh(k)\pE\brs{\rvx(m-k)\rvy^\ast(0)}}
%     &&\eqd \opZ\brp{\sum_{k\in\Z} \fh(k)\Rxy(m-k)}
%    \\&\eqd \opZ\brp{\fh(m)\convd\Rxy(m)}
%     &&=    \brs{\opZ\fh(m)}\brs{\opZ\Rxy(m)}
%     &&\eqd \boxed{\ZH(z) \Szxy(z)}
%    \\&&&&&=    \boxed{\ZH(z)\ZH^\ast\brp{\frac{1}{z^\ast}} \Szxx\brp{z}}
%\end{align*}

{\begin{align*}
    \Szxy(z)
      &=\mcom{\Szyx^\ast\brp{\frac{1}{z^\ast}}}{by \prefpp{thm:ZSxy_sym}}
     &&\eqd \brlr{\Szyt^\ast\brp{\frac{1}{z^\ast}}}_{\rvt\eqd\rvx}
     &&=\boxed{\ZH^\ast\brp{\frac{1}{z^\ast}} \Szxx^\ast\brp{\frac{1}{z^\ast}}}
     \\
    \Szyy(z)
      &\eqd \brlr{\Szyt(z)}_{\rvt\eqd\rvy}
     &&=    \brlr{ \ZH(z) \Szxt\brp{z}}_{\rvt\eqd\rvy}
     &&=    \boxed{\ZH(z) \Szxy\brp{z}}
    \\&=    \boxed{\ZH(z) \ZH^\ast\brp{\frac{1}{z^\ast}} \Szxx^\ast\brp{\frac{1}{z^\ast}}}
\\
    2.\quad\Szty(z)
      &\eqd \opZ\Rty(m)
     &&\eqd \opZ\pE\brs{\rvt^\ast(0)\rvy(m)}
     &&=    \opZ\pE\brs{\rvt^\ast(0)\brp{\fh(m)\convd\rvx(m)}}
    \\&=    \opZ\pE\brs{\rvt^\ast(0)\brp{\sum_{k\in\Z} \fh(k)\rvx(m-k)}}
     &&=    \opZ\brp{\sum_{k\in\Z} \fh(k)\pE\brs{\rvt^\ast(0)\rvx(m-k)}}
     &&\eqd \opZ\brp{\sum_{k\in\Z} \fh(k)\Rtx(m-k)}
    \\&\eqd \opZ\brp{\fh(m)\convd\Rtx(m)}
     &&=    \brs{\opZ\fh(m)}\brs{\opZ\Rtx(m)}
     &&\eqd \boxed{\ZH(z) \Sztx(z)}
    \\
    \Szxy(z)
      &\eqd \brlr{\Szty}_{\rvt=\rvx}
     &&=    \brlr{\ZH(z) \Sztx(z)}_{\rvt=\rvx}
     &&=    \ZH(z) \Szxx(z)
     \\
    \Szyy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt\eqd\rvy}
     &&=    \brlr{\ZH(z) \Sztx(z)}_{\rvt\eqd\rvy}
     &&=    \ZH(z) \Szyx(z)
    \\&=    \boxed{\ZH(z) \Szxy^\ast\brp{\frac{1}{z^\ast}}}
     &&=    \boxed{\ZH(z) \ZH^\ast\brp{\frac{1}{z^\ast}} \Szxx^\ast\brp{\frac{1}{z^\ast}}}
\\
    3.\quad\Szty(z)
      &\eqd \opZ\Rty(m)
     &&\eqd \opZ\pE\brs{\rvt(0)\rvy^\ast(m)}
       \mathrlap{\qquad=    \opZ\pE\brp{\rvt(0)\brs{\sum_{k\in\Z} \fh(k)\rvx(m-k)}^\ast}}
    \\&=    \opZ\pE\brs{\rvt(0) \sum_{k\in\Z} \fh^\ast(k)      \rvx^\ast(m-k)}
     &&=    \opZ        \sum_{k\in\Z} \fh^\ast(k) \pE\brs{\rvt(0)\rvx^\ast(m-k)}
     &&\eqd \opZ        \sum_{k\in\Z} \fh^\ast(k) \Rtx^\ast(m-k)
    \\&\eqd \opZ\brs{\fh^\ast(m) \convd \Rtx^\ast(m)}
     &&=    \brs{\opZ\fh^\ast(m)} \brs{\opZ\Rtx^\ast(m)}
     &&= \boxed{\ZH^\ast\brp{z^\ast} \Sztx^\ast\brp{z^\ast}}
    \\
    \Szxy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt=\rvx}
     &&= \brlr{\ZH^\ast\brp{z^\ast} \Sztx^\ast\brp{z^\ast}}_{\rvt=\rvx}
     &&= \boxed{\ZH^\ast\brp{z^\ast} \Szxx^\ast\brp{z^\ast}}
    \\
    \Szyy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt=\rvy}
     &&= \brlr{\ZH^\ast\brp{z^\ast} \Sztx^\ast\brp{z^\ast}}_{\rvt=\rvy}
     &&= \ZH^\ast\brp{z^\ast} \Szyx^\ast\brp{z^\ast}
    \\&= \boxed{\ZH^\ast\brp{z^\ast} \Szxy\brp{\frac{1}{z}}}
     &&= \boxed{\ZH^\ast\brp{z^\ast} \ZH^\ast\brp{\frac{1}{z^\ast}} \Szxx^\ast\brp{\frac{1}{z^\ast}}}
\\
    4.\quad\Szty(z)
      &\eqd \opZ\Rxy(m)
     &&\eqd \opZ\pE\brs{\rvt^\ast(m)\rvy(0)}
     &&=    \opZ\pE\brs{\rvt^\ast(m)\sum_{k\in\Z} \fh(k)           \rvx(0-k)}
    \\&=    \opZ\sum_{k\in\Z} \fh(k)\pE\brs{\rvt^\ast(m)\rvx(0-k)}
     &&=    \opZ\sum_{k\in\Z} \fh(k)\pE\brs{\rvt^\ast(m+k)\rvx(0)}
     &&=    \opZ\sum_{k\in\Z} \fh(k)\Rtx(m+k)
    \\&=    \opZ\sum_{k'\in\Z} \fh(-k')\Rtx(m-k')
      && \text{where $k'\eqd k$}
    \\&\eqd \opZ\brs{\fh(-m) \convd \Rtx(m)}
     &&= \brs{\opZ\fh(-m)} \brs{\opZ\Rtx(m)}
     &&= \boxed{\ZH\brp{\frac{1}{z}} \Sztx(z)}
    \\
    \Szxy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt=\rvx}
     &&= \brlr{\ZH\brp{\frac{1}{z}} \Sztx(z)}_{\rvt=\rvx}
     &&= \boxed{\ZH\brp{\frac{1}{z}} \Szxx(z)}
    \\
    \Szyy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt=\rvy}
     &&= \brlr{\ZH\brp{\frac{1}{z}} \Sztx(z)}_{\rvt=\rvy}
     &&= \ZH\brp{\frac{1}{z}} \Szyx(z)
    \\&= \boxed{\ZH\brp{\frac{1}{z}} \Szxy^\ast\brp{\frac{1}{z^\ast}}}
     &&= \boxed{\ZH\brp{\frac{1}{z}} \ZH^\ast\brp{z^\ast} \Szxx^\ast\brp{\frac{1}{z^\ast}}}
\\
    5.\quad\Szty(z)
      &\eqd \opZ\Rty(m)
     &&\eqd \opZ\pE\brs{\rvt(0)\rvy(m)}
    \\&=    \opZ\pE\brs{\rvt(0)\brp{\sum_{k\in\Z} \fh(k) \rvx(m-k)}}
     &&=    \opZ                    \sum_{k\in\Z} \fh(k) \pE\brs{\rvt(0)\rvx(m-k)}
     &&\eqd \opZ                    \sum_{k\in\Z} \fh(k) \Rtx(m-k)
    \\&\eqd \opZ\brs{\fh(m) \convd \Rtx(m)}
      &&
      &&= \boxed{\ZH(z) \Sztx(z)}
    \\
    \Szxy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt=\rvx}
     &&= \brlr{\ZH(z) \Sztx(z)}_{\rvt=\rvx}
     &&= \boxed{\ZH(z) \Szxx(z)}
    \\
    \Szyy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt=\rvy}
     &&= \brlr{\ZH(z) \Sztx(z)}_{\rvt=\rvy}
     &&= \ZH(z) \Szyx(z)
    \\&= \boxed{\ZH(z) \Szxy^\ast\brp{\frac{1}{z^\ast}}}
     &&= \boxed{\ZH(z) \ZH^\ast\brp{\frac{1}{z^\ast}} \Szxx^\ast\brp{\frac{1}{z^\ast}}}
\\
   6.\quad\Szty(z)
      &\eqd \opZ\Rty(m)
     &&\eqd \opZ\pE\brs{\rvt(m)\rvy(0)}
       \mathrlap{\qquad
       =    \opZ\pE\brs{\rvt(m)\brp{\sum_{k\in\Z} \fh(k) \rvx(0-k)}}}
    \\&=    \opZ\sum_{k\in\Z} \fh(k) \pE\brs{\rvt(m)\rvx(-k)}
     &&=    \opZ\sum_{k\in\Z} \fh(k) \pE\brs{\rvt(m+k)\rvx(0)}
     &&\eqd \opZ\sum_{k\in\Z} \fh(k) \Rtx(m+k)
    \\&\mcom{\eqd \opZ\brs{\fh(-m) \convd \Rtx(m)}}{by \prefp{prop:conv_knk}}
     &&= \opZ\brs{\fh(-m)} \brs{\opZ\Rtx(m)}
     &&= \boxed{\ZH\brp{\frac{1}{z}} \Sztx(z)}
    \\
    \Szxy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt=\rvx}
     &&= \brlr{\ZH\brp{\frac{1}{z}} \Sztx(z)}_{\rvt=\rvx}
     &&= \boxed{\ZH\brp{\frac{1}{z}} \Szxx(z)}
    \\
    \Szyy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt=\rvy}
     &&= \brlr{\ZH\brp{\frac{1}{z}} \Sztx(z)}_{\rvt=\rvy}
     &&= \ZH\brp{\frac{1}{z}} \Szyx(z)
    \\&= \boxed{\ZH\brp{\frac{1}{z}} \Szxy^\ast\brp{\frac{1}{z^\ast}}}
     &&= \boxed{\ZH\brp{\frac{1}{z}} \ZH^\ast\brp{z^\ast} \Szxx^\ast\brp{\frac{1}{z^\ast}}}
\\
    7.\quad\Szty(z)
      &\eqd \opZ\Rty(m)
     &&\eqd \opZ\pE\brs{\rvt^\ast(0)\rvy^\ast(m)}
     &&=    \opZ\pE\brs{\rvt^\ast(0)\rvy^\ast(m)}
    \\&=    \opZ\pE\brs{\rvt^\ast(0)\brp{\sum_{k\in\Z} \fh(k) \rvx(m-k)}^\ast}
     &&=    \opZ                    \sum_{k\in\Z} \fh^\ast(k) \pE\brs{\rvt^\ast(0)\rvx^\ast(m-k)}
     &&\eqd \opZ                    \sum_{k\in\Z} \fh^\ast(k) \Rtx(m-k)
    \\&\eqd \opZ\brs{\fh^\ast(m) \convd \Rtx(m)}
     &&= \brs{\opZ\fh^\ast(m)} \brs{\opZ\Rtx(m)}
     &&= \boxed{\ZH^\ast\brp{z^\ast} \Sztx(z)}
    \\
    \Szxy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt=\rvx}
     &&= \brlr{\ZH^\ast\brp{z^\ast} \Sztx(z)}_{\rvt=\rvx}
     &&= \boxed{\ZH^\ast\brp{z^\ast} \Szxx(z)}
    \\
    \Szyy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt=\rvy}
     &&= \brlr{\ZH^\ast\brp{z^\ast} \Sztx(z)}_{\rvt=\rvy}
     &&= \ZH^\ast\brp{z^\ast} \Szyx(z)
    \\&= \boxed{\ZH^\ast\brp{z^\ast} \Szxy^\ast\brp{\frac{1}{z^\ast}}}
     &&= \boxed{\ZH^\ast\brp{z^\ast} \ZH\brp{\frac{1}{z}} \Szxx^\ast\brp{\frac{1}{z^\ast}}}
\\
    8.\quad\Szty(z)
      &\eqd \opZ\Rty(m)
     &&\eqd \opZ\pE\brs{\rvt^\ast(m)\rvy^\ast(0)}
       \mathrlap{\qquad=    \opZ\pE\brs{\rvt^\ast(m)\brp{\sum_{k\in\Z} \fh^\ast(k) \rvx^\ast(0-k)}}}
    \\&=    \opZ\sum_{k\in\Z} \fh^\ast(k) \pE\brs{\rvt^\ast(m)\rvx^\ast(-k)}
     &&=    \opZ\sum_{k\in\Z} \fh^\ast(k) \pE\brs{\rvt^\ast(0)\rvx^\ast(-m-k)}
    \\&=    \opZ\sum_{k\in\Z} \fh^\ast(k) \pE\brs{\rvt^\ast(-m-k)\rvx^\ast(0)}
     &&\eqd \opZ                    \sum_{k\in\Z} \fh^\ast(k) \Rtx^\ast(-m-k)
     &&=    \opZ                    \sum_{k\in\Z} \fh^\ast(k) \Rtx(m+k)
    \\&\eqd \opZ\brs{\fh(-m) \convd \Rtx(m)}
     &&= \opZ\brs{\fh(-m) \convd \Rtx(m)}
     &&= \brs{\opZ\fh(-m)} \brs{\opZ\Rtx(m)}
    \\&= \boxed{\ZH\brp{\frac{1}{z}} \Sztx(z)}
    \\
    \Szxy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt=\rvx}
     &&= \brlr{\ZH\brp{\frac{1}{z}} \Sztx(z)}_{\rvt=\rvx}
     &&= \boxed{\ZH\brp{\frac{1}{z}} \Szxx(z)}
    \\
    \Szyy(z)
      &\eqd \brlr{\Szty(z)}_{\rvt=\rvy}
     &&= \brlr{\ZH\brp{\frac{1}{z}} \Sztx(z)}_{\rvt=\rvy}
     &&= \ZH\brp{\frac{1}{z}} \Szyx(z)
    \\&= \boxed{\ZH\brp{\frac{1}{z}} \Szxy^\ast\brp{\frac{1}{z^\ast}}}
     &&= \boxed{\ZH\brp{\frac{1}{z}} \ZH^\ast\brp{z^\ast} \Szxx^\ast\brp{\frac{1}{z^\ast}}}
  \end{align*}}
\end{proof}

%---------------------------------------
\begin{proposition}
\label{prop:Rxym}
\label{prop:RxySwxy}
%---------------------------------------
\propbox{\begin{array}{FM >{\ds}rc l*{3}{@{\hspace{0pt}}l} c >{\ds}rc l*{2}{@{\hspace{0pt}}l}}
    (1).&Papoulis:        & \Rxy(m) &\eqd& \pE[\rvx     &(m)\rvy^\ast&(0&)] &\implies& \Swxy(\omega) &=&\FH^\ast&( &\omega)\Swxx(\omega)
  \\(2).&Kay:             & \Rxy(m) &\eqd& \pE[\rvx^\ast&(0)\rvy     &(m&)] &\implies& \Swxy(\omega) &=&\FH     &( &\omega)\Swxx(\omega)
  \\(3).&y-star-m:        & \Rxy(m) &\eqd& \pE[\rvx     &(0)\rvy^\ast&(m&)] &\implies& \Swxy(\omega) &=&\FH^\ast&(-&\omega)\Swxx(\omega)
  \\(4).&x-star-m:        & \Rxy(m) &\eqd& \pE[\rvx^\ast&(m)\rvy     &(0&)] &\implies& \Swxy(\omega) &=&\FH     &(-&\omega)\Swxx(\omega)
  \\(5).&Bendat:          & \Rxy(m) &\eqd& \pE[\rvx     &(0)\rvy     &(m&)] &\implies& \Swxy(\omega) &=&\FH     &( &\omega)\Swxx(\omega)
  \\(6).&alt-Bendat:      & \Rxy(m) &\eqd& \pE[\rvx     &(m)\rvy     &(0&)] &\implies& \Swxy(\omega) &=&\FH     &(-&\omega)\Swxx(\omega)
  \\(7).&Bendat-star      & \Rxy(m) &\eqd& \pE[\rvx^\ast&(0)\rvy^\ast&(m&)] &\implies& \Swxy(\omega) &=&\FH^\ast&(-&\omega)\Swxx(\omega)
  \\(8).&alt-Bendat-star: & \Rxy(m) &\eqd& \pE[\rvx^\ast&(m)\rvy^\ast&(0&)] &\implies& \Swxy(\omega) &=&\FH     &(-&\omega)\Swxx(\omega)
\end{array}}
\end{proposition}
\begin{proof}
\begin{align*}
\intertext{1. If we follow Papoulis $\brp{\Rxy(m)\eqd\pE\brs{\rvx(m)\rvy^\ast(0)}}$, then\ldots}
    \Swxy(\omega)
      &\eqd \brlr{\Szxy(z)}_{z=e^{i\omega}}
    \\&=    \brlr{\ZH^\ast\brp{\frac{1}{z^\ast}} \Szxx(z)}_{z=e^{i\omega}}
      &&    \text{by $\Szxy(z)$ result}
      &&    \text{\xref{prop:RxySzxy}}
    \\&=    \ZH^\ast\brp{e^{i\omega}} \Szxx\brp{e^{i\omega}}
    \\&=    \boxed{\FH^\ast(\omega) \Swxx(\omega)}
\end{align*}
\begin{align*}
    2.\quad\Swxy(\omega)
      &\eqd \brlr{\Szxy(z)}_{z=e^{i\omega}}
     &&=    \brlr{\ZH(z) \Szxx(z)}_{z=e^{i\omega}}
     &&=    \ZH\brp{e^{i\omega}} \Szxx\brp{e^{i\omega}}
     &&\eqd \boxed{\FH(\omega) \Swxx(\omega)}
\\
    3.\quad\Swxy(\omega)
      &\eqd \brlr{\Szxy(z)}_{z=e^{i\omega}}
     &&=    \brlr{\ZH^\ast\brp{z^\ast} \Swxx^\ast\brp{z^\ast}}_{z=e^{i\omega}}
     &&=    \ZH^\ast\brp{e^{-i\omega}} \Szxx^\ast\brp{e^{-i\omega}}
     &&\eqd \boxed{\FH^\ast(-\omega) \Swxx^\ast(-\omega)}
\\
    4.\quad\Swxy(\omega)
      &\eqd \brlr{\Szxy(z)}_{z=e^{i\omega}}
     &&=    \brlr{\ZH\brp{\frac{1}{z}} \Szxx(z)}_{z=e^{i\omega}}
     &&=    \ZH\brp{e^{-i\omega}} \Szxx\brp{e^{i\omega}}
     &&\eqd \boxed{\FH(-\omega) \Swxx(\omega)}
\\
    5.\quad\Swxy(\omega)
      &\eqd \brlr{\Szxy(z)}_{z=e^{i\omega}}
     &&=    \brlr{\ZH(z) \Szxx(z)}_{z=e^{i\omega}}
     &&=    \ZH\brp{e^{i\omega}} \Szxx\brp{e^{i\omega}}
     &&\eqd \boxed{\FH(\omega) \Swxx(\omega)}
\\
    6.\quad\Swxy(\omega)
      &\eqd \brlr{\Szxy(z)}_{z=e^{i\omega}}
     &&=    \brlr{\ZH\brp{\frac{1}{z}} \Szxx^\ast\brp{z^\ast}}_{z=e^{i\omega}}
     &&=    \ZH\brp{e^{-i\omega}} \Szxx\brp{e^{-i\omega}}
     &&\eqd \boxed{\FH(-\omega) \Swxx(-\omega)}
\\
    7.\quad\Swxy(\omega)
      &\eqd \brlr{\Szxy(z)}_{z=e^{i\omega}}
     &&=    \brlr{\ZH^\ast\brp{z^\ast} \Szxx(z)}_{z=e^{i\omega}}
     &&=    \ZH^\ast\brp{e^{-i\omega}} \Szxx\brp{e^{i\omega}}
     &&\eqd \boxed{\FH^\ast(-\omega) \Swxx(\omega)}
\\
    8.\quad\Swxy(\omega)
      &\eqd \brlr{\Szxy(z)}_{z=e^{i\omega}}
     &&=    \brlr{\ZH\brp{\frac{1}{z}} \Szxx(z)}_{z=e^{i\omega}}
     &&=    \ZH^\ast\brp{e^{-i\omega}} \Szxx\brp{e^{i\omega}}
     &&\eqd \boxed{\FH(-\omega) \Swxx(\omega)}
  \end{align*}
\end{proof}

Note the following:
\begin{enumerate}
\item The \ope{expectation} operator $\pE\brp{\rvX\rvY^\ast}$ is an \fncte{inner product}.
As such, it would seem the most natural to follow the convention of other inner product definitions
and thus put the conjugate $\conj$ on $\rvy$ (i.e. follow Papoulis):
\\\indentx$\begin{array}{c>{\ds}rc>{\ds}l}
    \imark & \inprod{\fx(t)}{\fy(t)} &\eqd& \int_{t\in\R} \fx(t)\fy^\conj(t) \dt
  \\\imark & \inprod{\fx(n)}{\fy(n)} &\eqd& \sum_{n\in\Z} \fx(n)\fy^\conj(n)
  \\\imark & \inprod{\rvX}{\rvY}     &\eqd& \pE\brp{\rvX\rvY^\conj}
\end{array}$

\item If we view $\Rxy(m)$ as an \ope{analysis} of $\rvy$ in terms of $\rvx$ 
      (or as a \ope{projection} of $\rvy$ onto $\rvx$),
      then it would seem more natural to put the conjugate on $\rvx$ (i.e. follow Kay).
      This is what is done in Fourier analysis when projecting a function $\ff(t)$ onto the 
      set of basis functions $\set{e^{i\omega n}}{\omega\in\R}$, as in 
      \\\begin{align*}
        \opDTFT\brs{\rvy(n)}(\omega) 
          &\eqd \inprod{\rvy(n)}{e^{i\omega n}} 
          && \text{(\ope{project} $\rvy(n)$ onto $e^{i\omega n}$ for some $\omega\in\R$)}
        \\&\eqd \sum_{n\in\Z} \rvy(n) \brs{e^{+i\omega n}}^\ast
        \\&\eqd \sum_{n\in\Z} \rvy(n) e^{-i\omega n}
      \end{align*}
      But arguably, a ``projection of $\rvy$ onto $\rvx$" would better be served by the use of $\Ryx(m)$ rather than $\Rxy(m)$.

\item If we follow Kay, then there is the advantage that you also end up with Bendat's result for $\Swxy(\omega)$.
\end{enumerate}

%---------------------------------------
\begin{proposition}
\label{prop:RxySwxy_real}
%---------------------------------------
In the special case where $\rvx(n)$ and $\rvy(n)$ are \propb{real-valued}\ldots
\propbox{\begin{array}{FM >{\ds}rc l*{3}{@{\hspace{0pt}}l} c >{\ds}rc l@{\hspace{0pt}}l}
    (1s).&Papoulis:        & \Rxy(m) &\eqd& \pE[\rvx     &(m)\rvy^\ast&(0&)] &\implies& \Swxy(\omega) &=&\FH^\ast&(\omega)\Swxx(\omega)
  \\(2s).&Kay:             & \Rxy(m) &\eqd& \pE[\rvx^\ast&(0)\rvy     &(m&)] &\implies& \Swxy(\omega) &=&\FH     &(\omega)\Swxx(\omega)
  \\(3s).&y-star-m:        & \Rxy(m) &\eqd& \pE[\rvx     &(0)\rvy^\ast&(m&)] &\implies& \Swxy(\omega) &=&\FH     &(\omega)\Swxx(\omega)
  \\(4s).&x-star-m:        & \Rxy(m) &\eqd& \pE[\rvx^\ast&(m)\rvy     &(0&)] &\implies& \Swxy(\omega) &=&\FH^\ast&(\omega)\Swxx(\omega)
  \\(5s).&Bendat:          & \Rxy(m) &\eqd& \pE[\rvx     &(0)\rvy     &(m&)] &\implies& \Swxy(\omega) &=&\FH     &(\omega)\Swxx(\omega)
  \\(6s).&alt-Bendat:      & \Rxy(m) &\eqd& \pE[\rvx     &(m)\rvy     &(0&)] &\implies& \Swxy(\omega) &=&\FH^\ast&(\omega)\Swxx(\omega)
  \\(7s).&Bendat-star      & \Rxy(m) &\eqd& \pE[\rvx^\ast&(0)\rvy^\ast&(m&)] &\implies& \Swxy(\omega) &=&\FH     &(\omega)\Swxx(\omega)
  \\(8s).&alt-Bendat-star: & \Rxy(m) &\eqd& \pE[\rvx^\ast&(m)\rvy^\ast&(0&)] &\implies& \Swxy(\omega) &=&\FH^\ast&(\omega)\Swxx(\omega)
\end{array}}
\end{proposition}
\begin{proof}
These results follow directly from \pref{prop:RxySwxy} and \prefpp{thm:dtft_conjneg_real}.
\end{proof}
