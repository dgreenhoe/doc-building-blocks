%============================================================================
% LaTeX File
% Daniel J. Greenhoe
%============================================================================

%======================================
\chapter{KL Expansion---Continuous Case}
%======================================
%=======================================
\section{Definitions}
\label{sec:KL}
%=======================================
%---------------------------------------
\begin{definition}
\label{def:opR}
%---------------------------------------
Let $\rvx(t)$ be a \fncte{random process}
with continuous \fncte{auto-correlation} $\Rxx(t,u)$ \xref{def:Rxx}.
\defboxt{
  The \opd{auto-correlation operator} $\opRx$ of $\rvx(t)$ is defined as
  \\\indentx$\ds\opRx\ff  \eqd \int_{u\in\R}\Rxx(t,u)\ff(u) \du$
  }
\end{definition}

%---------------------------------------
\begin{remark}
\footnote{
  \citer{fredholm1900},
  \citerp{fredholm1903}{365},
  \citerpg{michel1993}{97}{048667598X},
  \citerpg{keener}{101}{0201156741}
  }
\label{rem:kernel}
%---------------------------------------
The equation $\int_{u\in\R}\Rxx(t,u)\ff(u) \du$ is a
   \ope{Fredholm integral equation of the first kind} and
   $\Rxx(t,u)$ is the \fncte{kernel} of the equation.
\end{remark}

%---------------------------------------
\begin{definition}
\label{def:white}
%---------------------------------------
Let $\rvx(t)$ be a \fncte{random process} with \fncte{auto-correlation} $\Rxx(\tau)$ \xref{def:Rxx}.
\defboxt{
  A \fncte{random process} $\rvx(t)$ is \propd{white} if
  \\\indentx$\Rxx(\tau)=\delta(\tau)$
  }
\end{definition}

\begin{liste}
  \item If a random process $\rvx(t)$ is \prope{white} \xref{def:white}
        and the set $\Psi=\setn{\fpsi_1(t),\fpsi_2(t),\ldots,\fpsi_\xN(t)}$
        is \textbf{any} set of orthonormal basis functions for $\rvx(t)$, then the innerproducts
        $\inprod{\rvx(t)}{\fpsi_n(t)}$ and $\inprod{\rvx(t)}{\fpsi_m(t)}$ are \prope{uncorrelated}
        for $m\ne  n$.
  \item However, if $\rvx(t)$ is \propb{colored} (not white), then the innerproducts are not
        in general uncorrelated.
  \item But if the elements of $\Psi$ are chosen to be the eigenfunctions of $\opRx$ such that $\ds\opRx \fpsi_n = \lambda_n \fpsi_n$,
        then the set $\setn{\fpsi_n(t)}$ are \prope{orthogonal} \xref{cor:opR_eigen} and
        the innerproducts \textbf{are} \prope{uncorrelated} even though $\rvx(t)$ is not white.
  \item This criterion is called the \fncte{Karhunen-Lo\`{e}ve criterion} for $\rvx(t)$ \xref{thm:kle}.
\end{liste}

%=======================================
\section{Properties}
%=======================================
%---------------------------------------
\begin{theorem}
\label{thm:opR}
%---------------------------------------
Let $\opRx$ be the \ope{auto-correlation} operator \xref{def:opR}.
Let the \fncte{inner product} \xref{def:inprod} $\inprodn$ be defined as
\quad$\ds\inprod{\rvx(t)}{\rvy(t)} \eqd \int_{t\in\R} \rvx(t) \rvy^\ast(t) \dt$
\thmbox{\begin{array}{FlDD}
    (1). & \inprod{\opRx \rvx}{\rvx} \ge 0
         & \text{(\prope{non-negative})}
         & and
        \\
    (2). & \inprod{\opRx \rvx}{\fy} = \inprod{\rvx}{\opRx \fy}
         & \text{(\prope{self-adjoint})}
         &
\end{array}}
\end{theorem}
\begin{proof}
\begin{align*}
\intertext{1. Proof that $\opRx$ is \prope{non-negative}:}
   \inprod{\opRx \fy}{\fy}
     &\eqd \inprod{\int_{u\in\R}\Rxx(t,u) \fy(u) \du}{\fy(t)}
     && \text{by definition of $\opRx$}
     && \text{\xref{def:opR}}
   \\&\eqd \inprod{\int_{u\in\R}\pE\brs{\rvx(t)\rvx^\ast(u)} \fy(u) \du}{\fy(t)}
     && \text{by definition of $\Rxx(t,u)$}
     && \text{\xref{def:Rxx}}
   \\&= \pE\brs{\inprod{\int_{u\in\R}\rvx(t)\rvx^\ast(u) \fy(u) \du}{\fy(t)}}
     && \text{by \prope{linearity} of $\inprodn$ and $\int$}
     && \text{\ifsxref{vsinprod}{def:inprod}}
   \\&= \pE\brs{\int_{u\in\R}\rvx^\ast(u) \fy(u) \du \inprod{\rvx(t)}{\fy(t)}}
     && \text{by \prope{additivity} property of $\inprodn$}
     && \text{\ifsxref{vsinprod}{def:inprod}}
   \\&= \pE\brs{\inprod{\fy(u)}{\rvx(u)} \inprod{\rvx(t) }{\fy(t)}}
     && \text{by local definition of $\inprodn$}
   \\&= \pE\brs{\inprod{\rvx(u)}{\fy(u)}^\ast \inprod{\rvx(t) }{\fy(t)}}
     && \text{by \prope{conjugate symmetry} prop.}
     && \text{\ifsxref{vsinprod}{def:inprod}}
   \\&\eqd \pE{\abs{\inprod{\rvx(t) }{\fy(t)}}^2}
     && \text{by definition of $\absn$}
     && \text{\xref{def:abs}}
   \\&\ge 0
     && \text{by \prope{strictly positive} property of norms}
     && \text{\ifxref{vsnorm}{def:norm}}
\intertext{2. Proof that $\opRx$ is \prope{self-adjoint}:}
   \inprod{\brs{\opRx \rvx}(t)}{\fy}
     &\eqd \inprod{\int_{u\in\R}\Rxx(t,u) \rvx(u) \du}{\fy(t)}
     && \text{by definition of $\opRx$}
     && \text{\xref{def:opR}}
   \\&= \int_{u\in\R}\rvx(u) \inprod{\Rxx(t,u)  }{\fy(t)} \du
     && \text{by \prope{additive} property of $\inprodn$}
     && \text{\ifsxref{vsinprod}{def:inprod}}
   \\&= \int_{u\in\R}\rvx(u) \inprod{\fy(t)}{\Rxx(t,u)}^\ast \du
     && \text{by \prope{conjugate symmetry} prop.}
     && \text{\ifsxref{vsinprod}{def:inprod}}
   \\&= \inprod{ \rvx(u) }{\inprod{\fy(t)}{\Rxx(t,u)} }
     && \text{by local definition of $\inprodn$}
   \\&= \inprod{ \rvx(u) }{\int_{t\in\R}\fy(t) \Rxx^\ast(t,u)\dt }
     && \text{by definition of $\inprodn$}
     && \text{\ifsxref{vsinprod}{def:inprod}}
   \\&= \inprod{ \rvx(u) }{\int_{t\in\R}\fy(t) \Rxx(u,t)\dt }
     && \text{by property of $\Rxx$}
     && \text{\xref{thm:Rxx_prop}}
   \\&\eqd \inprod{ \rvx(u) }{\mcom{\opRx}{$\opRxa$} \fy }
     && \text{by definition of $\opRx$}
     && \text{\xref{def:opR}}
   \\\implies& \opRx=\opRxa
     && \text{by definition of \ope{adjoint} $\opRxa$}
     && \text{\ifxref{operator}{def:adjoint}}
   \\\implies& \text{$\opRx$ is \prope{self-adjoint}}
     && \text{by definition of \prope{self-adjoint}}
     && \text{\ifxref{operator}{def:op_selfadj}}
\end{align*}
\end{proof}

%---------------------------------------
\begin{corollary}
\footnote{
  \citerpp{keener}{114}{119}
  }
\label{cor:opR_eigen}
%---------------------------------------
Let $\seq{\lambda_n}{n\in\Z}$ be the eigenvalues and
    $\seq{\fpsi_n}{n\in\Z}$ be the eigenfunctions of
    operator $\opRx$ such that
    $\opRx \fpsi_n = \lambda_n \fpsi_n$.
\corbox{\begin{array}{FlM}
  (1). & \lambda_n \in \R
       & (\prope{real-valued})
       \\
  (2). & \lambda_n\ne \lambda_m \implies \inprod{\fpsi_n}{\fpsi_m}=0
       & (\prope{orthogonal})
       \\
  (3). & \norm{\fpsi_n(t)}^2>0 \implies \lambda_n\ge0
       & (\prope{non-negative})
       \\
  (4). & \norm{\fpsi_n(t)}^2>0, \inprod{\opRx\ff}{\ff} > 0 \implies \lambda_n>0
       & ($\opRx$ \prope{positive definite} $\implies$ $\lambda_n$ \prope{positive})
\end{array}}
\end{corollary}
\begin{proof}
\begin{enumerate}
\item Proof that eigenvalues are \prope{real-valued}:
Because $\opRx$ is \prope{self-adjoint}, its eigenvalues are real\ifsxref{operator}{thm:self_adjoint}.

\item Proof that eigenfunctions associated with distinct eigenvalues are orthogonal:
Because $\opRx$ is \prope{self-adjoint}, this property follows\ifsxref{operator}{thm:self_adjoint}.

\item Proof that eigenvalues are \prope{non-negative}:
      \begin{align*}
         0 &\le \inprod{\opRx \fpsi_n}{\fpsi_n}
           &&   \text{by definition of \prope{non-negative definite}}
         \\&=   \inprod{\lambda_n \fpsi_n}{\fpsi_n}
           &&   \text{by hypothesis}
         \\&=   \lambda_n \inprod{\fpsi_n}{\fpsi_n}
           &&   \text{by definition of inner-products}
         \\&=   \lambda_n \norm{\fpsi_n}^2
           &&   \text{by definition of norm induced by inner-product}
      \end{align*}

\item Proof that eigenvalues are \prope{positive} if $\opRx$ is \prope{positive definite}:
      \begin{align*}
         0 &< \inprod{\opRx \fpsi_n}{\fpsi_n}
           && \text{by definition of \prope{positive definite}}
         \\&= \inprod{\lambda_n \fpsi_n}{\fpsi_n}
           && \text{by hypothesis}
         \\&= \lambda_n \inprod{\fpsi_n}{\fpsi_n}
           && \text{by \prope{homogeneous} property of $\inprodn$}
           && \text{\ifxref{vsinprod}{def:inprod}}
         \\&= \lambda_n \norm{\fpsi_n}^2
           && \text{by \thme{induced norm} theorem}
           && \text{\ifxref{vsinprod}{thm:norm=inprod}}
      \end{align*}
\end{enumerate}
\end{proof}

%---------------------------------------
\begin{theorem}[\thmd{Karhunen-Lo/`eve Expansion}]
\footnote{
  \citerpp{keener}{114}{119}
  }
\label{thm:kle}
%---------------------------------------
Let $\opRx$ be the \ope{auto-correlation operator} \xref{def:opR}
of a \fncte{random process} $\rvx(t)$.
Let $\seq{\lambda_n}{n\in\Z}$ be the eigenvalues of $\opRx$
and $\seq{\fpsi_n}{n\in\Z}$ are the eigenfunctions of $\opRx$ such that
    $\opRx \fpsi_n = \lambda_n \fpsi_n$.
\thmbox{
  \mcom{\norm{\fpsi_n(t)}=1}
       {$\setn{\fpsi_n(t)}$ are \prope{normalized}}
  \implies
  \mcom{\pE\brp{\abs{\rvx(t)-\sum_{n\in\Z}\inprod{\rvx(t)}{\fpsi_n(t)} \fpsi_n(t) }^2} = 0}
       {\prope{convergence in probability}}
    \qquad\text{($\setn{\fpsi_n(t)}$ is a \structe{basis} for $\rvx(t)$)}
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Define $\ds\dotx_n\eqd \inprod{\rvx(t)}{\fpsi_n(t)}$ \label{idef:kle_xdot}
 %\item Define $\ds\opRx\rvx(t) \eqd \int_{u\in\R} \Rxx(t,u)\rvx(u)\du$ \label{idef:kle_R}

  \item lemma: \label{ilem:kle_mercer}
        $\ds\pE\brs{\rvx(t)\rvx(t)} = \sum_{n\in\Z}\lambda_n \abs{\fpsi_n(t)}^2$. Proof:
        \begin{align*}
          \pE\brs{\rvx(t)\rvx(t)}
            &= \sum_{n\in\Z}\lambda_n \abs{\fpsi_n(t)}^2
            && \begin{array}{MMM}
                   by  & \prope{non-negative} property & \xref{thm:opR}
                 \\and & \thme{Mercer's Theorem}       & \xref{thm:mercer}
               \end{array}
        \end{align*}

  \item lemma: \label{ilem:kle_1}
    \begin{align*}
       &\pE\brs{\rvx(t) \brp{\sum_{n\in\Z}\dotx_n \fpsi_n(t)}^\ast}
       \\&\eqd \pE\brs{\rvx(t) \brp{\sum_{n\in\Z}\int_{u\in\R}\rvx(u)\fpsi_n^\ast(u)\du \fpsi_n(t)}^\ast}
         && \text{by definition of $\dotx$}
         && \text{\xref{idef:kle_xdot}}
       \\&= \sum_{n\in\Z}\brp{\int_{u\in\R}\pE\brs{\rvx(t)\rvx^\ast(u)}\fpsi_n(u)\du} \fpsi_n^\ast(t)
         && \text{by \prope{linearity}}
         && \text{\ifxref{expectation}{thm:pE_linop}}
       \\&\eqd \sum_{n\in\Z}\brp{\int_{u\in\R}\Rxx(t,u)\fpsi_n(u)\du} \fpsi_n^\ast(t)
         && \text{by definition of $\Rxx(t,u)$}
         && \text{\xref{def:Rxx}}
       \\&\eqd \sum_{n\in\Z}\brp{\opRx\fpsi_n(t) \fpsi_n^\ast(t)}
         && \text{by definition of $\opRx$}
         && \text{\xref{def:opR}}
       \\&= \sum_{n\in\Z}\lambda_n\fpsi_n(t) \fpsi_n^\ast(t)
         && \text{by property of \structe{eigen-system}}
       \\&= \sum_{n\in\Z}\lambda_n \abs{\fpsi_n(t)}^2
    \end{align*}

  \item lemma: \label{ilem:kle_2}
    \begin{align*}
       &\pE\brs{\sum_{n\in\Z}\dotx_n \fpsi_n(t)\brp{\sum_{m\in\Z}\dotx_m \fpsi_m(t)}^\ast}
       \\&\eqd \pE\brs{\sum_{n\in\Z}\int_{u\in\R}\rvx(u)\fpsi_n^\ast(u)\du   \fpsi_n(t)\brp{\sum_{m\in\Z}\int_v \rvx(v)\fpsi_m^\ast(v)\dv \fpsi_m(t)}^\ast}
         && \text{by definition of $\dotx$
                  \xref{idef:kle_xdot}}
       \\&= \sum_{n\in\Z}\sum_{m\in\Z}\int_u\brp{\int_v \pE\brs{\rvx(u)\rvx^\ast(v)}\fpsi_m(v)\dv} \fpsi_n^\ast(u)\du   \fpsi_n(t)   \fpsi_m^\ast(t)
         && \text{by \prope{linearity}
                  \ifxref{expectation}{thm:pE_linop}}
       \\&= \sum_{n\in\Z}\sum_{m\in\Z}\int_u\brp{\int_v \Rxx(u,v)\fpsi_m(v)\dv} \fpsi_n^\ast(u)\du   \fpsi_n(t)   \fpsi_m^\ast(t)
         && \text{by definition of $\Rxx(t,u)$
                  \xref{def:Rxx}}
       \\&= \sum_{n\in\Z}\sum_{m\in\Z}\int_u\brp{\opRx\fpsi_m(u)} \fpsi_n^\ast(u)\du   \fpsi_n(t)   \fpsi_m^\ast(t)
         && \text{by definition of $\opRx$
                  \xref{def:opR}}
       \\&= \sum_{n\in\Z}\sum_{m\in\Z}\int_u\brp{\lambda_m\fpsi_m(u)} \fpsi_n^\ast(u)\du   \fpsi_n(t)   \fpsi_m^\ast(t)
         && \text{by property of \structe{eigen-system}}
       \\&= \sum_{n\in\Z}\sum_{m\in\Z}\lambda_m \brp{\int_{u\in\R}\fpsi_m(u) \fpsi_n^\ast(u)\du }   \fpsi_n(t)   \fpsi_m^\ast(t)
         && \text{by \prope{linearity}}
       \\&= \sum_{n\in\Z}\sum_{m\in\Z}\lambda_m \norm{\fpsi(t)}^2 \kdelta_{mn}   \fpsi_n(t)   \fpsi_m^\ast(t)
         && \text{by \prope{orthogonal} property
                  \xref{cor:opR_eigen}}
       \\&= \sum_{n\in\Z}\sum_{m\in\Z}\lambda_m \kdelta_{mn}   \fpsi_n(t)   \fpsi_m^\ast(t)
         && \text{by \prope{normalized} hypothesis}
       \\&= \sum_{n\in\Z}\lambda_n   \fpsi_n(t)   \fpsi_n^\ast(t)
         \qquad\text{by definition of \fncte{Kronecker delta} $\kdelta$}
         && \text{\xref{def:kdelta}}
       \\&= \sum_{n\in\Z}\lambda_n \abs{\fpsi_n(t)}^2
    \end{align*}

\item Proof that $\setn{\fpsi_n(t)}$ is a \structe{basis} for $\rvx(t)$:
  \begin{align*}
    &\pE\brp{\abs{\rvx(t)-\sum_{n\in\Z}\dotx_n \fpsi_n(t) }^2}
    \\&= \pE\brp{\brs{\rvx(t)-\sum_{n\in\Z}\dotx_n \fpsi_n(t) }\brs{\rvx(t)-\sum_{m\in\Z}\dotx_m \fpsi_m(t) }^\ast}
    \\&= \pE\brp{
         \rvx(t)\rvx^\ast(t)
       - \rvx(t)\brs{\sum_{n\in\Z}\dotx_n \fpsi_n(t)}^\ast
       - \rvx^\ast(t)\sum_{n\in\Z}\dotx_n \fpsi_n(t)
       + \brs{\sum_{n\in\Z}\dotx_n \fpsi_n(t)} \brs{\sum_{m\in\Z}\dotx_m \fpsi_m(t) }^\ast
       }
    \\&= \pE\brp{\rvx(t)\rvx^\ast(t)}
       - \pE\brs{\rvx(t)\brs{\sum_{n\in\Z}\dotx_n \fpsi_n(t)}^\ast}
       - \pE\brs{\rvx^\ast(t)\sum_{n\in\Z}\dotx_n \fpsi_n(t)}
       + \pE\brs{\sum_{n\in\Z}\dotx_n \fpsi_n(t) \brs{\sum_{m\in\Z}\dotx_m \fpsi_m(t) }^\ast }
    \\&\qquad\text{by \prope{linearity} of $\pE$ \ifxref{expectation}{thm:pE_linop}}
    \\&= \mcom{\sum_{n\in\Z}\lambda_n \abs{\fpsi_n(t)}^2}{by \pref{ilem:kle_mercer}}
       - \mcom{\sum_{n\in\Z}\lambda_n \abs{\fpsi_n(t)}^2}{by \pref{ilem:kle_1}}
       - \mcom{\brs{\sum_{n\in\Z}\lambda_n \abs{\fpsi_n(t)}^2}^\ast}{by \pref{ilem:kle_1}}
       + \mcom{\sum_{n\in\Z}\lambda_n \abs{\fpsi_n(t)}^2}{by \pref{ilem:kle_2}}
    \\&= 0
  \end{align*}
\end{enumerate}
\end{proof}
