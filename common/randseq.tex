%============================================================================
% LaTeX File
% Daniel J. Greenhoe
%============================================================================
%======================================
\chapter{Random Sequences}
\label{app:random_processes}
%======================================
\qboxnps
  {Aristotle (384 BC -- 322 BC)
    \index{Aristotle}
    \index{quotes!Aristotle}
    \footnotemark
  }
  {../common/people/aristot.jpg}
  {A likely impossibility is always preferable to an
  unconvincing possibility.}
  \footnotetext{\begin{tabular}[t]{ll}
    quote: & \url{http://en.wikiquote.org/wiki/Aristotle} \\
    image: & \url{http://en.wikipedia.org/wiki/Aristotle}
  \end{tabular}}

%=======================================
%\section{Random sequences}
%=======================================
%---------------------------------------
\section{Definitions}
%---------------------------------------
%---------------------------------------
\begin{definition}
\footnote{
  \citerpgc{papoulis1984}{263}{0070484686}{$R_{xy}(m)=E\brb{\rvx(m)\rvy^\ast(0)}$},
  \citerpgc{cadzow}      {341}{0023180102}{$r_{xy}(m)=E\brs{\rvx(m)\rvy^\ast(0)}$},
  \citePc  {matlab_xcorr}                 {$R_{xy}(m)=E\setn{x_{n+m}y_n^\ast}   $},
  \citePc  {matlab_cpsd}                  {$R_{xy}(m)=E\setn{x_{n+m}y_n^\ast}   $}
  }
\label{def:pmeanxn}
\label{def:pvarxn}
\label{def:Rxxnm}
\label{def:Rxxnm}
\label{def:Ryynm}
\label{def:Rxynm}
%---------------------------------------
Let $\rvx(n)$ and $\rvy(n)$ be \fncte{random sequence}s.\\
\defbox{\begin{array}{MlMlc>{\ds}l}
     The \fnctd{mean}             & \pmeanx(n) & of $\rvx(n)$               is & \pmeanx(n)&\eqd& \pE\brs{\rvx(n)}
   \\The \fnctd{variance}         & \pvarx(n)  & of $\rvx(n)$               is & \pvarx(n) &\eqd& \pE\brp{\brs{\rvx(n)-\pmeanx(n)}^2}
   \\The \fnctd{cross-correlation}& \Rxy(n,m)  & of $\rvx(n)$ and $\rvy(n)$ is & \Rxy(n,m) &\eqd& \pE\brs{\rvx(n+m)\rvy^\ast(n)}
   \\The \fnctd{auto-correlation} & \Rxx(n,m)  & of $\rvx(n)$               is & \Rxx(n,m) &\eqd& \brlr{\Rxy(n,m)}_{\rvy=\rvx}
  %\\The \fnctd{auto-correlation operator} & \opR\ff    & of $\ff(t)$               is & \opR f    &\eqd& \int_{u\in\R}\Rxx(t,u) f(u) \du     %& \text{(\prope{auto-correlation operator})}
\end{array}}
\end{definition}

%---------------------------------------
\section{Properties}
%---------------------------------------
%---------------------------------------
\begin{theorem}
\label{thm:Rxxnm}
\label{thm:Ryynm}
\label{thm:Rxynm}
%---------------------------------------
\thmbox{\begin{array}{rcl}
   \Rxx(n,m) &=& \Rxx^\ast(n+m,-m)\\
   \Rxy(n,m) &=& \Ryx^\ast(n+m,-m)
\end{array}}
\end{theorem}
\begin{proof}
\begin{align*}
  \Rxy(n,m)
     &\eqd \pE\brs{\rvx(n+m) \rvy^\ast(n)}
     && \text{by definition of $\Rxy(n,m)$}
     && \text{\xref{def:Rxynm}}
   \\&= \pE\brs{\rvy^\ast(n) \rvx(n+m)}
     && \text{by \prope{commutative} property of $\fieldC$}
     && \text{\ifxref{algebra}{def:field}}
   \\&= \brp{\pE\brs{\rvy(n) \rvx^\ast(n+m)}}^\ast
     && \text{by \prope{distributive} property of \structd{$\invo$-algebra}s}
     && \text{\xref{def:staralg}}
   \\&= \brp{\pE\brs{\rvy(n+m-m) \rvx^\ast(n+m)}}^\ast
     && \text{by \prope{additive identity} property of $\fieldR$}
     && \text{\ifxref{algebra}{def:field}}
   \\&\eqd \Ryx^\ast(n+m,-m)
     && \text{by definition of $\Rxy$}
     && \text{\xref{def:Rxy}}
   \\
   \\
   \Rxx(n,m)
     &= \brlr{\Rxy(n,m)}_{\rvy=\rvx}
     && \text{by $\rvy=\rvx$ constraint}
   \\&= \brlr{\Rxy^\ast(n+m,-m)}_{\rvy=\rvx}
     && \text{by previous result}
   \\&= \Rxx^\ast(n+m,-m)
     && \text{by $\rvy=\rvx$ constraint}
\end{align*}
\end{proof}

\begin{figure}[ht]\color{figcolor}
\begin{fsK}
\begin{center}
  \setlength{\unitlength}{0.2mm}
  \begin{picture}(300,130)(-100,-80)
  \thicklines
  \put(-100,  10 ){\makebox (100, 40)[b]{$\rvx(n)$}  }
  \put(-100, -50 ){\makebox (100, 40)[t]{$\Rxx(n,m)$}  }
  \put(-100,   0 ){\vector  (  1,  0){100}             }
  \put(   0, -50 ){\framebox(100,100){$\convd\fh(n)$}  }
  \put( 100,   0 ){\vector  (  1,  0){100}             }
  \put( 110,   0 ){\makebox (100, 40)[lb]{$\ds\rvy(n)=\fh(n)\convd\rvx(n)=\sum_k\fh(k)\rvx(n-k)$}  }
  \put( 100, -50 ){\makebox (100, 40)[t]{$\Ryy(n,m)$}  }
  \put(  50, -60 ){\makebox (  0,  0)[t]{$\Rxy(n,m)$}  }
  \end{picture}
\caption{
   Linear system with \fncte{random sequence} input and output
   \label{fig:d-linear-sys}
   }
\end{center}
\end{fsK}
\end{figure}

%---------------------------------------
\begin{theorem}
\footnote{
  \citerp{papoulis}{310}
  }
\label{thm:Rxyh}
%---------------------------------------
Let $\rvx(n)$ be a \fncte{random sequence} with \fncte{mean} $\pmeanx$
and $\rvy(n)$    a \fncte{random sequence} with \fncte{mean} $\pmeany$.
Let $\opS$ be a system with \fncte{impulse response} $\fh(n)$,
\fncte{input} $\rvx(n)$, and \fncte{output} $\rvy(n)$ \xref{fig:d-linear-sys}.
\thmbox{
   \brb{\begin{array}{M}
      $\opS$ is
   %\\\prope{linear time invariant}
    (\prope{LTI})
  \end{array}}
  \implies
  \brb{\begin{array}{Frc>{\ds}l>{\ds}lD}
       (1).&\pmeany(n)&=& \sum_{k\in\Z} \fh(k)      \pmeanx(n-k)  &\eqd \fh(n)\convd \pmeanx(n) & and
     \\(2).&\Rxy(n,m) &=& \sum_{k\in\Z} \fh^\ast(k) \Rxx(n-k,m+k) &                            & and 
     \\(3).&\Ryy(n,m) &=& \sum_{k\in\Z} \fh^\ast(k) \Ryx(n-k,m+k)
  \end{array}} 
  }
\end{theorem}
\begin{proof}
\begin{align*}
   \pmeany(n)
     &\eqd \pE\brs{\rvy(n)}
     && \text{by definition of $\pmeany$}
     && \text{\xref{def:pmeanxn}}
   \\&= \pE\brs{\sum_{k\in\Z} \fh(k) \rvx(n-k)}
     && \text{by \prope{LTI} hypothesis}
   \\&= \sum_{k\in\Z} \fh(k) \pE\brs{\rvx(n-k)}
     && \text{by \prope{linear} property}
   \\&= \sum_{k\in\Z} \fh(k) \pmeanx(n-k)
     && \text{by definition of $\pmeanx$}
     && \text{\xref{def:pmeanxn}}
   \\&\eqd \fh(n)\convd \pmeanx(n) 
     && \text{by definition of \ope{convolution}}
     && \text{\xref{def:dsp_conv}}
   \\
   \\
   \Rxy(n,m)
     &\eqd \pE\brs{\rvx(n+m) \rvy^\ast(n) }
     && \text{by definition of $\Rxy(n,m)$}
     && \text{\xref{def:Rxynm}}
   \\&= \pE\brs{\rvx(n+m) \brp{\fh(n)\convd\rvx(n)}^\ast}
     && \text{by \prope{LTI} hypothesis}
   \\&\eqd \pE\brs{\rvx(n+m) \brp{ \sum_{k\in\Z} h(k) \rvx(n-k) }^\ast }
     && \text{by definition of \ope{convolution} $\conv$}
     && \text{\xref{def:dsp_conv}}
   \\&=    \pE\brs{\rvx(n+m) \sum_{k\in\Z} \fh^\ast(k) \rvx^\ast(n-k)  }
     && \text{by \prope{distributive} property of \structd{$\invo$-algebra}s}
     && \text{\xref{def:staralg}}
   \\&=    \pE\brs{ \sum_{k\in\Z} \fh^\ast(k) \rvx(n+m)\rvx^\ast(n-k)  }
     && \text{by \prope{distributive} property of $\fieldC$}
     && \text{\ifxref{algebra}{def:field}}
   \\&= \sum_{k\in\Z} \fh^\ast(k) \pE\brs{\rvx(n-k+k+m) \rvx^\ast(n-k) }
     && \text{by \prope{linear} property of $\pE$}
     && \text{\xref{thm:pE}}
   \\&\eqd \sum_{k\in\Z} \fh^\ast(k) \Rxx(n-k,m+k)
     && \text{by definition of $\Rxx(n,m)$}
     && \text{\xref{def:Rxxnm}}
   %\\&\eqd \sum_{k'\in\Z} \fh^\ast(-k') \Rxx(n+k',m-k')
   %  && \text{where $k'\eqd -k$}
   %\\&\eqd \sum_{k\in\Z} \fh^\ast(-k) \Rxx(n+k,m-k)
   %  && \text{where $k\eqd k'$}
   %\\&= \Rxx(n+k,m) \convd \fh^\ast(-m)
   %  && \text{by definition of \ope{convolution}}
   %  && \text{\xref{def:dsp_conv}}
   \\
   \\
   \Ryy(n,m)
     &\eqd \pE\brs{\rvy(n+m) \rvy^\ast(n) }
     && \text{by definition of $\Rxy(n,m)$}
     && \text{\xref{def:Rxynm}}
   \\&= \pE\brs{\rvy(n+m) \brp{\fh(n)\convd\rvx(n)}^\ast}
     && \text{by \prope{LTI} hypothesis}
   \\&\eqd \pE\brs{\rvy(n+m) \brp{ \sum_{k\in\Z} \fh(k) \rvx(n-k) }^\ast }
     && \text{by definition of \ope{convolution}}
     && \text{\xref{def:dsp_conv}}
   \\&=    \pE\brs{\rvy(n+m) \sum_{k\in\Z} \fh^\ast(k) \rvx^\ast(n-k)  }
     && \text{by \prope{distributive} property of \structd{$\invo$-algebra}s}
     && \text{\xref{def:staralg}}
   \\&=    \pE\brs{ \sum_{k\in\Z} \fh^\ast(k) \rvy(n+m)\rvx^\ast(n-k)  }
     && \text{by \prope{distributive} property of $\fieldC$}
     && \text{\ifxref{algebra}{def:field}}
   \\&=    \sum_{k\in\Z} \fh^\ast(k) \pE\brs{\rvy(n-k+k+m) \rvx^\ast(n-k) }
     && \text{by \prope{linear} property of $\pE$}
     && \text{\xref{thm:pE}}
   \\&\eqd \sum_{k\in\Z} \fh^\ast(k) \Ryx(n-k,m+k)
     && \text{by definition of $\Rxy(n,m)$}
     && \text{\xref{def:Ryynm}}
   %\\&= \sum_{k'\in\Z} \fh^\ast(-k') \Ryx(n+k',m-k')
   %  && \text{where $k'\eqd-k$}
   %\\&= \sum_{k\in\Z} \fh^\ast(-k) \Ryx(n+k,m-k)
   %  && \text{where $k\eqd k'$}
   %\\&\eqd \Ryx(n+k,m) \convd \fh^\ast(-m)
   %  && \text{by definition of \ope{convolution}}
   %  && \text{\xref{def:dsp_conv}}
   %\\
   %\\
   %\Ryy(n,m)
   %  &= \Rxy(n,m)\convd \fh(m)
   %  && \text{by previous result}
   %\\&= \brs{\Rxx(n,m) \convd \fh^\ast(-m)}\convd \fh(-m)
   %  && \text{by previous result}
   %\\&= \Rxx(n,m) \convd \fh(-m) \convd \fh^\ast(-m)
   %  && \text{by previous result}
   %\\
   %\\
   %\Ryy(n,m)
   %  &= \Rxx(n,m)\convd\fh(-m) \convd \fh^\ast(-m)
   %  && \text{by previous result}
   %\\&\eqd \sum_{p\in\Z}\fh^\ast(-p) \brs{\Rxx(n,m-p)\convd\fh(-m)}
   %  && \text{by definition of \ope{convolution}}
   %  && \text{\xref{def:dsp_conv}}
   %\\&= \sum_{p\in\Z}\fh^\ast(-p) \sum_{k\in\Z}\fh(-k) \Rxx(n,m-p-k)
   %  && \text{by definition of \ope{convolution}}
   %  && \text{\xref{def:dsp_conv}}
   %\\&= \sum_{p\in\Z} \sum_{k\in\Z} \fh(-k) \fh^\ast(-p) \Rxx(n,m-p-k)
   %  && \text{by \prope{distributive} property of $\fieldC$}
   %  && \text{\xref{def:field}}
\end{align*}
\end{proof}


%---------------------------------------
\section{Wide Sense Stationary processes}
\index{wide sense stationary}
\index{WSS}
%---------------------------------------
%---------------------------------------
\begin{definition}
%---------------------------------------
Let $\rvx(n)$ be a \fncte{random sequence} with \fncte{mean} $\pmeanx(n)$ and
\fncte{variance} $\pvar(n)$ \xref{def:pvarxn}.
\\
\defboxt{
  $\rvx(n)$ is \propd{wide sense stationary} (\propd{WSS}) if
  \\\indentx
    $\begin{array}{FlMMD}
       1. & \pmeanx(n)  & is \prope{constant} with respect to $n$ & (\prope{stationary in the 1st moment})    & and\\
       2. & \pvarx(n)   & is \prope{constant} with respect to $n$ & (\prope{stationary in the 2nd moment})
    \end{array}$
  }
\end{definition}

%---------------------------------------
\begin{definition}
\footnote{
  \citerpgc{papoulis1984}{263}{0070484686}{``$R_{xy}(\tau)=E\brb{\rvx(t+\tau)\rvy^\ast(t)}$"},
  %\citerpgc{kay1988}{52}{8131733564}{``$r_{xy}[k] = \mathcal{E}\brb{x^\ast[n]y[n+k]}\quad(3.42)"$},
  %\citerpgc{bendat2011}{111}{1118210824}{$R_{xy}(\tau)=E\brs{\rvx(t)\rvy(t+\tau)}$},
  \citerpgc{cadzow}{341}{0023180102}{$r_{xy}(n)=E\brs{\rvx(k+n)\rvy^\ast(k)}$ (10.41)}
  %\citerpgc{koopmans1995}{}{{0124192513}{}
  %\citerpgc{weisstein2002}{594}{1420035223}{entry: Cross-Correlation; $f\star g=\int_{-\infty}^{\infty}\bar{f}(\tau)g(t+\tau)\dtau$ (4)},
  %\citerpgc{bracewell1965}{46,243}{???}{cited by other reference} % https://books.google.com/books?id=oVFTDwAAQBAJ&pg=PA92&dq=bracewell+%22pentagram+notation%22&hl=en&sa=X&ved=0ahUKEwigptTEq-DeAhXIi60KHd1RCJIQ6AEILjAB#v=onepage&q=bracewell%20%22pentagram%20notation%22&f=false
  }
\label{def:mean_wss}
\label{def:Rxxm}
\label{def:Rxym}
%---------------------------------------
Let $\rvx(n)$ be a \fncte{random sequence} with statistics
$\pmeanx(n)$, $\pvarx(n)$, $\Rxx(n,m)$, and $\Rxy(n,m)$ \xref{def:Rxynm}.
\defboxt{
  $\brb{\begin{array}{M}
    $\rvx$ and $\rvy$ are
    \prope{wide sense stationary}
  \end{array}}\quad\implies$
  \\\quad$
  \brb{\begin{array}{FMlMlc>{\ds}l}
     (1).&The \fnctd{mean}             & \pmeanx  & of $\rvx(n)$               is & \pmeanx &\eqd& \pE\brs{\rvx(0)}
   \\(2).&The \fnctd{variance}         & \pvarx   & of $\rvx(n)$               is & \pvarx  &\eqd& \pE\brp{\brs{\rvx(0)-\pmeanx}^2}
   \\(4).&The \fnctd{cross-correlation} & \Rxy(m)  & of $\rvx(n)$ and $\rvy(n)$ is & \Rxy(m) &\eqd& \pE\brs{\rvx(m)\rvy^\ast(0)}
   \\(3).&The \fnctd{auto-correlation}  & \Rxx(m)  & of $\rvx(n)$               is & \Rxx(m) &\eqd& \brlr{\Rxy(m)}_{\rvy=\rvx}
  %\\The \fnctd{auto-correlation operator} & \opR\ff    & of $\ff(t)$               is & \opR f    &\eqd& \int_{u\in\R}\Rxx(t,u) f(u) \du     %& \text{(\prope{auto-correlation operator})}
\end{array}}$
  }
\end{definition}

%---------------------------------------
\begin{remark}
%---------------------------------------
  The $\Rxy(n,m)$ of \prefpp{def:Rxynm} and the $\Rxy(m)$ of \prefpp{def:Rxym} (etc.) are examples
  of \hie{function overload}---that is, functions that use the same
  mnemonic but are distinguished by different domains.
  Perhaps a more common example of function overload is the ``$+$" mnemonic.
  Traditionally it is used with domain of the natural numbers $\N$ as in $3+2$.
  Later it was extended for domain real numbers $\R$ as in $\sqrt{3}+\sqrt{2}$,
  or even complex numbers $\C$ as in $\brp{\sqrt{3}+i\sqrt{2}}+\brp{e+i\pi}$.
  And it was even more dramatically extended for use with domain $\R^\xN\times\R^\xM$
  in ``linear algebra" as in
  \\\indentx$
    \brs{\begin{array}{cc}1&2\\3&4\end{array}} +
    \brs{\begin{array}{cc}5&6\\7&8\end{array}} =
    \brs{\begin{array}{cc}6&8\\10&12\end{array}}
   $
\end{remark}

%---------------------------------------
\begin{proposition}
\label{prop:Rxynmm}
\label{prop:Rxxnmm}
%---------------------------------------
Let $\rvy(n)$ be a \fncte{random sequence},
    $\rvx(n)$    a \fncte{random sequence} with \fncte{auto-correlation} $\Rxx(n,m)$,
and $\Rxy$    the \fncte{cross-correlation} of $\rvx$ and $\rvy$.
\propbox{
  \brb{\begin{array}{M}
    $\rvx$ and $\rvy$ are
    \\\prope{wide sense stationary}
    \\(\prope{WSS}) \xref{def:wss}
  \end{array}}
  \implies
  \brb{\begin{array}{rcll}
    \Rxx(n,m) &=& \Rxx(m) & \forall n\in\Z\\
    \Rxy(n,m) &=& \Rxy(m) & \forall n\in\Z\\
    \text{\xref{def:Rxynm}} && \text{\xref{def:Rxym}}
  \end{array}}
}
\end{proposition}
\begin{proof}
\begin{align*}
  \Rxy(n,m)
     &\eqd \pE\brs{\rvx[n+m]\rvy^\ast[n]}
     &&    \text{by definition of $\Rxy(n,m)$}
     &&    \text{\xref{def:Rxynm}}
   \\&=    \pE\brs{\rvx[n-n+m]\rvy^\ast[n-n]}
     &&    \text{by \prope{wide sense stationary} hypothesis}
   \\&=    \pE\brs{\rvx[m]\rvy^\ast[0]}
   \\&\eqd \Rxy(m)
     && \text{by definition of $\Rxy(m)$}
     && \text{\xref{def:Rxym}}
   \\
  \Rxx(n,m)
     &=    \brlr{\Rxy(n,m)}_{\rvy=\rvx}
   \\&=    \brlr{\Rxy(m)}_{\rvy=\rvx}
     && \text{by previous result}
   \\&= \Rxx(m)
\end{align*}
\end{proof}

%---------------------------------------
\begin{corollary}
\label{cor:Rxxm}
\label{cor:Rxym}
%---------------------------------------
Let $\rvx(n)$ be a \fncte{random sequence} with \fncte{auto-correlation} $\Rxx(n,m)$,
    $\rvy(n)$    a \fncte{random sequence} with \fncte{auto-correlation} $\Ryy(n,m)$,
and $\Rxy(n,m)$  the \fncte{cross-correlation} of $\rvx$ and $\rvy$.
Let $\opS$ be a \structe{system} with input $\rvx(n)$ and output $\rvy(n)$.
\corbox{
  \brb{\begin{array}{FMD}
      (A).&$\rvx$ and $\rvy$ are \prope{WSS} & and
    \\(B).&$\opS$ is \prope{LTI}             &
  \end{array}}
  \implies
  \brb{\begin{array}{Frc>{\ds}lDD}
      (1).&\Rxx(m) &=& \Rxx^\ast(-m)               & (\prope{conjugate symmetric}) & and
    \\(2).&\Rxy(m) &=& \Ryx^\ast(-m)               & (\prope{conjugate symmetric})
  \end{array}}
}
\end{corollary}
\begin{proof}
\begin{align*}
  \Rxy(m)
     &= \Rxy(n,m)
     && \text{by \prefp{prop:Rxynmm}}
     && \text{and hypothesis (A)}
   \\&= \Ryx^\ast(n+m,-m)
     && \text{by \prefp{thm:Rxynm}}
     && \text{and hypothesis (B)}
   \\&= \Ryx^\ast(-m)
     && \text{by \prefp{prop:Rxynmm}}
     && \text{and hypothesis (A)}
   \\
  \Rxx(m)
     &= \Rxx(n,m)
     && \text{by \prefp{prop:Rxynmm}}
     && \text{and hypothesis (A)}
   \\&= \Rxx^\ast(n+m,-m)
     && \text{by \prefp{thm:Rxynm}}
     && \text{and hypothesis (B)}
   \\&= \Rxx^\ast(-m)
     && \text{by \prefp{prop:Rxynmm}}
     && \text{and hypothesis (A)}
\end{align*}
\end{proof}


\begin{figure}[ht]\color{figcolor}
\begin{fsK}
\begin{center}
  \setlength{\unitlength}{0.2mm}
  \begin{picture}(300,100)(-100,-60)
  \thicklines
  %\graphpaper[10](0,0)(160,80)
  \put(-100,  10 ){\makebox (100, 40)[b]{$\rvx(n)$}  }
  \put(-100, -50 ){\makebox (100, 40)[t]{$\Rxx(m)$}  }
  \put(-100, -50 ){\makebox (100, 40)[b]{$\Sxx(z)$}  }
  \put(-100,   0 ){\vector  (  1,  0){100}             }
  \put(   0, -50 ){\framebox(100,100){$\convd\fh(n)$}  }
  \put( 100,   0 ){\vector  (  1,  0){100}             }
  \put( 100,  10 ){\makebox (100, 40)[b]{$\rvy(n)$}  }
  \put( 100, -50 ){\makebox (100, 40)[t]{$\Ryy(m)$}  }
  \put( 100, -50 ){\makebox (100, 40)[b]{$\Syy(z)$}  }
  \put(  50, -60 ){\makebox (  0,  0)[t]{$\Rxy(m)$}  }
  \end{picture}
\caption{
   Linear system with WSS \fncte{random sequence} input and output
   \label{fig:d-linear-sys-WSS}
   }
\end{center}
\end{fsK}
\end{figure}

%---------------------------------------
\begin{corollary}
\footnote{
  \citerp{papoulis}{323}
  }
\label{cor:Rxyh}
%---------------------------------------
Let $\rvx(n)$ be a \fncte{random sequence} with \fncte{auto-correlation} $\Rxx(n,m)$,
    $\rvy(n)$    a \fncte{random sequence} with \fncte{auto-correlation} $\Ryy(n,m)$,
and $\Rxy(n,m)$  the \fncte{cross-correlation} of $\rvx$ and $\rvy$.
Let $\opS$ be a \structe{system} with input $\rvx(n)$, output $\rvy(n)$, 
and \fncte{impulse response} $\fh(n)$ \xref{fig:d-linear-sys-WSS}.
\corbox{
  \brbr{\begin{array}{FMD}
      (A). & $\opS$    is \prope{LTI} & and
    \\(B). & $\rvx(n)$ is \prope{WSS} & and
    \\(C). & $\rvy(n)$ is \prope{WSS} &
  \end{array}}
  \implies
  \brbl{\begin{array}{Frc>{\ds}lc>{\ds}lD}
       (1).&\pmeany &=& \pmeanx\sum_{n\in\Z} \fh(k)          &    &                                      & and
     \\(2).&\Rxy(m) &=& \Rxx(m)\convd \fh^\ast(-m)           &\eqd& \sum_{k\in\Z} \fh^\ast(k) \Rxx(m+k)  & and
     \\(3).&\Ryy(m) &=& \Ryx(m)\convd \fh^\ast(-m)           &\eqd& \sum_{k\in\Z} \fh^\ast(k) \Rxy(m+k)  & and
     \\(4).&\Ryy(m) &=& \mc{4}{l}{\ds\Rxx^\ast(m)\convd \fh(-m)\convd\fh^\ast(-m)} %&\eqd& \mc{2}{l}{\ds\sum_{p\in\Z}\sum_{k\in\Z}\fh(k)h^\ast(p) \Rxx(m-p-k)}
  \end{array}}
  }
\end{corollary}
\begin{proof}
\begin{align*}
  \pmeany 
     &= \pmeany(n)
     && \text{by \prefp{prop:Rxynmm}}
     && \text{and hypothesis (A)}
   \\&= \sum_{n\in\Z} \fh(k) \pmeanx(n-k)
     && \text{by \prefp{thm:Rxynm}}
     && \text{and hypothesis (B)}
   \\&= \sum_{n\in\Z} \fh(k) \pmeanx(0)
     && \text{by \prefp{def:wss}}
     && \text{and hypothesis (B)}
   \\&= \pmeanx(0) \sum_{n\in\Z} \fh(k) 
     && \text{by \prope{linear} property of $\sum$}
   \\&= \pmeanx \sum_{n\in\Z} \fh(k) 
     && \text{by \prefp{prop:Rxynmm}}
   \\
  \Rxy(m)
     &\eqd \Rxy(0,m)
     && \text{by \prefp{prop:Rxynmm}}
     && \text{and hypothesis (A)}
   \\&= \sum_{k\in\Z} \fh^\ast(k) \Rxx(0-k,m+k)
     && \text{by \prefp{thm:Rxyh}}
     && \text{and hypothesis (B)}
   \\&= \sum_{k\in\Z} \fh^\ast(k) \Rxx(m+k)
     && \text{by \prefp{prop:Rxynmm}}
     && \text{and hypothesis (A)}
   \\&= \fh^\ast(-m) \convd\Rxx(m)
     && \text{by \prefp{prop:conv_knk}}
\\
\\
  \Ryy(m)
     &\eqd \Ryy(0,m)
     && \text{by \prefp{prop:Rxynmm}}
     && \text{and hypothesis (A)}
   \\&= \sum_{k\in\Z} \fh^\ast(k) \Ryx(n-k,m+k)
     && \text{by \prefp{thm:Rxyh}}
     && \text{and hypothesis (B)}
   \\&= \sum_{k\in\Z} \fh^\ast(k) \Ryx(m+k)
     && \text{by \prefp{prop:Rxynmm}}
     && \text{and hypothesis (A)}
   \\&= \fh^\ast(-m) \convd\Ryx(m)
     && \text{by \prefp{prop:conv_knk}}
\\
\\
  \Ryy(m)
     &= \fh^\ast(-m) \convd\Ryx(m)
     && \text{by result (2)}
   \\&= \fh^\ast(-m) \convd\Rxy^\ast(m)
     && \text{by \prefp{cor:Rxym}}
   \\&= \fh^\ast(-m) \convd\brs{\fh^\ast(-m) \convd\Rxx(m)}^\ast
     && \text{by result (1)}
   \\&= \fh^\ast(-m) \convd\fh(-m) \convd\Rxx^\ast(m)
      && \text{by \prope{distributive} property of \structd{$\invo$-algebra}s}
      && \text{\xref{def:staralg}}
\end{align*}
\end{proof}


%=======================================
\section{Spectral density}
%=======================================
%---------------------------------------
\begin{definition}
\label{def:psd}
\label{def:csd}
\label{def:Swxy}
%---------------------------------------
Let $\rvx(n)$ and $\rvy(n)$ be a \prope{wide sense stationary} \fncte{random sequence}s
with auto-correlation $\Rxx(m)$ and cross-correlation $\Rxy(m)$.
Let $\opZ$ be the \ope{Z-transform operator}\ifsxref{dsp}{def:opZ}.
\\
\defbox{\begin{array}{MMrclcl}
   The \opd{power spectral density} & (\opd{PSD}) $\ZSxx(z)$ of $\vx$ is           & \ZSxx(z) &\eqd& \opZ{\Rxx(m)} &\eqd& \ds \sum_{m\in\Z} \Rxx(m) z^{-m}\\
   The \opd{cross spectral density} & (\opd{CSD}) $\ZSxy(z)$ of $\vx$ and $\vy$ is & \ZSxy(z) &\eqd& \opZ{\Rxy(m)} &\eqd& \ds \sum_{m\in\Z} \Rxy(m) z^{-m}
\end{array}}
\end{definition}

%---------------------------------------
\begin{theorem}
\label{thm:ZSxy_sym}
%---------------------------------------
Let $\opS$ be a system with \fncte{impulse response} $\fh(n)$,
\fncte{input} $\rvx(n)$, and \fncte{output} $\rvy(n)$.
\thmbox{
  \brb{\begin{array}{MD}
    \mc{2}{M}{$\rvx$ and $\rvy$ are \prope{wide sense stationary}}
  \end{array}}
  \implies
  \brb{\begin{array}{F>{\ds}rc>{\ds}lD}
       (1).&\ZSxx(z) &=& \ZSxx^\ast\brp{\frac{1}{z^\ast}}             & and
     \\(2).&\ZSyx(z) &=& \ZSxy^\ast\brp{\frac{1}{z^\ast}}             &
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{align*}
  \ZSyx(z)
     &\eqd \opZ \Ryx(m)
    && \text{by definition of $\ZSxy(z)$}
    && \text{\xref{def:csd}}
  \\&\eqd \sum_{m\in\Z} Ryx(m) z^{-m}
    && \text{by definition of $\opZ$}
    && \text{\xref{def:opZ}}
  \\&\eqd \sum_{m\in\Z} \Rxy^\ast(-m) z^{-m}
    && \text{by \prefp{cor:Rxym}}
  \\&= \brs{\sum_{m\in\Z} \Rxy(-m) (z^\ast)^{-m}}^\ast
  \\&= \brs{\sum_{-p\in\Z} \Rxy(p) (z^\ast)^{p}}^\ast
    && \text{where $p\eqd -m$}
    && \text{$\implies$ $m=-p$}
  \\&= \brs{\sum_{p\in\Z} \Rxy(p) (z^\ast)^{p}}^\ast
    && \text{by \prope{absolutely summable} property}
    && \text{\xref{def:spllR}}
  \\&= \brs{\sum_{p\in\Z} \Rxy(p) \brp{\frac{1}{z^\ast}}^{-p}}^\ast
  \\&= \ZSxy^\ast\brp{\frac{1}{z^\ast}}
    && \text{by definition of $\opZ$}
    && \text{\xref{def:opZ}}
  \\
  \ZSxx(z)
    &= \brlr{\ZSxy(z)}_{\rvy=\rvx}
  \\&= \brlr{\ZSyx^\ast(z)}_{\rvy=\rvx}
  \\&= \brlr{\ZSxy^\ast\brp{\frac{1}{z^\ast}}}_{\rvy=\rvx}
    && \text{by (2)---previous result}
  \\&= \ZSxx^\ast\brp{\frac{1}{z^\ast}}
\end{align*}
\end{proof}

%---------------------------------------
\begin{theorem}
\footnote{
  \citerp{papoulis}{323}
  }
\label{thm:ZSxy}
%---------------------------------------
Let $\opS$ be a system with \fncte{impulse response} $\fh(n)$,
\fncte{input} $\rvx(n)$, and \fncte{output} $\rvy(n)$.
\thmbox{
  \brb{\begin{array}{FMD}
    (A).& $\fh$ is \prope{linear time invariant} & and\\
    (B).& \mc{2}{M}{$\rvx$ and $\rvy$ are \prope{wide sense stationary}}
  \end{array}}
  \implies
  \brb{\begin{array}{F>{\ds}rc>{\ds}lD}
       (1).&\ZSxy(z) &=& \ZSxx(z) \Zh^\ast\brp{\frac{1}{z^\ast}}      & and
     \\(2).&\ZSyy(z) &=& \ZSyx(z) \Zh^\ast\brp{\frac{1}{z^\ast}}      & and
     \\(3).&\ZSyy(z) &=& \ZSxx(z) \Zh\brp{z} \Zh^\ast\brp{\frac{1}{z^\ast}}
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{align*}
  \ZSxy(z)
     &\eqd \opZ \Rxy(m)
    && \text{by definition of $\Sxy(z)$}
    && \text{\xref{def:csd}}
   \\&= \opZ \brs{\Rxx(m) \convd \fh^\ast(-m)}
    && \text{by \prefp{cor:Rxyh}}
   \\&= \brs{\opZ\Rxx(m)}\,\opZ\brs{\fh^\ast(-m)}
    && \text{by \thme{convolution theorem}}
    && \text{\xref{thm:conv}}
   \\&= \ZSxx(z) \Zh^\ast\brp{\frac{1}{z^\ast}}
    && \text{by \prefp{thm:opZ}}
   \\
   \\
  \ZSyy(z)
     &\eqd \opZ \Ryy(m)
    && \text{by definition of $\ZSyy(z)$}
    && \text{\xref{def:csd}}
   \\&= \opZ \brs{\Ryx(m) \convd \fh^\ast(-m)}
    && \text{by \prefp{cor:Rxyh}}
   \\&= \brs{\opZ\Ryx(m)}\,\opZ\brs{\fh^\ast(-m)}
    && \text{by \thme{convolution theorem}}
    && \text{\xref{thm:conv}}
   \\&= \ZSyx(z) \Zh^\ast\brp{\frac{1}{z^\ast}}
    && \text{by \prefp{thm:opZ}}
   \\
   \\
  \ZSyy(z)
     &= \ZSyx(z) \Zh^\ast\brp{\frac{1}{z^\ast}}
     && \text{by previous result}
     && \text{(2)}
   \\&= \ZSxy^\ast\brp{\frac{1}{z^\ast}} \Zh^\ast\brp{\frac{1}{z^\ast}}
     && \text{by \prefp{thm:ZSxy_sym}}
   \\&= \brs{ \ZSxx(z') \Zh^\ast\brp{\frac{1}{z'^\ast}} }^\ast_{z'=\frac{1}{z^\ast}} 
        \Zh^\ast\brp{\frac{1}{z^\ast}}
     && \text{by previous result}
     && \text{(1)}
   \\&= \ZSxx^\ast\brp{\frac{1}{z^\ast}} \Zh\brp{z} \Zh^\ast\brp{\frac{1}{z^\ast}}
   \\&= \ZSxx(z) \Zh\brp{z} \Zh^\ast\brp{\frac{1}{z^\ast}}
     && \text{by \pref{thm:ZSxy_sym}}
\end{align*}
\end{proof}

%---------------------------------------
\begin{corollary}
\label{cor:Swxy_sym}
%---------------------------------------
Let $\opS$ be a system with \fncte{impulse response} $\fh(n)$,
\fncte{input} $\rvx(n)$, and \fncte{output} $\rvy(n)$.
\corbox{
  \brb{\begin{array}{FMD}
    (A).& $\fh$ is \prope{LTI} & and\\
    (B).& \mc{2}{M}{$\rvx$ and $\rvy$ are \prope{WSS}}
  \end{array}}
  \implies
  \brb{\begin{array}{F>{\ds}rc>{\ds}lDD}
       (1).&\Swxy^\ast(\omega) &=& \ds \Swyx(\omega)          & (\prope{conjugate-symmetric}) & and
     \\(2).&\Swxx^\ast(\omega) &=& \ds \Swxx(\omega)          & (\prope{conjugate symmetric}) & and
     \\(3).&\Swxx(\omega)      &\in& \R                       & (\prope{real-valued})         &
  \end{array}}
  }
\end{corollary}
\begin{proof}
\begin{align*}
   \Swxy^\ast(\omega)
     &= \brlr{\ZSxy^\ast(z)}_{z=e^{i\omega}}
     && \text{by definition of \ope{DTFT}}
     && \text{\xref{def:dtft}}
   \\&= \brlr{\ZSyx^{\ast\ast}\brp{\frac{1}{z^\ast}}}_{z=e^{i\omega}}
     && \text{by \prefp{thm:ZSxy}}
   \\&= \brlr{\ZSyx\brp{\frac{1}{z^\ast}}}_{z=e^{i\omega}}
     && \text{by \prope{???} property of \structd{$\invo$-algebra}s}
     && \text{\xref{def:staralg}}
   \\&= \ZSyx\brp{\frac{1}{e^{i\omega\ast}}}
   \\&= \ZSyx\brp{e^{i\omega}}
   \\&= \Swyx\brp{\omega}
     && \text{by definition of \ope{DTFT}}
     && \text{\xref{def:dtft}}
   \\
   \Swxx^\ast(\omega)
     &= \brlr{\ZSxx^\ast(z)}_{z=e^{i\omega}}
     && \text{by definition of \ope{DTFT}}
     && \text{\xref{def:dtft}}
   \\&= \brlr{\ZSxx^{\ast\ast}\brp{\frac{1}{z^\ast}}}_{z=e^{i\omega}}
     && \text{by \prefp{thm:ZSxy}}
   \\&= \brlr{\ZSxx\brp{\frac{1}{z^\ast}}}_{z=e^{i\omega}}
     && \text{by \prope{???} property of \structd{$\invo$-algebra}s}
     && \text{\xref{def:staralg}}
   \\&= \ZSxx\brp{\frac{1}{e^{i\omega\ast}}}
   \\&= \ZSxx\brp{e^{i\omega}}
   \\&= \Swxx\brp{\omega}
     && \text{by definition of \ope{DTFT}}
     && \text{\xref{def:dtft}}
   \\&\implies\text{$\Swxx(\omega)$ is \prope{real-valued}}
   \\
   \Swxx^\ast(\omega)
     &= \brlr{\Swxy^\ast(\omega)}_{\rvy=\rvx}
   \\&= \brlr{\Swyx(\omega)}_{\rvy=\rvx}
     && \text{by previous result}
   \\&= \Swxx(\omega)
\end{align*}
\end{proof}

%---------------------------------------
\begin{corollary}
\label{cor:Swxy}
%---------------------------------------
Let $\opS$ be a system with \fncte{impulse response} $\fh(n)$,
\fncte{input} $\rvx(n)$, and \fncte{output} $\rvy(n)$.
\corbox{
  \brb{\begin{array}{FMD}
    (A).& $\fh$ is \prope{linear time invariant} & and\\
    (B).& \mc{2}{M}{$\rvx$ and $\rvy$ are \prope{wide sense stationary}}
  \end{array}}
  \implies
  \brb{\begin{array}{FrclD}
       (1).&\Swxy(\omega) &=& \ds \Swxx(\omega) \Fh^\ast(\omega) & and
     \\(2).&\Swyy(\omega) &=& \ds \Swyx(\omega) \Fh^\ast(\omega)   & and
     \\(3).&\Swyy(\omega) &=& \mc{2}{l}{\ds \Swxx(\omega) \abs{\Fh(\omega)}^2}
  \end{array}}
  }
\end{corollary}
\begin{proof}
\begin{align*}
   \Swxy(\omega)
     &= \brlr{\ZSxy(z)}_{z=e^{i\omega}}
     && \text{by definition of \ope{DTFT}}
     && \text{\xref{def:dtft}}
   \\&= \brlr{\ZSxx(z)\Zh^\ast\brp{\frac{1}{z^\ast}}}_{z=e^{i\omega}}
     && \text{by \prefp{thm:ZSxy}}
   \\&= \ZSxx\brp{e^{i\omega}}\Zh^\ast\brp{\frac{1}{e^{i\omega\ast}}}
   \\&= \ZSxx\brp{e^{i\omega}}\Zh^\ast\brp{e^{i\omega}}
   \\&= \Swxx(\omega) \Fh^\ast(\omega)
     && \text{by definition of \ope{DTFT}}
     && \text{\xref{def:dtft}}
   \\
   \Swyy(\omega)
     &= \brlr{\ZSyy(z)}_{z=e^{i\omega}}
     && \text{by definition of \ope{DTFT}}
     && \text{\xref{def:dtft}}
   \\&= \brlr{\ZSyx(z)\Zh^\ast\brp{\frac{1}{z^\ast}}}_{z=e^{i\omega}}
     && \text{by \prefp{thm:ZSxy}}
   \\&= \ZSyx\brp{e^{i\omega}} \Zh^\ast\brp{\frac{1}{e^{i\omega\ast}}}
   \\&= \ZSyx\brp{e^{i\omega}} \Zh^\ast\brp{e^{i\omega}}
   \\&= \Swyx(\omega) \Fh^\ast(\omega)
     && \text{by definition of \ope{DTFT}}
     && \text{\xref{def:dtft}}
   \\
   \Swyy(\omega)
     &= \brlr{\ZSyy(z)}_{z=e^{i\omega}}
     && \text{by definition of \ope{DTFT}}
     && \text{\xref{def:dtft}}
   \\&= \brlr{\ZSxx(z)\Zh\brp{z} \Zh^\ast\brp{\frac{1}{z^\ast}}}_{z=e^{i\omega}}
     && \text{by \prefp{thm:ZSxy}}
   \\&= \ZSxx\brp{e^{i\omega}} \Zh\brp{e^{i\omega}} \Zh^\ast\brp{\frac{1}{e^{i\omega\ast}}}
   \\&= \ZSxx\brp{e^{i\omega}} \Zh\brp{e^{i\omega}} \Zh^\ast\brp{e^{i\omega}}
   \\&= \Swxx(\omega) \Fh(\omega) \Fh^\ast(\omega)
     && \text{by definition of \ope{DTFT}}
     && \text{\xref{def:dtft}}
   \\&= \Swxx(\omega) \abs{\Fh(\omega)}^2
   \\
     &\text{alternative proof to previous one:}
   \\
   \Swyy(\omega)
     &= \Swyx(\omega) \Fh^\ast(\omega)
     && \text{by previous result}
     && \text{(2)}
   \\&= \Swxy^\ast(\omega) \Fh^\ast(\omega)
     && \text{by \prefp{cor:Swxy_sym}}
   \\&= \brs{\Swxx(\omega) \Fh^\ast(\omega)}^\ast \Fh^\ast(\omega)
     && \text{by previous result}
     && \text{(1)}
   \\&= \Swxx^\ast(\omega) \Fh(\omega) \Fh^\ast(\omega)
     && \text{by \prope{distributive} property of \structd{$\invo$-algebra}s}
     && \text{\xref{def:staralg}}
   \\&= \Swxx(\omega) \abs{\Fh(\omega)}^2
     && \text{by \prefp{cor:Swxy_sym}}
\end{align*}
\end{proof}






