%============================================================================
% Daniel J. Greenhoe
% XeLaTeX file
% Hadamard matrix
% 
% H1 = [1]
% 
% H2 = |H1 H1 | = |1  1|
%      |H1 H1^|   |1 -1|
%
%                 |1  1   1   1|
% H3 = |H2 H2 | = |1 -1   1  -1|
%      |H2 H2^|   |1  1  -1  -1|
%                 |1 -1  -1   1|
%============================================================================
\begin{pspicture}(-4,-2)(4,2)%
  \psset{%
    linewidth=1pt,%
    linecolor=latline,%
    radius=0.75\psunit,%
    dotsize=5pt,%
    }%
  %-------------------------------------
  % nodes
  %-------------------------------------
  \rput(0,1.5){\ovalnode{lub}{$\spX=\oppS H_3$}}%
  %\cnodeput(0,2){lub}{$\spX$}
  %\rput[l](1,2){\rnode{Xlabel}{\footnotesize$\spX=\oppS\set{\cos(2\pi n x)}{n=0,1,2,3}$}}%
  \cnodeput( 0,-1.5){glb}{$\spZero$}%
  \rput[bl](-4,-1.8){\rnode[t]{slabel}{scaling subspace}}%
  \Cnode(-3, 0){h1111}%
  \Cnode(-1, 0){h11nn}%
  \Cnode( 1, 0){h1nn1}%
  \Cnode( 3, 0){h1n1n}%
  %-------------------------------------
  % connecting lines
  %-------------------------------------
  \ncline{h1111}{lub}%
  \ncline{h1n1n}{lub}%
  \ncline{h11nn}{lub}%
  \ncline{h1nn1}{lub}%
  \ncline{h1111}{glb}%
  \ncline{h1n1n}{glb}%
  \ncline{h11nn}{glb}%
  \ncline{h1nn1}{glb}%
  \ncline{->}{Xlabel}{lub}%
  \ncline{->}{slabel}{h1111}%
  %\ncarc[arcangle=30]{->}{slabel}{h1111}
  %-------------------------------------
  % plots
  %-------------------------------------
  \psset{yunit=3.5mm,xunit=2.75mm}%
  \rput(h1111){\begin{pspicture}(-1,-2)(4,2)%
      \psset{linecolor=blue}%
      \psline[linecolor=axis]{->}(0,0)(4,0)%
      \psline[linecolor=axis]{<->}(0,-1.75)(0,1.75)%
      \psline{-o}(0,0)(0, 1)%  1
      \psline{-o}(1,0)(1, 1)%  1
      \psline{-o}(2,0)(2, 1)%  1
      \psline{-o}(3,0)(3, 1)%  1
    \end{pspicture}}%
  \rput(h1n1n){\begin{pspicture}(-1,-2)(4,2)%
      \psset{linecolor=red}%
      \psline[linecolor=axis]{->}(0,0)(4,0)%
      \psline[linecolor=axis]{<->}(0,-1.75)(0,1.75)%
      \psline{-o}(0,0)(0, 1)%  1
      \psline{-o}(1,0)(1,-1)% -1
      \psline{-o}(2,0)(2, 1)%  1
      \psline{-o}(3,0)(3,-1)% -1
    \end{pspicture}}%
  \rput(h11nn){\begin{pspicture}(-1,-2)(4,2)%
      \psset{linecolor=red}%
      \psline[linecolor=axis]{->}(0,0)(4,0)%
      \psline[linecolor=axis]{<->}(0,-1.75)(0,1.75)%
      \psline{-o}(0,0)(0, 1)%  1
      \psline{-o}(1,0)(1, 1)%  1
      \psline{-o}(2,0)(2,-1)% -1
      \psline{-o}(3,0)(3,-1)% -1
    \end{pspicture}}%
  \rput(h1nn1){\begin{pspicture}(-1,-2)(4,2)%
      \psset{linecolor=red}%
      \psline[linecolor=axis]{->}(0,0)(4,0)%
      \psline[linecolor=axis]{<->}(0,-1.75)(0,1.75)%
      \psline{-o}(0,0)(0, 1)%  1
      \psline{-o}(1,0)(1,-1)% -1
      \psline{-o}(2,0)(2,-1)% -1
      \psline{-o}(3,0)(3, 1)%  1
      %\psgrid(-4,-1.8)(4,1.8)%
    \end{pspicture}}%
\end{pspicture}%