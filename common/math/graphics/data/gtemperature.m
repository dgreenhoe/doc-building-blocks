%========================================================================
% Daniel J. Greenhoe
% Sunspots
%
% Data source:  Data was adapted from
%   https://climate.nasa.gov/vital-signs/global-temperature/
%     "Land-Ocean Temperature Index (C"
%     https://data.giss.nasa.gov/gistemp/graphs/graph_data/Global_Mean_Estimates_based_on_Land_and_Ocean_Data/graph.txt
%
% cd "c:/dan/r/common/math/graphics/data"
%========================================================================
Y = [ 
 -0.17
 -0.08
 -0.11
 -0.18
 -0.28
 -0.33
 -0.31
 -0.36
 -0.17
 -0.10
 -0.35
 -0.22
 -0.27
 -0.31
 -0.30
 -0.22
 -0.11
 -0.11
 -0.27
 -0.18
 -0.08
 -0.16
 -0.28
 -0.38
 -0.48
 -0.27
 -0.23
 -0.40
 -0.43
 -0.49
 -0.44
 -0.45
 -0.37
 -0.35
 -0.16
 -0.15
 -0.36
 -0.47
 -0.31
 -0.28
 -0.28
 -0.20
 -0.28
 -0.27
 -0.28
 -0.23
 -0.12
 -0.22
 -0.21
 -0.37
 -0.16
 -0.10
 -0.16
 -0.28
 -0.13
 -0.21
 -0.15
 -0.03
 -0.01
 -0.02
  0.12
  0.18
  0.06
  0.08
  0.20
  0.09
 -0.08
 -0.03
 -0.11
 -0.11
 -0.18
 -0.07
  0.01
  0.08
 -0.13
 -0.14
 -0.19
  0.04
  0.06
  0.03
 -0.02
  0.06
  0.04
  0.05
 -0.20
 -0.11
 -0.06
 -0.02
 -0.08
  0.06
  0.03
 -0.08
  0.01
  0.16
 -0.07
 -0.01
 -0.10
  0.18
  0.07
  0.17
  0.26
  0.32
  0.14
  0.31
  0.16
  0.12
  0.18
  0.32
  0.39
  0.27
  0.45
  0.41
  0.22
  0.23
  0.32
  0.45
  0.33
  0.47
  0.61
  0.39
  0.40
  0.54
  0.63
  0.63
  0.54
  0.68
  0.64
  0.67
  0.55
  0.66
  0.73
  0.61
  0.65
  0.69
  0.75
  0.90
  1.02
  0.93
  0.85
];
pkg load signal;
N = length(Y);
X = [0:2018-1880]';   % years-1880
U = [ones(1,N) ; X', ; X'.^2, ; X'.^3];
coefs = inv(U*U')*(U*Y)
a=coefs(1)
b=coefs(2)
c=coefs(3)
d=coefs(4)
bestFit = d*X.^3 + c*X.^2 + b*X + a;
plot(bestFit)
x = 2030;
predict2030 = d*(x-1880)^3 + c*(x-1880)^2 + b*(x-1880) + a
x = 1870;
predict1870 = d*(x-1880)^3 + c*(x-1880)^2 + b*(x-1880) + a
pkg load signal
[mag,freq] = pwelch(Y-bestFit, Nfft=4, overlap=0.5)%

plot(freq,mag);
