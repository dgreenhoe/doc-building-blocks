%============================================================================
% Daniel J. Greenhoe
% XeLaTeX file
% nominal unit = 10mm
%============================================================================
\begin{pspicture}(-3.8,-0.5)(3.8,3.5)
  \psset{linewidth=1pt,linecolor=latline,radius=0.75\psunit}%
  %-------------------------------------
  % nodes
  %-------------------------------------
  \rput(0,3){\ovalnode{lub}{$\spX=\oppS\set{\fh(nx)}{n=0,1,2,3}$}}%
  \cnodeput( 0,0){glb}{$\spZero$}%
  \rput[bl](-3.5,-0.3){\rnode[tl]{slabel}{scaling subspace}}%
  \Cnode(-3,1.5){cos0hz}%
  \Cnode(-1,1.5){cos1hz}%
  \Cnode( 1,1.5){cos2hz}%
  \Cnode( 3,1.5){cos3hz}%
  %-------------------------------------
  % connecting lines
  %-------------------------------------
  \ncline{cos0hz}{lub}%
  \ncline{cos1hz}{lub}%
  \ncline{cos2hz}{lub}%
  \ncline{cos3hz}{lub}%
  \ncline{cos0hz}{glb}%
  \ncline{cos1hz}{glb}%
  \ncline{cos2hz}{glb}%
  \ncline{cos3hz}{glb}%
  \ncline{->}{Xlabel}{lub}%
  \ncline{->}{slabel}{cos0hz}%
  %\ncarc[arcangle=30]{->}{slabel}{cos0hz}
  %-------------------------------------
  % plots
  %-------------------------------------
  \rput(cos0hz){\rput(-0.625,0){%
    \psline[linecolor=axis]{->}(0,0)(1.4,0)%
    \psline[linecolor=axis]{<->}(0,-0.7)(0,0.7)%
    \psline[linecolor=blue](0,0)(0,0.212)(1.2,0.212)(1.2,0)%
    }}%
  \rput(cos1hz){\rput(-0.5,0){%
    \psline[linecolor=axis]{->}(0,0)(1.4,0)%
    \psline[linecolor=axis]{<->}(0,-0.7)(0,0.7)%
    \psline[linecolor=red](0,0)(0,0.30)(0.6,0.30)(0.6,-0.30)(1.2,-0.30)(1.2,0)%
    }}%
  \rput(cos2hz){\rput(-0.125,0){%
    \psline[linecolor=axis]{->}(0,0)(0.7,0)%
    \psline[linecolor=axis]{<->}(0,-0.7)(0,0.7)%
    \psline[linecolor=red](0,0)(0,0.42)(0.3,0.42)(0.3,-0.42)(0.6,-0.42)(0.6,0)%
    }}%
  \rput(cos3hz){\rput(-0.125,0){%
    \psline[linecolor=axis]{->}(0,0)(0.7,0)%
    \psline[linecolor=axis]{<->}(0,-0.7)(0,0.7)%
    \psline[linecolor=red](0,0)(0,0.6)(0.15,0.6)(0.15,-0.6)(0.30,-0.6)(0.30,0)%
    }}%
  %-------------------------------------
  % development support
  %-------------------------------------
  %\psgrid(-4,-1.8)(4,1.8)%
\end{pspicture}%