%============================================================================
% LaTeX File
% Daniel Greenhoe
%============================================================================

%======================================
\chapter{Multidimensional Wavelet Systems}
\label{app:3d}
\index{multidimensional wavelet systems}
%======================================
 
%--------------------------------------
\section {Multidimensional subspaces}
%--------------------------------------
Wavelet systems not only can be constructed in one dimensional spaces
but in multidimensional spaces as well.
Scaling functions and wavelet functions in $p$-dimensions can be constructed 
using products of one-dimensional functions $\fphi(t)$ and $\fpsi(t)$.


%--------------------------------------
\begin{theorem}
\label{thm:pdim}
\citep{mallat}{313}
%--------------------------------------
Let $\phi(x)\in V_m$.

Let a function $\theta_k(x)$ be defined as follows:
\begin{eqnarray*}
   \theta_0(x) &\eqd& \fphi(x) \\
   \theta_1(x) &\eqd& \fpsi(x) 
\end{eqnarray*}

Let $b\eqd [b_{1} b_{2} \ldots b_p ]$ be the dyadic representation of a number
$n$ where $0\le n < 2^p$.
\begin{eqnarray*}
   n &=& \sum\limits_{m=0}^{2^p-1} b_m 2^m
   \hspace{1cm}\mbox{where }b_m \in \{0,1\}
\end{eqnarray*}

Let a function $\psi^{(b)}(x)$ be defined as follows:
\begin{eqnarray*}
   \psi^{(b)}(x_1, x_2, \ldots, x_p) &=& 
   \theta_{b_1}(x_1)\theta_{b_{2}}(x_2)\cdots\theta_{b_p}(x_p) 
\end{eqnarray*}

Then 
\begin{eqnarray*}
   \left\{
      \psi^{(b)}(x_1, x_2, \ldots, x_p) : b=0,1,2,\ldots, 2^p-1
   \right\}
\end{eqnarray*}
spans $L^2(\R^p)$.
\end{theorem}

The function 
$\psi^{(0)}(x_1, x_2, \ldots, x_p) \eqd \theta_0(x_1)\theta_0(x_2)\cdots\theta_0(x_p)$
is roughly equivalent to the scaling function $\phi(x)$ in the one-dimensional case.
We can therefore label this function $\phi^{(0)}(x) \eqd \psi^{(0)}(x)$.
The remaining functions
$\left\{ \psi^{(b)}(x_1, x_2, \ldots, x_p) : b = 1,2,\ldots,2^p-1 \right\}$
are roughly equivalent to the wavelet function $\psi(x)$ in the one-dimensional case.


%--------------------------------------
\section {Constructing a 3-dimensional wavelet basis}
%--------------------------------------
In three-dimensional Euclidean space, we are interested in wavelet functions
in $p=3$ dimensions.
Let the indeterminates $x,y,z$ represent translation in each of these three
dimensions.
Then by \prefpp{thm:pdim} the following functions form a basis in $L^2(\R^3)$.
   \begin{eqnarray*}
      \psi^{(0)}(x,y,z) &=& \phi(x) \phi(y) \phi(z) \\ 
      \psi^{(1)}(x,y,z) &=& \phi(x) \phi(y) \psi   (z) \\ 
      \psi^{(2)}(x,y,z) &=& \phi(x) \psi   (y) \phi(z) \\ 
      \psi^{(3)}(x,y,z) &=& \phi(x) \psi   (y) \psi   (z) \\ 
      \psi^{(4)}(x,y,z) &=& \psi   (x) \phi(y) \phi(z) \\ 
      \psi^{(5)}(x,y,z) &=& \psi   (x) \phi(y) \psi   (z) \\ 
      \psi^{(6)}(x,y,z) &=& \psi   (x) \psi   (y) \phi(z) \\ 
      \psi^{(7)}(x,y,z) &=& \psi   (x) \psi   (y) \psi   (z)
   \end{eqnarray*}

%--------------------------------------
\section {Wavelet Transform in $p$-dimensions}
%--------------------------------------
%--------------------------------------
\begin{definition}[Wavelet transform in $p$-dimensions $\mathcal{W}^{(p)}f(b,n_1,n_2,\ldots,n_p)$]
%--------------------------------------
Let the wavelet transform $\mathcal{W}^{(p)}f(b,n_1,n_2,\ldots,n_p)$ of 
function $f(n_1,n_2,\ldots,n_p)$ be defined as
\begin{eqnarray*}
   \mathcal{W}^{(p)}f(b,j,n_1,n_2,\ldots,n_p)
   &\eqd&  w_j^{(b)}(n_1,n_2,\ldots,n_p) \\
   &\eqd&  \inprod{f(n_1, n_2, \ldots, n_p)}{\psi_{j,n}^{(b)}(n_1, n_2, \ldots, n_p)}
\end{eqnarray*} 
where $b=1,2,\ldots,2^p-1$.

In addition, let 
\begin{eqnarray*}
   v_j(n_1,n_2,\ldots,n_p) 
   &\eqd&  \inprod{f(n_1, n_2, \ldots, n_p)}{\psi_{j,n}^{(0)}(n_1, n_2, \ldots, n_p)}.
\end{eqnarray*} 
\end{definition}

\if 0
%--------------------------------------
\section {Wavelet Transform with separable wavelet functions}
%--------------------------------------
If the wavelet functions $\psi^{(b)}(x_1, x_2, \ldots, x_p)$ are separable
then the complexity of the wavelet transformation may decrease to some 
extent.
   \begin{eqnarray*}
      w_j^{(b)}(n_1, n_2, \ldots, n_p) 
         &=& \inprod{f(x_1, x_2, \ldots, x_p)}{\psi_j^{(b)}(x_1, x_2, \ldots, x_p)}\\
         &=& \inprod{f(x_1, x_2, \ldots, x_p)}{
             \psi_j^{(b)}(x_1) \psi_j^{(b)}(x_2) \cdots \psi_j^{(b)}(x_p) }
   \end{eqnarray*}
In $L^2(\R^p)$ this becomes
   \begin{eqnarray*}
      w_j^{(b)}(n_1, n_2, \ldots, n_p) 
         &=& \inprod{f(x_1, x_2, \ldots, x_p)}{\psi_j^{(b)}(x_1, x_2, \ldots, x_p)}\\
         &=& \inprod{f(x_1, x_2, \ldots, x_p)}{
             \psi_j^{(b)}(x_1) \psi_j^{(b)}(x_2) \cdots \psi_j^{(b)}(x_p) } \\
         &=& \int\limits_{x_1=-\infty}^{x_1=+\infty}
             \int\limits_{x_2=-\infty}^{x_2=+\infty}
             \cdots
             \int\limits_{x_p=-\infty}^{x_p=+\infty}
             f(x_1, x_2, \ldots, x_p)
             \psi_j^{(b)}(x_1) \psi_j^{(b)}(x_2) \psi_j^{(b)}(x_p)
             dx_1 dx_2 \cdots dx_p  \\
         &=& \int\limits_{x_1=-\infty}^{x_1=+\infty}\psi_j^{(b)}(x_1)
             \int\limits_{x_2=-\infty}^{x_2=+\infty}\psi_j^{(b)}(x_2)
             \cdots
             \int\limits_{x_p=-\infty}^{x_p=+\infty}
             f(x_1, x_2, \ldots, x_p)
             \psi_j^{(b)}(x_p)
             dx_1 dx_2 \cdots dx_p
   \end{eqnarray*}
\fi

%--------------------------------------
\section {Fast Wavelet Transform in $p$-dimensions}
%--------------------------------------
%--------------------------------------
\subsection {Filter Coefficients}
%--------------------------------------
Let $b=[b_{1} b_{2} \ldots b_p ]$ be the binary representation of a number
$2^p$.
Then $p$-dimensional separable filter coefficients 
$\bar{g}^{(b)}(n_1, n_2, \ldots, n_p)$
may be constructed
from one-dimensional scaling coefficients $h(m)$ in the following
manner:
\footnote{\cite{mallat} pp.313-314}
   \begin{eqnarray}
      g(m)       &=&      (-1)^{1-m}h(1-m) \\
      u_0(m)     &\eqd& h(m)  \\ 
      u_1(m)     &\eqd& g(m)  \\ 
      g^{(b)}(n_1, n_2, \ldots, n_p)       &=&      u_{b_1}(n_1) u_{b_2}(n_2) \cdots u_{b_p}(n_p)  \\
      \bar{g}^{(b)}(n_1, n_2, \ldots, n_p) &=&      g^{(b)}(-n_1, -n_2, \ldots, -n_p)  \\
      h^{(0)}(n_1, n_2, \ldots, n_p)       
         &\eqd& g^{(0)}(n_1, n_2, \ldots, n_p)   \\
         &=&      h(n_1) h(n_2) \cdots h(n_p)      \\
      \bar{h}^{(0)}(n_1, n_2, \ldots, n_p) &\eqd& h^{(0)}(-n_1, -n_2, \ldots, -n_p)  
   \end{eqnarray}

%--------------------------------------
\subsection {Convolution Operations}
%--------------------------------------
As in a one-dimensional space, the Fast Wavelet Transform (FWT) operation
can be performed in $p$-dimensional space as well.
Again the FWT can be implemented using filtering and downsampling operations.
That is, the wavelet values $w^{(b)}(n_1, n_2, \ldots, n_p)$ at scale $j$
can be computed from $v^{(b)}(x_1, x_2, \ldots, x_p)$ at scale $j+1$
through the operations of filtering and downsampling.  This is shown in the 
followng equations.
\footnote{\cite{mallat} p.314}
Let the operator $[\cdot]\downarrow_2$ represent the operation of downsampling by 2.
   \begin{eqnarray}
      v_j(n_1, n_2, \ldots, n_p) 
         &=& \left[
             \bar{g}^{(0)}(n_1, n_2, \ldots, n_p) \star v_{j+1}(n_1, n_2, \ldots, n_p)
             \right]\downarrow_2 \\
         &=& \left[
             \bar{h}^{(0)}(n_1, n_2, \ldots, n_p) \star v_{j+1}(n_1, n_2, \ldots, n_p)
             \right]\downarrow_2 \\
      w_j^{(b)}(n_1, n_2, \ldots, n_p) 
         &=& \left[ 
         \bar{g}^{(b)}(n_1, n_2, \ldots, n_p) \star v_{j+1}(n_1, n_2, \ldots, n_p)
            \right]\downarrow_2 
   \end{eqnarray}

When the filter coefficients $\bar{g}^{(b)}()$ are separable, 
then the convolution operation can be carried out as consecutive
$p$ one-dimensional convolution operations.
\footnote{\cite{mallat} p.61}
   \begin{eqnarray*}
      &&w_j^{(b)}(n_1, n_2, \ldots, n_p) \\
         &=& \left[
             \bar{g}^{(b)}(n_1, n_2, \ldots, n_p) \star v_{j+1}(n_1, n_2, \ldots, n_p) 
             \right]\downarrow_2 \\
         &=& \left[
             \sum\limits_{m_1} \sum\limits_{m_2} \cdots \sum\limits_{m_p} 
             \bar{g}^{(b)}(m_1, m_2, \ldots, m_p) v_{j+1}(n_1-m_1, n_2-m_2, \ldots, n_p-m_p)
             \right]\downarrow_2 \\
         &=& \left[
             \sum\limits_{m_1} \sum\limits_{m_2} \cdots \sum\limits_{m_p} 
             \bar{u}^{(b_1)}(m_1) 
             \bar{u}^{(b_2)}(m_2)
             \cdots 
             \bar{u}^{(b_p)}(m_p)
             v_{j+1}(n_1-m_1, n_2-m_2, \ldots, n_p-m_p)
             \right]\downarrow_2 \\
         &=& \left[
             \sum\limits_{m_1} \bar{u}^{(b_1)}(m_1) 
             \sum\limits_{m_2} \bar{u}^{(b_2)}(m_2) 
             \cdots 
             \sum\limits_{m_p} \bar{u}^{(b_p)}(m_p) 
             v_{j+1}(n_1-m_1, n_2-m_2, \ldots, n_p-m_p)
             \right]\downarrow_2 \\
         &=& \left[
             \sum\limits_{m_1} \bar{u}^{(b_1)}(m_1) 
             \sum\limits_{m_2} \bar{u}^{(b_2)}(m_2) 
             \cdots 
             \sum\limits_{m_{p-1}} \bar{u}^{(b_{p-1})}(m_{p-1}) 
             \left(\bar{u}^{(b_p)}(n_p) \star v_{j+1}(n_1, n_2, \ldots, n_p)\right)
             \right]\downarrow_2 \\
         &=& \left[
             \bar{u}^{(b_1)}(n_1) 
             \star
             \bar{u}^{(b_2)}(n_2) 
             \star
             \cdots 
             \star
             \bar{u}^{(b_p)}(n_p) \star 
             v_{j+1}(n_1, n_2, \ldots, n_p)
             \right]\downarrow_2 \\
   \end{eqnarray*}


%--------------------------------------
\subsection {FWT in 3-dimensional space}
%--------------------------------------
In 3-dimensional space, the filter coefficients $\bar{g}^{(b)}(n_x,n_y,n_z)$
for the Fast Wavelet Transform take the following form:
   \begin{eqnarray*}
      \bar{h}^{(0)}(n_x,n_y,n_z) &\eqd& \bar{g}^{(0)}(n_x,n_y,n_z) \\ 
      \bar{g}^{(0)}(n_x,n_y,n_z) &=& \bar{h}(n_x) \bar{h}(n_y) \bar{h}(n_z) \\ 
      \bar{g}^{(1)}(n_x,n_y,n_z) &=& \bar{h}(n_x) \bar{h}(n_y) \bar{g}   (n_z) \\ 
      \bar{g}^{(2)}(n_x,n_y,n_z) &=& \bar{h}(n_x) \bar{g}   (n_y) \bar{h}(n_z) \\ 
      \bar{g}^{(3)}(n_x,n_y,n_z) &=& \bar{h}(n_x) \bar{g}   (n_y) \bar{g}   (n_z) \\ 
      \bar{g}^{(4)}(n_x,n_y,n_z) &=& \bar{g}   (n_x) \bar{h}(n_y) \bar{h}(n_z) \\ 
      \bar{g}^{(5)}(n_x,n_y,n_z) &=& \bar{g}   (n_x) \bar{h}(n_y) \bar{g}   (n_z) \\ 
      \bar{g}^{(6)}(n_x,n_y,n_z) &=& \bar{g}   (n_x) \bar{g}   (n_y) \bar{h}(n_z) \\ 
      \bar{g}^{(7)}(n_x,n_y,n_z) &=& \bar{g}   (n_x) \bar{g}   (n_y) \bar{g}   (n_z)
   \end{eqnarray*}

At each scale $j$, there is one set of scaling cofficients 
$v_j(n_x,n_y,n_z)= w_j^{(0)}(n_x,n_y,n_z)$ and 
seven sets of wavelet coefficients $w_j^{(b)}(n_x,n_y,n_z)$ for $b=1,2,\ldots,7$. 
Each set is a three dimensional function.
   \begin{eqnarray*}
      v_j(n_x,n_y,n_z) &=& w_j^{(0)}(n_x,n_y,n_z) \\
      w_j^{(0)}(n_x,n_y,n_z) &=& \left[ 
         \bar{h}(n_x) \star \bar{h}(n_y) \star \bar{h}(n_z) 
         \star v_{j+1}(n_x,n_y,n_z) 
         \right] \downarrow_2 \\
      w_j^{(1)}(n_x,n_y,n_z) &=& \left[ 
         \bar{h}(n_x) \star \bar{h}(n_y) \star \bar{g}(n_z) 
         \star v_{j+1}(n_x,n_y,n_z) 
         \right]  \downarrow_2 \\
      w_j^{(2)}(n_x,n_y,n_z) &=& \left[ 
         \bar{h}(n_x) \star \bar{g}(n_y) \star \bar{h}(n_z) 
         \star v_{j+1}(n_x,n_y,n_z) 
         \right]  \downarrow_2 \\
      w_j^{(3)}(n_x,n_y,n_z) &=& \left[ 
         \bar{h}(n_x) \star \bar{g}(n_y) \star \bar{g}(n_z) 
         \star v_{j+1}(n_x,n_y,n_z) 
         \right]  \downarrow_2 \\
      w_j^{(4)}(n_x,n_y,n_z) &=& \left[ 
         \bar{g}(n_x) \star \bar{h}(n_y) \star \bar{h}(n_z) 
         \star v_{j+1}(n_x,n_y,n_z) 
         \right]  \downarrow_2 \\
      w_j^{(5)}(n_x,n_y,n_z) &=& \left[ 
         \bar{g}(n_x) \star \bar{h}(n_y) \star \bar{g}(n_z) 
         \star v_{j+1}(n_x,n_y,n_z) 
         \right] \downarrow_2  \\
      w_j^{(6)}(n_x,n_y,n_z) &=& \left[ 
         \bar{g}(n_x) \star \bar{g}(n_y) \star \bar{h}(n_z) 
         \star v_{j+1}(n_x,n_y,n_z) 
         \right]\downarrow_2  \\
      w_j^{(7)}(n_x,n_y,n_z) &=& \left[ 
         \bar{g}(n_x) \star \bar{g}(n_y) \star \bar{g}(n_z) 
         \star v_{j+1}(n_x,n_y,n_z) 
         \right]\downarrow_2    
   \end{eqnarray*}

These equations are illustrated in \prefpp{fig:fwt_one}.
\footnote{reference: \citei[page 312]{mallat} }

\begin{center}
\begin{figure}[h]
\setlength{\unitlength}{\textwidth/1200}%
\begin{picture}(1150,1000)
%{\color{graphpaper}\graphpaper[100](0,0)(1200,1000)}%
\thicklines

\put( 60, 960){\makebox(100,40)[bl]{$v_{j+1}(n)$ where $n=(n_x,n_y,n_z)$}}

\put(  50, 950){\line  (1, 0){ 600}}
\put( 650, 950){\vector(0,-1){  50}}
\put(  50,1000){\vector(0,-1){ 100}}

\put( 600, 800){\framebox(100,100){$\bar{g}(n_z)$} }
\put(   0, 800){\framebox(100,100){$\bar{h}(n_z)$} }

\put( 650, 750){\line  (1, 0){300}}
\put( 950, 750){\vector(0,-1){ 50}}
\put( 650, 800){\vector(0,-1){100}}
\put(  50, 750){\line  (1, 0){300}}
\put( 350, 750){\vector(0,-1){ 50}}
\put(  50, 800){\vector(0,-1){100}}

\put( 900, 600){\framebox(100,100){$\bar{g}(n_y)$} }
\put( 600, 600){\framebox(100,100){$\bar{h}(n_y)$} }
\put( 300, 600){\framebox(100,100){$\bar{g}(n_y)$} }
\put( 0  , 600){\framebox(100,100){$\bar{h}(n_y)$} }

\put(  50, 550){\line  (1, 0){150}}
\put(1100, 550){\vector(0,-1){ 50}}
\put( 950, 600){\vector(0,-1){100}}
\put( 350, 550){\line  (1, 0){150}}
\put( 800, 550){\vector(0,-1){ 50}}
\put( 650, 600){\vector(0,-1){100}}
\put( 650, 550){\line  (1, 0){150}}
\put( 500, 550){\vector(0,-1){ 50}}
\put( 350, 600){\vector(0,-1){100}}
\put( 950, 550){\line  (1, 0){150}}
\put( 200, 550){\vector(0,-1){ 50}}
\put(  50, 600){\vector(0,-1){100}}

\put(1050, 400){\framebox(100,100){$\bar{g}(n_x)$} }
\put( 900, 400){\framebox(100,100){$\bar{h}(n_x)$} }
\put( 750, 400){\framebox(100,100){$\bar{g}(n_x)$} }
\put( 600, 400){\framebox(100,100){$\bar{h}(n_x)$} }
\put( 450, 400){\framebox(100,100){$\bar{g}(n_x)$} }
\put( 300, 400){\framebox(100,100){$\bar{h}(n_x)$} }
\put( 150, 400){\framebox(100,100){$\bar{g}(n_x)$} }
\put(   0, 400){\framebox(100,100){$\bar{h}(n_x)$} }

\put(1100, 400){\vector(0,-1){50} }
\put( 950, 400){\vector(0,-1){50} }
\put( 800, 400){\vector(0,-1){50} }
\put( 650, 400){\vector(0,-1){50} }
\put( 500, 400){\vector(0,-1){50} }
\put( 350, 400){\vector(0,-1){50} }
\put( 200, 400){\vector(0,-1){50} }
\put(  50, 400){\vector(0,-1){50} }

\put(1050, 250){\framebox(100,100){$\downarrow 2$} }
\put( 900, 250){\framebox(100,100){$\downarrow 2$} }
\put( 750, 250){\framebox(100,100){$\downarrow 2$} }
\put( 600, 250){\framebox(100,100){$\downarrow 2$} }
\put( 450, 250){\framebox(100,100){$\downarrow 2$} }
\put( 300, 250){\framebox(100,100){$\downarrow 2$} }
\put( 150, 250){\framebox(100,100){$\downarrow 2$} }
\put(   0, 250){\framebox(100,100){$\downarrow 2$} }

\put(1100, 250){\vector(0,-1){50} }
\put( 950, 250){\vector(0,-1){50} }
\put( 800, 250){\vector(0,-1){50} }
\put( 650, 250){\vector(0,-1){50} }
\put( 500, 250){\vector(0,-1){50} }
\put( 350, 250){\vector(0,-1){50} }
\put( 200, 250){\vector(0,-1){50} }
\put(  50, 250){\vector(0,-1){50} }

\put(1100, 190){\makebox(0,0)[t]{$w_j^{(7)}(n)$}}
\put( 950, 190){\makebox(0,0)[t]{$w_j^{(3)}(n)$}}
\put( 800, 190){\makebox(0,0)[t]{$w_j^{(5)}(n)$}}
\put( 650, 190){\makebox(0,0)[t]{$w_j^{(1)}(n)$}}
\put( 500, 190){\makebox(0,0)[t]{$w_j^{(6)}(n)$}}
\put( 350, 190){\makebox(0,0)[t]{$w_j^{(2)}(n)$}}
\put( 200, 190){\makebox(0,0)[t]{$w_j^{(4)}(n)$}}
\put(  50, 190){\makebox(0,0)[t]{$w_j^{(0)}(n)$}}

\put( 50, 100){\vector(0,-1){100} }
\put( 60,  10){\makebox(0,0)[l]{$v_j(n)$ where $n=(n_x,n_y,n_z)$}}

\end{picture}
\caption{
   One stage 3-dimensional Fast Wavelet Transform
   \label{fig:fwt_one}
   }
\end{figure}
\end{center}

To perform an entire Fast Wavelet Transform in 3-dimensions, we
can cascade $m$ of the above structures together to decompose a 
function $f(n_x,n_y,n_z)$ into coefficients at $m$ different scales.
Let $v_m(n_x,n_y,n_z)=f(n_x,n_y,n_z)$.  
\prefpp{fig:fwt_m} shows the resulting FWT of $f(n_x,n_y,n_z)$.




\begin{figure}
\begin{center}
\setlength{\unitlength}{\textwidth/20}%
\begin{tabular}{c}


\begin{picture}(10,10)
%{\color{graphpaper}\graphpaper[1](0,0)(12,10)}%
\thicklines

\put( 0.6, 9.6){\makebox(1,0.4)[bl]{$f(n_x,n_y,n_z) = v_m(n)$ where $n=(n_x,n_y,n_z)$}}

\put( 0.5, 9.5){\line  (1, 0){ 6  }}
\put( 6.5, 9.5){\vector(0,-1){0.5} }
\put( 0.5,10.0){\vector(0,-1){1.0} }

\put( 6  , 8  ){\framebox(1,1){$\bar{g}(n_z)$} }
\put( 0  , 8  ){\framebox(1,1){$\bar{h}(n_z)$} }

\put( 6.5, 7.5){\line  (1, 0){3.0}}
\put( 9.5, 7.5){\vector(0,-1){0.5} }
\put( 6.5, 8.0){\vector(0,-1){1.0} }
\put( 0.5, 7.5){\line  (1, 0){3.0} }
\put( 3.5, 7.5){\vector(0,-1){0.5} }
\put( 0.5, 8.0){\vector(0,-1){1.0} }

\put( 9  , 6  ){\framebox(1,1){$\bar{g}(n_y)$} }
\put( 6  , 6  ){\framebox(1,1){$\bar{h}(n_y)$} }
\put( 3  , 6  ){\framebox(1,1){$\bar{g}(n_y)$} }
\put( 0  , 6  ){\framebox(1,1){$\bar{h}(n_y)$} }

\put( 0.5, 5.5){\line  (1, 0){1.5}}
\put(11.0, 5.5){\vector(0,-1){0.5} }
\put( 9.5, 6.0){\vector(0,-1){1.0} }
\put( 3.5, 5.5){\line  (1, 0){1.5}}
\put( 8.0, 5.5){\vector(0,-1){0.5} }
\put( 6.5, 6.0){\vector(0,-1){1.0} }
\put( 6.5, 5.5){\line  (1, 0){1.5}}
\put( 5.0, 5.5){\vector(0,-1){0.5} }
\put( 3.5, 6.0){\vector(0,-1){1.0} }
\put( 9.5, 5.5){\line  (1, 0){1.5}}
\put( 2.0, 5.5){\vector(0,-1){0.5} }
\put( 0.5, 6.0){\vector(0,-1){1.0} }

\put(10.5, 4  ){\framebox(1,1){$\bar{g}(n_x)$} }
\put( 9  , 4  ){\framebox(1,1){$\bar{h}(n_x)$} }
\put( 7.5, 4  ){\framebox(1,1){$\bar{g}(n_x)$} }
\put( 6  , 4  ){\framebox(1,1){$\bar{h}(n_x)$} }
\put( 4.5, 4  ){\framebox(1,1){$\bar{g}(n_x)$} }
\put( 3  , 4  ){\framebox(1,1){$\bar{h}(n_x)$} }
\put( 1.5, 4  ){\framebox(1,1){$\bar{g}(n_x)$} }
\put( 0  , 4  ){\framebox(1,1){$\bar{h}(n_x)$} }

\put(11.0, 4  ){\vector(0,-1){0.5} }
\put( 9.5, 4  ){\vector(0,-1){0.5} }
\put( 8.0, 4  ){\vector(0,-1){0.5} }
\put( 6.5, 4  ){\vector(0,-1){0.5} }
\put( 5.0, 4  ){\vector(0,-1){0.5} }
\put( 3.5, 4  ){\vector(0,-1){0.5} }
\put( 2.0, 4  ){\vector(0,-1){0.5} }
\put( 0.5, 4  ){\vector(0,-1){0.5} }

\put(10.5, 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 9  , 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 7.5, 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 6  , 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 4.5, 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 3  , 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 1.5, 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 0  , 2.5){\framebox(1,1){$\downarrow 2$} }

\put(11.0, 2.5){\vector(0,-1){0.5} }
\put( 9.5, 2.5){\vector(0,-1){0.5} }
\put( 8.0, 2.5){\vector(0,-1){0.5} }
\put( 6.5, 2.5){\vector(0,-1){0.5} }
\put( 5.0, 2.5){\vector(0,-1){0.5} }
\put( 3.5, 2.5){\vector(0,-1){0.5} }
\put( 2.0, 2.5){\vector(0,-1){0.5} }
%\put( 0.5, 2.5){\vector(0,-1){1.5} }
\put( 0.5, 2.5){\line(0,-1){1.5} }

\put(10.5, 1.0){\makebox(1,1){$w_{m-1}^{(7)}(n)$}}
\put( 9  , 1.0){\makebox(1,1){$w_{m-1}^{(3)}(n)$}}
\put( 7.5, 1.0){\makebox(1,1){$w_{m-1}^{(5)}(n)$}}
\put( 6  , 1.0){\makebox(1,1){$w_{m-1}^{(1)}(n)$}}
\put( 4.5, 1.0){\makebox(1,1){$w_{m-1}^{(6)}(n)$}}
\put( 3  , 1.0){\makebox(1,1){$w_{m-1}^{(2)}(n)$}}
\put( 1.5, 1.0){\makebox(1,1){$w_{m-1}^{(4)}(n)$}}
%\put( 0  , 1.0){\makebox(1,1){$w_{m-1}^{(0)}(n)$}}
\put( 0  , 1.0){\makebox(1,1){$v_{m-1}(n)$}}

%\put( 0.5, 1.0){\vector(0,-1){1.0} }
\put( 0.5, 1.0){\line(0,-1){1.0} }
%\put( 0.6, 0.0){\makebox(1,1)[l]{$v_j(n)$ where $n=(n_x,n_y,n_z)$}}
\end{picture}

\\

\begin{picture}(10,9)
\thinlines

%\put( 0.6, 9.6){\makebox(1,0.4)[bl]{$v_{j+1}(n)$ where $n=(n_x,n_y,n_z)$}}

\put( 0.5, 9.5){\line  (1, 0){ 6  }}
\put( 6.5, 9.5){\vector(0,-1){0.5} }
\put( 0.5,10.0){\vector(0,-1){1.0} }

\put( 6  , 8  ){\framebox(1,1){$\bar{g}(n_z)$} }
\put( 0  , 8  ){\framebox(1,1){$\bar{h}(n_z)$} }

\put( 6.5, 7.5){\line  (1, 0){3.0}}
\put( 9.5, 7.5){\vector(0,-1){0.5} }
\put( 6.5, 8.0){\vector(0,-1){1.0} }
\put( 0.5, 7.5){\line  (1, 0){3.0} }
\put( 3.5, 7.5){\vector(0,-1){0.5} }
\put( 0.5, 8.0){\vector(0,-1){1.0} }

\put( 9  , 6  ){\framebox(1,1){$\bar{g}(n_y)$} }
\put( 6  , 6  ){\framebox(1,1){$\bar{h}(n_y)$} }
\put( 3  , 6  ){\framebox(1,1){$\bar{g}(n_y)$} }
\put( 0  , 6  ){\framebox(1,1){$\bar{h}(n_y)$} }

\put( 0.5, 5.5){\line  (1, 0){1.5}}
\put(11.0, 5.5){\vector(0,-1){0.5} }
\put( 9.5, 6.0){\vector(0,-1){1.0} }
\put( 3.5, 5.5){\line  (1, 0){1.5}}
\put( 8.0, 5.5){\vector(0,-1){0.5} }
\put( 6.5, 6.0){\vector(0,-1){1.0} }
\put( 6.5, 5.5){\line  (1, 0){1.5}}
\put( 5.0, 5.5){\vector(0,-1){0.5} }
\put( 3.5, 6.0){\vector(0,-1){1.0} }
\put( 9.5, 5.5){\line  (1, 0){1.5}}
\put( 2.0, 5.5){\vector(0,-1){0.5} }
\put( 0.5, 6.0){\vector(0,-1){1.0} }

\put(10.5, 4  ){\framebox(1,1){$\bar{g}(n_x)$} }
\put( 9  , 4  ){\framebox(1,1){$\bar{h}(n_x)$} }
\put( 7.5, 4  ){\framebox(1,1){$\bar{g}(n_x)$} }
\put( 6  , 4  ){\framebox(1,1){$\bar{h}(n_x)$} }
\put( 4.5, 4  ){\framebox(1,1){$\bar{g}(n_x)$} }
\put( 3  , 4  ){\framebox(1,1){$\bar{h}(n_x)$} }
\put( 1.5, 4  ){\framebox(1,1){$\bar{g}(n_x)$} }
\put( 0  , 4  ){\framebox(1,1){$\bar{h}(n_x)$} }

\put(11.0, 4  ){\vector(0,-1){0.5} }
\put( 9.5, 4  ){\vector(0,-1){0.5} }
\put( 8.0, 4  ){\vector(0,-1){0.5} }
\put( 6.5, 4  ){\vector(0,-1){0.5} }
\put( 5.0, 4  ){\vector(0,-1){0.5} }
\put( 3.5, 4  ){\vector(0,-1){0.5} }
\put( 2.0, 4  ){\vector(0,-1){0.5} }
\put( 0.5, 4  ){\vector(0,-1){0.5} }

\put(10.5, 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 9  , 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 7.5, 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 6  , 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 4.5, 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 3  , 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 1.5, 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 0  , 2.5){\framebox(1,1){$\downarrow 2$} }

\put(11.0, 2.5){\vector(0,-1){0.5} }
\put( 9.5, 2.5){\vector(0,-1){0.5} }
\put( 8.0, 2.5){\vector(0,-1){0.5} }
\put( 6.5, 2.5){\vector(0,-1){0.5} }
\put( 5.0, 2.5){\vector(0,-1){0.5} }
\put( 3.5, 2.5){\vector(0,-1){0.5} }
\put( 2.0, 2.5){\vector(0,-1){0.5} }
\put( 0.5, 2.5){\vector(0,-1){0.5} }

\put(10.5, 1.0){\makebox(1,1){$w_{m-2}^{(7)}(n)$}}
\put( 9  , 1.0){\makebox(1,1){$w_{m-2}^{(3)}(n)$}}
\put( 7.5, 1.0){\makebox(1,1){$w_{m-2}^{(5)}(n)$}}
\put( 6  , 1.0){\makebox(1,1){$w_{m-2}^{(1)}(n)$}}
\put( 4.5, 1.0){\makebox(1,1){$w_{m-2}^{(6)}(n)$}}
\put( 3  , 1.0){\makebox(1,1){$w_{m-2}^{(2)}(n)$}}
\put( 1.5, 1.0){\makebox(1,1){$w_{m-2}^{(4)}(n)$}}
%\put( 0  , 1.0){\makebox(1,1){$w_{m-2}^{(0)}(n)$}}
\put( 0  , 1.0){\makebox(1,1){$v_{m-2}(n)$}}

%\put( 0.5, 1.0){\vector(0,-1){1.0} }
%\put( 0.6, 0.0){\makebox(1,1)[l]{$v_j(n)$ where $n=(n_x,n_y,n_z)$}}
\put( 0.5, 1.00){o}
\put( 0.5, 0.66){o}
\put( 0.5, 0.33){o}
\end{picture}


\\
   
\begin{picture}(10,5.6)
\thinlines


\put( 0.5, 5.5){\line  (1, 0){1.5}}
\put(11.0, 5.5){\vector(0,-1){0.5} }
\put( 9.5, 6.0){\vector(0,-1){1.0} }
\put( 3.5, 5.5){\line  (1, 0){1.5}}
\put( 8.0, 5.5){\vector(0,-1){0.5} }
\put( 6.5, 6.0){\vector(0,-1){1.0} }
\put( 6.5, 5.5){\line  (1, 0){1.5}}
\put( 5.0, 5.5){\vector(0,-1){0.5} }
\put( 3.5, 6.0){\vector(0,-1){1.0} }
\put( 9.5, 5.5){\line  (1, 0){1.5}}
\put( 2.0, 5.5){\vector(0,-1){0.5} }
\put( 0.5, 6.0){\vector(0,-1){1.0} }

\put(10.5, 4  ){\framebox(1,1){$\bar{g}(n_x)$} }
\put( 9  , 4  ){\framebox(1,1){$\bar{h}(n_x)$} }
\put( 7.5, 4  ){\framebox(1,1){$\bar{g}(n_x)$} }
\put( 6  , 4  ){\framebox(1,1){$\bar{h}(n_x)$} }
\put( 4.5, 4  ){\framebox(1,1){$\bar{g}(n_x)$} }
\put( 3  , 4  ){\framebox(1,1){$\bar{h}(n_x)$} }
\put( 1.5, 4  ){\framebox(1,1){$\bar{g}(n_x)$} }
\put( 0  , 4  ){\framebox(1,1){$\bar{h}(n_x)$} }

\put(11.0, 4  ){\vector(0,-1){0.5} }
\put( 9.5, 4  ){\vector(0,-1){0.5} }
\put( 8.0, 4  ){\vector(0,-1){0.5} }
\put( 6.5, 4  ){\vector(0,-1){0.5} }
\put( 5.0, 4  ){\vector(0,-1){0.5} }
\put( 3.5, 4  ){\vector(0,-1){0.5} }
\put( 2.0, 4  ){\vector(0,-1){0.5} }
\put( 0.5, 4  ){\vector(0,-1){0.5} }

\put(10.5, 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 9  , 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 7.5, 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 6  , 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 4.5, 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 3  , 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 1.5, 2.5){\framebox(1,1){$\downarrow 2$} }
\put( 0  , 2.5){\framebox(1,1){$\downarrow 2$} }

\put(11.0, 2.5){\vector(0,-1){0.5} }
\put( 9.5, 2.5){\vector(0,-1){0.5} }
\put( 8.0, 2.5){\vector(0,-1){0.5} }
\put( 6.5, 2.5){\vector(0,-1){0.5} }
\put( 5.0, 2.5){\vector(0,-1){0.5} }
\put( 3.5, 2.5){\vector(0,-1){0.5} }
\put( 2.0, 2.5){\vector(0,-1){0.5} }
\put( 0.5, 2.5){\vector(0,-1){0.5} }

\put(10.5, 1.0){\makebox(1,1){$w_0^{(7)}(n)$}}
\put( 9  , 1.0){\makebox(1,1){$w_0^{(3)}(n)$}}
\put( 7.5, 1.0){\makebox(1,1){$w_0^{(5)}(n)$}}
\put( 6  , 1.0){\makebox(1,1){$w_0^{(1)}(n)$}}
\put( 4.5, 1.0){\makebox(1,1){$w_0^{(6)}(n)$}}
\put( 3  , 1.0){\makebox(1,1){$w_0^{(2)}(n)$}}
\put( 1.5, 1.0){\makebox(1,1){$w_0^{(4)}(n)$}}
%\put( 0  , 1.0){\makebox(1,1){$w_0^{(0)}(n)$}}
\put( 0  , 1.0){\makebox(1,1){$v_0(n)$}}

%\put( 0.5, 1.0){\vector(0,-1){1.0} }
%\put( 0.6, 0.0){\makebox(1,1)[l]{$v_j(n)$ where $n=(n_x,n_y,n_z)$}}

\end{picture}


\end{tabular} 
\caption{
   $m$-stage 3-dimensional Fast Wavelet Transform
   \label{fig:fwt_m}
   }
\end{center}
\end{figure}


