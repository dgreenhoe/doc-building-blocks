%============================================================================
% LaTeX File
% Daniel J. Greenhoe
%============================================================================

%=======================================
%\section{Metric transforms}
%\section{Metric preserving functions}
%=======================================
%%If we know that one or more functions are metrics, then we can use them 
%%to generate other metrics. 
%%This is demonstrated by the following:\\
%Metrics induce other metrics, as demonstrated by the following:
%\\\indentx\begin{tabular}{cl >{\footnotesize(}l<{):} >{\footnotesize}l}
%     \imark&\pref{thm:isometry_inv}& \prefpo{thm:isometry_inv}& generate a metric using an isometry.
%  \\ \imark&\pref{thm:met_sumpf}   & \prefpo{thm:met_sumpf}   & generate a metric using a monotone function.
%  \\ \imark&\pref{thm:met_fod}     & \prefpo{thm:met_fod}     & generate a metric using a \fncte{metric preserving function}.
% %\\ \imark&\pref{thm:met_d=sumpi} & \prefpo{thm:met_d=sumpi} & generate a metric from a linear combination of metrics.
%  \\ \imark&\pref{thm:met_power}   & \prefpo{thm:met_power}   & generate an $\xN$-dimensional metric from weighted $1$-dimensional metrics.
% %\\ \imark&\pref{prop:p==>d}      & \prefpo{prop:p==>d}      & generate a metric from another metric.
% %\\ \imark&\pref{prop:p==>dn}     & \prefpo{prop:p==>dn}     & generate a multi-dimensional metric from a primitive metric.
%\end{tabular}


%%---------------------------------------
%\begin{definition}
%\citetbl{
%  \citerpgc{recasens2010}{83}{3642162215}{Definition 4.3}
%  }
%\label{def:metric_transform}
%%---------------------------------------
%\defbox{\brbr{\begin{array}{DlCDD}
%  \mc{5}{M}{A function $\fphi$ is a \hid{metric transform} if}
%    \\
%    \cnto & x\ge y \implies \fphi(x) \ge \fphi(y)                &\forall x,y\in\R   & (\prope{monotone})    & and 
%    \cntn & \fphi(0) = 0                                         &                   &                             & and 
%    \cntn & \fphi(x) \ge 0                                       &\forall x  \in\R   & (\prope{positive definite}) & and 
%    \cntn & \fphi(x+y) \le \fphi(x) + \fphi(y)                   &\forall x,y\in\Rnn & (\prope{subadditive}).      & 
%  \end{array}}
%  }
%\end{definition}


%\pref{thm:met_sumpf} (next) shows that we can construct a large number
%of metrics from an existing metric $\metrican$ and the family $\setn{\ff}$
%of strictly increasing or strictly decreasing functions.
%Examples of such constructs include the following:\\
%\begin{tabular}{>{\imark}llll}
%  & Exponential metric  & \pref{ex:ms_32x} & \prefpo{ex:ms_32x} \\
%  & Tangential metric   & \pref{ex:ms_tan} & \prefpo{ex:ms_tan} 
%\end{tabular}

%%=======================================
%\subsection{Metric transforms on the domains of metrics}
%%=======================================
%%--------------------------------------
%\begin{definition}
%\citetbl{
%  \citerpc{thron1966}{153}{definition 19.4},
%  \citerpgc{giles1987}{124}{0521359287}{Definition 6.22},
%  \citerpgc{khamsi2001}{15}{0471418250}{Definition 2.4},
%  \citerpg{kubrusly2001}{110}{0817641742}
%  }
%\label{def:isometry}
%%--------------------------------------
%Let $\metspaceX$ and $\opair{\setY}{\metrican}$ be \structe{metric space}s \xref{def:metric}.
%\\\defboxp{
%  The function $\ff\in\clFxy$ is an \hid{isometry} on $\clF{\metspaceX}{\opair{\setY}{\metrican}}$ if
%    \quad$\ds\metric{x}{y}= \metrica{\ff(x)}{\ff(y)} \qquad\scy \forall x,y\in\setX$.
%    \\
%  The spaces $\metspaceX$ and $\opair{\setY}{\metrican}$ are \hid{isometric} if there exists an isometry on $\clF{\metspaceX}{\opair{\setY}{\metrican}}$.
%  }
%\end{definition}
%
%%--------------------------------------
%\begin{theorem}
%\citetbl{
%  \citerpc{thron1966}{153}{theorem 19.5}
%  }
%\label{thm:isometry_inv}
%%--------------------------------------
%Let $\metspaceX$ and $\opair{\setY}{\metrican}$ be \structe{metric space}s.
%Let $\ff$ be a \fncte{bijective function} %\xref{def:ftypes} 
%in $\clFxy$ and $\ffi$ its inverse in $\clFyx$ \xref{def:clFxy}.
%\thmbox{
%  \brb{\text{$\ff$ is an \hid{isometry} on $\clF{\metspaceX}{\opair{\setY}{\metrican}}$}}
%  \qquad\iff\qquad
%  \brb{\text{$\ffi$ is an \hid{isometry} on $\clF{\opair{\setY}{\metrican}}{\metspaceX}$}}
%  }
%\end{theorem}
%
%
%If a function $\metrican$ is a \structe{metric} and a function $\fg$ is \prope{injective}, then 
%the function $\metric{x}{y}\eqd\metrica{\fg(x)}{\fg(y)}$ is also a \structe{metric} (next theorem).
%For an example of this with $\metrica{x}{y}\eqd\abs{x-y}$ and $\fg\eqd\arctan(x)$, see \prefpp{ex:ms_atan}.
%Examples include $\metrica{x}{y}\eqd\abs{x-y}$ and $\fg\eqd\arctan(x)$.
%%---------------------------------------
%\begin{theorem}[\thm{Pullback metric}/\thm{$\fg$-transform metric}]
%\label{thm:met_sumpf}
%\label{thm:pullback}
%\citetbl{
%  \citerpg{deza2009}{81}{3642002331}
%  %\url{http://groups.google.com/group/sci.math/msg/6d091dfa5061cc08}
%  }
%%---------------------------------------
%Let $\setX$ and $\setY$ be sets and $\fg$ a function in $\clFxy$.
%\thmbox{
%  \brb{\begin{array}{FMDD}
%     1. & $\metrican$ is a \fncte{metric} in $\clF{\setY}{\R}$ & \xref{def:metric} & and 
%   \\2. & $\fg$ is \prope{injective}                           & & %\xref{def:ftypes} &
%   %\cntn & \mcom{\fphi(x)=\fphi(y)\iff x=y \quad\scriptstyle\forall x,y\in\setX}{$\fphi$ is strictly increasing or strictly decreasing}
%  \end{array}}
%%  \qquad\implies\qquad
%  \implies
%  \brb{\begin{array}{MC}
%    $\metric{x}{y} =  \metrica{\fg(x)}{\fg(y)}$ &\forall x,y\in\setX\\
%    is a \fncte{metric} in $\clF{\setY}{\R}$
%  \end{array}}
%  }
%\end{theorem}
%\begin{proof}
%\begin{align*}
%  \intertext{1. Proof that ${x}={y}\implies\metric{x}{y}=0$:}
%  \metric{x}{y}
%    &\eqd \metrica{\fphi(x)}{\fphi(y)}
%    &&    \text{by definition of $\metricn$}
%  \\&=    \metrica{\fphi(x)}{\fphi(x)}
%    &&    \text{by ${x}={y}$ hypothesis}
%  \\&=    0
%    &&    \text{by \prope{nondegenerate} property of metric $\metrican$ \xref{def:metric}}
%  \\&=    0
%  \\
%  \intertext{2. Proof that ${x}={y}\impliedby\metric{x}{y}=0$:}
%  0
%    &=    \metric{x}{y}
%    &&    \text{by right hypothesis}
%  \\&\eqd  \metrica{\fphi(x)}{\fphi(y)}
%    &&    \text{by definition of $\metricn$}
%  \\\implies \metrica{\fphi(x)}{\fphi(y)}&=0 \text{ for $n=1,2,\ldots,\xN$}
%    &&    \text{because $\metrican$ is non-negative}
%  \\\implies {x}&={y}
%    &&    \text{by left hypothesis 2}
%  \\
%  \intertext{3. Proof that $\metric{x}{y}\le\metric{z}{x}+\metric{z}{y}$:}
%  \metric{x}{y}
%    &\eqd  \metrica{\fphi(x)}{\fphi(y)}
%    &&    \text{by definition of $\metricn$}
%  \\&\le   \big( \metrica{\fphi(x)}{\fphi(z)} + \metric{\fphi(z)}{\fphi(y)} \big)
%    &&    \text{by \prope{subadditive} property of $\metrican$ \xref{def:metric}}
%  \\&=     \metrica{\fphi(z)}{\fphi(x)} +  \metrica{\fphi(z)}{\fphi(y)} 
%    &&    \text{by \prope{symmetry} property of metric $\metrican$ \xref{def:metric}}
%  \\&\eqd \metric{z}{x} + \metric{z}{y}
%    &&    \text{by definition of $\metricn$}
%\end{align*}
%\end{proof}

%=======================================
\subsection{Metric preserving functions}
%=======================================
%---------------------------------------
\begin{definition}
\citetbl{
  \citerpc{vallin1999}{849}{Definition 1.1},
  \citerp{corazza1999}{309},
  \citerpg{deza2009}{80}{3642002331}
  }
\label{def:metpreserv}
\label{def:mpf}
%---------------------------------------
Let $\sssetM$ be the set of all \structe{metric space}s \xref{def:metric} on a set $\setX$.
\defboxp{
  $\fphi\in\clFrnrn$ is a \fnctd{metric preserving function} if
    \quad$\metric{x}{y}\eqd\fphi\circ\metrica{x}{y}$ \quad is a \structe{metric} on $\setX$ for all $\opair{\setX}{\metrican}\in\sssetM$
  }
\end{definition}


%\pref{thm:mpf_necessary} (next theorem) presents some necessary conditions for a function $\fphi$ to be \prope{metric preserving}.
%\prefpp{thm:met_fod} presents some sufficient conditions.
%But first some conditions that are \emph{not} necessary:
%\\\indentx\begin{tabular}{cl>{\footnotesize}l}
%    \imark&It is \emph{not} necessary for $\fphi$ to be \prope{continuous}   & (see \prefp{ex:mpf_discrete}).
%  \\\imark&It is \emph{not} necessary for $\fphi$ to be \prope{increasing}   & (see \prefp{ex:mpf_11x1}).
%  \\\imark&It is \emph{not} necessary for $\fphi$ to be \prope{monotone}     & (see \prefp{ex:mpf_x11x1}).
%\end{tabular}

%---------------------------------------
\begin{theorem}[necessary conditions]
\citetbl{
  \citerpc{corazza1999}{310}{Proposition 2.1},
  \citerpg{deza2009}{80}{3642002331}
  }
\label{thm:mpf_necessary}
%---------------------------------------
Let $\oppR\fphi$ be the \structe{range} %\xref{def:range} 
of a function $\fphi$.
\thmbox{
  \brb{\begin{array}{M}
    $\fphi$ is a\\ 
    \fncte{metric preserving function}\\
    \xref{def:mpf}
  \end{array}}
  \quad\implies\quad
  \brb{\begin{array}{FlD}
      1. & \fphi^{-1}(0) = \setn{0}             &  and
    \\2. & \oppR\fphi \subseteq \Rnn            &  and
    \\3. & \fphi(x+y) \leq \fphi(x) + \fphi(y)  & ($\fphi$ is \prope{subadditive})
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Proof that $\fphi$ is a \structe{metric preserving function} $\implies$ $\fphi^{-1}(0) = \setn{0}$:
    \begin{enumerate}
      \item Suppose that the statement is not true and $\fphi^{-1}(0) = \setn{0,a}$.
      \item Then $\fphi(a)=0$ and for some $x,y$ such that $x\neq y$ and $\metric{x}{y}=a$ we have
        \begin{align*}
          \fphi\circ\metric{x}{y}
            &= \fphi(a)
          \\&= 0
          \\&\implies \text{$\fphi\circ\metricn$ is \emph{not} a metric}
          \\&\implies \text{$\fphi$ is \emph{not} a metric preserving function}
        \end{align*}
      \item But this contradicts the original hypothesis, and so it must be that $\fphi^{-1}(0) = \setn{0}$.
    \end{enumerate}

  \item Proof that $\oppR\fphi \subseteq \Rnn$:
    \begin{align*}
      \oppR\fphi\circ\metricn
        &\subseteq \oppR\metricn
      \\&\subseteq \Rnn
    \end{align*}

  \item Proof that $\fphi$ is a metric preserving function $\implies$ $\fphi$ is \prope{subadditive}:
    \begin{enumerate}
      \item For $\fphi$ to be a \structe{metric preserving function}, 
            by definition it must work with \emph{all} \structe{metric space}s.
      
      \item So to develop necessary conditions, we can pick any metric space we want
            (because it is necessary that $\fphi$ preserves it as a metric space).
      
      \item For this proof we choose the metric space $\opair{\R}{\metricn}$ where $\metric{x}{y}\eqd\abs{x-y}$ for all $x,y\in\Rnn$:
        \begin{align*}
          \fphi(x) + \fphi(y)
            &=   \fphi\brp{\abs{(x+y)-x}} + \fphi\brp{\abs{x-0}} 
            &&   \text{by definition of $\abs{\cdot}$}
          \\&=   \brp{\fphi\circ\metricn}(x+y,x) + \brp{\fphi\circ\metricn}(x,0)
            &&   \text{by definition of $\metricn$}
          \\&\ge \brp{\fphi\circ\metricn}(x+y,0)
            &&   \text{by left hypothesis and \prefp{def:metric}}
          \\&=   \fphi\brp{\abs{(x+y)-0}}
            &&   \text{by definition of $\metricn$}
          \\&=   \fphi(x+y)
            &&   \text{because $x,y\in\Rnn$}
        \end{align*}
    \end{enumerate}
\end{enumerate}
\end{proof}

\pref{thm:met_fod} (next theorem) presents some sufficient conditions for a function to be metric preserving.
%---------------------------------------
\begin{theorem}[sufficient conditions]
\citetbl{
  \citerc{corazza1999}{Proposition 2.3},
  \citerpg{deza2009}{80}{3642002331},
  \citerpgc{kelley1955}{131}{0387901256}{Problem C}
  %\citerpp{carothers2000}{38}{39}
  }
\label{thm:met_fod}
%---------------------------------------
%Let $\metrican$ be a metric in $\clFxxr$. 
Let $\fphi$ be a function in $\clFrr$.
\thmbox{
  %\text{$\fphi$ is a \structe{metric transform}}
  %\qquad\implies\qquad
  \brb{\begin{array}{DlCDD}
      1. & x\ge y \implies \fphi(x) \ge \fphi(y)                &\forall x,y\in\Rnn & (\prope{isotone})        & and 
    \\2. & \fphi(0) = 0                                         &                   &                          & and 
    \\3. & \fphi(x+y) \le \fphi(x) + \fphi(y)                   &\forall x,y\in\Rnn & (\prope{subadditive})    & 
    %\cntn & \fphi(x) \ge 0                                       &\forall x  \in\R   & (\prope{positive definite}) & and 
  \end{array}}
  \implies
  \brb{\begin{array}{M}
    %$\metric{x}{y}\eqd\fphi\circ\metrica{x}{y}$\\ 
    %is a \structe{metric} in $\clFxxr$
    $\fphi$ is a \emph{metric}\\
    \emph{preserving function}\\
    \xref{def:mpf}.
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Proof that $\fphi\circ\metric{x}{y}=0 \implies x=y$:
    \begin{align*}
      \fphi\circ\metric{x}{y}=0
        &\implies \metric{x}{y}=0
        && \text{by $\fphi$ hypothesis 2}
      \\&\implies x=y
        && \text{by \prope{nondegenerate} property \prefpo{def:metric}}
    \end{align*}

  \item Proof that $\fphi\circ\metric{x}{y}=0 \impliedby x=y$:
    \begin{align*}
      \fphi\circ\metric{x}{y}
        &= \fphi\circ\metric{x}{x}
        && \text{by $x=y$ hypothesis}
      \\&= \fphi(0)
        && \text{by \prope{nondegenerate} property \prefpo{def:metric}}
      \\&= 0
        && \text{by $\fphi$ hypothesis 2}
    \end{align*}

  \item Proof that $\fphi\circ\metric{x}{y}\le\fphi\circ\metric{z}{x}+\fphi\circ\metric{z}{y}$:
    \begin{align*}
      \fphi\circ\metric{x}{y}
        &\le \fphi\brp{\metric{x}{z} + \metric{z}{y}}
        && \text{by $\fphi$ hypothesis 1 and triangle inequality \prefpo{def:metric}}
      \\&\le \fphi\brp{\metric{z}{x} + \metric{z}{y}}
        && \text{by symmetric property of $\metricn$ \prefpo{def:metric}}
      \\&\le \fphi\circ\metric{z}{x} + \fphi\circ\metric{z}{y}
        && \text{by $\fphi$ hypothesis 3}
    \end{align*}
\end{enumerate}
\end{proof}


\begin{figure}[h]
  \gsize%
  \centering%
  \psset{unit=8mm}
  \begin{tabstr}{0.75}%
  \begin{tabular}{ccc}
     {\input{../common/math/graphics/metric/mpf_ascaled}}%
    &{\input{../common/math/graphics/metric/mpf_snowflake}}%
    &{\input{../common/math/graphics/metric/mpf_truncated}}%
    \\
     (A) \exm{$\alpha$-scaled}/\exm{dilated}
    &(B) \exm{power transform}/\exm{snowflake}
    &(C) \exm{$\alpha$-truncated}/\exmd{radar screen}
    \\
     \xref{ex:mpf_ascaled}
    &\xref{ex:mpf_snowflake}
    &\xref{ex:mpf_atrun}
    \\
     {\input{../common/math/graphics/metric/mpf_bounded}}%
    &{\input{../common/math/graphics/metric/mpf_discrete}}%
    &{\input{../common/math/graphics/metric/mpf_x1x2}}%
    \\
     (D) \exm{bounded}
    &(E) \exm{discrete}
    &(F)
    \\
     \xref{ex:mpf_bounded}
    &\xref{ex:mpf_discrete}
    &\xref{ex:mpf_x1x2}
    \\
  \end{tabular}
  \end{tabstr}
  \caption{metric preserving functions\label{fig:mpf}}
\end{figure}
%---------------------------------------
\begin{example}[\exm{$\alpha$-scaled metric}/\exm{dilated metric}]
\citetbl{
  \citerpg{deza2006}{44}{0444520872}
  }
\index{metrics!$\alpha$-scaled metric}
\index{metrics!dilated metric}
\label{ex:mpf_ascaled}
%---------------------------------------
Let $\metspaceX$ be a \structe{metric space} \xref{def:metric}.
\exbox{
  \fphi(x)\eqd\alpha x,\,\alpha\in\Rp
  \qquad
  \text{is a \fncte{metric preserving function} (\prefp{fig:mpf} (A))}
  %\qquad
  %\brp{\text{$\ds\metrica{x}{y} \eqd \alpha\metric{x}{y}$
  %is a metric on $\setX$}}
  }
\end{example}
\begin{proof}
%The proof for this example and \pref{ex:mpf_snowflake}--\prefpp{ex:mpf_discrete} follow from \prefpp{thm:met_fod}.
The proofs for \pref{ex:mpf_ascaled}--\prefpp{ex:mpf_x1x2} follow from \prefpp{thm:met_fod}.
%\begin{enumerate}
%  \item Note that $\fphi$ satisfies the conditions of \prefpp{thm:met_fod}.
%  \item Therefore, by \prefpp{thm:met_fod}, $\metric{x}{y}$ is a metric on $\setX$.
%\end{enumerate}
\end{proof}

%---------------------------------------
\begin{example}[\exm{power transform metric}/\exm{snowflake transform metric}]
\citetbl{
  \citerpg{deza2009}{81}{3642002331},
  \citerpg{deza2006}{45}{0444520872}
  }
\index{metrics!power transform metric}
\label{ex:mpf_snowflake}
%---------------------------------------
Let $\metspaceX$ be a \structe{metric space} \xref{def:metric}.
\exboxt{
  $\ds\fphi(x)\eqd x^\alpha,\,\alpha\in\intoc{0}{1}$,
    is a \fncte{metric preserving function}  (see \prefp{fig:mpf} (B))
  %\qquad
  %\brp{\text{$\ds\metrica{x}{y} \eqd \brs{\metric{x}{y}}^\alpha$,
  %is a metric on $\setX$}}
  }
\end{example}
%\begin{proof}
%by \prefpp{thm:met_fod}.
%%\begin{enumerate}
%%  \item Note that $\fphi$ satisfies the conditions of \prefpp{thm:met_fod} for $0<\alpha\le 1$.
%%  \item Therefore, by \prefpp{thm:met_fod}, $\metric{x}{y}$ is a metric on $\setX$.
%%\end{enumerate}
%\end{proof}

%---------------------------------------
\begin{example}[\exmd{$\alpha$-truncated metric}/\exmd{radar screen metric}]
\citetbl{
  \citerp{giles1987}{33},
  \citerppg{deza2006}{242}{243}{0444520872}
  }
\label{ex:mpf_atrun}
\index{metrics!radar screen}
\index{metrics!$\alpha$-truncated metric}
%---------------------------------------
Let $\metspaceX$ be a \structe{metric space} \xref{def:metric}.
\exboxp{
  $\ds\quad\fphi(x)\eqd \min\setn{\alpha,\,x},\,\alpha\in\Rp$
  \quad
  is a \fncte{metric preserving function}  (see \prefp{fig:mpf} (C)).
  }
\end{example}
\begin{proof}
  by \prefpp{thm:met_fod}.
%\begin{enumerate}
%  \item Note that $\fphi$ satisfies the conditions of \prefpp{thm:met_fod}.
%  \item $\ds\metric{x}{y}\eqd \min\setn{\alpha,\metrica{x}{y}}=\fphi\circ\metrica{x}{y}$
%  \item Therefore, by \prefpp{thm:met_fod}, $\metric{x}{y}$ is a metric.
%\end{enumerate}
\end{proof}

%---------------------------------------
\begin{example}[\exm{bounded metric}]
\citetbl{
  \citerp{vallin1999}{849},
  \citerpg{ab}{39}{0120502577} 
  }
\index{metrics!bounded}
\label{ex:mpf_bounded}
%---------------------------------------
Let $\metspaceX$ be a \structe{metric space} \xref{def:metric}.
\exbox{
  \ds\fphi(x)\eqd \frac{x}{1+x}
  \qquad
  \text{is a \fncte{metric preserving function}  (see \prefp{fig:mpf} (D)).}
  }
\end{example}
\begin{proof}
by \prefpp{thm:met_fod}.
%\begin{enumerate}
%  \item Note that $\fphi$ satisfies the conditions of \prefpp{thm:met_fod}.
%  \item $\ds\metric{x}{y}\eqd \frac{\metrica{x}{y}}{1+\metrica{x}{y}}=\fphi\circ\metrica{x}{y}$
%  \item Therefore, by \prefpp{thm:met_fod}, $\metric{x}{y}$ is a metric.
%\end{enumerate}
\end{proof}

%---------------------------------------
\begin{example}[\exmd{discrete metric preserving function}]
\citetbl{
  \citerp{corazza1999}{311}
  }
\label{ex:mpf_discrete}
%---------------------------------------
Let $\fphi$ be a function in $\clFrr$.
\exbox{
  \fphi(x)\eqd\brb{\begin{array}{cM}
    0 & for $x\leq0$\\
    1 & otherwise
  \end{array}}
  \qquad
  \text{is a \fncte{metric preserving function}  (see \prefp{fig:mpf} (E)).}
  }
\end{example}
\begin{proof}
  by \prefp{thm:met_fod}.
\end{proof}


%---------------------------------------
\begin{example}
\label{ex:mpf_x1x2}
%---------------------------------------
Let $\fphi$ be a function in $\clFrr$.
\exbox{
  \fphi(x)\eqd\brb{\begin{array}{cM@{\qquad}cM}
    x   & for $0\le x<1$,  &   1   & for $1\leq x\leq2$,\\  
    x-1 & for $2<x<3$,     &   2   & for $x\ge3$
  \end{array}}
  \qquad
  \begin{array}{M}
    is a \fncte{metric preserving function}\\  
    (see \prefp{fig:mpf} (F)).
  \end{array}
  }
\end{example}
\begin{proof}
  by \prefp{thm:met_fod}.
\end{proof}

\begin{figure}[h]
  \gsize%
  \centering%
  \psset{xunit=5mm,yunit=6mm}
  \begin{tabstr}{0.75}%
  \begin{tabular}{ccc}
     {\input{../common/math/graphics/metric/mpf_11x1}}%
    &{\input{../common/math/graphics/metric/mpf_x11x1}}%
    &{\input{../common/math/graphics/metric/mpf_0121}}%
    \\
     (A) \xref{ex:mpf_11x1}
    &(B) \xref{ex:mpf_x11x1}
    &(C) \xref{ex:mpf_0121}
  \end{tabular}
  \end{tabstr}
  \caption{\prope{non-monotone} \fncte{metric preserving function}s\label{fig:mpf_nonmono}}
\end{figure}
%---------------------------------------
\begin{example}
\citetbl{
  \citerppc{greenhoe2015sto}{10}{11}{Theorem 4.16}
  }

\label{ex:mpf_11x1}
%---------------------------------------
Let $\fphi$ be a function in $\clFrr$.
\exbox{
  \fphi(x)\eqd\brb{\begin{array}{lM}
    0               & for $x=0$\\
    1+\frac{1}{x+1} & for $x>0$
  \end{array}}
  \qquad
  \text{is a \fncte{metric preserving function} (see \prefp{fig:mpf_nonmono} (A)).}
  }
\end{example}
%\begin{proof}
%\begin{enumerate}
%  \item Note that $\fphi\circ\metric{x}{x}=0 \iff x=0$.
%
%  \item lemma: %$\frac{1}{a+b} \le \frac{1}{a} + \frac{1}{b}$ for $a,b\in\Rp$:
%        \label{item:mpf_11x1_lem}
%      $\ds\frac{1}{a+b} \le \frac{1}{a} \le \frac{1}{a} + \frac{1}{b} \qquad \forall a,b\in\Rp$
%    %\begin{align*}
%    %  \frac{1}{a+b}
%    %    &\le \frac{1}{a}
%    %  \\&\le \frac{1}{a} + \frac{1}{b}
%    %\end{align*}
%
%  \item Proof that $\fphi\circ\metricn$ is \prope{subadditive}:
%    \begin{align*}
%      \fphi\circ\metric{x}{y}
%        &= 1 + \frac{1}{1+\metric{x}{y}}
%        && \text{by definition of $\fphi$}
%      \\&\le 1 + \frac{1}{1+\metric{x}{z}+\metric{z}{y}}
%        &&   \text{by \prope{subadditive} property of $\metricn$ \xref{def:metric}}
%      \\&\le 1 + \frac{1}{1+\metric{x}{z}+1+\metric{z}{y}}
%        && \text{because $\frac{1}{x}\le\frac{1}{x+1}$ $\forall x\in\Rn$}
%      \\&\le 1 + \frac{1}{1+\metric{x}{z}} + \frac{1}{1+\metric{z}{y}}
%        &&   \text{by \pref{item:mpf_11x1_lem}}
%      \\&\le \brs{1 + \frac{1}{1+\metric{x}{z}}} + \brs{1+\frac{1}{1+\metric{z}{y}}}
%        && \text{because $x\le x+1$\quad$\forall x\in\R$}
%      \\&=   \fphi\circ\metric{x}{z} + \fphi\circ\metric{z}{y}
%        && \text{by definition of $\fphi$}
%    \end{align*}
%
%  \item Therefore, by \prefpp{thm:metric_equiv}, $\fphi\circ\metric{x}{y}$ is a \structe{metric} 
%        and $\fphi$ is a \structe{metric preserving function}.
%\end{enumerate}
%%
%\end{proof}

%---------------------------------------
\begin{example}
\citetbl{
  \citerp{corazza1999}{309},
  \citerpc{dobos1998}{25}{Example~1},
  \citer{juza1956}
  }
\label{ex:mpf_x11x1}
%---------------------------------------
Let $\fphi$ be a function in $\clFrr$.
\exbox{
  \fphi(x)\eqd\brb{\begin{array}{lM}
    x                 & for $x\leq2$\\
    1 + \frac{1}{x-1} & for $x>2$
  \end{array}}
  \qquad
  \text{is a \fncte{metric preserving function} (see \prefp{fig:mpf_nonmono} (B)).}
  %\text{is a \prope{nonmonotonic} \struct{metric preserving function} (\prefp{fig:mpf_nonmono} (B))}
  }
\end{example}
%\begin{proof}
%
%\end{proof}

%---------------------------------------
\begin{example}
\label{ex:mpf_0121}
%---------------------------------------
Let $\fphi$ be a function in $\clFrr$.
\exbox{
  \fphi(x)\eqd\brb{\begin{array}{lM}
    x                 & for $0\leq x\leq2$\\
    -x+4              & for $2<x<3$\\
    1                 & for $x \geq3$
  \end{array}}
  \qquad
  \text{is a \fncte{metric preserving function} (see \prefp{fig:mpf_nonmono} (C)).}
  %\text{is a \prope{nonmonotonic} \struct{metric preserving function} (\prefp{fig:mpf_nonmono} (C))}
  }
\end{example}
%\begin{proof}
%
%\end{proof}



%=======================================
\subsection{Product metrics}
%=======================================


%---------------------------------------
\begin{theorem}[Fr{\'e}chet product metric]
\citetbl{
  \citerpg{deza2006}{47}{0444520872},
  \citerpg{deza2009}{84}{3642002331},
  \citerppgc{steen1978}{64}{65}{0387903127}{Example 37.7},
  \citerpg{isham1999}{10}{9810235623}
  }
\label{thm:met_d=sumpi}
\label{prop:fpm}
%---------------------------------------
Let $\setX$ be a set.
%Let $\tuplexn{\opair{\setX}{\metrican_n}}$ be an $\xN$-tuple of metric spaces on a set $\setX$.
%Let $\tuplexn{\alpha_n\in\Rnn}$ be an $\xN$-tuple of real values with $\max\tuplen{\alpha_n}>0$.
\thmbox{
  \brb{\begin{array}{FMD}
    \cnto & $\tuplen{\metrican_n}$ are \structe{metrics} on $\setX$ & and
    \cntn & $\alpha_n\ge0\quad\forall n=1,2,\ldots,\xN$               & and
    \cntn & $\max\setxn{\alpha_n}>0$ 
  \end{array}}
  \quad\implies\quad
  \brb{\begin{array}{M}
    $\ds\metric{x}{y} = \sum_{n=1}^\xN \alpha_n \metricasub{n}{x}{y}$\\
    \qquad is a \structe{metric} on $\setX$
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{align*}
  \intertext{1. Proof that $x=y\implies\metric{x}{y}=0$:}
  \metric{x}{y}
    &= \sum_{n=1}^\xN \alpha_n\, \metricasub{n}{x}{y}
    && \text{by definition of $\metricn$}
  \\&= \sum_{n=1}^\xN \alpha_n\, \metricasub{n}{x}{x}
    && \text{by left hypothesis}
  \\&= \sum_{n=1}^\xN 0
    && \text{by \prope{nondegenerate} property of metrics \xref{def:metric}}
  \\&= 0
  \\
  \intertext{2. Proof that $x=y\impliedby\metric{x}{y}=0$:}
  0
    &= \metric{x}{y}
    && \text{by right hypothesis}
  \\&= \sum_{n=1}^\xN \alpha_n\, \metricasub{n}{x}{y}
    && \text{by definition of $\metricn$}
  \\\implies & \metricasub{n}{x}{y}=0 \qquad \forall x,y\in\spX
    && \text{by metric properties \prefpo{def:metric}}
  \\\implies & x=y \qquad \forall x,y\in\spX
    && \text{by non-degenerate property of metrics \prefpo{def:metric}}
  \\
  \intertext{3. Proof that $\metric{x}{y}\le\metric{z}{x}+\metric{z}{y}$:}
  \metric{x}{y}
    &= \sum_{n=1}^\xN \alpha_n\, \metricasub{n}{x}{y}
    && \text{by definition of $\metricn$}
  \\&\le \sum_{n=1}^\xN \alpha_n\,\Big[ \metricasub{n}{x}{z} + \metricasub{n}{z}{y} \Big]
    && \text{by \prope{subadditive} property \xref{def:metric}}
  \\&= \sum_{n=1}^\xN \alpha_n\,\Big[ \metricasub{n}{z}{x} + \metricasub{n}{z}{y} \Big]
    && \text{by \prope{symmetry} property \xref{def:metric}}
  \\&= \sum_{n=1}^\xN \alpha_n\,\metricasub{n}{z}{x} +  \sum_{n=1}^\xN \alpha_n\, \metricasub{n}{z}{y} 
  \\&= \metric{z}{x} + \metric{z}{y}
    && \text{by definition of $\metricn$}
\end{align*}
\end{proof}



%---------------------------------------
\begin{theorem}[\thmd{Power mean metrics}]
%citetbl{
% \citerppc{greenhoe2015sto}{11}{12}{Theorem 4.19}
% }
\label{thm:met_power}
%---------------------------------------
Let $\setX$ be a set. % and $\metrican\in\clFxxr$ be a function.
Let $\tuplexn{x_n\in\setX}$ and $\tuplexn{y_n\in\setX}$ be $\xN$-tuples on $\setX$.
\thmboxp{
 $
 \brb{\begin{array}{FMD}
   1. & \text{$\metrican$ is a \structe{metric} on $\setX$} & and
 \\2. & $\ds\sum_{n=1}^\xN \lambda_n = 1$
 \end{array}}
 \implies
 \brb{\begin{array}{Ml}
   $\ds\metric{\tuplen{x_n}}{\tuplen{y_n}}\eqd \brp{\sum_{n=1}^\xN \lambda_n \metrican^r(x_n,y_n)}^\frac{1}{r}$, & r\in\intcc{1}{\infty}\\
   is a \structe{metric} on $\setX$.
 \end{array}}$
\\
Moreover, if $r=\infty$, then $\ds\metric{\tuplen{x_n}}{\tuplen{y_n}} = \max_{n=1,\ldots,\xN}\metrica{x_n}{y_n}$.
}
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Proof that $\tuplen{x_n}=\tuplen{y_n}\implies\metric{\tuplen{x_n}}{\tuplen{y_n}}=0$ for $r\in\intco{1}{\infty}$:
    \begin{align*}
      \metricn(\tuplen{x_n},\tuplen{y_n})
        &\eqd \brp{\sum_{n=1}^\xN \lambda_n \metrican^r(x_n,y_n)}^\frac{1}{r}
        &&    \text{by definition of $\metricn$}
      \\&=    \brp{\sum_{n=1}^\xN \lambda_n \metrican^r(x_n,x_n)}^\frac{1}{r}
        &&    \text{by $\tuplen{x_n}=\tuplen{y_n}$ hypothesis}
      \\&=    \brp{\sum_{n=1}^\xN 0}^\frac{1}{r}
        &&    \text{because $\metrican$ is \prope{nondegenerate}}
      \\&=    0
    \end{align*}

  \item Proof that $\tuplen{x_n}=\tuplen{y_n}\impliedby\metric{\tuplen{x_n}}{\tuplen{y_n}}=0$ for $r\in\intco{1}{\infty}$:
     \begin{align*}
      0
        &=    \metric{\tuplen{x_n}}{\tuplen{y_n}}
        &&    \text{by $\metric{\tuplen{x_n}}{\tuplen{y_n}}=0$ hypothesis}
      \\&\eqd \brp{\sum_{n=1}^\xN \lambda_n \metrican^r(x_n,y_n)}^\frac{1}{r}
        &&    \text{by definition of $\metricn$}
      \\\implies \brp{\metrica{x_n}{y_n}}^\frac{1}{r} &= 0 \text{ for } n=1,2,\ldots,\xN
        &&    \text{because $\metrican$ is \prope{non-negative}}
      \\\implies \tuplen{x_n}&=\tuplen{y_n}
        &&    \text{because $\metrican$ is \prope{nondegenerate}}
    \end{align*}
  
  \item Proof that $\metricn$ satisfies the triangle inequality property  for $r=1$:
    \begin{align*}
      \metric{\tuplen{x_n}}{\tuplen{y_n}}
        &\eqd \brp{\sum_{n=1}^\xN \lambda_n \metrican^r(x_n,y_n)}^\frac{1}{r}
        &&    \text{by definition of $\metricn$}
      \\&=    \sum_{n=1}^\xN \lambda_n \metrica{x_n}{y_n}
        &&    \text{by $r=1$ hypothesis}
      \\&\leq \sum_{n=1}^\xN \lambda_n \brs{\metrica{z_n}{x_n}+\metrica{z_n}{y_n}}
        &&    \text{by \prope{triangle inequality}}
      \\&=    \sum_{n=1}^\xN \lambda_n \metrica{z_n}{x_n} + \sum_{n=1}^\xN \lambda_n \metrica{z_n}{y_n}
      \\&=    \brp{\sum_{n=1}^\xN \lambda_n \metrican^r(z_n,x_n)}^\frac{1}{r} + \brp{\sum_{n=1}^\xN \lambda_n \metrican^r(z_n,y_n)}^\frac{1}{r}
        &&    \text{by $r=1$ hypothesis}
      \\&\eqd \metric{\tuplen{z_n}}{\tuplen{x_n}} + \metric{\tuplen{z_n}}{\tuplen{y_n}}
        &&    \text{by definition of $\metricn$}
    \end{align*}

  \item Proof that $\metricn$ satisfies the triangle inequality property  for $r\in\intoo{1}{\infty}$:
    \begin{align*}
      &\metric{\tuplen{x_n}}{\tuplen{y_n}}
      \\&\eqd \brp{\sum_{n=1}^\xN \lambda_n \metrican^r(x_n,y_n)}^\frac{1}{r}
        &&    \text{by definition of $\metricn$}
      \\&\leq \brp{\sum_{n=1}^\xN \lambda_n \brs{\metrican(z_n,x_n)+\metrican(z_n,y_n)}^r}^\frac{1}{r}
        &&    \text{by \prope{subaddtive} property \xref{def:metric}}
      \\&=    \brp{\sum_{n=1}^\xN \brs{\lambda_n^\frac{1}{r} \metrican(z_n,x_n)+\lambda_n^\frac{1}{r}\metrican(z_n,y_n)}^r}^\frac{1}{r}
        &&    \text{by \prope{subaddtive} property \xref{def:metric}}
      \\&\leq \brp{\sum_{n=1}^\xN \brs{\lambda_n^\frac{1}{r}\metrican(z_n,x_n)}^r}^\frac{1}{r} 
            + \brp{\sum_{n=1}^\xN \brs{\lambda_n^\frac{1}{r}\metrican(z_n,y_n)}^r}^\frac{1}{r}
        &&    \text{by \thme{Minkowski's inequality}} %{ \xref{thm:lp_minkowski}}
      \\&\leq \brp{\sum_{n=1}^\xN \lambda_n \metrican^r(z_n,x_n)}^\frac{1}{r} 
            + \brp{\sum_{n=1}^\xN \lambda_n \metrican^r(z_n,y_n)}^\frac{1}{r}
      \\&\eqd \metric{\tuplen{z_n}}{\tuplen{x_n}} + \metric{\tuplen{z_n}}{\tuplen{y_n}}
        &&    \text{by definition of $\metricn$}
    \end{align*}

  \item Proof for the $r=\infty$ case:
    \begin{enumerate}
      \item Proof that $\metric{\tuplen{x_n}}{\tuplen{y_n}} = \max\tuplen{x_n}$: by \prefp{thm:seq_Mr}
      
  \item Proof that $\tuplen{x_n}=\tuplen{y_n}\implies\metric{\tuplen{x_n}}{\tuplen{y_n}}=0$:
    \begin{align*}
      \metric{\tuplen{x_n}}{\tuplen{y_n}}
        &\eqd \max\set{\metrica{x_n}{y_n}}{n=1,2,\ldots,\xN}
        &&    \text{by definition of $\metricn$}
      \\&=    \max\set{\metrica{x_n}{x_n}}{n=1,2,\ldots,\xN}
        &&    \text{by $\tuplen{x_n}=\tuplen{y_n}$ hypothesis}
      \\&=    0
        &&    \text{because $\metrican$ is \prope{nondegenerate}}
      \\
    \end{align*}
  \item Proof that $\tuplen{x_n}=\tuplen{y_n}\impliedby\metric{\tuplen{x_n}}{\tuplen{y_n}}=0$:
    \begin{align*}
      0
        &=    \metric{\tuplen{x_n}}{\tuplen{y_n}}
        &&    \text{by $\metric{\tuplen{x_n}}{\tuplen{y_n}}=0$ hypothesis}
      \\&\eqd \max\set{\metrica{x_n}{y_n}}{n=1,2,\ldots,\xN}
        &&    \text{by definition of $\metricn$}
      \\\implies \metrica{x_n}{y_n}&=0 \text{ for } n=1,2,\ldots,\xN
      \\\implies \tuplen{x_n}&=\tuplen{y_n}
        &&    \text{because $\metrican$ is \prope{nondegenerate}}
      \\
    \end{align*}
  \item Proof that $\metricn$ satisfies the triangle inequality property:
    \begin{align*}
      &\metric{\tuplen{x_n}}{\tuplen{y_n}}
      \\&\eqd \max\set{\metrica{x_n}{y_n}}{n=1,2,\ldots,\xN}
        &&    \text{by definition of $\metricn$}
      \\&\le  \max\set{\metrica{x_n}{z_n}+\metrica{z_n}{y_n}}{n=1,2,\ldots,\xN}
        %&&    \text{because $\metrican$ satisfies the triangle inequality property}
        &&    \text{by \prope{subadditive} property}
      \\&\le  \max\set{\metrica{x_n}{z_n}}{n=1,2,\ldots,\xN}
          +   \max\set{\metrica{z_n}{y_n}}{n=1,2,\ldots,\xN}
        &&    \text{by \prope{non-negative} property}
      \\&=    \max\set{\metrica{z_n}{x_n}}{n=1,2,\ldots,\xN}
          +   \max\set{\metrica{z_n}{y_n}}{n=1,2,\ldots,\xN}
        &&    \text{by \prope{symmetry} property}
      \\&\eqd \metricn(\tuplen{z_n},\tuplen{x_n}) + \metricn(\tuplen{z_n},\tuplen{y_n})
        &&    \text{by definition of $\metricn$}
    \end{align*}
  \end{enumerate}

  \item And so by \prefpp{thm:metric_equiv}, $\metricn$ is a \fncte{metric} for $r\in\intcc{1}{\infty}$.
\end{enumerate}
\end{proof}



