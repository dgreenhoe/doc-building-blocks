%============================================================================
% LaTeX File
% Daniel J. Greenhoe
%============================================================================
%=======================================
\chapter{Additive noise}
%=======================================

%---------------------------------------
\begin{minipage}{\tw-55mm}
\begin{theorem}
\label{thm:xvy}
%---------------------------------------
Let $\opS$ be the \structe{system} with $\rvy(n) = \rvx(n) + \rvv(n)$.
\end{theorem}
\end{minipage}
\qquad\tbox{\includegraphics{graphics/sys_xvy.pdf}}
\thmbox{
  \brbr{\begin{array}{FrclDD}
      (A).& \Rxx(n_1,m)             &=& \Rxx(n_2,m)         &(\prope{WSS})          & and
    \\(B).& \pE\brs{\rvx(n)\rvv(n)} &=&\pE\rvx(n)\pE\rvv(n) &(\prope{uncorrelated}) & and 
    %   \\& \mc{3}{D}{(\prope{uncorrelated})}               &                         and
    \\(C).& \pE\rvv(n)              &=& 0                   & (\prope{zero-mean})     
  \end{array}}
  \implies
  \brbl{\begin{array}{FrclD}
      (1).&\Ryy(m)       &=& \Rxx(m)       + \Rvv(m)       & and
    \\(4).&\Ryv(m)       &=&                 \Rvv(m)       & and
    \\(2).&\Szyy(z)      &=& \Szxx(z)      + \Szvv(z)      & and
    \\(5).&\Szyv(z)      &=&                 \Szvv(z)      & and
    \\(3).&\Swyy(\omega) &=& \Swxx(\omega) + \Swvv(\omega) & and
    \\(6).&\Swyv(\omega) &=&                 \Swvv(\omega) & 
  \end{array}}
  }
\\
\begin{proof}
\begin{align*}
  \Ryy(m)
    &\eqd \pE\brs{\rvy(m)\rvy^\ast(0)}
    && \text{by (A) and definition of $\Ryy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brs{(\rvx(m)+\rvv(m))(\rvx(0)+\rvv(0))^\ast}
    && \text{by definition of $\rvy$}
  \\&= \mathrlap{
       \pE\brs{\rvx(m)\rvx^\ast(0)}
     + \pE\brs{\rvx(m)\rvv^\ast(0)}
     + \pE\brs{\rvv(m)\rvx^\ast(0)} 
     + \pE\brs{\rvv(m)\rvv^\ast(0)}
     }
  \\&= \mathrlap{
       \pE\brs{\rvx(m)\rvx^\ast(0)}
     + \pE{\rvx(m)\pE\rvv^\ast(0)}
     + \pE{\rvv(m)\pE\rvx^\ast(0)} 
     + \pE\brs{\rvv(m)\rvv^\ast(0)}
     \quad\text{by \prope{uncorrelated} hypothesis (B)}
     }
  \\&= \mathrlap{
       \pE\brs{\rvx(m)\rvx^\ast(0)}
     + \pE\rvx(m)\cancelto{0}{\pE\rvv^\ast(0)}
     + \cancelto{0}{\pE\rvv(m)}\pE\rvx^\ast(0)
     + \pE\brs{\rvv(m)\rvv^\ast(0)}
     \quad\text{by \prope{zero-mean} hypothesis (C)}
     }
  \\&= \Rxx(m) + \Rvv(m)
    && \text{by definition of $\Rxx$}
    && \text{\xref{def:Rxxm}}
  \\
  \Ryv(m)
    &\eqd \pE\brs{\rvy(m)\rvv^\ast(0)}
    && \text{by (A) and definition of $\Ryy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brs{(\rvx(m)+\rvv(m))\rvv^\ast(0)}
    && \text{by definition of $\rvy$}
  \\&= \pE\brs{\rvx(m)\rvv^\ast(0)} + \pE\brs{\rvv(m)\rvv^\ast(0)}
  \\&= \pE\rvx(m)\pE\rvv^\ast(0) + \pE\brs{\rvv(m)\rvv^\ast(0)}
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(B)}
  \\&= \pE\rvx(m)\cancelto{0}{\pE\rvv^\ast(0)} + \pE\brs{\rvv(m)\rvv^\ast(0)}
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(C)}
  \\&= \Rxv(m) + \Rvv(m)
    && \text{by definitions of $\Rxy$ and $\Rxx$}
    && \text{\xref{def:Rxxm}}
  \\
  \Szyy(z)
    &\eqd \opZ\Ryy(m)
    && \text{by definition of $\Szxx$}
    && \text{\xref{def:Szxx}}
  \\&= \opZ\Rqq(m) + \opZ\Rvv(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Szqq(z) + \Szvv(z)
    && \text{by definition of $\Szyy$}
    && \text{\xref{def:Swxy}}
  \\
  \Swyy(\omega)
    &\eqd \opDTFT\Ryy(m)
    && \text{by definition of $\Swyy$}
    && \text{\xref{def:Swxx}}
  \\&= \opDTFT\Rqq(m) + \opDTFT\Rvv(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Swqq(\omega) + \Swvv(\omega)
    && \text{by definition of $\Swyy$}
    && \text{\xref{def:Swxy}}
\end{align*}
\end{proof}


%---------------------------------------
\begin{minipage}{\tw-55mm}
\begin{theorem}
\label{thm:dual_addnoise}
%---------------------------------------
Let $\opS$ be the \structe{system} with $\rvy(n) = \rvx(n) + \rvv(n)$.
\end{theorem}
\end{minipage}
\qquad\tbox{\includegraphics{graphics/dual_addnoise.pdf}}
\thmbox{
  \brbr{\begin{array}{FMD}
      (A).& $\rvx(n)$ and $\rvr(n)$ are \prope{WSS}                     & and
    \\(B).& $\rvx$ and $\rvw$ are \prope{uncorrelated} & and
    \\(C).& $\rvr$ and $\rvv$ are \prope{uncorrelated} & and
    \\(D).& $\rvw$ and $\rvv$ are \prope{uncorrelated} & and
    \\(E).& $\pE\rvv(n)=\pE\rvw(n)=0$ (\prope{zero-mean})     
  \end{array}}
  \implies
  \brb{\begin{array}{FrclD}
      (1).&\Rsy(m)       &=& \Rrx(m)                       & and
    \\(2).&\Szsy(z)      &=& \Szrx(z)                      & and
    \\(3).&\Swsy(\omega) &=& \Swrx(\omega)                 &
  \end{array}}
  }
\\
\begin{proof}
\begin{align*}
  \Rsy(m) 
    &\eqd \pE\brs{\rvs(m)\rvy^\ast(0)}
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brp{\brs{\rvr(m)+\rvw(m)}(\rvx(0)+\rvv(0))^\ast}
    && \text{by definition of $\opS$}
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)}  
      +\pE\brs{\rvr(m)\rvv^\ast(0)}  
      +\pE\brs{\rvw(m)\rvx^\ast(0)}  
      +\pE\brs{\rvw(m)\rvv^\ast(0)}  
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)}  
      +\pE\rvr(m)\pE\rvv^\ast(0)  
      +\pE\rvw(m)\pE\rvx^\ast(0)  
      +\pE\rvw(m)\pE\rvv^\ast(0)  
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(B)}
  \\&= \pE\brs{\rvr(m)\rvx^\ast(0)}  
      +\pE\rvr(m)\cancelto{0}{\pE\rvv^\ast(0)}
      +\cancelto{0}{\pE\rvw(m)}\pE\rvx^\ast(0)  
      +\cancelto{0}{\pE\rvw(m)}\pE\rvv^\ast(0)  
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(C)}
  \\&= \Rrx(m)
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\
  \Szsy(\omega)
    &\eqd \opZ\Rsy(m)
    && \text{by definition of $\Szxy$}
    && \text{\xref{def:Szxy}}
  \\&= \opZ\Rrx(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Szrx(z)
    && \text{by definition of $\Szxy$}
    && \text{\xref{def:Szxy}}
  \\
  \Swsy(\omega)
    &\eqd \opDTFT\Rsy(m)
    && \text{by definition of $\Swxy$}
    && \text{\xref{def:Swxy}}
  \\&= \opDTFT\Rrx(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Swrx(\omega)
    && \text{by definition of $\Swxy$}
    && \text{\xref{def:Swxy}}
\end{align*}
\end{proof}

%---------------------------------------
\begin{minipage}{\tw-70mm}
\begin{theorem}
Let $\opS$ be the \structe{system} illustrated to the right.
%\footnote{
%  \citerpg{shin2008}{293}{0470725648}
%  }
\label{thm:sysH_xyuvpq}
%---------------------------------------
\end{theorem}
\end{minipage}
\hfill\tbox{\includegraphics{graphics/sysH_xyuvpq.pdf}}
\\
\thmbox{
  \brb{\begin{array}{FrclDD}
      (A).& \Rxx(n_1,m)             &=& \Rxx(n_2,m)         &(\prope{WSS})          & and
    \\(B).& \pE\brs{\rvx(n)\rvv(n)} &=&\pE\rvx(n)\pE\rvv(n) &(\prope{uncorrelated}) & and 
       %\\& \mc{3}{D}{(\prope{uncorrelated})}               &                         and
    \\(C).& \pE\rvv(n)              &=& 0                   & (\prope{zero-mean})   & 
  \end{array}}
  \implies
  \brb{\begin{array}{FrclD}
      (1).&\Rxy(m)       &=& \Rxq(m)                       & and
    \\(2).&\Rxy(m)       &=& \Rpy(m)                       & and
    \\(3).&\Szxy(z)      &=& \Szxq(z)                      & and
    \\(4).&\Swxy(\omega) &=& \Swxq(\omega)                 &
  \end{array}}
  }
\\
\begin{proof}
\begin{align*}
  \Rxy(m)
    &\eqd \pE\brs{\rvx(m)\rvy^\ast(0)}
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brs{\rvx(m)(\rvq(0)+\rvv(0))^\ast}
    && \text{by definition of $\opS$}
  \\&= \pE\brs{\rvx(m)\rvq^\ast(0)+\rvx(m)\rvv^\ast(0)}
  \\&= \pE\brs{\rvx(m)\rvq^\ast(0)} + \pE\brs{\rvx(m)\rvv^\ast(0)}
  \\&= \pE\brs{\rvx(m)\rvq^\ast(0)} + \brs{\pE\rvx(m)}\brs{\pE\rvv^\ast(0)}
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(B)}
  \\&= \pE\brs{\rvx(m)\rvq^\ast(0)} + \brs{\pE\rvx(m)}\cancelto{0}{\brs{\pE\rvv^\ast(0)}}
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(C)}
  \\&= \Rxq(m)
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\
  \Rxy(m)
    &\eqd \pE\brs{\rvx(m)\rvy^\ast(0)}
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\&\eqd \pE\brp{\brs{\rvp(m)-\rvu(m)}\rvy^\ast(0)}
    && \text{by definition of $\opS$}
  \\&= \pE\brs{\rvp(m)\rvy^\ast(0)-\rvu(m)\rvy^\ast(0)}
  \\&= \pE\brs{\rvp(m)\rvy^\ast(0)} - \brs{\pE\rvu(m)}\brs{\pE\rvy^\ast(0)}
    && \text{by \prope{uncorrelated} hypothesis}
    && \text{(B)}
  \\&= \pE\brs{\rvp(m)\rvy^\ast(0)} - \cancelto{0}{\brs{\pE\rvu(m)}}\brs{\pE\rvy^\ast(0)}
    && \text{by \prope{zero-mean} hypothesis}
    && \text{(C)}
  \\&= \Rpy(m)
    && \text{by definition of $\Rxy$}
    && \text{\xref{def:Rxym}}
  \\
  \Szxy(\omega)
    &\eqd \opZ\Rxy(m)
    && \text{by definition of $\Szxy$}
    && \text{\xref{def:Szxy}}
  \\&= \opZ\Rxq(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Szxq(z)
    && \text{by definition of $\Szxy$}
    && \text{\xref{def:Szxy}}
  \\
  \Swxy(\omega)
    &\eqd \opDTFT\Rxy(m)
    && \text{by definition of $\Swxy$}
    && \text{\xref{def:Swxy}}
  \\&= \opDTFT\Rxq(m)
    && \text{by previous result}
    && \text{(1)}
  \\&= \Swxq(\omega)
    && \text{by definition of $\Swxy$}
    && \text{\xref{def:Swxy}}
\end{align*}
\end{proof}

%---------------------------------------
\begin{minipage}{\tw-80mm}
\begin{theorem}
\label{thm:xGw_xHy_addnoise}
%---------------------------------------
Let $\opS$ be the \structe{system} illustrated to the right.
\end{theorem}
\end{minipage}
\hfill\tbox{\includegraphics{graphics/xGy_xHw_addnoise.pdf}}
\\
\thmbox{
  \brb{\begin{array}{FMMD}
      (A).& $\fg(n)$  is                &\prope{LTI}       & and
    \\(B).& $\rvx(n)$ is                &\prope{WSS}       & and
    \\(C).& $\rvu(n)$ and $\rvv(n)$ are &\prope{zero-mean} & and
    \\(D).& $\rvx(n)$, $\rvu(n)$, $\rvv(n)$ are &\prope{uncorrelated}
  \end{array}}
  \implies
  \brb{\begin{array}{FrclD}
      (1).& \Rsy(m)       &=& \Rrq(m)                  & and
    \\(2).& \Swsy(\omega) &=& \Swrq(\omega)            & and
    \\(3).& \Swsy(\omega) &=& \fG(\omega)\Swxy(\omega) &
  \end{array}}
  }
\\
\begin{proof}
\begin{align*}
  \Swsy(\omega)
    &= \Swrq(\omega)
    && \text{\prefp{thm:dual_addnoise}}
  \\&= \fG(\omega)\Swxx[pq](\omega)
    && \text{by \prefp{thm:xGw_xHy}}
  \\&= \fG(\omega)\Swxy(\omega)
    && \text{by \prefp{thm:sysH_xyuvpq}}
\end{align*}
\end{proof}
