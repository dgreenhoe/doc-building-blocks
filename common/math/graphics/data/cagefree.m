%========================================================================
% Daniel J. Greenhoe
% Sunspots
%
% Data source:  Data was adapted from
%   https://climate.nasa.gov/vital-signs/global-temperature/
%     "Land-Ocean Temperature Index (C"
%     https://data.giss.nasa.gov/gistemp/graphs/graph_data/Global_Mean_Estimates_based_on_Land_and_Ocean_Data/graph.txt
%
% cd "c:/dan/r/common/math/graphics/data"
%========================================================================
% years - 2000
X = [ 
  07.997260
  08.997268
  09.997260
  10.997260
  11.997260
  12.997268
  13.997260
  14.997260
  15.997260
  16.581967
  16.666667
  16.748634
  16.833333
  16.915301
  17.000000
  17.084932
  17.161644
  17.246575
  17.328767
  17.413699
  17.495890
  17.580822
  17.665753
  17.747945
  17.832877
  17.915068
  18.000000
  18.084932
  18.161644
  18.246575
  18.328767
  18.413699
  18.495890
  18.580822
  18.665753
  18.747945
  18.832877
  18.915068
  19.000000
  19.084932
  19.161644
  19.246575
  19.328767
  19.413699
  19.495890
];
Y = [
  03.2000
  03.5000
  03.6000
  04.4000
  05.4000
  06.0000
  05.9000
  05.7000
  08.6000
  10.1357
  10.0570
  12.2935
  12.1006
  11.7935
  11.8198
  12.1525
  12.8421
  13.0828
  13.4157
  13.4814
  13.5565
  14.7124
  15.3027
  15.6979
  15.4614
  15.4320
  15.6280
  16.0702
  15.9784
  16.8020
  16.8312
  16.9103
  16.9261
  16.8928
  17.5776
  17.4986
  17.3403
  17.2532
  17.1839
  17.0127
  18.1475
  19.5398
  19.9312
  20.3561
  20.4524
];

format long g
pkg load signal;
N = length(Y);
U = [ones(1,N) ; X', ; X'.^2, ; X'.^3];
coefs = inv(U*U')*(U*Y)
a=coefs(1)
b=coefs(2)
c=coefs(3)
d=coefs(4)
bestFit = d*X.^3 + c*X.^2 + b*X + a;
plot(bestFit)
x = 2022;
predict2022 = d*(x-2000)^3 + c*(x-2000)^2 + b*(x-2000) + a

