%============================================================================
% Daniel J. Greenhoe
% LaTeX file
%============================================================================

%======================================
\chapter{Linear Combinations}
%======================================
\begin{figure}
  \centering%
  \psset{xunit=1.25\latunit}%
  \psset{yunit=1.25\latunit}%
  \gsize%
  \input{../common/math/graphics/latframes.tex}%
  \caption{Lattice of \structe{linear combinations}}
\end{figure}
%=======================================
\section{Linear combinations in linear spaces}
%=======================================
A \structe{linear space} \xref{def:vspace} in general is not equipped with a
\structe{topology}\ifsxref{topology}{def:topology}.
Without a topology, it is not possible to determine whether an \structe{infinite sum}\ifsxref{series}{def:suminf}
of vectors converges\ifsxref{seq}{def:converge}.
Therefore in this section (dealing with linear spaces),
all definitions related to sums of vectors will be valid for \emph{finite} sums\ifxref{sums}{def:sum} only (finite ``$\xNn$").

%--------------------------------------
\begin{definition}
\footnote{
  \citerpgc{berberian1961}{11}{0821819127}{Definition~I.4.1},
  \citerpg{kubrusly2001}{46}{0817641742}
  }
\label{def:lincombo}
%--------------------------------------
Let $\setxn{\vx_n\in\setX}$ be a set of vectors in a \structe{linear space} $\linearspaceX$.
%Let $\spL\eqd\linearspaceX$ be a \structe{linear space} \xrefP{def:vspace}.
\defboxt{%
  A vector $\vx\in\setX$ is a \structd{linear combination} of the vectors in $\setn{\vx_n}$ if
  \\there exists $\ds\setxn{\alpha_n\in\F}$ such that
  \qquad$\ds\vx=\sum_{n=1}^\xN \alpha_n \vx_n$ .
  }
\end{definition}

%--------------------------------------
\begin{definition}
\footnote{
  \citerpgc{michel1993}{86}{048667598X}{3.3.7 Definition},
  \citerpg{kurdila2005}{44}{3764321989},
  \citerpgc{searcoid2002}{71}{185233424X}{Definition 3.2.5---more general definition}
  %\citerppgc{heil2011}{20}{21}{0817646868}{Definition 1.25}
  }
\label{def:span}
\label{def:linspan}
%--------------------------------------
Let $\linearspaceX$ be a linear space and $\setY$ be a subset of $\setX$.
\defbox{\begin{array}{Ml}
  The \opd{linear span} of $\setY$ is defined as
  & \ds
  \hxs{\linspan}\setY
  \eqd
  \setbigleft{\sum_{\gamma\in\Gamma} \alpha_\gamma \vy_\gamma}{\alpha_\gamma\in\F,\,\vy_\gamma\in\setY} .
  \\
  The set $\setY$ \hid{spans} a set $\setA$ if & \setA\subseteq\linspan\setY.
  %\\
  %{The \hid{closed span} $\hxs{\linspanc}\seqxZp{\vx_n}$ of $\seqxZp{\vx_n}$ in $\spO$ is the \hie{closure} of $\linspan\seqxZp{\vx_n}$ in $\spO$.}
  %\\
  %{The sequence $\seqxZp{\vx_n}$ is \hid{complete} in $\spO$ if $\linspanc\seqxZp{\vx_n}$ spans $\setX$.}
\end{array}}
\end{definition}

%--------------------------------------
\begin{proposition}
\footnote{
  \citerpg{kubrusly2001}{46}{0817641742}
  }
\label{prop:lsub}
%--------------------------------------
Let $\setxn{\vx_n\in\setX}$ be a set of vectors in a \structe{linear space} $\spL\eqd\linearspaceX$.
%Let $\setY\eqd\setxn{\vx_n}$ and $\spL\eqd\linearspaceX$.
\propbox{
  %\brb{\begin{array}{FMD}
  %  A. & $\spL$ is a \structe{linear space}                   & and\\
  %  B. & Each $\vx_n\in\setY$ is a \structe{vector} in $\spL$ &
  %\end{array}}
  %\quad\implies\quad
  {\begin{array}{FMMD}
    1. & $\linspan\setn{\vx_n}$ is a \structe{linear space}              & \xref{def:vspace} & and
  \\2. & $\linspan\setn{\vx_n}$ is a \structe{linear subspace} of $\spL$ & \ifxref{vector}{def:lsub}.  &
  \end{array}}}
\end{proposition}

%--------------------------------------
\begin{definition}
\footnote{
%  \citerpg{carothers2005}{24}{0521842832},
  \citerppg{bachman1966}{3}{4}{0486402517},
  %\citerppg{bachman2000fa}{3}{4}{0486402517}\\
  \citerpg{christensen2003}{2}{0817642951},
  \citerpgc{heil2011}{156}{0817646868}{Definition 5.7}
  }
\label{def:linin}
%--------------------------------------
Let $\spL\eqd\linearspaceX$ be a \structe{linear space}.
\defbox{\begin{array}{M}
  The set $\setY\eqd\setxn{\vx_n\in\setX}$ is \propd{linearly independent} in $\spL$ if
  \\$\ds\qquad\brb{\sum_{n=1}^\xN \alpha_{n} \vx_{n} = 0}
      \quad\implies\quad
      \brb{\alpha_1=\alpha_2=\cdots=\alpha_\xN=0}$.
  \\The set $\setY$ is \propd{linearly dependent} in $\spL$ if $\setY$ is not linearly independent in $\spL$.
  %\\An infinite set $\setxZp{\vx_n\in\setX}$ is \propd{linearly independent} in $\spL$ if
  %\\\qquad every finite subset $\setxn{\vx_{\ff(n)}}$ is \prope{linearly independent} in $\spL$.
  \end{array}}
\end{definition}

%--------------------------------------
\begin{definition}
\footnote{
  \citeP{hamel1905},
  \citerpg{bachman1966}{4}{0486402517},
  %\citerpg{bachman2000fa}{4}{0486402517}\\
  \citerppgc{kubrusly2001}{48}{49}{0817641742}{Section 2.4},
  \citerpg{young2001}{1}{0127729550},
  \citerpg{carothers2005}{25}{0521842832},
  \citerpgc{heil2011}{125}{0817646868}{Definition 4.1}
  }
\label{def:basis_hamel}
\label{def:hamel}
%---------------------------------------
Let $\setxn{\vx_n\in\setX}$ be a set of vectors in a \structe{linear space} $\spL\eqd\linearspaceX$.
\defboxt{
  The set $\setn{\vx_n}$ is a \structd{Hamel basis} for $\spL$ if
  \\\indentx$\begin{array}{FMMD}
      1. & $\setn{\vx_n}$ \prope{spans} $\spL$                      & \xref{def:span}     &and
    \\2. & $\setn{\vx_n}$ is \prope{linearly independent} in $\spL$ & \xref{def:lincombo} &.
  \end{array}$\\
  A \structe{Hamel basis} is also called a \structd{linear basis}.
  }
\end{definition}

%--------------------------------------
\begin{definition}
\footnote{
  \citeP{hamel1905},
  \citerpg{bachman1966}{4}{0486402517},
  %\citerpg{bachman2000fa}{4}{0486402517}\\
  \citerppgc{kubrusly2001}{48}{49}{0817641742}{Section 2.4},
  \citerpg{young2001}{1}{0127729550},
  \citerpg{carothers2005}{25}{0521842832},
  \citerpgc{heil2011}{125}{0817646868}{Definition 4.1}
  }
\label{def:expansion}
\label{def:dim}
%---------------------------------------
Let $\spL\eqd\linearspaceX$ be a \structe{linear space}.
Let $\vx$ be a \structe{vector} in $\spL$ and $\setY\eqd\setxn{\vx_n\in\setX}$ be a set of vectors in $\spL$.
\defboxt{
  The expression $\ds\sum_{n=1}^\xN \alpha_{n} \vx_n$
  is the \structd{expansion} of $\vx$ on $\setY$ in $\spL$ if
  \quad$\ds\vx=\sum_{n=1}^\xN \alpha_{n} \vx_n$.
  \\In this case, the sequence $\seqn{\alpha_n}_{n=1}^\xN$ is the \structd{coordinates} of $\vx$ with respect to $\setY$ in $\spL$.
  \\If $\alpha_\xN\neq0$, then $\xN$ is the \vald{dimension} $\dimension\spL$ of $\spL$.
  }
\end{definition}

%---------------------------------------
\begin{theorem}
\footnote{
  \citerppgc{michel1993}{89}{90}{048667598X}{Theorem 3.3.25}
  }
\label{thm:hamel_unique}
%---------------------------------------
Let $\setxn{\vx_n}$ be a \structe{Hamel basis} \xref{def:hamel} for a
\structe{linear space}\\$\linearspaceX$.
\thmbox{
  \brb{\vx = \sum_{n=1}^\xN \alpha_{n} \vx_{n} = \sum_{n=1}^\xN \beta_{n}  \vx_n}
  %\brbr{\begin{array}{>{\scy}r>{\ds}lD}
  %  1. & \vx = \sum_{n=1}^\xN \alpha_{n} \vx_{n} & and \\
  %  2. & \vx = \sum_{n=1}^\xN \beta_{n}  \vx_{n} &
  %\end{array}}
  \qquad\implies\qquad
  {\mcom{\alpha_n=\beta_{n} {\scy\quad \forall n=1,2,\ldots,\xN}}{coordinates of $\vx$ are \prope{unique}}}
  \qquad \forall\vx\in\setX
  }
\end{theorem}
\begin{proof}
\begin{align*}
  \vzero
    &= \vx - \vx
  \\&= \sum_{n=1}^\xN \alpha_{n} \vx_{n} - \sum_{n=1}^\xN \beta_{n}  \vx_{n}
  \\&= \sum_{n=1}^\xN \brp{\alpha_n-\beta_n} \vx_n
  \\&\implies \text{$\setn{\vx_n}$ is \prope{linearly dependent} if $\brp{\alpha_n-\beta_n}\neq0 \qquad\forall n=1,2,\ldots,\xN$}
  \\&\implies \text{$\brp{\alpha_n-\beta_n}=0\qquad\forall n=1,2,\ldots,\xN$ \qquad \scs(because $\setn{\vx_n}$ is a \structe{basis} and therefore must be \prope{linearly independent})}
  %  && \text{because $\setn{\vx_n}$ is a \structe{basis} and therefore must be \prope{linearly independent}}
  \\&\implies \text{$\alpha_n=\beta_n$ for $n=1,2,\ldots,\xN$}
\end{align*}
\end{proof}

%---------------------------------------
\begin{theorem}
\footnote{
  \citerppgc{michel1993}{90}{91}{048667598X}{Theorem 3.3.26}
  }
\label{thm:frm_MN}
%---------------------------------------
Let $\spL\eqd\linearspaceX$ be a \structe{linear space}.
\thmbox{\begin{array}{>{\ds}l}
  \brb{\begin{array}{>{\scy}rMD}
    1. & $\ds\set{\vx_n\in\setX}{\scy n=1,2,\ldots,\xN}$ is a \structe{Hamel basis} for $\spL$ & and \\
    2. & $\ds\set{\vy_n\in\setX}  {\scy n=1,2,\ldots,\xM}$ is a set of \prope{linearly independent} vectors in $\spL$
  \end{array}}
  \\\qquad\implies\qquad
  \brb{\begin{array}{>{\scy}rMD}
    1. & $\xMn\le\xNn$ & and \\
    2. & $\xMn=\xNn \implies \set{\vy_n}{\scy n=1,2,\ldots,\xM}$ is a \structe{basis} for $\spL$ & and\\
    3. & $\xMn\neq\xNn \implies \set{\vy_n}{\scy n=1,2,\ldots,\xM}$ is \emph{not} a {basis} for $\spL$
  \end{array}}
\end{array}}
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Proof that $\setn{\vy_1,\,\vx_1,\,\ldots,\,\vx_{\xN-1}}$ is a \structe{basis} for $\spL$: \label{item:x1phiN1}
    \begin{enumerate}
      \item Proof that $\setn{\vy_1,\,\vx_1,\,\ldots,\,\vx_{\xN-1}}$ \prope{spans} $\spL$:
        \begin{enumerate}
          \item Because $\setxn{\vx_n}$ is a \structe{basis} for $\spL$, there exists $\beta\in\F$ and $\setxn{\alpha_n\in\F}$ such that
            \\$\ds \beta\vy_1 + \sum_{n=1}^\xN \alpha_n\vx_{n} = 0$.\label{item:frm_MN_beta}
          \item Select an $n$ such that $\alpha_n\neq0$ and renumber (if necessary) the above indices such that
            \\$\ds\vx_{n} = -\frac{\beta}{\alpha_n}\vy_1 +  \sum_{n=1}^{\xN-1} \frac{\alpha_n}{\alpha_n}\vx_n$.
          \item Then, for any $\vy\in\setX$, we can write
            \begin{align*}
              \vy
                &= \sum_{n=1}^\xN \gamma_{n\in\Z} \vx_n
              \\&= \brp{\sum_{n=1}^{\xN-1} \gamma_{n\in\Z} \vx_n} + \gamma_{n\in\Z} \brp{-\frac{\beta}{\alpha_n}\vy_1- \sum_{n=1}^{\xN-1} \frac{\alpha_n}{\alpha_n}\vx_n}
              \\&= -\frac{\beta\gamma_n}{\alpha_n}\vy_1 + {\sum_{n=1}^{\xN-1} \brp{\gamma_n-\frac{\alpha_n\gamma_n}{\alpha_n}} \vx_n}
              \\&= \delta\vy_1 + \sum_{n=1}^{\xN-1}\delta_{n\in\Z} \vx_n
            \end{align*}
          \item This implies that $\setn{\vy_1,\,\vx_1,\,\ldots,\,\vx_{\xN-1}}$ \prope{spans} $\spL$:
        \end{enumerate}

      \item Proof that $\setn{\vy_1,\,\vx_1,\,\ldots,\,\vx_{\xN-1}}$ is \prope{linearly independent}:
        \begin{enumerate}
          \item If $\setn{\vy_1,\,\vx_1,\,\ldots,\,\vx_{\xN-1}}$ is \prope{linearly dependent}, then there exists
                   $\setn{\epsilon,\,\epsilon_1,\,\ldots,\,\epsilon_{\xN-1}}$ such that
            \\$\ds\epsilon\vy_1 + \brp{\sum_{n=1}^{\xN-1}\epsilon_{n\in\Z} \vx_n} + 0\vx_{n} = 0$.  \label{item:frm_MN_epsilon}
          \item \pref{item:frm_MN_epsilon} implies that the coordinate of $\vy_1$ associated with $\vx_n$ \emph{is} $0$.
            \\$\ds\vy_1 = -\brp{\sum_{n=1}^{\xN-1}\frac{\epsilon_n}{\epsilon} \vx_n} + 0\vx_{n} = 0$.  \label{item:frm_MN_epsilon1}
          \item \pref{item:frm_MN_beta} implies that the coordinate of $\vy_1$ associated with $\vx_n$ is \emph{not} $0$.
            \\$\ds \vy_1 = -\sum_{n=1}^\xN \frac{\alpha_n}{\beta}\vx_n$.  \label{item:frm_MN_epsilon2}
          \item This implies that \pref{item:frm_MN_epsilon} (that the set is linearly dependent) is \emph{false}
                because \pref{item:frm_MN_epsilon1} and \pref{item:frm_MN_epsilon2} \emph{contradict} each other.
          \item This implies $\setn{\vy_1,\,\vx_1,\,\ldots,\,\vx_{\xN-1}}$ is \prope{linearly independent}.
        \end{enumerate}

    \end{enumerate}

  \item Proof that $\setn{\vy_1,\,\vy_2,\,\vx_1,\,\ldots,\,\vx_{\xN-2}}$ is a \structe{basis}: Repeat \pref{item:x1phiN1}.

  \item Suppose $m=n$. Proof that $\setn{\vy_1,\,\vy_2,\,\ldots,\,\vy_\xM}$ is a \structe{basis}:
        Repeat \pref{item:x1phiN1} $\xM-1$ times.
        \label{item:frm_MN_xM}

  \item Proof that $\xM\ngtr\xN$: \label{item:frm_MN_ngtr}
    \begin{enumerate}
      \item Suppose that $\xM=\xN+1$.
      \item Then because $\setxn{\vy_n}$ is a \structe{basis}, there exists $\set{\zeta_n}{\scy n=1,2,\ldots,\xN+1}$ such that
        \\$\ds \sum_{n=1}^{\xN+1} \zeta_{n\in\Z} \vy_{n\in\Z} = 0$.
      \item This implies that $\set{\vy_n}{\scy n=1,2,\ldots,\xN+1}$ is \prope{linearly dependent}.
      \item This implies that $\set{\vy_n}{\scy n=1,2,\ldots,\xN+1}$ is \emph{not} a basis.
      \item This implies that $\xM\ngtr\xN$.
    \end{enumerate}

  \item Proof that $\xM\neq\xN \implies \set{\vy_n}{\scy n=1,2,\ldots,\xM}$ is \emph{not} a {basis} for $\spL$:
    \begin{enumerate}
      \item Proof that $\xM>\xN \implies \set{\vy_n}{\scy n=1,2,\ldots,\xM}$ is \emph{not} a {basis} for $\spL$: same as in \pref{item:frm_MN_ngtr}.
      \item Proof that $\xM<\xN \implies \set{\vy_n}{\scy n=1,2,\ldots,\xM}$ is \emph{not} a {basis} for $\spL$:
        \begin{enumerate}
          \item Suppose $m=\xN-1$.
          \item Then $\set{\vy_n}{\scy n=1,2,\ldots,\xN-1}$ is a \structe{basis} and there exists $\lambda$ such that
            \\$\ds\sum_{n=1}^\xN \lambda_{n\in\Z} \vy_{n\in\Z} = 0$.
          \item This implies that $\setxn{\vy_n}$ is \prope{linearly dependent} and is \emph{not} a basis.
          \item But this contradicts \pref{item:frm_MN_xM}, therefore $\xM\neq\xN-1$.
          \item Because $\xM=\xN$ yields a basis but $\xM=\xN-1$ does not, $\xM<\xN-1$ also does not yield a basis.
        \end{enumerate}
    \end{enumerate}
\end{enumerate}
\end{proof}

%---------------------------------------
\begin{corollary}
\footnote{
  \citerpgc{kubrusly2001}{52}{0817641742}{Theorem 2.7},
  \citerpgc{michel1993}{91}{048667598X}{Theorem 3.3.31}
  }
\label{cor:frm_MN}
%---------------------------------------
Let $\spL\eqd\linearspaceX$ be a linear space.
\corbox{
  \mcom{
  \brb{\begin{array}{>{\scy}rMD}
    1. & $\ds\setxn{\vx_n\in\setX}$ is a \structe{Hamel basis} for $\spL$ & and \\
    2. & $\ds\set{\vy_n\in\setX}{\scy n=1,2,\ldots,\xM}$ is a \structe{Hamel basis} for $\spL$
  \end{array}}
  \qquad\implies\qquad \brb{\xNn=\xMn}
  }{(all Hamel bases for $\spL$ have the same number of vectors)}
  }
\end{corollary}
\begin{proof}
This follows from \prefpp{thm:frm_MN}.
\end{proof}


%=======================================
\section{Bases in topological linear spaces}
%=======================================
A linear space supports the concept of the \structe{span} of a set of vectors \xrefP{def:span}.
%The span of a set of vectors in a linear space is itself a \structe{linear space} \xrefP{prop:lsub}.
%In a \prope{finite} linear space, a set of vectors that \prope{spans} the space is also said to be \prope{total}
%in that space.
In a topological linear space $\spO\eqd\toplinspaceX$, a set $\setA$ is said to be \prope{total} in $\spO$
if the span of $\setA$ is \prope{dense} in $\spO$.
%if $\clsp{\linspan\setA}=\spX$ \xrefP{def:total_set}.
In this case, $\setA$ is said to be a \structe{total set} or a \structe{complete set}.
However, this use of ``complete" in a ``\structe{complete set}" is not equivalent to
the use of ``complete" in a ``\structe{complete metric space}" \ifxref{seq}{def:complete}.\footnote{%
  \citerppgc{haaser1991}{296}{297}{0486665097}{6$\cdot$Orthogonal Bases},
  \citerpgc{rynne2008}{78}{1848000057}{Remark 3.50},
  \citerpgc{heil2011}{21}{0817646868}{Remark 1.26}
  }
In this text, except for these comments and \pref{def:total_set},
``complete" refers to the metric space definition \ifxref{seq}{def:complete} only.


%If a \structe{total set} in $\spX$ with any one of its vectors removed is \emph{not} a total set in $\spX$,
%then that total set is a \structe{basis} for $\spX$.
If a set is both \prope{total} and \prope{linearly independent} \xrefP{def:linin} in $\spO$, then
that set is a \structe{Hamel basis} \xrefP{def:basis_hamel} for $\spO$.

%If we also add the requirement of uniqueness, then we have a \structe{Hamel basis} (1905, \xrefp{def:basis_hamel}).
%%This is often sufficient for constructing a basis in a finite space (see \structe{Hamel basis}, \prefp{def:basis_hamel}).
%However, in an \prope{infinite} linear space, in general the concepts of completeness, the Hamel basis, and even
%infinite summation is undefined.
%To define the \structe{total set} in an infinite linear space (\pref{def:total_set}, next definition),
%we must first append a topology to the linear space.
%That is, we need a \structe{topological linear space} \xrefP{def:toplinspace}.
%Examples of topological linear spaces include metric linear spaces, normed linear spaces, and inner product spaces.
%To define a basis, we also need the concept of \prope{convergence}.
%For convergence to a unique element, a topological space is not sufficient, but metric spaces
%(which include normed linear spaces and inner product spaces) are sufficient.
%
%The \structe{Schauder basis} (1927, \xrefp{def:basis_schauder}) is defined in
%a normed linear space. % (which also includes the inner product space).
%%\hie{Hamel bases} (1905) are often used in finite dimensional linear spaces.
%%However, in an infinite dimensional space, Hamel bases are frought with problems.
%%One problem is that even if the linear space is \prope{separable}, a Hamel basis for that linear space may be \prope{uncountable}.
%%In a Banach space, the often preferred bases are the \hie{Schauder bases} (1927, next definition).
%Schauder bases exploit assets that are available in Banach spaces but are not in general available in linear spaces:
%a topology induced by the norm $\normn$ and the property of \prope{completeness}.
%In escence, Hamel bases are \prope{algebraic} only, while Schauder bases are both algebraic and \prope{topological}.
%
%%The number of Banach spaces over a set $\setX$ tends to be much much larger than the set of Hilbert spaces over the same set.
%%Take for example the norm $\ds\norm{x}_p\eqd\brp{\sum_{n=1}^\infty x^p}^\frac{1}{p}$ ($p\in\R$) over the set of real numbers $\R$.
%%Of these uncountably infinite number of norms, only one of them ($p=2$) generates an inner product.
%%
%%But the set of Banach spaces over a set $\setX$ is not the largest of the sets of topological spaces;
%%the set of metric spaces is still larger.
%%But one advantage that Banach spaces have over metric spaces is that the norm at the core of a Banach space is
%%algebraic in nature
%
%Note that by definition $\sum_{n=1}^\infty \alpha \vx_{n} \eqd \lim_{\xN\to\infty} \sum_{n=1}^\xN \alpha_{n} x_n$,
%and that this definition depends on the the operator ``$\lim$" being
%defined \xrefP{def:strong_converge},
%which in turn requires a topology, such as is available in a \structe{Banach space} \xrefP{def:suminf}.
%Furthermore, note that in a Banach space, the equation
%$\vx\eqs\sum_{n=1}^\infty\alpha_n\vx_n$ by definition implies $\lim_{\xN\to\infty}\norm{\vx-\sum_{n=1}^\xN\alpha_n\vx_n}=0$
%(\prope{strong convergence}, \xrefp{def:strong_converge}),
%where the symbol ``$\eqs$" denotes \prope{strong convergence}\ifsxref{series}{def:eqs}.

%--------------------------------------
\begin{definition}
\footnote{
  \citerpgc{young2001}{19}{0127729550}{Definition 1.5.1},
  \citerpgc{sohrab2003}{362}{0817642110}{Definition 9.2.3},
  \citerpgc{gupta1998}{134}{8186358447}{Definition 2.4},
  \citerppgc{bachman1966}{149}{153}{0486402517}{Definition 9.3, Theorems 9.9 and 9.10}
  %\citerpgc{heil2011}{21}{0817646868}{Definition 1.25}
  }
\label{def:total_set}
%--------------------------------------
Let $\clsA$ be the \prope{closure} \ifxref{topology}{def:clsA} of a $\setA$ in a
\structe{topological linear space} \ifxref{vstopo}{def:toplinspace} $\spO\eqd\toplinspaceX$.
Let $\linspan\setA$ be the \structe{span} \xref{def:span} of a set $\setA$.
\defboxt{
  A set of vectors $\setA$ is \hid{total} (or \hid{complete} or \hid{fundamental}) in $\spO$ if
  \\\indentx
  $\clsp{\linspan\setA} = \spO$ \qquad\scs(\structe{span} of $\setA$ is \prope{dense} \ifxref{topology}{def:dense} in $\spO$).
  }
\end{definition}



%=======================================
\section{Schauder bases in Banach spaces}
%=======================================
%--------------------------------------
\begin{definition}
\footnote{
  \citerppg{carothers2005}{24}{25}{0521842832},
  \citerppgc{christensen2003}{46}{49}{0817642951}{Definition 3.1.1 and page 49},
  \citerpgc{young2001}{19}{0127729550}{Section 6},
  \citerp{singer1970}{17},
  %\citerpgc{heil2011}{24}{0817646868}{Definition 1.32}\\
  %\citerpgc{heil2011}{131}{0817646868}{Definition 4.7}\\
  %\citerpg{christensen2008}{2}{0817646779}\\
  \citor{schauder1927},
  \citor{schauder1928}
  }
\label{def:basis_schauder}
\label{def:schauder}
%--------------------------------------
Let $\spB\eqd\normspaceX$ be a \structe{Banach space}\ifsxref{seq}{def:banach}.
Let $\eqs$ represent \prope{strong convergence}\ifsxref{series}{def:eqs} in $\spB$.
\defboxt{
  The countable set $\setxZp{\vx_n\in\setX}$ is a \structd{Schauder basis} for $\spB$ if for each $\vx\in\setX$
    \\\indentx$\begin{array}{F>{\ds}lD}
        %1. & \exists \setxn{\alpha_n\in\F} \st \lim_{\xN\to\infty}\norm{\vx - \sum_{n=1}^\xN \alpha_{n} \vx_n}=0 & (\prope{convergent in norm})
        1. & \exists \seqxZp{\alpha_n\in\F} \quad\st\quad \vx \eqs \sum_{n=1}^\infty \alpha_n \vx_n
           & (\prope{strong convergence} in $\spB$)
             and%
           \\
        2. & \brb{\sum_{n=1}^\infty \alpha_{n} \vx_{n} \eqs \sum_{n=1}^\infty \beta_{n}  \vx_n}
             \implies
             \brb{\seqn{\alpha_n}=\seqn{\beta_n}}
           & (\structe{coefficient functionals} are \prope{unique})%
           %&
    \end{array}$
      \\
      In this case, $\ds\sum_{n=1}^\infty \alpha_{n} \vx_n$ is the \hid{expansion} of $\vx$ on $\setxZp{\vx_n}$ and\\
      the elements of $\seqn{\alpha_n}$ are the \hid{coefficient functionals} associated with the basis $\setn{\vx_n}$.\\
      Coefficient functionals are also called \hid{coordinate functionals}.
      %A \hid{Schauder basis} may also be simply called a \hid{basis}.
    }
\end{definition}

In a Banach space, the existence of a Schauder basis implies that the space is \prope{separable} %\ifsxref{topology}{def:separable}
\xref{thm:Bschauder==>separable}. %(next theorem).
The \label{BasisProblem} question of whether the converse is also true was posed by Banach himself in 1932,\cittrp{banach1932}{111}
and became know as ``\hie{The basis problem}".
This remained an open question for many years.
The question was finally answered some 41 years later in 1973 by \hi{Per Enflo} (University of California at Berkley),
with the answer being ``no".
Enflo constructed a counterexample in which a separable Banach space does \emph{not} have a Schauder
basis.\footnote{
  \citor{enflo1973},
  \citerppgc{lindenstrauss1977}{84}{95}{3642665594}{Section 2.d}
  }
Life is simpler in Hilbert spaces where the converse \emph{is} true:
a Hilbert space has a Schauder basis \emph{if and only if} it is separable \xref{thm:schauder<==>separable}.

%--------------------------------------
\begin{theorem}
\footnote{
  \citerpgc{bachman2002}{112}{9780387988993}{3.4.8},
  \citerpg{giles2000}{17}{0521653754},
  \citerpgc{heil2011}{21}{0817646868}{Theorem 1.27}
  }
\label{thm:Bschauder==>separable}
%--------------------------------------
%Let $\seqxZp{\vx_n\in\setX}$ be a sequence of vectors in a Banach space\\
Let $\spB\eqd\normspaceX$ be a \structe{Banach space}.
Let $\Q$ be the field of rational numbers.
%Let $\normn$ be a function in $\clF{\setX}{\R}$ on a linear space $\spB\eqd\linearspaceX$.
%Let $\seqxZp{x_n}$ be a sequence in $\spX$.
\thmbox{
  \brb{\begin{array}{FMD}
    1. & $\spB$ has a \structe{Schauder basis} & and\\
    2. & $\Q$ is \prope{dense} in $\F$.
  \end{array}}
  \quad\implies\quad
  \brb{\begin{array}{M}
    $\spB$ is \prope{separable}
  \end{array}}
  %If $\opair{\spB}{\normn}$ is a \prope{normed} linear space then
  %   \\\indentx $\exists$ a sequence $\seqxZp{\vx_n}$ that is \prope{complete} in $\spB$ $\implies$ $\setX$ is \prope{separable}.
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item lemma: \label{ilem:Bschauder==>separable_seto}
    \begin{align*}
      \seto{\set{\vx}{\text{$\exists\seqxZp{\alpha_n\Q}$ such that $\ds\lim_{\xN\to\infty}\norm{\vx-\sum_{n=1}^\xN\alpha_n\vx_n}=0$}}}
        &= \seto{\Q\times\Zp}
      \\&= \seto{\Z\times\Z}
      \\&= \seto{\Z}
      \\&= \text{\prope{countably infinite}}
    \end{align*}

  \item remainder of proof:
    \begin{align*}
      &\text{$\spB$ has a \structe{Schauder basis} $\seqxZp{\vx_n}$}
      \\&\implies \text{for every $\vx\in\spB$, there exists $\seqxZp{\alpha_n\in\F}$ such that $\ds\vx\eqs\sum_{n=1}^\infty\alpha_n\vx_n$}
        %&& \text{by definition of \structe{Schauder basis} \xref{def:schauder}}
        \qquad\text{by \prefp{def:schauder}}
      \\&\implies \text{for every $\vx\in\spB$, there exists $\seqxZp{\alpha_n\in\F}$ such that $\ds\lim_{\xN\to\infty}\norm{\vx-\sum_{n=1}^\xN\alpha_n\vx_n}=0$}
        %&& \text{by definition of $\eqs$ \xref{def:eqs}}
        \quad\text{\ifdochas{series}{by \pref{def:eqs}}}
      \\&\implies \text{for every $\vx\in\spB$, there exists $\seqxZp{\alpha_n\in\Q}$ such that $\ds\lim_{\xN\to\infty}\norm{\vx-\sum_{n=1}^\xN\alpha_n\vx_n}=0$}
        \quad\text{because $\cls{\Q}=\F$}
      \\&\implies \spB = \set{\vx}{\text{$\exists \seqxZp{\alpha_n\Q}$ such that $\ds\lim_{\xN\to\infty}\norm{\vx-\sum_{n=1}^\xN\alpha_n\vx_n}=0$}}
      \\&\implies \spB = \cls{\set{\vx}{\text{$\exists \seqxZp{\alpha_n\Q}$ such that $\ds\vx=\lim_{\xN\to\infty}\sum_{n=1}^\xN\alpha_n\vx_n$}}}
      \\&\implies \text{$\spB$ is \prope{separable}}
        \qquad\text{by \prefp{ilem:Bschauder==>separable_seto}}
    \end{align*}
\end{enumerate}
\end{proof}


%--------------------------------------
\begin{definition}
\footnote{
  \citerpgc{young2001}{25}{0127729550}{Definition 1.8.1, Theorem 1.8.7}
  }
\label{def:equivalent}
%--------------------------------------
Let $\setxZp{\vx_n}$ and $\setxZp{\vy_n}$ be \structe{Schauder bases} of a \structe{Banach space}\\$\normspaceX$.
\defboxt{
  $\setn{\vx_n}$ is \hid{equivalent} to $\setn{\vy_n}$
  \\if there exists a \prope{bounded} \prope{invertible} operator $\opR$ in $\clOxx$ such that
  %\\\indentx
  \quad$\opR\vx_n = \vy_n\qquad\scy\forall n\in\Z$
  }
\end{definition}

%--------------------------------------
\begin{theorem}
\footnote{
  \citerpgc{young2001}{25}{0127729550}{Definition 1.8.1, Theorem 1.8.7}
  }
\label{thm:equivalent_convergent}
%--------------------------------------
Let $\setxZp{\vx_n}$ and $\setxZp{\vy_n}$ be \structe{Schauder bases} of a \structe{Banach space}\\$\normspaceX$.
\thmboxt{
  $\brb{\text{$\setn{\vx_n}$ is \prope{equivalent} to $\setn{\vy_n}$}}$
  \\$\qquad\iff\qquad$
  $\brb{
    \text{$\ds\sum_{n=1}^\infty \alpha_n \vx_n$ is \prope{convergent}}
    \iff
    \text{$\ds\sum_{n=1}^\infty \alpha_n \vy_n$ is \prope{convergent}}
    }$
  }
\end{theorem}


%--------------------------------------
\begin{lemma}
\footnote{
  \citerp{dau}{140}
  }
\label{lem:bases_opFT}
%--------------------------------------
Let $\spO\eqd\toplinspaceX$ be a topological linear space.
Let $\linspan\setA$ be the \structe{span} of a set $\setA$\ifsxref{frames}{def:span}.
Let $\Ff(\omega)$ and $\Fg(\omega)$ be the \ope{Fourier transform}s\ifsxref{harFour}{def:ft} of the
functions $\ff(x)$ and $\fg(x)$, respectively, in $\spLLR$ \xref{def:spLLR}.
Let $\Da(\omega)$ be the \ope{DTFT}\ifsxref{dtft}{def:dtft} of a sequence $\seqxZ{a_n}$ in $\spllR$ \xref{def:spllR}.
\lembox{
  \brb{\begin{array}{FMD}
    (1). & $\setxZ{\opTrn^n\ff}$ is a \structe{Schauder basis} for $\spO$ & and \\
    (2). & $\setxZ{\opTrn^n\fg}$ is a \structe{Schauder basis} for $\spO$ &
  \end{array}}
  \quad\implies\quad
  \brb{\begin{array}{l}
    \exists \seqxZ{a_n} \st\\
    \Ff(\omega) = \Da(\omega)\Fg(\omega)
  \end{array}}
  }
\end{lemma}
\begin{proof}
Let $\spV_0'$ be the space spanned by $\setxZ{\opTrn^n\fphi}$.
\begin{align*}
  \Ff(\omega)
    &\eqd \opFT\ff
    &&    \text{by definition of $\opFT$}
    &&    \text{\ifsxref{harFour}{def:opFT}}
  \\&=    \opFT\sum_{n\in\Z} a_n \opTrn\fg
    &&    \text{by (2)}
  \\&=    \sum_{n\in\Z} a_n \opFT\opTrn\fg
  \\&=    \mcom{\sum_{n\in\Z} a_n e^{-i\omega n}}{$\Da(\omega)$}\mcom{\opFT\fg}{$\Fg(\omega)$}
    &&    \text{\ifxref{transop}{cor:FTD}}
  \\&=    \Da(\omega)\Fg(\omega)
    &&    \text{by definition of $\opDTFT$ and $\opFT$}
    &&    \text{\ifsxref{dtft}{def:dtft}\ifsxref{harFour}{def:opFT}}
  %  &\eqd \cft\int_\R \ff(x) e^{-i\omega x}\dx
  %  &&    \text{by \prefp{def:opFT}}
  %\\&=    \cft\int_\R \sum_{n\in\Z}a_n \fg(x-n) e^{-i\omega x}\dx
  %  &&    \text{by \prope{Riesz basis} hypothesis}
  %\\&=    \sum_{n\in\Z} a_n \brs{\cft \int_\R \fg(x-n) e^{-i\omega x}\dx  }
  %\\&=    \sum_{n\in\Z} a_n \brs{\cft \int_\R \fg(u) e^{-i\omega(u+n)}\du }
  %  &&    \text{where $u\eqd x-n$ $\implies$ $x=u+n$}
  %\\&=    \mcom{\brs{\sum_{n\in\Z} a_n e^{-i\omega n}}}{DTFT of $\seqn{a_n}$}
  %        \mcom{\brs{\cft\int_\R \fg(u) e^{-i\omega u}\du}}{Fourier Transform of $\fg(x)$}
  %\\&\eqd \Da(\omega) \Fg(\omega)
   %  &&    \text{by \prefpp{def:dtft} and \prefp{def:opFT}}
\\
\\
  \spV_0
    &\eqd \set{\ff(x)}{\ff(x)=\sum_{n\in\Z} b_n \opTrn^n\fg(x)}
    %&&    \text{by \prope{Riesz basis} hypothesis}
  \\&=    \set{\ff(x)}{\opFT\ff(x)=\opFT\sum_{n\in\Z} b_n \opTrn^n\fg(x)}
  \\&=    \set{\ff(x)}{\Ff(\omega)=\Fb(\omega) \Fg(\omega) }
  \\&=    \set{\ff(x)}{\Ff(\omega)=\Fb(\omega) \Da(\omega) \Ff(\omega) }
  \\&=    \set{\ff(x)}{\Ff(\omega)=\Fc(\omega) \Ff(\omega) }
    &&    \text{where $\Fc(\omega)\eqd\Fb(\omega)\Da(\omega)$}
  \\&=    \set{\ff(x)}{\ff(x)=\sum_{n\in\Z} \fc_{n} \ff(x-n) }
  \\&\eqd \spV_0'
\end{align*}
\end{proof}


%======================================
%\section{Total sets in Hilbert spaces}
%======================================
%=======================================
%\subsection{Parseval sequences in Hilbert spaces}
%=======================================
%=======================================
\section{Linear combinations in inner product spaces}
%=======================================
\ifdochasnot{vsinprod}{
%--------------------------------------
\begin{definition}
\label{def:orthog}
%\footnote{
%  \citer{james1945}
%  }
\index{orthogonality!inner product space}
%--------------------------------------
Let $\inprodspaceX$ be an \structe{inner product space} \xref{def:inprod}.
\defboxt{
  Two vectors $\vx$ and $\vy$ in $\setX$ are \propd{orthogonal} if
  \\\indentx$\ds
    \inprod{\vx}{\vy}=
      \brbl{\begin{array}{lM}
        0            & for $\vx\neq\vy$\\
        c\in\F\setd0 & for $\vx=\vy$
      \end{array}}$
  %\\
  %The notation $\vx\orthog\vy$ implies $\vx$ and $\vy$ are \prope{orthogonal}.
  %\\
  %A set $\setY\in\psetX$ is \propd{orthogonal} if $\vx\orthog\vy\quad{\scy\forall\vx,\vy\in\setY}$.
  %\\
  %A set $\setY$ is \propd{orthonomal} if it is \prope{orthogonal} and $\inprod{\vy}{\vy}=1\quad{\scy\forall\vy\in\setY}$.
  %\\
  %A sequence $\seqxZ{\vx_n\in\setX}$ is \propd{orthogonal} if $\inprod{\vx_n}{\vx_m}=c\kdelta_{nm}$ for some $c\in\R\setd0$.
  %\\
  %A sequence $\seqxZ{\vx_n\in\setX}$ is \propd{orthonormal} if $\inprod{\vx_n}{\vx_m}=\kdelta_{nm}$.
  }
\end{definition}
}

In an \structe{inner product space}, \prope{orthogonality} is a special case of \prope{linear independence};
or alternatively, linear independence is a generalization of orthogonality (next theorem).
%--------------------------------------
\begin{theorem}
\footnote{
  \citerpgc{ab}{283}{0120502577}{Corollary 32.8},
  \citerpgc{kubrusly2001}{352}{0817641742}{Proposition 5.34}
  }
\label{thm:orthog==>linin}
%--------------------------------------
Let $\setxn{\vx_n\in\setX}$ be a set of vectors in an \structe{inner product space}
\xref{def:inprod} $\inprodspaceX$.
\thmbox{
  \brb{\begin{array}{N}
    $\setn{\vx_n}$ is \prope{orthogonal}
    \\\xref{def:orthog}
  \end{array}}
  \quad\implies\quad
  \brb{\begin{array}{N}
    $\setn{\vx_n}$ is \prope{linearly independent}
    \\\xref{def:lincombo}
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Proof using \thme{Pythagorean theorem}\ifsxref{vsinprod}{thm:pythag}:
    \\Let $\seqxZp{\alpha_n}$ be a sequence with at least one nonzero element.
    \\\begin{align*}
        \norm{\sum_{n=1}^\xN \alpha_{n} \vx_n}^2
          &= \sum_{n=1}^\xN \norm{\alpha_{n} \vx_n}^2
          && \text{by left hypoth. and \thme{Pythagorean Theorem}}
          && \text{\ifxref{vsinprod}{thm:pythag}}
        \\&= \sum_{n=1}^\xN \abs{\alpha_n}^2\norm{\vx_n}^2
          && \text{by definition of $\normn$}
          && \text{\xref{def:norm}}
        \\&> 0
        \\\implies \sum_{n=1}^\xN \alpha_{n} \vx_{n} &\neq 0
        \\\implies \seqxZp{\vx_n} &\text{ is \prope{linearly independent}}
          && \text{by definition of \prope{linear independence}}
          && \text{\xref{def:linin}}
      \end{align*}

  \item Alternative proof:
    \begin{align*}
      \sum_{n=1}^\xN \alpha_n\vx_{n} = \vzero
        &\implies  \inprod{\sum_{n=1}^\xN \alpha_n\vx_n}{\vx_m} = \inprod{\vzero}{\vx_m}
      \\&\implies  \sum_{n=1}^\xN \alpha_n\inprod{\vx_n}{\vx_m} = 0
      \\&\implies  \sum_{n=1}^\xN \alpha_n\kdelta(k-m) = 0
      \\&\implies  \alpha_m = 0 \qquad \text{for $m=1,2,\ldots,\xN$}
    \end{align*}

\end{enumerate}
\end{proof}


%--------------------------------------
\begin{theorem}[\thmd{Bessel's Equality}]
\footnote{
  \citerpg{bachman2002}{103}{9780387988993},
  \citerppg{pedersen2000}{38}{39}{0849371694}
  }
\label{thm:bessel_eq}
\index{equalities!Bessel's}
%--------------------------------------
Let $\setxn{\vx_n\in\setX}$ be a set of vectors in an \structe{inner product space} \xrefP{def:inprod} $\inprodspaceX$ and with
$\norm{\vx}\eqd\sqrt{\inprod{\vx}{\vx}}$\ifsxref{vsinprod}{def:norm=inprod}.
\thmbox{
  \brb{\begin{array}{N}
    $\setn{\vx_n}$ is \prope{orthonormal}
    \\\xref{def:orthog}
  \end{array}}
  \quad\implies\quad
  \brb{
    \mcom{\norm{\vx-\sum_{n=1}^\xN \inprod{\vx}{\vx_n} \vx_{n} }^2}{approximation error}
      = \norm{\vx}^2 - \sum_{n=1}^\xN |\inprod{\vx}{\vx_n}|^2
    \quad\scy \forall \vx\in\setX
    }
  }
\end{theorem}
\begin{proof}
\begin{align*}
  &\norm{\vx-\sum_{n=1}^\xN \inprod{\vx}{\vx_n} \vx_{n} }^2
  \\&=    \norm{\vx}^2
          + \norm{\sum_{n=1}^\xN \inprod{\vx}{\vx_n} \vx_{n} }^2
          - 2\Real{\inprodr{\vx}{\sum_{n=1}^\xN \inprod{\vx}{\vx_n}\vx_n}}
    && \text{by \thme{polar identity}}
    && \text{\ifxref{vsinprod}{lem:polarid}}
  \\&=    \norm{\vx}^2
          + \norm{\sum_{n=1}^\xN \inprod{\vx}{\vx_n} \vx_{n} }^2
          - 2\Real\left[\left(\sum_{n=1}^\xN \inprod{\vx}{\vx_n}\right)^\ast\;\inprod{\vx}{\vx_n}\right]
    &&    \text{by property of $\inprodn$}
    &&    \text{\xref{def:inprod}}
  \\&=    \norm{\vx}^2
          + \sum_{n=1}^\xN \norm{\inprod{\vx}{\vx_n} \vx_{n} }^2
          - 2\Real\left[\left(\sum_{n=1}^\xN \inprod{\vx}{\vx_n}\right)^\ast\;\inprod{\vx}{\vx_n}\right]
    &&    \text{by \thme{Pythagorean Theorem}}
    &&    \text{\ifxref{vsinprod}{thm:pythag}}
  \\&=    \norm{\vx}^2
          + \sum_{n=1}^\xN \norm{\inprod{\vx}{\vx_n} \vx_{n} }^2
          - 2\Real\left(\sum_{n=1}^\xN \inprod{\vx}{\vx_n}^\ast\;\inprod{\vx}{\vx_n}\right)
    &&    \ifdochas{numsys}{\text{by \prefp{thm:conj}}}
  \\&=    \norm{\vx}^2
          + \sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2\; \mcom{\norm{\vx_{n} }^2}{$1$}
          - 2\Real\left(\sum_{n=1}^\xN \inprod{\vx}{\vx_n}^\ast\;\inprod{\vx}{\vx_n}\right)
    &&    \text{by property of $\normn$}
    &&    \text{\xref{def:norm}}
  \\&=    \norm{\vx}^2
          + \sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2\; \cdot 1
          - 2\Real\left(\sum_{n=1}^\xN \inprod{\vx}{\vx_n}^\ast\;\inprod{\vx}{\vx_n}\right)
    &&    \text{by def. of \prope{orthonormality}} % \{def:orthog}
    &&    \text{\xref{def:orthog}}
  \\&=    \norm{\vx}^2
          + \sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2
          - 2\Real\sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2
    &&    \ifdochas{numsys}{\text{by \prefp{thm:C_abs}}}
  \\&=    \norm{\vx}^2
          + \sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2
          - 2\sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2
   %&&    \text{by definition of $\Real$ \ifdochas{normalg}{\prefpo{def:nalg_Re}}}
    &&    \text{because $\absn$ is real}
  \\&=    \norm{\vx}^2
          - \sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2
\end{align*}
\end{proof}


%--------------------------------------
\begin{theorem}[\thmd{Bessel's inequality}]
\footnote{
  \citerppgc{giles2000}{54}{55}{0521653754}{3.13 Bessel's inequality},
  \citerpg{bollobas1999}{147}{0521655773},
  \citerpg{ab}{284}{0120502577}
  %\citerpp{pedersen2000}{38}{39}
  }
\label{thm:bessel_ineq}
\index{inequality!Bessel's}
%--------------------------------------
Let $\setxn{\vx_n\in\setX}$ be a set of vectors in an \structe{inner product space} \xrefP{def:inprod} $\inprodspaceX$ and with
$\norm{\vx}\eqd\sqrt{\inprod{\vx}{\vx}}$\ifsxref{vsinprod}{def:norm=inprod}.
\thmbox{
  \brb{\begin{array}{N}
   $\setn{\vx_n}$ is \prope{orthonormal}
   \\\xref{def:orthog}
  \end{array}}
  \quad\implies\quad
  \brb{\begin{array}{>{\ds}rc>{\ds}lC}
    \sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2 &\le& \norm{\vx}^2 & \forall \vx\in\setX
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{align*}
  0
    &\le \norm{\vx-\sum_{n=1}^\xN \inprod{\vx}{\vx_n} \vx_{n} }^2
    &&   \text{by definition of $\normn$}
    &&   \text{\xref{def:norm}}
  \\&=   \norm{\vx}^2 - \sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2
    &&   \text{by \thme{Bessel's Equality}}
    &&   \text{\xref{thm:bessel_eq}}
\end{align*}
\end{proof}

%--------------------------------------
\begin{theorem}
\label{thm:bat_frame}
%--------------------------------------
Let $\setxn{\vx_n\in\setX}$ be a set of vectors in an \structe{inner product space} \xrefP{def:inprod} $\inprodspaceX$ and with
$\norm{\vx}\eqd\sqrt{\inprod{\vx}{\vx}}$\ifsxref{vsinprod}{def:norm=inprod}.
\thmbox{
  \brb{\text{$\seqn{\alpha_k}$ is \prope{real-valued}}}
  \quad\implies\quad
  \alpha_{k} \norm{\vx_k}^2
    = \Real\inprod{\vx}{\vx_k} - \sum_{m\neq k} \alpha_{m} \inprod{\vx_k}{\vx_m}
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item lemma: \label{ilem:batframe_normvx}
        $\ds\pderiv{}{\alpha_k} \norm{\vx}^2 = 0$ because $\norm{\vx}^2$ does not vary with varying $\alpha_k$.

  \item lemma: \label{ilem:batframe_inprod}
    \begin{align*}
      \pderiv{}{\alpha_k}\inprod{\vx}{\sum_{n=1}^\xN \alpha_{n} \vx_n}
        &= \pderiv{}{\alpha_k}\sum_{n=1}^\xN \alpha^\ast_{n}\inprod{\vx}{\vx_n}
      \\&= \brp{\pderiv{}{\alpha_k}\sum_{n=1}^\xN \alpha_{n}\inprod{\vx}{\vx_n}^\ast}^\ast
      \\&= \brp{\inprod{\vx}{\vx_k}^\ast}^\ast
      \\&= \inprod{\vx}{\vx_k}
    \end{align*}

  \item  lemma: \label{ilem:batframe_norm}
    \begin{align*}
      \pderiv{}{\alpha_k} \norm{\sum_{n=1}^\xN \alpha_{n} \vx_n}^2
        &= \pderiv{}{\alpha_k} \inprod{\sum_{n=1}^\xN \alpha_{n} \vx_n}{\sum_{m=1}^\xN \alpha_{m} \vx_m}
      \\&= \pderiv{}{\alpha_k} \sum_{n=1}^\xN \sum_{m=1}^\xN \alpha_{n}\alpha^\ast_{m}\inprod{\vx_n}{\vx_m}
      \\&= \pderiv{}{\alpha_k} \sum_{n=1}^\xN \alpha_{n}\alpha^\ast\norm{\vx_n}^2
         + \pderiv{}{\alpha_k} \sum_{n=1}^\xN \sum_{m\neq n} \alpha_{n}\alpha^\ast_{m} \inprod{\vx_n}{\vx_m}
      \\&= 2\alpha_{k}\norm{\vx_k}^2
         + \pderiv{}{\alpha_k} \sum_{m\neq n} 2\alpha_{k}\alpha^\ast_{m}\inprod{\vx_n}{\vx_m}
      \\&= 2\alpha_{k} \norm{\vx_k}^2
         + 2\sum_{m\neq n} \alpha^\ast_{m}\inprod{\vx_k}{\vx_m}
    \end{align*}

  \item Proof that $\ds\alpha_{k} \norm{\vx_k}^2 = \Real\inprod{\vx}{\vx_k} - \sum_{m\neq k} \alpha_{m}\inprod{\vx_k}{\vx_m}$
    \begin{align*}
      0
        &= \frac{1}{2}\cdot0
      \\&= \frac{1}{2}\pderiv{}{\alpha_k} \norm{ \vx - \sum_{n=1}^\xN \alpha_{n} \vx_{n} }^2
      \\&= \cancelto{0}{\frac{1}{2}\pderiv{}{\alpha_k} \norm{\vx}^2}
          -\frac{2}{2}\Real\brs{\pderiv{}{\alpha_n}{\inprod{\vx}{\sum_{n=1}^\xN \alpha_{n} \vx_n}}}
          +\pderiv{}{\alpha_k} \frac{2}{2}\norm{\sum_{n=1}^\xN \alpha_{n} \vx_n}^2
        && \text{by \thme{Polar Identity}}
        && \text{\xref{lem:polarid}}
      \\&= 0
           - \Real\brs{\inprod{\vx}{\vx_k}}
           + \alpha_{k} \inprod{\vx_k}{\vx_k}
           + \sum_{m\neq k} \alpha^\ast_{m}\inprod{\vx_k}{\vx_m}
      \\&= - \Real\inprod{\vx}{\vx_k}
           + \alpha_{k} \norm{\vx_k}^2
           + \sum_{m\neq k} \alpha_{m}\inprod{\vx_k}{\vx_m}
    \end{align*}

  \item Note in the special case of $\seqn{\vx_n}$ being \prope{orthonormal}\ldots
    \begin{align*}
        \alpha_{k}
          &= \frac{1}{\cancelto{1}{\norm{\vx_k}}^2}\brs{\Real\brs{\inprod{\vx}{\vx_k}}
           - \sum_{m\neq k} \alpha_{m}\inprod{\vx_k}{\vx_m}}
        \\&= \frac{1}{1}\brs{\Real\brs{\inprod{\vx}{\vx_k}}
           - \sum_{m\neq k} \alpha_{m}\cancelto{0}{\inprod{\vx_k}{\vx_m}}}
        \\&= \Real\inprod{\vx}{\vx_k}
    \end{align*}
\end{enumerate}
\end{proof}

\pref{thm:bat_frame} (previous) demonstrates that in the case where $\seqn{\vx_n}$ is \prope{orthonormal}
and $\seqn{\alpha_k}$ is \propb{real-valued}, then the best $\alpha_k$ in the least square sense
is simply equal to the projection $\inprod{\vx}{\vx_k}$.
The \thme{Best Approximation Theorem} (next) shows that in the case of the \prope{orthonormal} $\seqn{\vx_n}$,
\begin{liste}
  \item the constraint on $\seqn{\alpha_k}$ can actually be dropped ($\seqn{\alpha_k}$ can be complex)
  \item the error of the projection is orthogonal to the projection.
\end{liste}

%--------------------------------------
\begin{theorem}[\thmd{Best Approximation Theorem}]
\footnote{
  \citerpp{walter}{3}{4},
  \citerp{pedersen2000}{39},
  \citerpp{edwards1995}{94}{100},
  \citor{weyl1940}
  }
\label{thm:bat}
%--------------------------------------
Let $\setxn{\vx_n\in\setX}$ be a set of vectors in an \structe{inner product space} \xref{def:inprod} $\inprodspaceX$ and with
$\norm{\vx}\eqd\sqrt{\inprod{\vx}{\vx}}$\ifsxref{vsinprod}{def:norm=inprod}.
\thmbox{
  \brb{\begin{array}{N}
  $\setn{\vx_n}$ is\\
  \prope{orthonormal}\\
  \xref{def:orthog}
  \end{array}}
  \quad\implies\quad
  \brb{\begin{array}{F>{\ds}l@{\quad}CD}
    1. & \arg\min_{\seq{\alpha_n}{n=1}^\xN} \norm{ \vx - \sum_{n=1}^\xN \alpha_{n} \vx_{n} }
         = \mcoml{\seq{\inprod{\vx}{\vx_n}}{n=1}^\xN}{best $\alpha_n=\inprod{\vx}{\vx_n}$}
       & \forall\vx\in\setX
       & and
    \\[1ex]
    2. & \mcom{\ds\brp{     \sum_{n=1}^\xN \inprod{\vx}{\vx_n}\vx_{n} }}{approximation}
         \orthog
         \mcom{\ds\brp{\vx- \sum_{n=1}^\xN \inprod{\vx}{\vx_n}\vx_{n} }}{approximation error}
       & \forall\vx\in\setX
       &
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
\item Proof that $\seqn{\inprod{\vx}{\vx_n}}$ is the best sequence:
\begin{align*}
  &\norm{ \vx - \sum_{n=1}^\xN \alpha_{n} \vx_{n} }^2
  \\&= \norm{\vx}^2
      -2\Real{\inprod{\vx}{\sum_{n=1}^\xN \alpha_{n} \vx_n}}
      +\norm{\sum_{n=1}^\xN \alpha_{n} \vx_n}^2
    && \text{by \thme{Polar Identity}}
    && \text{\xref{lem:polarid}}
  \\&= \norm{\vx}^2
      -2\Real\left(\sum_{n=1}^\xN \alpha_n^\ast \inprod{\vx}{\vx_n}\right)
      +\sum_{n=1}^\xN \norm{\alpha_{n} \vx_n}^2
    && \text{by \thme{Pythagorean Theorem}}
    && \text{\ifxref{vsinprod}{thm:pythag}}
  \\&= \mathrlap{\norm{\vx}^2
      -2\Real\left(\sum_{n=1}^\xN \alpha_n^\ast \inprod{\vx}{\vx_n}\right)
      +\sum_{n=1}^\xN \abs{\alpha_n}^2\cancelto{1}{\norm{\vx}}^2
      +\mcom{\Bigg[
       \sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2
      -\sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2
      \Bigg]}{0}}
  \\&= \mathrlap{\left[
       \norm{\vx}^2
      -\sum_{n=1}^\xN |\inprod{\vx}{\vx_n}|^2
       \right]
      +\sum_{n=1}^\xN \left[
        \abs{\inprod{\vx}{\vx_n}}^2
       -2\Real\brs{\alpha_n^\ast \inprod{\vx}{\vx_n}}
       + \abs{\alpha_n}^2
       \right]}
  \\&= \mathrlap{\left[
       \norm{\vx}^2
      -\sum_{n=1}^\xN |\inprod{\vx}{\vx_n}|^2
       \right]
      +\sum_{n=1}^\xN \left[
        |\inprod{\vx}{\vx_n}|^2
       -\alpha_n^\ast \inprod{\vx}{\vx_n}
       -\alpha_{n} \inprod{\vx}{\vx_n}^\ast
       + |\alpha_n|^2
       \right]}
  \\&= \norm{\vx -\sum_{n=1}^\xN \inprod{\vx}{\vx_n}\vx_{n} }^2
      +\sum_{n=1}^\xN |\inprod{\vx}{\vx_n} - \alpha_{n} |^2
    && \text{by \thme{Bessel's Equality}}
    && \text{\xref{thm:bessel_eq}}
  \\&\ge \norm{\vx -\sum_{n=1}^\xN \inprod{\vx}{\vx_n}\vx_{n} }^2
\end{align*}


\item Proof that the approximation and approximation error are orthogonal:
\begin{align*}
  \inprod{\sum_{n=1}^\xN\inprod{\vx}{\vx_n}\vx_n}{\vx-\sum_{n=1}^\xN\inprod{\vx}{\vx_n}\vx_n}
    &= \inprod{\sum_{n=1}^\xN\inprod{\vx}{\vx_n}\vx_n}{\vx}
      -\inprod{\sum_{n=1}^\xN\inprod{\vx}{\vx_n}\vx_n}
              {\sum_{n=1}^\xN\inprod{\vx}{\vx_n}\vx_n}
  \\&= \sum_{n=1}^\xN\inprod{\vx}{\vx_n}^\ast \inprod{\vx}{\vx_n}
      -\sum_{n=1}^\xN \sum_{m=1}^\xN
       \inprod{\vx}{\vx_n} \inprod{\vx}{\vx_m}^\ast
       \inprod{\vx_n}{\vx_m}
  \\&= \sum_{n=1}^\xN |\inprod{\vx}{\vx_n}|^2
      -\sum_{n=1}^\xN \sum_{m=1}^\xN
       \inprod{\vx}{\vx_n} \inprod{\vx}{\vx_m}^\ast
       \kdelta_{nm}
  \\&= \sum_{n=1}^\xN |\inprod{\vx}{\vx_n}|^2
      -\sum_{n=1}^\xN |\inprod{\vx}{\vx_n}|^2
  \\&= 0
\end{align*}
\end{enumerate}
\end{proof}


%=======================================
\section{Orthonormal bases in Hilbert spaces}
\label{sec:hspace_bases}
%=======================================



%--------------------------------------
\begin{definition}
\label{def:basis_ortho}
\index{orthogonal}
\index{orthonormal}
\index{basis!orthonormal}
\index{basis!orthogonal}
%--------------------------------------
Let $\setxn{\vx_n\in\setX}$ be a set of vectors in an \structe{inner product space} \xrefP{def:inprod} $\spO\eqd\inprodspaceX$.
\defbox{\begin{array}{M}
  The set $\setn{\vx_n}$ is an \structd{orthogonal basis} for $\spO$ if $\setn{\vx_n}$ is \prope{orthogonal} and is \\\qquad
    a \structe{Schauder basis} for $\spO$.
  \\
  The set $\setn{\vx_n}$ is an \structd{orthonormal basis} for $\spO$ if $\setn{\vx_n}$ is \prope{orthonormal} and is \\\qquad
   a \structe{Schauder basis} for $\spO$.
\end{array}}
\end{definition}


%%--------------------------------------
%\begin{definition}
%\label{def:biorthogonal_basis}
%\label{def:biorthonormal_basis}
%\index{orthogonal}
%\index{orthonormal}
%\index{basis!biorthonormal}
%\index{basis!biorthogonal}
%%--------------------------------------
%Let $\spV\eqd\opair{\spX}{\inprodn}$ be an inner product space.
%\defbox{\begin{array}{l@{\qquad}ll@{\qquad}C@{\qquad}D}
%  \mc{5}{l}{\text{
%    A \hid{biorthogonal basis} for $\spV\eqd\opair{\spX}{\inprodn}$
%    is any pair of sets $(\setPhi,\setTh)$ that satisfies
%    }}
%  \\& 1. & \spV = \linspan \setTh
%         &
%         & ($\setTh$ generates $\spV$)
%  \\& 2. & \inprod{\vx_n}{\vy_m} = 0 \text{ for } m\ne n
%         & \forall \vx_n\in\setPhi,\; \vy_m\in\setTh
%         & ($(\setPhi,\setTh)$ is biorthogonal)
%  \\
%  \mc{5}{l}{\text{
%    A \hid{biorthonormal basis} for $\spV\eqd\opair{\spX}{\inprodn}$
%    is any pair of sets $(\setPhi,\setTh)$ that satisfies
%    }}
%  \\& 1. & \spV = \linspan \setTh
%         &
%         & ($\setTh$ generates $\spV$)
%  \\& 2. & \inprod{\vx_n}{\vy_m} =
%           \left\{\begin{array}{ll}
%             0 & \text{ for } m\ne n \\
%             1 & \text{ for } m=n
%           \end{array}\right.
%         & \forall \vx_n\in\setPhi,\; \vy_m\in\setTh
%         & ($(\setPhi,\setTh)$ is biorthonormal)
%\end{array}}
%\end{definition}

%--------------------------------------
\begin{definition}
\footnote{
  \citerpgc{fabian2010}{27}{1441975144}{Theorem 1.55},
  \citerpg{young2001}{6}{0127729550},
  \citerpg{young1980}{6}{0127728503}
  }
\index{orthonormal expansion}
\index{Fourier expansion}
\label{def:hspace_fex}
\label{def:fcoef}
\label{def:fex}
%--------------------------------------
Let $\spH\eqd\inprodspaceX$ be a Hilbert space.
\defbox{\begin{array}{M}
  Suppose there exists a set $\ds\setxZp{\vx_n\in\setX}$ such that $\ds\vx\eqs\sum_{n=1}^\infty \inprod{\vx}{\vx_n} \vx_n$.\\
  Then the quantities $\inprod{\vx}{\vx_n}$ are called the \hid{Fourier coefficients} of $\vx$
  and the sum \\
  $\ds\sum_{n=1}^\infty \inprod{\vx}{\vx_n} \vx_n$ is called the \hid{Fourier expansion} of $\vx$ or the \hid{Fourier series} for $\vx$.
  \end{array}}
\end{definition}

\ifdochasnot{vsinprod}{
%---------------------------------------
\begin{definition}
\label{def:kdelta}
%---------------------------------------
\defbox{\begin{array}{M}
The \fnctd{Kronecker delta function} $\hxs{\kdelta_n}$ is defined as
  \qquad
  $\ds\kdelta_n\eqd
    \brbl{\begin{array}{cMD}
      1 & for $n=0$ & and \\
      0 & otherwise
    \end{array}}
  \qquad\scy
  \forall n\in\Z$
\end{array}}
\end{definition}
}

%--------------------------------------
\begin{lemma}[\thmd{Perfect reconstruction}]
\label{lem:Hfex}
%--------------------------------------
Let $\setxZp{\vx_n\in\setX}$ be a set of vectors in a \structe{Hilbert space} \ifxref{seq}{def:hilbert} $\spH\eqd\HspaceX$.
\lembox{
  \brb{\begin{array}{FMD}
    (1).&{$\seqn{\vx_n}$ is a \structe{basis} for $\spH$} & and\\
    (2).&{$\seqn{\vx_n}$ is \prope{orthonormal}}
  \end{array}}
  \qquad\implies\qquad
  \vx \eqs \ocom{\sum_{n=1}^\infty \mcom{\inprod{\vx}{\vx_n}}{Fourier coefficient}\vx_n}{Fourier expansion} \qquad\scy\forall\vx\in\setX
  }
\end{lemma}
\begin{proof}
  \begin{align*}
    \inprod{\vx}{\vx_n}
      &= \inprod{\sum_{m\in\Z} \alpha_m \vx_m}{\vx_n}
      && \text{by left hypothesis (1)}
    \\&= \sum_{m\in\Z} \alpha_m \inprod{\vx_m}{\vx_n}
      && \text{by \prope{homogeneous} property of $\inprodn$}
      && \text{\xref{def:inprod}}
    \\&= \sum_{m\in\Z} \alpha_m \kdelta_{n-m}
      && \text{by left hypothesis (2)}
      && \text{\xref{def:orthog}}
    \\&= \alpha_n
  \end{align*}
\end{proof}

%--------------------------------------
\begin{proposition}
\footnote{
  \citerppgc{han2007}{93}{94}{0821842129}{Proposition 3.11}
  }
\label{prop:parseval_reconstruction}
%--------------------------------------
Let $\setxZp{\vx_n\in\setX}$ be a set of vectors in a \structe{Hilbert space} \ifxref{seq}{def:hilbert}\\
$\spH\eqd\HspaceX$.
\propbox{\ds
  \mcom{\ds\norm{\vx}^2 \eqs\sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2}{\ide{Parseval frame}}
  \qquad\iff\qquad
  \mcom{\ds\vx\eqs\sum_{n=1}^\infty \inprod{\vx}{\vx_n}\vx_n}{\ide{Fourier expansion} \xref{def:fex}}
  \qquad\scy\forall\vx\in\setX
  }
\end{proposition}
\begin{proof}
\begin{enumerate}
  \item Proof that \ide{Parseval frame} $\impliedby$   \ide{Fourier expansion}
    \begin{align*}
      \norm{\vx}^2
        &\eqd \inprod{\vx}{\vx}
        && \text{by definition of $\normn$}
        && \text{\ifxref{vsnorm}{def:norm}}
      \\&= \inprod{\sum_{n=1}^\infty \inprod{\vx}{\vx_n}\vx}{\vx_n}
        && \text{by right hypothesis}
      \\&\eqs\sum_{n=1}^\infty \inprod{\vx}{\vx_n}\inprod{\vx}{\vx_n}
        && \text{by property of $\inprodn$}
        && \text{\ifxref{vsinprod}{def:inprod}}
      \\&\eqs\sum_{n=1}^\infty \inprod{\vx}{\vx_n}\inprod{\vx}{\vx_n}^\ast
        && \text{by property of $\inprodn$}
        && \text{\ifxref{vsinprod}{def:inprod}}
      \\&\eqs\sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2
        && \text{by property of $\C$}
        && \text{\ifxref{normalg}{def:cstar}}
    \end{align*}

  \item Proof that \ide{Parseval frame} $\implies$ \ide{Fourier expansion}  % 2017December21UTC; 2013 July 27 Saturday
    \begin{enumerate}
      \item Let $\seqxZp{\ve_n}$ be the \structe{standard othornormal basis} such that the $n$th element of $\ve_n$ is $1$ and all other elements are $0$.  \label{item:parseval_reconstruction_en}
      \item Let $\opM$ be an operator in $\spH$ such that $\ds\opM\vx\eqd\sum_{n=1}^\infty\inprod{\vx}{\vx_n}\ve_n$. \label{item:parseval_reconstruction_Mdef}
      \item lemma: $\opM$ is \prope{isometric}. Proof: \label{ilem:parseval_reconstruction_Miso}
        \begin{align*}
          \norm{\opM\vx}^2
            &= \norm{\sum_{n=1}^\infty \inprod{\vx}{\vx_n}\ve_n}^2
            && \text{by definition of $\opM$}&&\text{\xref{item:parseval_reconstruction_Mdef}}
          \\&= \sum_{n=1}^\infty \norm{\inprod{\vx}{\vx_n}\ve_n}^2
            && \text{by \thme{Pythagorean Theorem}}&&\text{\ifxref{vsinprod}{thm:pythag}}
          \\&= \sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2\norm{\ve_n}^2
            && \text{by \prope{homogeneous} property of $\normn$}&&\text{\xref{def:norm}}
          \\&= \sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2
            && \text{by definition of \prope{orthonormal}}&&\text{\xref{def:orthog}}
          \\&= \norm{\vx}^2
            && \text{by Parseval frame hypothesis}
          \\&\implies \quad\text{$\opM$ is \prope{isometric}}
            && \text{by definition of \prope{isometric}}&&\text{\ifsxref{operator}{def:op_isometric}}
        \end{align*}

      \item Let $\seqxZp{\vu_n}$ be an \structe{orthornormal basis} for $\spH$.  \label{item:parseval_reconstruction_un}
      \item Proof for \ide{Fourier expansion}:
        \begin{align*}
          \vx
            &= \sum_{n=1}^\infty \inprod{\vx}{\vu_n}\vu_n
            && \text{by \thme{Fourier expansion} \xref{prop:hspace_fex}}
          \\&= \sum_{n=1}^\infty \inprod{\opM\vx}{\opM\vu_n}\vu_n
            && \text{by \prefp{ilem:parseval_reconstruction_Miso}\ifdochas{operator}{ and \prefp{thm:isometric_equiv}}}
          \\&= \sum_{n=1}^\infty \inprod{\sum_{m=1}^\infty\inprod{\vx}{\vx_m}\ve_m}{\sum_{k=1}^\infty\inprod{\vu_n}{\vx_k}\ve_k}\vu_n
            && \text{by \prefp{item:parseval_reconstruction_Mdef}}
          \\&= \sum_{n=1}^\infty \sum_{m=1}^\infty\inprod{\vx}{\vx_m} \sum_{k=1}^\infty\inprod{\vu_n}{\vx_k}^\ast \inprod{\ve_m}{\ve_k}\vu_n
            && \text{by \prefp{def:inprod}}
          \\&= \sum_{n=1}^\infty \sum_{m=1}^\infty\inprod{\vx}{\vx_m} \inprod{\vu_n}{\vx_m}^\ast \vu_n
            && \text{by \prefp{item:parseval_reconstruction_en} and \prefp{def:orthog}}
          \\&= \sum_{n=1}^\infty \sum_{m=1}^\infty\inprod{\vx}{\vx_m} \inprod{\vx_m}{\vu_n} \vu_n
            && \text{by \prefp{def:inprod}}
          \\&= \sum_{m=1}^\infty \inprod{\vx}{\vx_m} \sum_{n=1}^\infty \inprod{\vx_m}{\vu_n} \vu_n
          \\&= \sum_{m=1}^\infty \inprod{\vx}{\vx_m} \vx_m
            && \text{by \prefp{item:parseval_reconstruction_un}}
        \end{align*}
    \end{enumerate}
\end{enumerate}
\end{proof}


%A set of orthonormal vectors may or may not span (form a basis for)
%a linear space $\spL$.
%Dedending on whether the set spans $\spL$,
%the norm of a vector is related to its projections on the members of the set
%by an inequality (set is not a basis) or by an equality (set is a basis):
%
%\begin{tabular}{llll}
%  Not a basis: &
%  $\norm{\vx}^2 \ge \sum_{n=1}^\xN |\inprod{\vx}{\vx_n}|^2$ &
%  \hie{Bessel's Inequality} \index{inequality!Bessel's} &
%  \scriptsize(\prefp{thm:bessel_ineq})
%\\
%  Is a basis: &
%  $\norm{\vx}^2 = \sum_{n=1}^\xN |\inprod{\vx}{\vx_n}|^2$ &
%  \hie{Plancherel's Equality}  &
%  \scriptsize(\prefp{thm:plancherel})
%\end{tabular}

When is a set of orthonormal vectors in a Hilbert space $\spH$ \prope{total}?
\pref{thm:parsevalid} (next) offers some help.
%\hie{Parseval's Identity} (\prefp{thm:plancherel}) demonstrates that if a sequence $\seqxZp{\vx_n}$ is
%\prope{orthonormal}, then $\norm{\vx}^2 \eqs\sum_{n=1}^\infty \left|\inprod{\vx}{\vx_n}\right|^2$.
%But the converse ($\seqxZp{\vx_n}$ \prope{orthonormal} $\impliedby$ $\norm{\vx}^2 \eqs\sum_{n=1}^\infty \left|\inprod{\vx}{\vx_n}\right|^2$)
%is \emph{not} true.
%That is, it is possible to have a set of vectors that satisfies Parseval's Identity, but yet are not \prope{orthonormal}.
%Such a set is illustrated in \pref{ex:mercedesA1} (next).%
%--------------------------------------
\begin{theorem}[\thmd{The Fourier Series Theorem}] %[\thmd{Parseval's Identity}]
\footnote{
  \citerppgc{bachman1966}{149}{155}{0486402517}{Theorem 9.12},
  \citerppgc{kubrusly2001}{360}{363}{0817641742}{Theorem 5.48},
  \citerppgc{ab}{298}{299}{0120502577}{Theorem 34.2},
  \citerpgc{christensen2003}{57}{0817642951}{Theorem 3.4.2},
  \citerppgc{berberian1961}{52}{53}{0821819127}{Theorem II\textsection8.3},
  \citerppgc{heil2011}{34}{35}{0817646868}{Theorem 1.50},
  \citerpgc{bracewell1978}{112}{007007013X}{Rayleigh's theorem}
  %\citerpg{bollobas1999}{147}{0521655773},
  %\citerp{mallat}{595}
  }
\label{thm:fst}
\label{thm:plancherel}
\label{thm:parsevalid}
\label{thm:parseval}
%--------------------------------------
Let $\setxZp{\vx_n\in\setX}$ be a set of vectors in a \structe{Hilbert space} \ifxref{seq}{def:hilbert} $\spH\eqd\HspaceX$ and let
$\norm{\vx}\eqd\sqrt{\inprod{\vx}{\vx}}$\ifsxref{vsinprod}{def:norm=inprod}.
\thmboxt{
  ${\scy(A)}$ $\setn{\vx_n}$ is \prope{orthonormal} in $\spH$
  $\qquad\implies\qquad$
  \\%\indentx
  $\brb{\begin{array}{cFrc>{\ds}lCD}
           & (1). & \cls{(\linspan\setn{\vx_n})} &=&    \spH                                                          &                        & ($\setn{\vx_n}$ is \prope{total} in $\spH$)
    \\\iff & (2). & \inprod{\vx}{\vy}    &\eqs& \sum_{n=1}^\infty \inprod{\vx}{\vx_n}\inprod{\vy}{\vx_n}^\ast & \forall\vx,\vy\in\spX  & (\thme{Generalized Parseval's Identity})
    \\\iff & (3). & \norm{\vx}^2         &\eqs& \sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2                 & \forall\vx\in\setX     & (\thme{Parseval's Identity})
    \\\iff & (4). & \vx                  &\eqs& \sum_{n=1}^\infty \inprod{\vx}{\vx_n}\vx_n                    & \forall\vx\in\setX     & (\thme{Fourier series expansion})
  \end{array}}$
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Proof that (1)$\implies$(2):
    \begin{align*}
      \inprod{\vx}{\vy}
        &\eqs \inprod{\sum_{n=1}^\infty \inprod{\vx}{\vx_n} \vx_n}
                     {\sum_{m=1}^\infty \inprod{\vy}{\vx_m} \vx_m}
        &&\text{by (A) and (1)}
      \\&\eqs \sum_{n=1}^\infty \inprod{\vx}{\vx_n} \inprod{ \vx_n}
             {\sum_{m=1}^\infty \inprod{\vy}{\vx_m} \vx_m}
        &&\text{by property of $\inprod{\cdot}{\cdot}$}
        &&\text{\xref{def:inprod}}
      \\&\eqs \sum_{n=1}^\infty \inprod{\vx}{\vx_n} \sum_{m=1}^\infty \inprod{\vy}{\vx_m}^\ast
            \inprod{ \vx_n}{ \vx_m}
        &&\text{by property of $\inprod{\cdot}{\cdot}$}
        &&\text{\xref{def:inprod}}
      \\&\eqs \sum_{n=1}^\infty \inprod{\vx}{\vx_n} \sum_{m=1}^\infty \inprod{\vy}{\vx_m}^\ast
            \kdelta_{mn}
        &&\text{by (A)}
      \\&\eqs \sum_{n=1}^\infty \inprod{\vx}{\vx_n} \inprod{\vy}{\vx_n}^\ast
        &&\text{by definition of $\kdelta_n$}
        &&\text{\xref{def:kdelta}}
    \end{align*}

  \item Proof that (2)$\implies$(3):
    \begin{align*}
      \norm{\vx}^2
        &\eqd \inprod{\vx}{\vx}
        &&    \text{by definition of \fncte{induced norm}}
        &&    \text{\ifxref{vsinprod}{thm:inducednorm}}
      \\&=    \sum_{n=1}^\infty \inprod{\vx}{\vx_n} \inprod{\vx}{\vx_n}^\ast
        &&    \text{by (2)}
      \\&=    \sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2
        &&    \ifdochas{numsys}{\text{by \prefp{thm:C_abs}}}
    \end{align*}

  \item Proof that (3)$\iff$(4) \emph{not} using (A): by \prefp{prop:parseval_reconstruction}

  \item Proof that (3)$\implies$(1) (proof by contradiction):
    \begin{enumerate}
      \item Suppose $\setn{\vx_n}$ is \prope{not total}.
      \item Then there must exist a vector $\vy$ in $\spH$ such that the set $\setB\eqd\setn{\vx_n}\setu\vy$ is \prope{orthonormal}.
      \item Then $\ds 1=\norm{y}^2 \neq \sum_{n=1}^\infty \abs{\inprod{\vy}{\vx_n}}^2 = 0$ .
      \item But this contradicts (3), and so $\setn{\vx_n}$ must be \prope{total} and (3)$\implies$(1).
    \end{enumerate}

  \item Extraneous proof that (3)$\implies$(4) (this proof is not really necessary here):
    \begin{align*}
      \norm{\vx - \sum_{n=1}^\infty \inprod{\vx}{\vx_n} \vx_{n} }^2
        &=  \norm{\vx}^2 -\sum_{n=1}^\infty |\inprod{\vx}{\vx_n}|^2
        &&  \text{by \thme{Bessel's Equality}}
        && \text{\xref{thm:bessel_eq}}
      \\&=  0
        &&  \text{by (3)}
      \\&\implies\quad \vx\eqs\sum_{n=1}^\infty\inprod{\vx}{\vx_n}\vx_n
        && \text{by definition of $\eqs$}
        && \text{\ifxref{series}{def:eqs}}
    \end{align*}

  \item Extraneous proof that (A)$\implies$(4) (this proof is not really necessary here)
    \begin{enumerate}
      \item The sequence
            $\sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2$
            is {\em monotonically increasing} in $n$.
      \item By Bessel's inequality (\prefpo{thm:bessel_ineq}),
            the sequence is upper bounded by $\norm{\vx}^2$:
           \[ \sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2 \le \norm{\vx}^2 \]
      \item Because this sequence is both monotonically increasing and bounded in $n$,
            it must equal its bound in the limit as $n$ approaches infinity:
           \begin{eqnarray}
             \lim_{\xN\to\infty} \sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2
             = \norm{\vx}^2
             \label{eq:plancherel1}
           \end{eqnarray}
      \item If we combine this result with \thme{Bessel's Equality} \xref{thm:bessel_eq} we have
        \begin{align*}
          \lim_{\xN\to\infty}
          \norm{ \vx - \sum_{n=1}^\xN \inprod{\vx}{\vx_n} \vx_{n} }^2
            &=  \norm{\vx}^2 -
                \lim_{\xN\to\infty}
                \sum_{n=1}^\xN |\inprod{\vx}{\vx_n}|^2
            &&  \text{by \thme{Bessel's Equality} \xref{thm:bessel_eq}}
          \\&=  \norm{\vx}^2 - \norm{\vx}^2
            &&  \text{by \prefp{eq:plancherel1}}
          \\&=  0
        \end{align*}
    \end{enumerate}
\end{enumerate}
\end{proof}

%--------------------------------------
\begin{proposition}[\thmd{Fourier expansion}]
\index{orthonormal expansion}
\label{prop:hspace_fex}
%--------------------------------------
Let $\setxZp{\vx_n\in\setX}$ be a set of vectors in a \structe{Hilbert space} \ifxref{seq}{def:hilbert}\\$\HspaceX$.
\propbox{
  \mcom{\begin{array}{M}
    $\setn{\vx_n}$ is an
    \structe{orthonormal basis} for $\spH$
  \end{array}}{(A)}
  \quad\implies\quad
  \Bigg\{
  \mcom{\vx \eqs \sum_{n=1}^\infty \alpha_{n} \vx_n}{(1)}
  \quad\iff\quad
  \mcom{\alpha_{n} = \inprod{\vx}{\vx_n}}{(2)}
  \Bigg\}
  }
\end{proposition}
\begin{proof}
\begin{enumerate}
  \item Proof that (1)$\implies$(2): by \prefp{lem:Hfex}
    %\begin{align*}
    %  \inprod{\vx}{\vx_n}
    %    &= \inprod{\sum_{m\in\Z} \alpha_m \vx_m}{\vx_n}
    %    && \text{by (A)}
    %  \\&= \sum_{m\in\Z} \alpha_m \inprod{\vx_m}{\vx_n}
    %  \\&= \sum_{m\in\Z} \alpha_m \kdelta_{n-m}
    %  \\&= \alpha_n
    %\end{align*}

  \item Proof that (1)$\impliedby$(2): %by \prefp{thm:fst}
    \begin{align*}
  \norm{ \vx - \sum_{n=1}^\infty \alpha_{n} \vx_{n\in\Z} }^2
    &=  \norm{ \vx - \sum_{n=1}^\infty \inprod{\vx}{\vx_n} \vx_{n\in\Z} }^2
    &&  \text{by right hypothesis}
  \\&=  \norm{\vx}^2 -\sum_{n=1}^\infty |\inprod{\vx}{\vx_n}|^2
    &&  \text{by Bessel's equality}&&\text{\xref{thm:bessel_eq}}
  \\&=  0
    &&  \text{by \thme{Parseval's Identity}}&&\text{\xref{thm:fst}}
  \\&\iffdef\quad \vx \eqs \sum_{n=1}^\infty \inprod{\vx}{\vx_n}\vx_n
    && \text{by definition of \prope{strong convergence}}&&\text{\ifxref{series}{def:eqs}}
    \end{align*}
\end{enumerate}
\end{proof}

%--------------------------------------
\begin{proposition}[\thmd{Riesz-Fischer Theorem}]
\footnote{
  \citerpg{young2001}{6}{0127729550}
  }
\label{prop:rft}
%--------------------------------------
Let $\setxZp{\vx_n\in\setX}$ be a set of vectors in a \structe{Hilbert space} \ifxref{seq}{def:hilbert}\\$\HspaceX$.
\propbox{
  \mcom{\begin{array}{M}
    $\setn{\vx_n}$ is an\\
    \structe{orthonormal basis}\\
    for $\spH$
  \end{array}}{(A)}
  \quad\implies\quad
  \Bigg\{
  \mcom{\sum_{n=1}^\infty \abs{\alpha_{n}}^2<\infty}{(1)}
  \quad\iff\quad
  \mcom{{\begin{array}{l}
    \scy\exists\vx\in\spH\st\\
    \alpha_{n} = \inprod{\vx}{\vx_n}
  \end{array}}}{(2)}
  \Bigg\}
  }
\end{proposition}
\begin{proof}
\begin{enumerate}
  \item Proof that (1)$\implies$(2):
    \begin{enumerate}
      \item If (1) is true, then let $\ds\vx\eqd\sum_{n\in\Zp}\alpha_n\vx_n$.
      \item Then
        \begin{align*}
            \inprod{\vx}{\vx_n} &= \inprod{\sum_{m\in\Zp}\alpha_m\vx_m}{\vx_n}
                                && \text{by definition of $\vx$}
                              \\&=    \sum_{m\in\Zp}\alpha_m \inprod{\vx_m}{\vx_n}
                                && \text{by \prope{homogeneous} property of $\inprodn$}&&\text{\xref{def:inprod}}
                              \\&=    \sum_{m\in\Zp}\alpha_m \kdelta_{mn}
                                &&  \text{by (A)}
                              \\&=    \sum_{m\in\Zp}\alpha_n
                                &&  \text{by definition of $\kdelta$}&&\text{\xref{def:kdelta}}
        \end{align*}
    \end{enumerate}

  \item Proof that (1)$\impliedby$(2):
    \begin{align*}
      \sum_{n\in\Zp}\abs{\alpha_n}^2
        &= \sum_{n\in\Zp}\abs{\inprod{\vx}{\vx_n}}^2
        && \text{by (2)}
      \\&\le \norm{\vx}^2
        && \text{by \thme{Bessel's Inequality}}&&\text{\xref{thm:bessel_ineq}}
      \\&\le \infty
    \end{align*}
\end{enumerate}
\end{proof}

%--------------------------------------
\begin{theorem}
\footnote{
  \citerpg{young2001}{6}{0127729550}
  }
\label{thm:sepHiso}
%--------------------------------------
%Let $\spH$ be a \structe{Hilbert space}\ifsxref{seq}{def:hilbert}.
\thmboxt{
  All \structe{separable Hilbert spaces} are \prope{isomorphic}. That is,
  \\
  $\brb{\begin{array}{MD}
    $\spX$ is a separable\\Hilbert space & and \\
    $\spY$ is a separable\\Hilbert space &
  \end{array}}
  \implies
  \brb{\begin{array}{FlclCD}
    \mc{6}{M}{there is a \prope{bijective} operator $\opM\in\clOxy$ such that}\\
      %\quad(1). $\opM$ is \prope{bijective} operator in $\clOxy$
      \quad(1). & \vy               &=& \opM\vx                   & \forall \vx\in\spX,\, \vy\in\spY & and\\
      \quad(2). & \norm{\opM\vx}    &=& \norm{\vx}                & \forall \vx\in\spX               & and\\
      \quad(3). & \inprod{\opM\vx}{\opM\vy} &=& \inprod{\vx}{\vy} & \forall \vx\in\spX,\, \vy\in\spY &
  \end{array}}$
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Let $\spX\eqd\HspaceX$ be a \structe{separable Hilbert space} with \structe{orthonormal basis} $\setxZp{\vx_n}$.\label{item:sepHiso_X}
      \\Let $\spY\eqd\HspaceY$ be a \structe{separable Hilbert space} with \structe{orthonormal basis} $\setxZp{\vy_n}$.\label{item:sepHiso_Y}

  \item Proof that there exists \structe{bijective} operator $\opM$ and its inverse $\opMi$ between $\setn{\vx_n}$ and $\setn{\vy_n}$:
    \begin{enumerate}
      \item Let $\opM$ be defined such that $\vy_n\eqd\opM\vx_n$.\label{item:sepHiso_M}
      \item Thus $\opM$ is a \structe{bijection} between $\setn{\vx_n}$ and $\setn{\vy_n}$.
      \item Because $\opM$ is a \prope{bijection} between $\setn{\vx_n}$ and $\setn{\vy_n}$,
            $\opM$ has an inverse operator $\opMi$ between $\setn{\vx_n}$ and $\setn{\vy_n}$
            such that $\vx_n=\opMi\vy_n$.\label{item:sepHiso_Mi}
    \end{enumerate}

  \item Proof that $\opM$ and $\opMi$ are \structe{bijective} operators between $\spX$ and $\spY$:
    \begin{enumerate}
      \item Proof that $\opM$ maps  $\spX$ \prope{into} $\spY$:
        \begin{align*}
          \vx\in\spX
            &\iff \vx\eqs\sum_{n\in\Zp}\inprod{\vx}{\vx_n}\vx_n
            && \text{by \thme{Fourier expansion}}&&\text{\xref{thm:fst}}
          \\&\implies \exists\vy\in\spY \st \inprod{\vy}{\vy_n}=\inprod{\vx}{\vx_n}
            && \text{by \thme{Riesz-Fischer Thm.}}&&\text{\xref{prop:rft}}
          \\&\implies
          \\\vy
            &= \sum_{n\in\Zp}\inprod{\vy}{\vy_n}\vy_n
            && \text{by \thme{Fourier expansion}}&&\text{\xref{thm:fst}}
          \\&= \sum_{n\in\Zp}\inprod{\vx}{\vx_n}\vy_n
            && \text{by \thme{Riesz-Fischer Thm.}}&&\text{\xref{prop:rft}}
          \\&= \sum_{n\in\Zp}\inprod{\vx}{\vx_n}\opM\vx_n
            && \text{by definition of $\opM$}&&\text{\xref{item:sepHiso_M}}
          \\&= \opM\sum_{n\in\Zp}\inprod{\vx}{\vx_n}\vx_n
            && \text{by prop. of {linear ops.}}
            &&\text{\ifsxref{operator}{thm:L_prop}}
          \\&= \opM\vx
            && \text{by definition of $\vx$}
        \end{align*}

      \item Proof that $\opMi$ maps $\spY$ \prope{into} $\spX$:
        \begin{align*}
          \vy\in\spY
            &\iff \vy\eqs\sum_{n\in\Zp}\inprod{\vy}{\vy_n}\vy_n
            && \text{by \thme{Fourier expansion}}
            &&\text{\xref{thm:fst}}
          \\&\implies \exists\vx\in\spX \st \inprod{\vx}{\vx_n}=\inprod{\vy}{\vy_n}
            && \text{by \thme{Riesz-Fischer Thm.}}
            &&\text{\xref{prop:rft}}
          \\&\implies
          \\\vx
            &= \sum_{n\in\Zp}\inprod{\vx}{\vx_n}\vx_n
            && \text{by \thme{Fourier expansion}}
            &&\text{\xref{thm:fst}}
          \\&= \sum_{n\in\Zp}\inprod{\vy}{\vy_n}\vx_n
            && \text{by \thme{Riesz-Fischer Thm.}}
            &&\text{\xref{prop:rft}}
          \\&= \sum_{n\in\Zp}\inprod{\vy}{\vy_n}\opMi\vy_n
            && \text{by definition of $\opMi$}
            &&\text{\xref{item:sepHiso_Mi}}
          \\&= \opMi\sum_{n\in\Zp}\inprod{\vy}{\vy_n}\vy_n
            && \text{by prop. of \structe{linear ops.}}
            &&\text{\ifsxref{operator}{thm:L_prop}}
          \\&= \opMi\vy
            && \text{by definition of $\vy$}
        \end{align*}
    \end{enumerate}

  \item Proof for (2):
    \begin{align*}
      \norm{\opM\vx}^2
        &= \norm{\opM\sum_{n\in\Zp}\inprod{\vx}{\vx_n}\vx_n}^2
        && \text{by \thme{Fourier expansion}}&&\text{\xref{thm:fst}}
      \\&= \norm{\sum_{n\in\Zp}\inprod{\vx}{\vx_n}\opM\vx_n}^2
        && \text{by property of \structe{linear operators}}&&\text{\ifxref{operator}{thm:L_prop}}
      \\&= \norm{\sum_{n\in\Zp}\inprod{\vx}{\vx_n}\vy_n}^2
        && \text{by definition of $\opM$}&&\text{\xref{item:sepHiso_M}}
      \\&= \sum_{n\in\Zp}\abs{\inprod{\vx}{\vx_n}}^2
        && \text{by \thme{Parseval's Identity}}&&\text{\xref{prop:rft}}
      \\&= \norm{\sum_{n\in\Zp}\inprod{\vx}{\vx_n}\vx_n}^2
        && \text{by \thme{Parseval's Identity}}&&\text{\xref{prop:rft}}
      \\&= \norm{\vx}^2
            && \text{by \thme{Fourier expansion}}&&\text{\xref{thm:fst}}
    \end{align*}

  \item Proof for (3): by (2)\ifdochas{operator}{ and \prefp{thm:op_inprodiso}}
\end{enumerate}
\end{proof}

%--------------------------------------
\begin{theorem}
\footnote{
  %\citerpgc{heil2011}{21}{0817646868}{Theorem 1.27}\\
  \citerpgc{bachman2002}{112}{9780387988993}{3.4.8},
  \citerpgc{berberian1961}{53}{0821819127}{Theorem II\textsection8.3}
  }
\label{thm:schauder<==>separable}
%--------------------------------------
Let $\spH$ be a \structe{Hilbert space}\ifsxref{seq}{def:hilbert}.
\thmbox{\begin{array}{M}
  $\spH$ has a \structe{Schauder basis}
  $\qquad\iff\qquad$
  $\spH$ is \prope{separable}
  %If $\opair{\spO}{\normn}$ is an \prope{inner product} space then
  %   \\\indentx $\exists$ an \prope{orthonormal} sequence $\seqxZp{\vx_n}$ that is \prope{complete} in $\spO$ $\iff$ $\setX$ is \prope{separable}.
  \end{array}}
\end{theorem}

%--------------------------------------
\begin{theorem}
\footnote{
  \citerpgc{kubrusly2001}{357}{0817641742}{Proposition 5.43}
  }
\label{thm:ortho<==>separable}
%--------------------------------------
Let $\spH$ be a \structe{Hilbert space}.
\thmbox{\begin{array}{M}
  $\spH$ has an \structe{orthonormal basis}
  $\qquad\iff\qquad$
  $\spH$ is \prope{separable}
  \end{array}}
\end{theorem}

%=======================================
\section{Riesz bases in Hilbert spaces}
%=======================================
%--------------------------------------
\begin{definition}
\footnote{
  \citerpgc{young2001}{27}{0127729550}{Definition 1.8.2},
  \citerpgc{christensen2003}{63}{0817642951}{Definition 3.6.1},
  \citerpgc{heil2011}{196}{0817646868}{Definition 7.9}
  }
\label{def:basis_riesz}
\index{basis!Riesz}
%--------------------------------------
Let $\setxZp{\vx_n\in\setX}$ be a set of vectors in a \structe{separable Hilbert space}\ifsxref{seq}{def:hilbert}
$\spH\eqd\HspaceX$.
\defboxt{
  $\setn{\vx_n}$ is a \hid{Riesz basis} for $\spH$ if
  $\setn{\vx_n}$ is \prope{equivalent} \xref{def:equivalent}\\
  to some \structe{orthonormal basis} \xref{def:basis_ortho} in $\spH$. %\footnotemark
  }
\end{definition}
%\footnotetext{\prope{equivalent}: \xref{def:equivalent}; \structe{orthonormal basis}: \xref{def:basis_ortho}}

%--------------------------------------
\begin{definition}
\footnote{
  %\citerpgc{young2001}{27}{0127729550}{Theorem 1.8.9},
  \citerppgc{christensen2003}{66}{68}{0817642951}{page 68 and (3.24) on page 66},
  %\citerppgc{heil2011}{197}{198}{0817646868}{Theorem 7.13},
  \citerpgc{wojtaszczyk1997}{20}{0521578949}{Definition 2.6}%
  }
\label{def:rieszseq}
%--------------------------------------
Let $\seqxZp{\vx_n\in\setX}$ be a sequence of vectors in a \structe{separable Hilbert space}\ifsxref{seq}{def:hilbert}\\
$\spH\eqd\HspaceX$.
\defboxt{
  The sequence $\seqn{\vx_n}$ is a \fnctd{Riesz sequence} for $\spH$ if
    \\\qquad
    $\ds\exists A,B\in\Rp \st\qquad
    A{\sum_{n=1}^\infty \abs{\alpha_n}^2}
    \le
    \norm{\sum_{n=1}^\infty \alpha_n\vx_n}^2
    \le
    B{\sum_{n=1}^\infty \abs{\alpha_n}^2}
    \qquad\scy\forall\seqn{\alpha_n}\in\spllF.$
 %  \\
 %A \structe{Riesz sequence} $\setn{\vx_n}$ for $\spH$ is a \hid{Riesz basis} for $\spH$ if $\linspan\setn{\vx_n}=\spH$.
%  The quantities $A$ and $B$ are \hid{frame bounds}.
%  \\The quantity $A'$ is the \hid{optimal lower frame bound} if
%  \\\qquad $A'=\sup\set{A\in\Rp}{\text{$A$ is a lower frame bound}}$.
%  \\The quantity $B'$ is the \hid{optimal upper frame bound} if
%  \\\qquad $B'=\inf\set{B\in\Rp}{\text{$B$ is an upper frame bound}}$.
%  \\A frame is a \hid{tight frame} if $A=B$.
%  \\A frame is a \hid{normalized tight frame} (or a \hid{Parseval frame}) if $A=B=1$.
%  \\A frame $\setxZp{\vx_n}$ is an \hid{exact frame} if for some $m\in\Z$, $\setxZp{\vx_n}\setd\setn{\vx_m}$ is \emph{not} a frame.
  }
\end{definition}

%--------------------------------------
\begin{definition}
\label{def:biortho}
%--------------------------------------
Let $\spX\eqd\inprodspaceX$ be an \structe{inner product space} \xref{def:inprod}.
\defboxt{
  The sequences $\seqxZ{\vx_n\in\setX}$ and $\seqxZ{\vy_n\in\setX}$ are \hid{biorthogonal}
  \\with respect to each other in $\spX$ if
  \indentx$\inprod{\vx_n}{\vy_m}=\kdelta_{nm}$
  }
\end{definition}


%%--------------------------------------
%\begin{theorem}
%\footnote{
%  \citerpgc{young2001}{27}{0127729550}{Theorem 1.8.9}
%  }
%\label{thm:rbasis_rseq}
%%--------------------------------------
%Let $\spH\eqd\HspaceX$ be a \structe{separable Hilbert space}\ifsxref{seq}{def:hilbert}.
%\thmbox{
%  \brb{\begin{array}{M}$\seqxZ{\vx_n}$ is a \structe{Riesz basis}\\for $\spH$\end{array}}
%  \quad\iff\quad
%  \brb{\begin{array}{FMD}
%    (1). & $\seqn{\vx_n}$ is a \structe{Riesz sequence} in $\spH$ & and\\
%    (2). & $\linspan\seqn{\vx_n}=\spH$
%  \end{array}}
%  }
%\end{theorem}

%%--------------------------------------
%\begin{theorem}
%%\footnote{
%%  \citerpgc{wojtaszczyk1997}{20}{0521578949}{Lemma 2.7(a)}
%%  }
%\label{thm:rbasis_eq}
%%--------------------------------------
%Let $\spH\eqd\HspaceX$ be a \structe{separable Hilbert space}\ifsxref{seq}{def:hilbert}.
%\thmbox{
%  \brb{\begin{array}{FMD}
%    (A). & $\seqxZ{\vx_n}$ is a \structe{Riesz basis} for $\spH$ & and\\
%    (B). & $\seqxZ{\vy_n}$ is a \structe{Riesz basis} for $\spH$
%  \end{array}}
%  \quad\implies\quad
%  \brb{\begin{array}{M}
%    $\seqn{\vx_n}$ and $\seqn{\vy_n}$ are \prope{isomorphic}  %with respect to each other & or equivalently\\
%    %(2). & There exists an \prope{isometric} operator $\opM$ such that $\vy_n=\opM\vx_n$ and $\vx_n=\opMi\vy_n$ $\forall n\in\Z$.
%  \end{array}}
%  }
%\end{theorem}
%\begin{proof}
%\begin{enumerate}
%  \item Let $\ve_n$ be the \structe{unit vector} in $\spH$ such that the $n$th element of $\ve_n$ is $1$ and all other elements are $0$.
%  \item Let $\opM$ be an operator on $\spH$ such that $\opM\ve_n=\vx_n$.
%  \item Note that $\opM$ is \prope{isometric}, and as such $\norm{\opM\vx}=\norm{\vx}\quad{\scy\forall\vx\in\spH}$.
%  \item Let $\vy_n\eqd\brp{\opMi}^\ast$. \label{prop:rbasis_xy_Mia}
%  \item Then,
%%        \begin{align*}
%%          \inprod{\vy_n}{\vx_m}
%%            &= \inprod{\brp{\opMi}^\ast\ve_n}{\opM\ve_m}
%%          \\&= \inprod{\ve_n}{\opMi\opM\ve_m}
%%          \\&= \inprod{\ve_n}{\ve_m}
%%          \\&= \kdelta_{nm}
%%          \\&\implies \text{$\setn{\vx_n}$ and $\setn{\vy_n}$ are \prope{biorthogonal}}
%%            && \text{by \prefp{def:orthog}}
%%        \end{align*}
%%
%%      \item Proof
%    \begin{align*}
%      \norm{\sum_{n\in\Z}\alpha_n \vy_n}
%        &= \norm{\sum_{n\in\Z}\alpha_n \brp{\opMi}^\ast\ve_n}
%        && \text{by definition of $\vy_n$ (\prefp{prop:rbasis_xy_Mia})}
%      \\&= \norm{\brp{\opMi}^\ast\sum_{n\in\Z}\alpha_n \ve_n}
%        && \text{by property of \structe{linear operator}s}
%      \\&= \norm{\sum_{n\in\Z}\alpha_n \ve_n}
%        && \text{because $\brp{\opMi}^\ast$ is \prope{isometric}}
%      \\&= \norm{\opM\sum_{n\in\Z}\alpha_n \ve_n}
%        && \text{because $\opM$ is \prope{isometric}}
%      \\&= \norm{\sum_{n\in\Z}\alpha_n \opM\ve_n}
%        && \text{by property of \structe{linear operator}s}
%      \\&= \norm{\sum_{n\in\Z}\alpha_n \vx_n}
%        && \text{by definition of $\opM$}
%      \\&\implies \text{$\setn{\vy_n}$ is a \structe{Riesz basis}}
%        &&  \text{by left hypothesis}
%    \end{align*}
%\end{enumerate}
%\end{proof}

%--------------------------------------
\begin{lemma}
\footnote{
  \citerppgc{christensen2003}{65}{66}{0817642951}{Lemma 3.6.5}
  }
\label{lem:xyextension}
%--------------------------------------
Let $\setxZp{\vx_n}$ be a sequence in a \structe{Hilbert space} $\spX\eqd\HspaceX$.
Let $\setxZp{\vy_n}$ be a sequence in a \structe{Hilbert space} $\spY\eqd\HspaceY$\ifsxref{seq}{def:hilbert}.
Let
\lemboxt{
  $\brb{\begin{array}{FMCD}
    (i).   & $\setn{\vx_n}$ is \prope{total} in $\spX$                                                                        &                               & and \\
    (ii).  & {\scs There exists $A>0$ such that} $\ds A\sum_{n\in\setC} \abs{a_n}^2\le\norm{\sum_{n\in\setC} a_n\vx_n}^2$    & \text{for finite $\setC$} & and \\
    (iii). & {\scs There exists $B>0$ such that} $\ds\norm{\sum_{n=1}^\infty b_n\vy_n}^2 \le B\sum_{n=1}^\infty\abs{b_n}^2$   & \forall \seqxZp{b_n}\in\spllF &
  \end{array}}\qquad\implies$
  \\
  $\brb{\begin{array}{FMD}
    (1).  & $\opRo$ is a linear bounded operator that maps from $\linspan\setn{\vx_n}$ to $\linspan\setn{\vy_n}$    &  \\
          & \indentx where $\ds\opRo\sum_{n\in\setC}c_n\vx_n \eqd \sum_{n\in\setC}c_n\vy_n$, for some sequence $\seqn{c_n}$ and finite set $\setC$ & and \\
    (2).  & $\opR$ has a unique extension to a bounded operator $\opR$ that maps from $\spX$ to $\spY$ & and \\
    (3).  & $\normop{\opRo}\le\frac{B}{A}$ & and \\
    (4).  & $\normop{\opR}\le\frac{B}{A}$
  \end{array}}$
}
\end{lemma}
%\begin{proof}
%\begin{enumerate}
%  \item Proof that $\opRo$ is \prope{linear}: this follows directly from its definition.
%  \item Proof that $\opRo$ is \prope{bounded}:
%    \begin{align*}
%      \normop{\opRo}
%        &\eqd \sup_{\vx\in\linspan\setn{\vx_n}}\set{\norm{\opRo\vx}}{\norm{\vx} \le 1}
%        &&    \text{by definition of $\normopn$ \xref{def:normop}}
%      \\&=    \sup_{\vx\in\linspan\setn{\vx_n}}\set{\norm{\opRo\sum_{n\in\setC}c_n\vx_n}}{\norm{\vx} \le 1}
%      \\&=    \sup_{\vx\in\linspan\setn{\vx_n}}\set{\norm{\sum_{n\in\setC}c_n\vy_n}}{\norm{\vx} \le 1}
%        &&    \text{by definition of $\opRo$ in (1)}
%      \\&\le  \sup_{\vx\in\linspan\setn{\vx_n}}\set{B\sum_{n\in\setC}\abs{c_n}^2}{\norm{\vx} \le 1}
%        &&    \text{by (iii)}
%      \\&\le  \sup_{\vx\in\linspan\setn{\vx_n}}\set{\frac{B}{A}\norm{\sum_{n\in\setC}\abs{c_n}\vx_n}^2}{\norm{\vx} \le 1}
%        &&    \text{by (ii)}
%    \end{align*}
%\end{enumerate}
%\end{proof}

%--------------------------------------
\begin{theorem}
\footnote{
  \citerpgc{young2001}{27}{0127729550}{Theorem 1.8.9},
  \citerpgc{christensen2003}{66}{0817642951}{Theorem 3.6.6},
  \citerppgc{heil2011}{197}{198}{0817646868}{Theorem 7.13},
  \citerppgc{christensen2008}{61}{62}{0817646779}{Theorem 3.3.7}
  }
\index{basis!Riesz}
\label{thm:rieszAB}
%--------------------------------------
Let $\setxZp{\vx_n\in\setX}$ be a set of vectors in a \structe{separable Hilbert space}\ifsxref{seq}{def:hilbert}\\
$\spH\eqd\HspaceX$.
\thmbox{%\begin{array}{>{\ds}l}
  \brb{\begin{array}{M}
    $\setn{\vx_n}$ is a \structe{Riesz basis}\\
    for $\spH$
  \end{array}}
  \quad\iff\quad
  \brb{\begin{array}{FMD}
    (1).  & $\setn{\vx_n}$ is \prope{total} in $\spH$
          & and
       \\
    %B. & $\setn{\vx_n}$ is a \structe{Riesz sequence} in $\spH$.
    (2).  & $\scy\exists A,B\in\Rp \st \quad\forall\seqn{\alpha_n}\in\spllF$,
        \\&  $\ds A{\sum_{n=1}^\infty \abs{\alpha_n}^2} \le \norm{\sum_{n=1}^\infty \alpha_n\vx_n}^2 \le B{\sum_{n=1}^\infty \abs{\alpha_n}^2}$
  \end{array}}
  %\\\qquad\iff\qquad
  %\brb{\begin{array}{FMD}
  %  (3A). & $\setn{\vx_n}$ is \prope{total} in $\spH$
  %        & and
  %        \\
  %  (3B). & $\ds \sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2 < \infty\qquad\scy\forall\vx\in\spH$
  %        & and
  %        \\
  %  (3C). & $\exists \setn{\vy_n}$ such that $\setn{\vy_n}$ is \prope{total} in $\spH$,
  %      \\& \prope{biorthogonal} with respect to to $\setn{\vx_n}$ and
  %      \\& $\ds \sum_{n=1}^\infty \abs{\inprod{\vx}{\vy_n}}^2 < \infty\qquad\scy\forall\vx\in\spH$.
  %\end{array}}
}
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Proof for ($\implies$) case:
    \begin{enumerate}
      \item Proof that \structe{Riesz basis} hypothesis $\implies$ (1): all bases for $\spH$ are \prope{total} in $\spH$.
      \item Proof that \structe{Riesz basis} hypothesis $\implies$ (2):
        \begin{enumerate}
          \item Let $\seqxZp{\vu_n}$ be an \structe{orthonormal basis} for $\spH$. \label{item:rieszAB_un}
          \item Let $\opR$ be a \prope{bounded bijective} operator such that $\vx_n=\opR\vu_n$. \label{item:rieszAB_R}
          \item Proof for upper bound $B$:
            \begin{align*}
              \norm{\sum_{n=1}^\infty \alpha_n\vx_n}^2
                &= \norm{\sum_{n=1}^\infty \alpha_n\opR\vu_n}^2
                && \text{by definition of $\opR$}
                && \text{\xrefn{item:rieszAB_R}}
              \\&= \norm{\opR\sum_{n=1}^\infty \alpha_n\vu_n}^2
                && \text{by \prefp{thm:L_prop}}
              \\&\le \normop{\opR}^2 \norm{\sum_{n=1}^\infty \alpha_n\vu_n}^2
                && \text{by \prefp{thm:LxLx}}
              \\&= \normop{\opR}^2 \sum_{n=1}^\infty \norm{\alpha_n\vu_n}^2
                && \text{by \thme{Pythagorean Theorem}}&&\text{\ifxref{vsinprod}{thm:pythag}}
              \\&= \normop{\opR}^2 \sum_{n=1}^\infty \abs{\alpha}^2 \norm{\vu_n}^2
                && \text{by \prope{homogeneous} property of norms}&&\text{\xref{def:norm}}
              \\&= \mcom{\normop{\opR}^2}{$B$} \sum_{n=1}^\infty \abs{\alpha}^2
                && \text{by definition of \prope{orthonormality}}&&\text{\xref{def:orthog}}
            \end{align*}

          \item Proof for lower bound $A$:
            \begin{align*}
              \norm{\sum_{n=1}^\infty \alpha_n\vx_n}^2
                &=   \frac{\normop{\opRi}^2}{\normop{\opRi}^2}\,\norm{\sum_{n=1}^\infty \alpha_n\vx_n}^2
               %&&   \text{because $\normop{\opRi}>0$ for $\opRi\neq\opZero$ \xref{prop:op_norm}}
                &&   \text{because $\normop{\opRi}>0$}&&\text{\xref{prop:op_norm}}
              \\&\ge \frac{1}{\normop{\opRi}^2}\,\norm{\opRi\sum_{n=1}^\infty \alpha_n\vx_n}^2
                &&   \text{by \prefp{thm:LxLx}}
              \\&=   \frac{1}{\normop{\opRi}^2}\,\norm{\opRi\sum_{n=1}^\infty \alpha_n\opR\vu_n}^2
                &&   \text{by definition of $\opR$}&&\text{\xref{item:rieszAB_R}}
              \\&=   \frac{1}{\normop{\opRi}^2}\,\norm{\opRi\opR\sum_{n=1}^\infty \alpha_n\vu_n}^2
                &&   \text{by property of \structe{linear operator}s}
                &&   \text{\xref{thm:L_prop}}
              \\&=   \frac{1}{\normop{\opRi}^2}\,\norm{\sum_{n=1}^\infty \alpha_n\vu_n}^2
                &&   \text{by definition of inverse op.}
                &&   \text{\ifxref{operator}{def:opI}}
              \\&=   \frac{1}{\normop{\opRi}^2}\,\sum_{n=1}^\infty \norm{\alpha_n\vu_n}^2
                &&   \text{by \thme{Pythagorean Theorem}}
                &&\text{\ifxref{vsinprod}{thm:pythag}}
              \\&=   \frac{1}{\normop{\opRi}^2}\,\sum_{n=1}^\infty \abs{\alpha_n}^2 \norm{\vu_n}^2
                &&   \text{by $\normn$ \prope{homogeneous} prop.}
                &&\text{\xref{def:norm}}
              \\&=   \mcom{\frac{1}{\normop{\opRi}^2}}{$A$}\,\sum_{n=1}^\infty \abs{\alpha_n}^2
                &&   \text{by def. of \prope{orthonormality}}
                &&\text{\xref{def:orthog}}
            \end{align*}
        \end{enumerate}
    \end{enumerate}
  \item Proof for ($\implies$) case:
    \begin{enumerate}
      \item Let $\setxZp{\vu_n}$ be an \structe{orthonormal basis} for $\spH$.
      \item Using (2) and \prefpp{lem:xyextension}, construct an bounded extension operator $\opR$ such that
            \\\indentx$\opR\vu_n=\vx_n$ for all $n\in\Zp$.
      \item Using (2) and \prefpp{lem:xyextension}, construct an bounded extension operator $\opS$ such that
            \\\indentx$\opS\vx_n=\vu_n$ for all $n\in\Zp$.
      \item Then, $\opR\opV\vx=\opV\opR\vx$ $\implies$ $\opV=\opRi$, and so $\opR$ is a bounded invertible operator
      \item and $\setn{\vx_n}$ is a \structe{Riesz sequence}.
    \end{enumerate}
\end{enumerate}
\end{proof}


%--------------------------------------
\begin{theorem}
\footnote{
  \citerpgc{wojtaszczyk1997}{20}{0521578949}{Lemma 2.7(a)}
  }
\label{thm:rbasis_xy}
%--------------------------------------
Let $\spH\eqd\HspaceX$ be a \structe{separable Hilbert space}\ifsxref{seq}{def:hilbert}.
\thmbox{
  \brb{\begin{array}{M}
    $\seqxZ{\vx_n\in\spH}$ is a\\
    \structe{Riesz basis} for $\spH$\\
    %$\ds A{\sum_{n=1}^\infty \abs{a_n}^2} \le \norm{\sum_{n=1}^\infty a_n\vx_n}^2 \le B{\sum_{n=1}^\infty \abs{a_n}^2}$\\
  \end{array}}
  \implies
  \brb{\begin{array}{cFMD}
    \mc{4}{M}{There exists $\seqxZ{\vy_n\in\spH}$ such that}\\
    & (1). & $\seqn{\vx_n}$ and $\seqn{\vy_n}$ are \prope{biorthogonal}  & and\\
    & (2). & $\seqn{\vy_n}$ is also a \structe{Riesz basis} for $\spH$   & and \\
    & (3). & ${\scy\exists B>A>0 \st}$ \\
    &      & \mc{2}{l}{\ds A{\sum_{n=1}^\infty \abs{a_n}^2} \le \norm{\sum_{n=1}^\infty a_n\vx_n}^2 = \norm{\sum_{n=1}^\infty a_n\vy_n}^2 \le B{\sum_{n=1}^\infty \abs{a_n}^2}}\\
    &      & $\scy\forall\seqxZp{a_n}\in\spllF$
  \end{array}}
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Proof for (1):
    \begin{enumerate}
      \item Let $\ve_n$ be the \structe{unit vector} in $\spH$ such that the $n$th element of $\ve_n$ is $1$ and all other elements are $0$.
      \item Let $\opM$ be an operator on $\spH$ such that $\opM\ve_n=\vx_n$.
      \item Note that $\opM$ is \prope{isometric}, and as such $\norm{\opM\vx}=\norm{\vx}\quad{\scy\forall\vx\in\spH}$.
      \item Let $\vy_n\eqd\brp{\opMi}^\ast$. \label{prop:rbasis_xy_Mia}
      \item Then,
        \begin{align*}
          \inprod{\vy_n}{\vx_m}
            &= \inprod{\brp{\opMi}^\ast\ve_n}{\opM\ve_m}
          \\&= \inprod{\ve_n}{\opMi\opM\ve_m}
          \\&= \inprod{\ve_n}{\ve_m}
          \\&= \kdelta_{nm}
          \\&\implies \text{$\setn{\vx_n}$ and $\setn{\vy_n}$ are \prope{biorthogonal}}
            && \text{by \prefp{def:orthog}}
        \end{align*}
    \end{enumerate}

  \item Proof for (3):
    \begin{align*}
      \norm{\sum_{n\in\Z}\alpha_n \vy_n}
        &= \norm{\sum_{n\in\Z}\alpha_n \brp{\opMi}^\ast\ve_n}
        && \text{by definition of $\vy_n$}&&\text{\xref{prop:rbasis_xy_Mia}}
      \\&= \norm{\brp{\opMi}^\ast\sum_{n\in\Z}\alpha_n \ve_n}
        && \text{by property of \structe{linear ops.}}
      \\&= \norm{\sum_{n\in\Z}\alpha_n \ve_n}
        && \text{because $\brp{\opMi}^\ast$ is \prope{isometric}}&&\text{\xref{def:op_isometric}}
      \\&= \norm{\opM\sum_{n\in\Z}\alpha_n \ve_n}
        && \text{because $\opM$ is \prope{isometric}}&&\text{\xref{def:op_isometric}}
      \\&= \norm{\sum_{n\in\Z}\alpha_n \opM\ve_n}
        && \text{by property of \structe{linear operator}s}
      \\&= \norm{\sum_{n\in\Z}\alpha_n \vx_n}
        && \text{by definition of $\opM$}
      \\&\implies \text{$\setn{\vy_n}$ is a \structe{Riesz basis}}
        &&  \text{by left hypothesis}
    \end{align*}

  \item Proof for (2): by (3) and definition of \structe{Riesz basis} \xref{def:basis_riesz}
\end{enumerate}
\end{proof}

%--------------------------------------
\begin{proposition}
\footnote{
  \citerpgc{igari1996}{220}{0821821040}{Lemma 9.8},
  \citerppgc{wojtaszczyk1997}{20}{21}{0521578949}{Lemma 2.7(a)}
  }
\label{prop:rbasis_frame}
%--------------------------------------
Let $\setxZp{\vx_n}$ be a set of vectors in a \structe{Hilbert space}\ifsxref{seq}{def:hilbert} $\spH\eqd\HspaceX$.
\propbox{
  \brb{\begin{array}{M}
    $\setn{\vx_n}$ is a \structe{Riesz basis} for $\spH$ with\\
    $\ds A{\sum_{n=1}^\infty \abs{a_n}^2} \le \norm{\sum_{n=1}^\infty a_n\vx_n}^2 \le B{\sum_{n=1}^\infty \abs{a_n}^2}$\\
    $\scy\forall\setn{a_n}\in\spllF$
  \end{array}}
  \implies
  \brb{\begin{array}{M}
    $\setn{\vx_n}$ is a \structe{frame} for $\spH$ with\\
    $\ds\mcom{\frac{1}{B}\norm{\vx}^2 \le {\sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2} \le  \frac{1}{A}\norm{\vx}^2}{\prope{stability condition}}$\\
    $\scy\forall\vx\in\spH$
  \end{array}}
  }
\end{proposition}
\begin{proof}
\begin{enumerate}
  \item Let $\setxZp{\vy_n}$ be a \structe{Riesz basis} that is \prope{biorthogonal} to $\setxZp{\vx_n}$ \xref{thm:rbasis_xy}.\label{item:rbasis_frame_yn}

  \item Let $\ds\vx\eqd\sum_{n=1}^\infty a_n\vy_n$. \label{item:rbasis_frame_x}

  \item lemma: %$\sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2=\sum_{n=1}^\infty \abs{a_n}^2$. Proof:
        \label{ilem:rbasis_frame_sum}
    \begin{align*}
      \sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2
        &= \sum_{n=1}^\infty \abs{\inprod{\sum_{m=1}^\infty a_n \vy_m}{\vx_n}}^2
        && \text{by definition of $\vx$}&&\text{\xref{item:rbasis_frame_x}}
      \\&= \sum_{n=1}^\infty \abs{\sum_{m=1}^\infty a_n \inprod{\vy_m}{\vx_n}}^2
        && \text{by \prope{homogeneous} property of $\inprodn$}&&\text{\xref{def:inprod}}
      \\&= \sum_{n=1}^\infty \abs{\sum_{m=1}^\infty a_n \kdelta_{mn}}^2
        && \text{by definition of \prope{biorthogonal}}&&\text{\xref{def:biortho}}
      \\&= \sum_{n=1}^\infty \abs{a_n}^2
        && \text{by definition of $\kdelta$}&&\text{\xref{def:kdelta}}
    \end{align*}

  \item Then\\
    $\begin{array}{r>{\ds}lc>{\ds}cc>{\ds}ll}
                 & A{\sum_{n=1}^\infty \abs{a_n}^2} &\le& \norm{\sum_{n=1}^\infty a_n\vx_n}^2 &\le& B{\sum_{n=1}^\infty \abs{a_n}^2}
                 & \text{by definition of $\setn{\vy_n}$ \xref{item:rbasis_frame_yn}}
      \\\implies & A{\sum_{n=1}^\infty \abs{a_n}^2} &\le& \norm{\sum_{n=1}^\infty a_n\vy_n}^2 &\le& B{\sum_{n=1}^\infty \abs{a_n}^2}
                 & \text{by definition of $\setn{\vy_n}$ \xref{item:rbasis_frame_yn}}
                %& \text{because $\setn{\vy_n}$ is a \structe{Riesz basis} \xref{thm:rbasis_xy}}
      \\\implies & A{\sum_{n=1}^\infty \abs{a_n}^2} &\le& \norm{\vx}^2 &\le& B{\sum_{n=1}^\infty \abs{a_n}^2}
                 & \text{by definition of $\vx$ \xref{item:rbasis_frame_x}}
      \\\implies & A{\sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2} &\le& \norm{\vx}^2 &\le& B{\sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2}
                 & \text{by \pref{ilem:rbasis_frame_sum}}
      \\\implies & \frac{1}{B}\norm{\vx}^2 &\le& {\sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2} &\le&  \frac{1}{A}\norm{\vx}^2
    \end{array}$
\end{enumerate}
\end{proof}

%--------------------------------------
\begin{theorem}[\thmd{Battle-Lemari{/'e} orthogonalization}]
\footnote{
  \citerpgc{wojtaszczyk1997}{25}{0521578949}{Remark 2.4},
  \citerp{vidakovic}{71},
  \citerp{mallat89}{72},
  \citerp{mallat}{225},
  \citerpgc{dau}{140}{0898712742}{(5.3.3)}
  }
\label{thm:blo}
%--------------------------------------
%Let $\spX$ be a Hilbert space.
Let $\Ff(\omega)$ be the \ope{Fourier Transform}\ifsxref{harFour}{def:ft} of a function $\ff\in\spLLR$.
\thmbox{
  \brb{\begin{array}{F>{\ds}lD}
    1. & \text{$\setxZ{\opTrn^n\fg}$ is a \structe{Riesz basis} for $\spLLR$} & and \\ \\
    2. & \Ff(\omega) \eqd \frac{\Fg(\omega)}{\sqrt{2\pi\ds\sum_{n\in\Z}\abs{\Fg(\omega+2\pi n)}^2}}
  \end{array}}
  \implies
  \brb{\begin{array}{M}%
    $\ds\setxZ{\opTrn^n\ff}$\\
    is an \structe{orthonormal basis} for $\spLLR$%
    \end{array}
    }%
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
\item Proof that $\setxZ{\opTrn^n\ff}$ is orthonormal:
\begin{align*}
  \Sphi(\omega)
    &= 2\pi\sum_{n\in\Z} \abs{\Ff(\omega+2\pi n)}^2
    && \text{by \prefp{thm:Swfg}}
  \\&= 2\pi\sum_{n\in\Z} \abs{\frac{\Fg(\omega+2\pi n)}{\sqrt{\ds2\pi\sum_{m\in\Z}\abs{\Fg(\omega+2\pi(n-m))}^2}}}^2
    && \text{by left hypothesis}
  \\&= \sum_{n\in\Z} \abs{\frac{\Fg(\omega+2\pi n)}{\sqrt{\ds\sum_{m\in\Z}\abs{\Fg(\omega+2\pi m)}^2}}}^2
  \\&= \sum_{n\in\Z} \abs{ \frac{1}{\sqrt{\ds\sum_{m\in\Z}\abs{\Fg(\omega+2\pi m)}^2}} }^2
               \abs{\Fg(\omega+2\pi n)}^2
  \\&= \frac{1}{\ds\sum_{m\in\Z}\abs{\Fg(\omega+2\pi m)}^2}
        \sum_{n\in\Z} \abs{\Fg(\omega+2\pi n)}^2
  \\&= 1
  \\ \implies & \text{$\setxZ{\ff_n}$ is orthonormal}
    && \text{by \prefp{thm:Swfgo}}
\end{align*}


\item Proof that $\setxZ{\opTrn^n\ff}$ is a basis for $\spV_0$: by \prefp{lem:bases_opFT}.

%\item Proof that $\setxZ{\opDil^m\opTrn^n\ff}$ is a basis for $\spV_m$: by \prefp{thm:V0Vn}.
\end{enumerate}
\end{proof}

%======================================
\section{Frames in Hilbert spaces}
%======================================


%--------------------------------------
\begin{definition}
\label{def:frame}
\footnote{
  \citerppg{young2001}{154}{155}{0127729550},
  \citerpgc{christensen2003}{88}{0817642951}{Definitions 5.1.1, 5.1.2},
  \citerppgc{heil2011}{204}{205}{0817646868}{Definition 8.2},
  \citerpgc{jorgensen2008}{267}{0817646825}{Definition 12.22},
  %\citerpgc{christensen2008}{3}{0817646779}{Definition 1.1.1},
  \citorp{duffin52}{343},
  \citerp{dgm86}{1272}
  }
\index{basis!frame}
\index{basis!tight frame}
%--------------------------------------
Let $\setxZp{\vx_n\in\setX}$ be a set of vectors in a \structe{Hilbert space}\ifsxref{seq}{def:hilbert}\\
$\spH\eqd\HspaceX$.
\defbox{\begin{array}{M}
  The set $\setn{\vx_n}$ is a \structd{frame} for $\spH$ if (\prope{stability condition})
    \\
    \qquad$\ds{\exists A,B\in\Rp \st
    \qquad A\norm{\vx}^2 \le \sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2 \le B\norm{\vx}^2\qquad\scy\forall\vx\in\setX}.$
    \\
  The quantities $A$ and $B$ are \hid{frame bounds}.
  \\The quantity $A'$ is the \hid{optimal lower frame bound} if
  \\\qquad $A'=\sup\set{A\in\Rp}{\text{$A$ is a lower frame bound}}$.
  \\The quantity $B'$ is the \hid{optimal upper frame bound} if
  \\\qquad $B'=\inf\set{B\in\Rp}{\text{$B$ is an upper frame bound}}$.
  \\A frame is a \structd{tight frame} if $A=B$.
  \\A frame is a \structd{normalized tight frame} (or a \structd{Parseval frame}) if $A=B=1$.
  \\A frame $\setxZp{\vx_n}$ is an \hid{exact frame} if for some $m\in\Z$, $\setxZp{\vx_n}\setd\setn{\vx_m}$ is \emph{not} a frame.
\end{array}}
\end{definition}




A frame is a \hie{Parseval frame} (\pref{def:frame}) if it satisfies \thme{Parseval's Identity} \xref{thm:plancherel}.
All orthonormal bases are Parseval frames \xref{thm:plancherel};
but not all Parseval frames are orthonormal bases. % \xrefP{ex:mercedesA1}.
%%--------------------------------------
%\begin{definition}
%\footnote{
%  \citerpgc{cohen2011}{28}{0817680942}{Definition 2.3},
%  \citerpgc{han2007}{92}{0821842129}{Definition 3.10}
%  }
%\label{def:frame_parseval}
%%--------------------------------------
%Let $\spH\eqd\HspaceX$ be a Hilbert space.
%\defbox{\ds
%  \text{A frame $\seqxZp{\vx_n}$ is a \hid{Parseval frame} in $\spH$ if}
%  \quad\mcom{\norm{\vx}^2 \eqs\sum_{n=1}^\infty \abs{\inprod{\vx}{\vx_n}}^2 \quad \forall\vx\in\setX}{\ide{Parseval's identity}}.
%  }
%\end{definition}

%--------------------------------------
\begin{definition}
%\footnote{
%  \citerpgc{cohen2011}{28}{0817680942}{Definition 2.3},
%  \citerpgc{han2007}{92}{0821842129}{Definition 3.10}
%  }
\label{def:frameop}
%--------------------------------------
Let $\setn{\vx_n}$ be a \structd{frame} \xref{def:frame}
for the \structe{Hilbert space}
\\$\spH\eqd\HspaceX$.
Let $\opS$ be an \ope{operator} on $\spH$.
\defboxt{
  $\opS$ is a \opd{frame operator} for $\setn{\vx_n}$ if
  \indentx$\ds\opS\ff(x) = \sum_{n\in\Z}\inprod{\ff}{\vx_n}\vx_n\qquad\scy\forall\ff\in\spH$.
  }
\end{definition}

%--------------------------------------
\begin{theorem}
\footnote{
  \citerppgc{christensen2008}{100}{102}{0817646779}{Theorem 5.1.7}
  }
\label{thm:frameop}
%--------------------------------------
Let $\opS$ be a \ope{frame operator} \xref{def:frameop}
of a \structe{frame} $\setn{\vx_n}$ \xref{def:frame}
for the \structe{Hilbert space} $\spH\eqd\HspaceX$.
\thmbox{\begin{array}{Frc>{\ds}lD}
  (1).& \mc{3}{M}{$\opS$ is \prope{invertible}.} & and\\
  (2).& \ff(x) &=& \sum_{n\in\Z}\inprod{\ff}{\opSi\vx_n}\vx_n
                =  \sum_{n\in\Z}\inprod{\ff}{\vx_n} \opSi\vx_n
                 & $\forall\ff\in\spH$
\end{array}}
\end{theorem}

%--------------------------------------
\begin{theorem}
\footnote{
  \citerpg{christensen2003}{3}{0817642951}
  }
%--------------------------------------
Let $\setxn{\vx_n\in\setX}$ be a set of vectors in a \structe{Hilbert space} \ifxref{seq}{def:hilbert}\\
$\spH\eqd\HspaceX$.
\thmbox{\text{
  $\setn{\vx_n}$ is a \structe{frame} for $\linspan\setn{\vx_n}$.
  }}
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Upper bound: Proof that there exists $B$ such that $\sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2\le B\norm{\vx}^2 \quad\forall \vx\in\spH$:
    \begin{align*}
      \sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2
        &\le \sum_{n=1}^\xN \inprod{\vx_n}{\vx_n} \inprod{\vx}{\vx}
        &&   \text{by \thme{Cauchy-Schwarz inequality} \ifxref{vsinprod}{thm:cs}}
      \\&=   \mcom{\brb{\sum_{n=1}^\xN \norm{\vx_n}^2}}{$B$} \norm{\vx}^2
    \end{align*}

  \item Lower bound: Proof that there exists $A$ such that $A\norm{\vx}^2\le\sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2\quad\forall\vx\in\spH$:
    \begin{align*}
      \sum_{n=1}^\xN \abs{\inprod{\vx}{\vx_n}}^2
        &= {\sum_{n=1}^\xN \abs{\inprod{\vx_n}{\frac{\vx}{\norm{\vx}}}}^2} \norm{\vx}^2
      \\&\ge \mcom{\brp{\inf_\vy\set{\sum_{n=1}^\xN \abs{\inprod{\vx_n}{\vy}}^2}{\norm{\vy}=1}}}{$A$} \norm{\vx}^2
    \end{align*}

\end{enumerate}
\end{proof}

%%--------------------------------------
%\begin{definition}
%\footnote{
%  \citerpg{christensen2003}{3}{0817642951}
%  }
%\label{def:frame_S}
%%--------------------------------------
%Let $\spH\eqd\inprodspaceX$ be a Hilbert space.
%\defbox{\text{
%  The \hid{synthesis operator} \;$\opT\in\clO{\F^\xN}{\setX}$ is defined such that $\opT\setxn{\alpha_n}\eqd\sum_{n=1}^\xN \alpha_{n} \vx_n$.
%  %Let the \hid{synthesis operator}$\opT$ be defined such that $\opT\vx\eqd\setxn{\alpha_n}$ and $\vx=\sum_{n=1}^\xN \alpha_{n} \vx_n$.
%  }}
%\end{definition}



%--------------------------------------
\begin{example}
\label{ex:frame_R2N}
% 2017 October 04 Wednesday
% Praise the Lord!!!
%--------------------------------------
Let $\inprodspace{\R^2}{+}{\cdot}{\R}{\dotplus}{\dottimes}{\inprodn}$ be an inner product space with
$\inprod{\vectxy{x_1}{y_1}}{\vectxy{x_2}{y_2}}\eqd x_1x_2+y_1y_2$.
Let $\opS$ be the \ope{frame operator} \xref{def:frameop} with \ope{inverse} $\opSi$.
\exboxt{%
  $\begin{array}{M}
    Let $\xN\in\setn{3,4,5,\ldots}$, $\theta\in\R$, and $r\in\Rp$ ($r>0$).\\
    Let $\vx_n\eqd r \vectxy{\cos(\theta+2n\pi/\xN)}{\sin(\theta+2n\pi/\xN)}$
    \quad${\forall\scy n\in\setn{0,1,\ldots,\xN-1}}$.\\
    Then, $\seqn{\vx_0,\vx_1,\ldots,\vx_{\xN-1}}$ is a \structb{tight frame} for $\R^2$ with
      \vale{frame bound} $A=\frac{\xN r^2}{2}$.
  \end{array}$\tbox{\includegraphics{../common/math/graphics/pdfs/frameR2N.pdf}}
  \\
  Moreover,\quad
  $\opS=\frac{\xN r^2}{2}\matIrr$,\quad
  $\opSi=\frac{2}{\xN r^2}\matIrr$,\quad
  and\quad
  $\ds\vv = \frac{2}{\xN r^2}\sum_{n=0}^{\xN-1} \inprod{\vv}{\vx_n} \vx_n$
          %\eqd \frac{2}{\xN r^2}\sum_{n=0}^{\xN-1} \brp{\vv^\opH\vx_n} \vx_n$
          \quad$\scy\forall\vv\in\R^2$.
  }
\end{example}
\begin{proof}

\begin{enumerate}
  \item Proof that $\seqn{\vx_0,\vx_1,\ldots,\vx_{\xN-1}}$ is a \prope{tight frame} with \vale{frame bound} $A=\frac{\xN r^2}{2}$:
        Let $\vv\eqd\opair{x}{y}\in\R^2$.
        \begin{align*}
          \sum_{n=0}^{\xN-1} \abs{\inprod{\vv}{\vx_n}}^2
            &\eqd \sum_{n=0}^{\xN-1} \abs{
                 \vv^\opH r
                 \brs{\begin{array}{c}\cos\brp{\theta+\frac{2n\pi}{\xN}}\\
                                      \sin\brp{\theta+\frac{2n\pi}{\xN}}\end{array}}
                 }^2
            && \text{by definitions of $\vv$ of $\inprod{\vy}{\vx}$}
          \\&\eqd \sum_{n=0}^{\xN-1} r^2 \abs{
                 x\cos\brp{\theta+\frac{2n\pi}{\xN}} +
                 y\sin\brp{\theta+\frac{2n\pi}{\xN}}
                 }^2
            && \text{by definition of $\vy^\opH\vx$ operation}
          \\&= \mathrlap{
               r^2x^2\sum_{n=0}^{\xN-1} \cos^2\brp{\theta+\frac{2n\pi}{\xN}}
             + r^2y^2\sum_{n=0}^{\xN-1} \sin^2\brp{\theta+\frac{2n\pi}{\xN}}
             + r^2xy \sum_{n=0}^{\xN-1} \cos\brp{\theta+\frac{2n\pi}{\xN}} \sin\brp{\theta+\frac{2n\pi}{\xN}}
             }
          \\&= r^2x^2\frac{\xN}{2} + r^2y^2\frac{\xN}{2} + r^2xy0
            && \text{by \prefp{cor:trig_circle}\hspace{23mm}\mbox{}}
          \\&= \brp{x^2+y^2}\frac{\xN r^2}{2}
             =    \brp{\frac{\xN r^2}{2}} \vv^\opH\vv
             \eqd \mcom{\brp{\frac{\xN r^2}{2}}}{$A$} \norm{\vv}^2
            && \text{by definition of $\norm{\vv}$}
        \end{align*}

   \item Proof that $\opS=\frac{\xN r^2}{2}\matIrr$: \label{item:frame_R2N_opS}
     \begin{enumerate}
       \item Let $\ve_1\eqd\brs{\begin{array}{c}1\\0\end{array}}$
             and $\ve_2\eqd\brs{\begin{array}{c}0\\1\end{array}}$.
             \label{item:frame_R2N_en}

       %\item Then $\begin{array}[t]{rcrcr}
       %              \vx_1 &=&                          & &        r    \ve_2
       %            \\\vx_n &=& -\frac{\sqrt{3}r}{2}\ve_1 &-& \frac{r}{2}\ve_2
       %            \\\vx_3 &=&  \frac{\sqrt{3}r}{2}\ve_1 &-& \frac{r}{2}\ve_2
       %            \end{array}$

       \item  lemma: $\opS\ve_1=\frac{\xN r^2}{2}\ve_1$. Proof: \label{ilem:frame_R2N_Se1}
         \begin{align*}
           \opS\ve_1
             &= \sum_{n=0}^{\xN-1} \inprod{\ve_1}{\vx_n}\vx_n
           \\&= \sum_{n=0}^{\xN-1} r\cos\brp{\theta+\frac{2n\pi}{\xN}}
                                   r\brs{\begin{array}{c}\cos\brp{\theta+\frac{2n\pi}{\xN}}\\
                                                        \sin\brp{\theta+\frac{2n\pi}{\xN}}\end{array}}
              = r^2\sum_{n=0}^{\xN-1} \brs{\begin{array}{c}
                                     \cos^2\brp{\theta+\frac{2n\pi}{\xN}}\\
                                     \cos\brp{\theta+\frac{2n\pi}{\xN}}\sin\brp{\theta+\frac{2n\pi}{\xN}}
                                   \end{array}}
           \\&= r^2\brs{\begin{array}{c} \xN/2\\ 0 \end{array}}
              = \frac{\xN r^2}{2}\ve_1
             \qquad\text{by \thme{Summation around unit circle} \xref{cor:trig_circle}}
           \end{align*}

       \item  lemma: $\opS\ve_2=\frac{\xN r^2}{2}\ve_2$. Proof: \label{ilem:frame_R2N_Se2}
         \begin{align*}
           \opS\ve_2
             &= \sum_{n=0}^{\xN-1} \inprod{\ve_2}{\vx_n}\vx_n
           \\&= \sum_{n=0}^{\xN-1} r\sin\brp{\theta+\frac{2n\pi}{\xN}}
                                   r\brs{\begin{array}{c}\cos\brp{\theta+\frac{2n\pi}{\xN}}\\
                                                         \sin\brp{\theta+\frac{2n\pi}{\xN}}\end{array}}
              = r^2\sum_{n=0}^{\xN-1} \brs{\begin{array}{c}
                                     \sin\brp{\theta+\frac{2n\pi}{\xN}}\cos\brp{\theta+\frac{2n\pi}{\xN}}\\
                                     \sin^2\brp{\theta+\frac{2n\pi}{\xN}}
                                   \end{array}}
           \\&= r^2\brs{\begin{array}{c} 0 \\ \xN/2 \end{array}}
              = \frac{\xN r^2}{2}\ve_2
             \qquad\text{by \thme{Summation around unit circle} \xref{cor:trig_circle}}
         \end{align*}

       \item Complete the proof of \pref{item:frame_R2N_opS} using
             \ope{Eigendecomposition} $\opS=\opQ\Lambda\opQi$: \label{item:frame_R2N_eigen}
         \begin{align*}
           \opS\ve_1 &= \frac{\xN r^2}{2}\ve_1
                     \qquad\text{by \pref{ilem:frame_R2N_Se2}}
                   \\&\implies\text{$\ve_1$ is an \fncte{eigenvector} of $\opS$ with \vale{eigenvalue} $\frac{\xN r^2}{2}$}
                   \\
           \opS\ve_2 &= \frac{\xN r^2}{2}\ve_2
                     \qquad\text{by \pref{ilem:frame_R2N_Se2}}
                   \\&\implies\text{$\ve_2$ is an \fncte{eigenvector} of $\opS$ with \vale{eigenvalue} $\frac{\xN r^2}{2}$}
                   \\
           \opS &= \ocom{\mcom{\brs{\begin{array}{cc}
                       |  &  |  \\
                     \ve_1&\ve_2\\
                       |  &  |
                    \end{array}}}{$\opQ$}
                    \mcom{\brs{\begin{array}{cc}
                      \frac{\xN r^2}{2} & 0\\
                      0            & \frac{\xN r^2}{2}
                    \end{array}}}{$\Lambda$}
                   \mcom{\brs{\begin{array}{cc}
                       |  &  |  \\
                     \ve_1&\ve_2\\
                       |  &  |
                    \end{array}}^{-1}}{$\opQi$}}{\ope{Eigendecomposition} of $\opS$}
                 = \brs{\begin{array}{cc}
                       1  &  0  \\
                       0  &  1
                    \end{array}}
                    \brs{\begin{array}{cc}
                      \frac{\xN r^2}{2} & 0\\
                      0            & \frac{\xN r^2}{2}
                    \end{array}}
                   \brs{\begin{array}{cc}
                       1  &  0  \\
                       0  &  1
                    \end{array}}^{-1}
                  =\frac{\xN r^2}{2}\brs{\begin{array}{cc}
                       1  &  0  \\
                       0  &  1
                    \end{array}}
         \end{align*}
     \end{enumerate}

  \item Proof that  \label{item:frame_R2N_opSi}
        $\ds\opSi=\frac{2}{\xN r^2}\matIrr$:
    \begin{align*}
      \opS\opSi &= \frac{\xN r^2}{2}\matIrr
                   \frac{2}{\xN r^2}\matIrr
                 = \matIrr
                 \eqd \opI_2
                && \text{by \pref{item:frame_R2N_opS}}
                \\
      \opSi\opS &= \frac{2}{\xN r^2}\matIrr
                   \frac{\xN r^2}{2}\matIrr
                 = \matIrr
                 \eqd \opI_2
                && \text{by \pref{item:frame_R2N_opS}}
    \end{align*}

  \item Proof that $\vv = \frac{2}{\xN r^2}\sum_{n=0}^{\xN-1} \brp{\vv^\opH\vx_n} \vx_n$:
    \begin{align*}
      \vv
        &= \sum_{n=0}^{\xN-1} \inprod{\vv}{\opSi\vx_n}\vx_n
         = \sum_{n=0}^{\xN-1} \inprod{\vv}{\frac{2}{\xN r^2}\matIrr\vx_n}\vx_n
        && \text{by \pref{item:frame_R2N_opSi}}
      \\&= \frac{2}{\xN r^2}\sum_{n=0}^{\xN-1} \inprod{\vv}{\vx_n} \vx_n
         = \frac{2}{\xN r^2}\sum_{n=0}^{\xN-1} \brp{\vv^\opH\vx_n} \vx_n
        && \text{by definition of $\inprod{\vy}{\vx}$}
     \end{align*}

\end{enumerate}
\end{proof}

%--------------------------------------
\begin{example}[\exmd{Peace Frame}/\exmd{Mercedes Frame}]
\footnote{
  \citerppgc{heil2011}{204}{205}{0817646868}{$r=1$ case},
  \citerpgc{byrne2005}{80}{1568812426}{$r=1$ case},
  \citerpgc{han2007}{91}{0821842129}{Example 3.9, $r=\sqrt{2/3}$ case}
  }
\label{ex:mercedes}
%--------------------------------------
Let $\inprodspace{\R^2}{+}{\cdot}{\R}{\dotplus}{\dottimes}{\inprodn}$ be an inner product space with
$\inprod{\opair{x_1}{y_1}}{\opair{x_2}{y_2}}\eqd x_1y_1+x_2y_2$.
Let $\opS$ be the \ope{frame operator} \xref{def:frameop} with \ope{inverse} $\opSi$.
\exbox{%
  \begin{array}{M}
    Let $\vx_1\eqd\frac{1}{2}\brs{\begin{array}{c}0        \\ 2\end{array}}$,
        $\vx_2\eqd\frac{1}{2}\brs{\begin{array}{r}-\sqrt{3}\\-1\end{array}}$,
    and $\vx_3\eqd\frac{1}{2}\brs{\begin{array}{r} \sqrt{3}\\-1\end{array}}$.\\
    \\Then, $\seqn{\vx_1,\vx_2,\vx_3}$ is a \structb{tight frame} for $\R^2$ with
    \\\vale{frame bound} $A=\frac{3}{2}$.
    \\Moreover, $\opS=\frac{3}{2}\matIrr$,\quad
                $\opSi=\frac{2}{3}\matIrr$,
    \\and\qquad$\ds\vv =    \frac{2}{3}\sum_{n=1}^{3} \inprod{\vv}{\vx_n} \vx_n
                       \eqd \frac{2}{3}\sum_{n=1}^{3} \brp{\vv^\opH\vx_n} \vx_n$\qquad $\scy\forall\vv\in\R^2$.
  \end{array}%
  \tbox{\includegraphics{../common/math/graphics/pdfs/mframe01.pdf}}
  }
\end{example}
\begin{proof}
\begin{enumerate}
  \item This frame is simply a special case of the frame presented in \prefpp{ex:frame_R2N}
        with $r=1$, $\xN=3$, and $\theta=\sfrac{\pi}{2}$.

  \item Let's give it a try! Let $\vv\eqd\brs{\begin{array}{c}1\\1\end{array}}$.
         \begin{align*}
           \sum_{n=1}^3 \inprod{\vv}{\opSi\vx_n}\vx_n
             &= \frac{2}{3}\sum_{n=1}^3 \brp{\vv^\opH\vx_n}\vx_n
             && \text{by \prefp{ex:frame_R2N}}
           \\&= \brp{\vv^\opH\vx_1}\vx_1 + \brp{\vv^\opH\vx_2}\vx_2 + \brp{\vv^\opH\vx_3}\vx_3
           \\&= \mathrlap{\frac{2}{3}\brp{
                   \brp{\vv^\opH\frac{1}{2}\brs{\begin{array}{c} 0       \\ 2\end{array}}}\vx_1
                  +\brp{\vv^\opH\frac{1}{2}\brs{\begin{array}{c}-\sqrt{3}\\-1\end{array}}}\vx_2
                  +\brp{\vv^\opH\frac{1}{2}\brs{\begin{array}{c} \sqrt{3}\\-1\end{array}}}\vx_3
                  }}
           \\&= \mathrlap{\frac{2}{3}\cdot\frac{1}{2}\brp{
                   \brp{\vv^\opH\brs{\begin{array}{c} 0       \\ 2\end{array}}}\vx_1
                  +\brp{\vv^\opH\brs{\begin{array}{c}-\sqrt{3}\\-1\end{array}}}\vx_2
                  +\brp{\vv^\opH\brs{\begin{array}{c} \sqrt{3}\\-1\end{array}}}\vx_3
                  }}
           \\&= \mathrlap{\frac{1}{3}\brp{
                   \brp{          2} \frac{1}{2}\brs{\begin{array}{c}       0 \\ 2\end{array}}
                  +\brp{-\sqrt{3}-1} \frac{1}{2}\brs{\begin{array}{c}-\sqrt{3}\\-1\end{array}}
                  +\brp{ \sqrt{3}-1} \frac{1}{2}\brs{\begin{array}{c} \sqrt{3}\\-1\end{array}}
                  }}
            \\&= \frac{1}{6}\brs{\begin{array}{ccccc}
                  2(0) &+& (-\sqrt{3}-1)(-\sqrt{3}) &+& ( \sqrt{3}-1)(\sqrt{3}) \\
                  2(2) &+& (-\sqrt{3}-1)(-1)        &+& ( \sqrt{3}-1)(-1)
                \end{array}}
           \\&= \frac{1}{6}\brs{\begin{array}{ccccc}
                  0 &+& (3+\sqrt{3}) &+& (3-\sqrt{3}) \\
                  4 &+& (1+\sqrt{3}) &+& (1-\sqrt{3})
                \end{array}}
             = \brs{\begin{array}{c}1\\1\end{array}}
              \eqd \vv
         \end{align*}
\end{enumerate}
\end{proof}

In \prefpp{ex:frame_R2N} and \prefpp{ex:mercedes},
the frame operator $\opS$ and its inverse $\opSi$ were computed.
In general however, it is not always necessary or even possible to compute these,
as illustrated in \pref{ex:frame_R2pq} (next).
%--------------------------------------
\begin{example}
\citetbl{
  \citerppgc{christensen2003}{7}{8}{0817642951}{?}
  }
\label{ex:frame_R2pq}
%--------------------------------------
Let $\inprodspace{\R^2}{+}{\cdot}{\R}{\dotplus}{\dottimes}{\inprodn}$ be an inner product space with
$\inprod{\opair{x_1}{y_1}}{\opair{x_2}{y_2}}\eqd x_1y_1+x_2y_2$.
Let $\opS$ be the \ope{frame operator} \xref{def:frameop} with \ope{inverse} $\opSi$.
\exboxt{%
  $\begin{array}{M}
    Let $\vp$ and $\vq$ be \prope{orthonormal} vectors\\in $\spX\eqd\linspan\setn{\vp,\vq}$.\\
    Let $\vx_1\eqd\vp$, $\vx_2\eqd\vp+\vq$, and $\vx_3\eqd\vp-\vq$.\\
    Then, $\setn{\vx_1,\vx_2,,\vx_3}$ is a \structb{frame} for $\spX$\\
    with \vale{frame bounds} $A=0$ and $B=5$.%\\
    %Moreover, $\opSi\vx_1=\sfrac{1}{3}\vp$, $\opSi\vx_2=\sfrac{1}{3}\vp+\sfrac{1}{2}\vq$
    %and $\opSi\vx_3=\sfrac{1}{3}\vp-\sfrac{1}{2}\vq$.
  \end{array}$
  \tbox{\includegraphics{../common/math/graphics/pdfs/frameR2pq.pdf}}
  $\begin{array}{Mr@{\hspace{1pt}}c@{\hspace{1pt}}lD}
    \mc{5}{M}{Moreover,}
          \\  & \opSi\vx_1 &=& \sfrac{1}{3}\vp                 & and
          \\  & \opSi\vx_2 &=& \sfrac{1}{3}\vp+\sfrac{1}{2}\vq & and
          \\  & \opSi\vx_3 &=& \sfrac{1}{3}\vp-\sfrac{1}{2}\vq & .
  \end{array}$
  }
\end{example}
\begin{proof}
\begin{enumerate}
  \item Proof that $\seqn{\vx_1,\vx_2,\vx_3}$ is a \structe{frame} with \vale{frame bounds} $A=0$ and $B=5$:
        \begin{align*}
          \sum_{n=1}^{3} \abs{\inprod{\vv}{\vx_n}}^2
            &\eqd \abs{\inprod{\vv}{\vp}}^2
                + \abs{\inprod{\vv}{\vp+\vq}}^2
                + \abs{\inprod{\vv}{\vp-\vq}}^2
            && \text{by definitions of $\vx_1$, $\vx_2$, and $\vx_3$}
          \\&=    \abs{\inprod{\vv}{\vp}}^2
                + \abs{\inprod{\vv}{\vp}+\inprod{\vv}{\vq}}^2
                + \abs{\inprod{\vv}{\vp}-\inprod{\vv}{\vq}}^2
            && \text{by \prope{additivity} of $\inprodn$ \xref{def:inprod}}
          \\&=\mathrlap{\abs{\inprod{\vv}{\vp}}^2
                    + \brp{\abs{\inprod{\vv}{\vp}}^2 + \abs{\inprod{\vv}{\vq}}^2 + \inprod{\vv}{\vp}\inprod{\vv}{\vq}^\ast+ \inprod{\vv}{\vq}\inprod{\vv}{\vp}^\ast}
              }
            \\&\quad\mathrlap{+ \brp{\abs{\inprod{\vv}{\vp}}^2 + \abs{\inprod{\vv}{\vq}}^2 - \inprod{\vv}{\vp}\inprod{\vv}{\vq}^\ast - \inprod{\vv}{\vq}\inprod{\vv}{\vp}^\ast }}
          \\&=    3\abs{\inprod{\vv}{\vp}}^2 + 2\abs{\inprod{\vv}{\vq}}^2
          \\&\boxed{\le}  3\norm{\vv}\norm{\vp} + 2\norm{\vv}\norm{\vq}
           %&&    \text{by \thme{Cauchy-Schwarz Inequality}}&&\text{\xref{thm:cs}}
            &&    \text{by \thme{CS Inequality} \ifxref{vsinprod}{thm:cs}}
          \\&=    \norm{\vv}\brp{3\norm{\vp} + 2\norm{\vq}}
          \\&=    \boxed{5}\norm{\vv}
            &&    \text{by \prope{orthonormality} of $\vp$ and $\vq$}
        \end{align*}

  \item lemma: $\opS\vp=3\vp$, $\opS\vq=2\vq$, $\opSi\vp=\frac{1}{3}\vp$, and $\opSi\vq=\frac{1}{2}\vq$. Proof: \label{ilem:3p2q}
    \begin{align*}
      \opS\vp
        &\eqd \sum_{n=1}^3 \inprod{\vp}{\vx_n}\vx_n
      \\&=    \inprod{\vp}{\vp}\vp + \inprod{\vp}{\vp+\vq}(\vp+\vq) + \inprod{\vp}{\vp-\vq}(\vp-\vq)
      \\&=    (1)\vp + (1+0)(\vp+\vq) + (1-0)(\vp-\vq)
      \\&=    3\vp
      \\\implies \opSi\vp
        &=\frac{1}{3}\vp
      \\
      \opS\vq
        &\eqd \sum_{n=1}^3 \inprod{\vq}{\vx_n}\vx_n
      \\&=    \inprod{\vq}{\vp}\vp + \inprod{\vq}{\vp+\vq}(\vp+\vq) + \inprod{\vq}{\vp-\vq}(\vp-\vq)
      \\&=    (0)\vq + (0+1)(\vp+\vq) + (0-1)(\vp-\vq)
      \\&=    2\vq
      \\\implies \opSi\vq
        &=    \frac{1}{2}\vq
    \end{align*}

   \item Remark: Without knowing $\vp$ and $\vq$, from \pref{ilem:3p2q} it follows that
                 it is not possible to compute $\opS$ or $\opSi$ explicitly.

   \item Proof that $\opSi\vx_1=\sfrac{1}{3}\vp$, $\opSi\vx_2=\sfrac{1}{3}\vp+\sfrac{1}{2}\vq$
         and $\opSi\vx_3=\sfrac{1}{3}\vp-\sfrac{1}{2}\vq$:
     \begin{align*}
       \opSi\vx_1
         &\eqd \opSi\vp
         && \text{by definition of $\vx_1$}
       \\&= \frac{1}{3}\vp
         && \text{by \pref{ilem:3p2q}}
         \\
       \opSi\vx_2
         &\eqd \opSi\brp{\vp+\vq}
         && \text{by definition of $\vx_2$}
       \\&= \frac{1}{3}\vp + \frac{1}{2}\vq
         && \text{by \pref{ilem:3p2q}}
         \\
       \opSi\vx_3
         &\eqd \opSi\brp{\vp-\vq}
         && \text{by definition of $\vx_2$}
       \\&= \frac{1}{3}\vp - \frac{1}{2}\vq
         && \text{by \pref{ilem:3p2q}}
     \end{align*}


   \item Check that $\vv=\sum_n \inprod{\vv}{\vx_n}\vx_n = \inprod{\vv}{\vp}\vp + \inprod{\vv}{\vq}\vq$:
     \begin{align*}
       \vv
         &= \sum_{n=1}^3 \inprod{\vv}{\opSi\vx_n}\vx_n
       \\&= \inprod{\vv}{\opSi\vp}\vp +\inprod{\vv}{\opSi(\vp+\vq)}(\vp+\vq) +\inprod{\vv}{\opSi(\vp-\vq)}(\vp-\vq)
       \\&= \inprod{\vv}{\frac{1}{3}\vp}\vp
            +\inprod{\vv}{\frac{1}{3}\vp+\frac{1}{2}\vq}(\vp+\vq)
            +\inprod{\vv}{\frac{1}{3}\vp-\frac{1}{2}\vq)}(\vp-\vq)
       \\&=   \brp{\frac{1}{3}+\frac{1}{3}+\frac{1}{3}}\inprod{\vv}{\vp}\vp
            + \brp{\frac{1}{3}-\frac{1}{3}}            \inprod{\vv}{\vp}\vq
            + \brp{\frac{1}{2}-\frac{1}{2}}            \inprod{\vv}{\vq}\vp
            + \brp{\frac{1}{2}+\frac{1}{2}}            \inprod{\vv}{\vq}\vq
       \\&=   \inprod{\vv}{\vp}\vp + \inprod{\vv}{\vq}\vq
     \end{align*}

\end{enumerate}
\end{proof}



%=======================================
%\section{Take a second look ...}
%=======================================

%%--------------------------------------
%\begin{definition}
%\footnote{
%  \citerp{pinsky2002}{305}
%  }
%\label{def:riesz_basis}
%\index{basis!Riesz}
%%--------------------------------------
%Let $(\spV,\normn )$ a normed linear space
%on the linear space $\spV\eqd(\setX,\F,+,\cdot)$.
%\defbox{\begin{array}{l@{\qquad}l>{\ds}l}
%  \mc{3}{l}{\text{
%    A \hid{Riesz basis} for $(\spV,\normn )$ is any set $\setTh\eqd\seq{\vx_n}{n\in\Z}$ that satisfies
%    }}
%    \\& 1.& \spV = \linspan\setTh
%            \qquad
%            \text{\scriptsize ($\setTh$ generates $\spV$).}
%    \\& 2.& \forall \seqn{\alpha_n\in\F},\; \exists A,B\in\Rp \st
%    \\&   & A\sum_n\abs{\alpha_n}^2 \le \norm{ \sum_{n\in\Z} \alpha_{n} \vx_{n} }^2 \le B\sum_n\abs{\alpha_n}^2
%  \end{array}}
%\end{definition}




%%--------------------------------------
%\begin{theorem}
%\footnote{
%  \citerp{mallat}{126}
%  }
%\index{frame!inversion}
%%--------------------------------------
%Let $\spV\eqd\opair{\spX}{\inprodn}$ be an inner product space.
%\thmbox{
%  \parbox{6\tw/16}{$\setTh$ is an orthonormal basis of $\spV$}
%  \qquad\iff\qquad
%  \parbox{6\tw/16}{$\setTh$ is a tight frame of $\spV$ with frame bound $A=1$.}
%  }
%\end{theorem}
%\begin{proof}
%\begin{align*}
%\intertext{1. Proof that $\setTh$ is an orthonormal basis $\implies$   $A=1$:}
%  A\norm{\vv}^2
%    &= \sum_{n=1}^\xN \left|\inprod{\vx_n}{\vv}\right|^2
%    && \text{by \pref{def:frame}}
%  \\&= \norm{\vv}^2
%    && \text{by left hypothesis and Parseval's Identity (\prefpo{thm:plancherel})}
%  \\ \implies & A=1
%  \\
%\intertext{2. Proof that $\setTh$ is an orthonormal basis $\impliedby$   $A=1$:}
%    A\norm{\vv}^2
%    &= \sum_{n=1}^\xN \left|\inprod{\vx_n}{\vv}\right|^2
%    && \text{by \pref{def:frame}}
%  \\&= \norm{\vv}^2
%    && \text{by right hypothesis and Parseval's Identity (\prefpo{thm:plancherel})}
%  \\\implies & \text{$\{\vx_n\}$ is orthonormal}
%    && \text{by Parseval's Identity (\prefpo{thm:plancherel})}
%\end{align*}
%\end{proof}



%%--------------------------------------
%\begin{theorem}
%\citep{dgm86}{1272}
%\index{frame!inversion}
%%--------------------------------------
%Let $\spH\eqd\inprodspaceX$ be a Hilbert space
%with tight frame $\setxn{\vx_n}$ and frame bound $A$.
%\thmbox{
%  \forall \vv\in\spV, \qquad
%  \vv = \frac{1}{A} \sum_{n\in\Z} \inprod{\vx_n}{\vv}\vx_n
%  }
%\end{theorem}
%%\begin{proof}
%%No proof at this time.
%%\end{proof}

