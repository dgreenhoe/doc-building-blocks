%============================================================================
% Daniel J. Greenhoe
% LaTeX File
%============================================================================


%======================================
\chapter{Wavelet Structures}
%======================================

\qboxnpqt
  { Jules Henri Poincar\'e (1854-1912), physicist and mathematician
    \index{Poincar\'e, Jules Henri}
    \index{quotes!Poincar\'e, Jules Henri}
    \footnotemark
  }
  {../common/people/small/poincare.jpg}
  {\ldots on fait la science avec des faits comme une maison avec des pierres ; 
   mais une accumulation de faits n'est pas plus une science qu'un tas de 
   pierres n'est une maison.}
  {Science is built up of facts, as a house is built of stones;
   but an accumulation of facts is no more a science than a heap of stones is a house.}
  \citetblt{
    quote:       & \citerc{poincare_sah}{Chapter IX, paragraph 7} \\
    translation: & \citerp{poincare_sah_eng}{141} \\
    image:       & \url{http://www-groups.dcs.st-and.ac.uk/~history/PictDisplay/Poincare.html}
    }

\qboxnps
  {
    Freeman Dyson (1923--), physicist and mathematician  %(January 1994)
    \index{Dyson, Freeman}
    \index{quotes!Dyson, Freeman}
    \footnotemark
  }
  %{../common/people/dyson_.flickr8168451.jpg}
  {../common/people/dyson_isepp-org_95-96.jpg}  %http://www.isepp.org/Media/Speaker%20Images/95-96%20Images/dyson.jpg
  %{../common/people/small/dyson.jpg}
  {The bottom line for mathematicians is that the architecture has to be right.
    In all the mathematics that I did, the essential point was to find
    the right architecture.
    It's like building a bridge.
    Once the main lines of the structure are right,
    then the details miraculously fit.
    The problem is the overall design.}
  \citetblt{
    quote: & \citerp{dyson1994}{20}  \\
    %image: & \url{http://www.flickr.com/photos/russnelson/8168451/}
    image: & \scs\url{http://www.isepp.org/Media/Speaker\%20Images/95-96\%20Images/dyson.jpg}
    }

%=======================================
\section{Introduction}
%=======================================
%=======================================
\subsection{What are wavelets?}
%=======================================
In Fourier analysis, \prope{continuous} {dilations} \xref{def:opD} of the \fncte{complex exponential} \xref{def:exp}
form a  \structe{basis} \xref{def:basis_schauder} for the \structe{space of square integrable functions} $\spLLR$ \xref{def:spLLR} 
such that
  \\\indentx$\ds\spLLR=\linspan\set{\opDil_\omega e^{ix}}{\scy\omega\in\R}$.

In Fourier series analysis \xref{thm:opFSi}, \prope{discrete} dilations of the complex exponential 
form a  basis for $\spLL{\intoo{0}{2\pi}}$ such that
  \\\indentx$\ds\spLL{\intoo{0}{2\pi}}=\linspan\setjZ{\opDil_j e^{ix}}$.

In Wavelet analysis, for some \fncte{mother wavelet} \xref{def:wavelet} $\fpsi(x)$,
  \\\indentx$\ds\spLLR=\linspan\set{\opDil_\omega\opTrn_\tau \fpsi(x)}{\omega,\tau\in\R}$.

However, the ranges of parameters $\omega$ and $\tau$ can be much reduced to the countable set $\Z$ resulting in
a \prope{dyadic} wavelet basis such that for some mother wavelet $\fpsi(x)$,
  \\\indentx$\ds\spLLR=\linspan\set{\opDil^j\opTrn^n \fpsi(x)}{j,n\in\Z}$.\\
This text deals almost exclusively with dyadic wavelets. 
Wavelets that are both \prope{dyadic} and \prope{compactly supported} have the attractive feature 
that they can be easily implemented in hardware or software by use of the 
\structe{Fast Wavelet Transform} \xref{fig:fwt}.

%\begin{minipage}{\tw-65mm}
%  In 1989, St{/'e}phane G. Mallat introduced the \structe{Multiresolution Analysis} (MRA, \prefp{def:mra})
%  method for wavelet construction. The MRA has become the dominate wavelet construction method.
%  This text uses the MRA method extensively, 
%  and combines the MRA ``scaling subspaces" \xref{def:mra} with ``wavelet subspaces" \xref{def:seqWn} 
%  to form a subspace structure as represented by the 
%  \structe{Hasse diagram} to the right.
%  The \structe{Fast Wavelet Transform} combines both sets of subspaces as well, 
%  providing the results of projections onto both wavelet and MRA subspaces.
%  %The MRA is not the only method of wavelet construction,
%  Moreover, P.G. Lemari{/'e} has proved that all wavelets with \prope{compact support} are generated by an MRA.\footnotemark
%\end{minipage}\hfill%
%\tbox{\includegraphics{graphics/latwav.pdf}}
%\footnotetext{
%  \citor{lemarie1990},
%  \citerpg{mallat}{240}{012466606X}
%  }

%=======================================
\subsection{Analyses}
%=======================================
%20171226%The MRA is an \hib{analysis} of the linear space $\spLLR$.
%20171226%An analysis of a linear space $\spX$ is any sequence $\seq{\spV_j}{j\in\Z}$ of linear subspaces of $\spX$.
%20171226%%A sequence $\seq{\spV_j}{j\in\Z}$ of linear subspaces of a linear space $\spX$
%20171226%%        is an \hib{analysis} of $\spX$.
%20171226%        %if  $\seq{\spV_j}{j\in\Z}$ is a partition of $\spX$.
%20171226%        The partial or complete reconstruction of $\spX$ from $\seq{\spV_j}{j\in\Z}$ is a \hib{synthesis}.%
%20171226%        \footnote{%
%20171226%          The word \hie{analysis} comes from the Greek word
%20171226%          {\fntagreek{>av'alusis}},
%20171226%          meaning ``dissolution" (\citerpc{perschbacher1990}{23}{entry 359}),
%20171226%          which in turn means
%20171226%          ``the resolution or separation into component parts"
%20171226%          (\citer{collins2009}, \scs\url{http://dictionary.reference.com/browse/dissolution})
%20171226%          }
%20171226%  An analysis is sometimes completely \hie{characterized} by a \hie{transform}.
%20171226%  For example, a Fourier analysis is a sequence of subspaces with sinusoidal bases.
%20171226%  Examples of subspaces in a Fourier analysis include $\spV_1=\Span\setn{e^{ix}}$, 
%20171226%  $\spV_{2.3}=\Span\setn{e^{i2.3x}}$, $\spV_{\sqrt{2}}=\Span\setn{e^{i\sqrt{2}x}}$, etc.
%20171226%  A \hib{transform} is loosely defined as a function that maps a family of functions
%20171226%  into an analysis.
%20171226%  A very useful transform (a ``\hie{Fourier transform}") for Fourier Analysis is \xref{def:opFT}
%20171226%  \\\indentx$\ds\brs{\opFT\ff}(\omega) \eqd \frac{1}{\sqrt{2\pi}} \int_\R \ff(x) e^{-i\omega x} \dx$
%20171226%
%20171226%
%20171226%%  \item A sequence $\opT$ in $\clFxy$ is a \hib{transform} \label{item:wavstrct_T}
%20171226%%        if each element in the sequence is a projection operator in $\clFxy$.
%20171226%%        An example of a transform is the \hib{cosine transform} $\opT$ in $\clFrr$ such that
%20171226%%        \begin{align*}
%20171226%%          \opT\fx(t) &\eqd \seq{\opP_j}{j\in\Z}
%20171226%%             \\&\eqd \seq{\int_{t\in\R} \fx(t)\,\mcom{\cos(nt)}{kernel} \dt}{n\in\Z}
%20171226%%             \\&\eqd \seqn{\cdots,\,
%20171226%%                           %\int_{t\in\R} \cos\brs{(-2)t}\,\fx(t) \dt,\,
%20171226%%                           \int_{t\in\R} \fx(t)\,\cos\brs{(-1)t} \dt,\,
%20171226%%                           \int_{t\in\R} \fx(t)\,                \dt,\,
%20171226%%                           \int_{t\in\R} \fx(t)\,\cos\brs{( 1)t} \dt,\,
%20171226%%                           %\int_{t\in\R} \cos\brs{(-2)t}\,\fx(t) \dt,\,
%20171226%%                           \cdots
%20171226%%                          }
%20171226%%        \end{align*}
%20171226%%        Further examples of transforms include the \hie{Fourier Transform} and various \hie{Wavelet Transforms}.
%20171226%% it is a \hib{sequence} of projection operators on $\A function $\opT$ in $\clFxy$ is a \hib{transform} if with domain $\clFxy$ and range $\clF{\setA}{\setB}$ if

    \begin{minipage}{\tw-65mm}%
      An analysis can be partially characterized by its order structure with respect
      to an order relation such as the set inclusion relation $\subseteq$.
      Most transforms have a very simple M-$n$ order structure,
      as illustrated to the right.
      The M-$n$ lattices for $n\ge3$ are \prope{modular} but not \prope{distributive}.
      Analyses typically have one subspace that is a \hie{scaling} subspace;
      and this subspace is often simply a family of constants
      (as is the case with \hi{Fourier Analysis}).
    \end{minipage}%
    \hfill\tbox{\includegraphics{graphics/latmn.pdf}}%

    \begin{minipage}{\tw-55mm}%
      A special characteristic of wavelet analysis is that there is not just one
      scaling subspace,
      %(as is with the case of Fourier and other analyses),
      but an entire sequence of scaling subspaces.
      These scaling subspaces are \prope{linearly ordered} with respect to the
      ordering relation $\subseteq$. In wavelet theory, this structure is called a \structe{multiresolution analysis},
      or \structe{MRA} \xref{def:mra}.

     The MRA was introduced by St{/'e}phane G. Mallat in 1989.
     The concept of a scaling space was perhaps first introduced by Taizo Iijima in 1959 in Japan,
    and later as the \structe{Gaussian Pyramid} by Burt and Adelson in the 1980s in the West.\footnotemark
    \end{minipage}%
    \footnotetext{%
      \citorp{mallat89}{70},
      \citor{iijima1959},
      \citor{burt1983},
      \citor{adelson1981},
      \citer{lindeberg1993},
      \citer{alvertez1993},
      \citer{guichard2012},
      \citerc{weickert1999}{historical survey}
      }
    \hfill\tbox{\includegraphics{graphics/latmra.pdf}}%

    \begin{minipage}{\tw-65mm}%
      A second special characteristic of wavelet analysis is that it's order structure
      with respect to the $\subseteq$ relation is not a simple M-$n$ lattice 
     (as is with the case of Fourier and other analyses).
      Rather, it is a lattice of the form illustrated to the right.
      This lattice is \prope{non-complemented}, \prope{non-distributive},
      \prope{non-modular}, and \prope{non-Boolean} \xref{prop:order_wavstrct}.
    \end{minipage}%
    \hfill\tbox{\includegraphics{graphics/latwav.pdf}}%

    \begin{minipage}{\tw-65mm}%
      The wavelet subspace structure is similar in form to that of the \structe{Primorial numbers},\footnotemark
      illustrated to the right by a \hie{Hasse diagram}.
      %In the world of mathematical structures,
      %there is circumstantial evidence that the order structure of wavelet analyses is quite rare,
      %if not outright unique.
      %For example, suppose we replace the wavelet subspaces with prime numbers
      %and the scaling subspaces with their products as illustrated to the right.
      %The resulting sequence $\seqn{1,\,2,\,6,\,30,\,210}$ as of 2011 July 30
      %has no matches in Neil J.A. Sloane's  \emph{Online Encyclopedia of Integer Sequences}
      %(hosted by \emph{AT\&T Research}).\footnotemark
    \end{minipage}%
    \citetblt{%
      \citeoeis{A002110}%
      }%
    \hfill\tbox{\includegraphics{graphics/latp_1235711.pdf}}%

  An analysis can be represented using three different structures:
    %\paragraph{Equivalence of lattice representations.}
    %So far we have discussed representing a wavelet analysis using three different structures:
\\\begin{tabular}{@{\qquad}ll}
  \circOne    & sequence of subspaces             \\
  \circTwo    & sequence of basis coefficients         \\
  \circThree  & sequence of basis vectors
\end{tabular}\\
These structures are isomorphic to each other, and can therefore be used interchangeably.
%(see \prefp{thm:VPb_isomorphic}).
%(see \prefp{fig:wav_VPb_isomorphic}).
%That is, a ``\hie{wavelet analysis}" can be described using any of these structures.
%However, sometimes when introducing theorems about wavelets,
%it is convenient to use elements from not just one, but from multiple lattices;
%and so it is convenient to have a ``collection" of wavelet analysis elements
%all assembled together into one formally defined tuple.
%\pref{def:wavsys} (next) does just that---it defines a \hie{wavelet analysis} in terms of a tuple with elements
%extracted from the four wavelet structures.

%---------------------------------------
% isomorphic lattices
%---------------------------------------
\mbox{}\hfill
  \tbox{\includegraphics{graphics/latp_VW.pdf}}\qquad{\Large$\thapprox$}\qquad
  \tbox{\includegraphics{graphics/latp_hg.pdf}}\qquad{\Large$\thapprox$}\qquad
  \tbox{\includegraphics{graphics/latp_pp.pdf}}
\hfill\mbox{}

\prefpp{fig:analyses} illustrate the order structures of some analyses,
        including two wavelet analyses:
\begin{figure}[th]
  \centering%
  \begin{tabular}{|c|c|}%
    \hline%
    \mc{1}{B}{Cosine analysis  (even Fourier series)}&\mc{1}{B}{Cosine polynomial analysis}%
    \\\includegraphics{graphics/baslat_cosh.pdf}&\includegraphics{graphics/baslat_cose.pdf}%
    \\\hline%
    \mc{1}{|B|}{Chebyshev polynomial analysis\cittrp{rivlin1974}{4}}&\mc{1}{|B|}{Hadamard-3 analysis}%
    \\\includegraphics{graphics/baslat_cheby.pdf}&\includegraphics{graphics/baslat_h3.pdf}%
    \\\hline
    \mc{1}{|B|}{Haar/Daubechies-$p1$ wavelet analysis} & \mc{1}{B|}{Daubechies-$p2$ wavelet analysis}%
    \\\includegraphics{graphics/baslat_d1.pdf}&\includegraphics{graphics/baslat_d2.pdf}%
    \\\hline%
  \end{tabular}%
  \caption{examples of the order structures of some analyses\label{fig:analyses}}
\end{figure}


%20171226%%=======================================
%20171226%\section{Multiresolution analysis}
%20171226%%=======================================
%20171226%%=======================================
%20171226%\subsection{Definition}
%20171226%%=======================================
%20171226%\ifdochasnot{transop}{%
%20171226%Much of the wavelet theory developed in this section is constructed using the \opb{translation operator} $\opTrn$
%20171226%and the \opb{dilation operator} $\opDil$ (next).
%20171226%%These operators are illustrated below.
%20171226%%and in \prefp{fig:haar-jn} for the \hie{Haar} MRA\cittr{haar1910}.
%20171226%%
%20171226%%---------------------------------------
%20171226%\begin{definition}
%20171226%\footnote{
%20171226%  \citerppgc{walnut2002}{79}{80}{0817639624}{Definition 3.39},
%20171226%  \citerppg{christensen2003}{41}{42}{0817642951},
%20171226%  \citerpgc{wojtaszczyk1997}{18}{0521578949}{Definitions 2.3,2.4},
%20171226%  \citerpg{kammler2008}{A-21}{0521883407},
%20171226%  \citerpg{bachman2000}{473}{0387988998},
%20171226%  \citerpg{packer2004}{260}{0821834029}, %{section 3.1}\\
%20171226%  \citerpg{zayed2004}{}{0817643044},
%20171226%  \citerpgc{heil2011}{250}{0817646868}{Notation 9.4},
%20171226%  \citerpg{casazza1998}{74}{0817639594},
%20171226%  \citerp{goodman1993}{639},
%20171226%  \citerp{dai1996}{81},
%20171226%  \citerpg{dai1998}{2}{0821808001}
%20171226%  %\citerpg{dai1998}{21}{0821808001}
%20171226%  }
%20171226%\label{def:wav_opT}
%20171226%\label{def:wav_opD}
%20171226%\label{def:wavstrct_TD}
%20171226%\label{def:opT}
%20171226%\label{def:opD}
%20171226%%---------------------------------------
%20171226%%Let $\spX\eqd\spLLR$ be the space of all \structe{square Lebesgue integrable functions} \xref{def:spLLR}.
%20171226%%Let $\opTrn$ and $\opDil$ be operators in $\clOxx$.
%20171226%%Let $\C$ be the set of complex numbers,
%20171226%%and $\hxs{\spLLR}$ the set of all functions with range $\C$ and domain $\C$.
%20171226%\defbox{\begin{array}{Frc>{\ds}lMlC}
%20171226%    1. & \mc{6}{M}{$\hxs{\opTrn}$ is the \opd{translation operator} on $\spCC$ defined as}\\
%20171226%       & \indentx\hxs{\opTrn_\tau}  \ff(x) &\eqd&         \ff(x-\tau) &and& \hxs{\opTrn}\eqd\opTrn_1 & \forall \ff\in\spCC
%20171226%       \\
%20171226%    2. & \mc{6}{M}{$\hxs{\opDil}$ is the \opd{dilation operator} on $\spCC$ defined as}\\
%20171226%       & \indentx\hxs{\opDil_\alpha} \ff(x) &\eqd& \ff(\alpha x) &and& \opDil\eqd\sqrt{2}\opDil_2 & \forall \ff\in\spCC
%20171226%\end{array}}
%20171226%\end{definition}
%20171226%
%20171226%\begin{center}\begin{tabular}{cc}
%20171226%  \includegraphics{graphics/opTrn.pdf}&\includegraphics{graphics/opDil.pdf}%
%20171226%\end{tabular}\end{center}
%20171226%}
%20171226%
%20171226%
%20171226%
%20171226%A multiresolution analysis provides ``coarse" approximations of a function in a linear space $\spLLR$ at multiple
%20171226%``scales" or ``resolutions".
%20171226%%\paragraph{Scaling function.}
%20171226%Key to this process is a sequence of \hie{scaling functions}.
%20171226%Most traditional transforms feature a single \hie{scaling function} $\fphi(x)$
%20171226%set equal to one ($\fphi(x)=1$).
%20171226%This allows for convenient representation of the most basic functions, such as constants.\citep{jawerth}{8}
%20171226%A multiresolution system, on the other hand, uses a generalized form of the scaling concept:
%20171226%\begin{dingautolist}{"AC}
%20171226%  \item Instead of the scaling function simply being set \emph{equal to unity} ($\fphi(x)=1$),
%20171226%        a multiresolution system \xref{def:mrasys} is often constructed in such a way that the scaling function 
%20171226%        $\fphi(x)$ forms a \hie{partition of unity} \xref{def:pun} such that
%20171226%        $\sum_{n\in\Z} \opTrn^n\fphi(x) = 1$.
%20171226%  \item Instead of there being \emph{just one} scaling function, there
%20171226%        is an entire sequence of scaling functions $\seqjZ{\opDil^j\fphi(x)}$, 
%20171226%        each corresponding to a different ``\hie{resolution}".
%20171226%\end{dingautolist}
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{definition}% [multiresolution system]
%20171226%\footnote{
%20171226%  \citerpg{hernandez1996}{44}{0849382742},
%20171226%  \citerpgc{mallat}{221}{012466606X}{Definition 7.1},
%20171226%  \citorp{mallat89}{70},
%20171226%  \citorpgc{meyer1992}{21}{0521458692}{Definition 2.2.1},
%20171226%  \citerpgc{christensen2003}{284}{0817642951}{Definition 13.1.1},
%20171226%  \citerppgc{bachman2000}{451}{452}{0387988998}{Definition 7.7.6},
%20171226%  \citerppgc{walnut2002}{300}{301}{0817639624}{Definition 10.16},
%20171226% %\citerppgc{vidakovic}{51}{52}{0471293652}{Riesz basis: footnote on page 52}\\
%20171226%  \citerppgc{dau}{129}{140}{0898712742}{Riesz basis: page 139}
%20171226%  %\citerppgc{christensen2003}{73}{74}{0817642951}{Definition 3.8.2}\\
%20171226%  %\citerpgc{heil2011}{371}{0817646868}{Definition 12.8}\\
%20171226%  %\citerpgc{walter}{38}{1584882271}{3.1 Multiresolution Analysis}
%20171226%  }
%20171226%\label{def:seqVn}
%20171226%\label{def:mra}
%20171226%\label{def:wavstrct_phi}
%20171226%%--------------------------------------
%20171226%%Let $\spLLR$ be the space of all \structe{square Lebesgue integrable functions} \xref{def:spLLR}.
%20171226%Let $\seqjZ{\spV_j}$ be a sequence of subspaces on $\spLLR$ \xref{def:spLLR}.  %be a \prope{separable} \structe{Hilbert space}.
%20171226%Let $\clsA$ be the \structe{closure} of a set $\setA$.
%20171226%\\\defboxt{
%20171226%  The sequence $\seqjZ{\spV_j}$ is a \structd{multiresolution analysis} on $\spLLR$ if
%20171226%  \\
%20171226%  $\begin{array}{@{\qquad}F>{\ds}lCDD}
%20171226%   %1. & \spV_j \text{ is a linear subspace of $\spX$}\qquad \forall \spV_j\in\seqjZ{\spV_j}
%20171226%    %\cnto & \mc{2}{M}{$\spLLR$ is \prope{complete}}                       & ($\spLLR$ is a \structe{Hilbert Space})         & and
%20171226%    %\cntn & \mc{2}{M}{$\spLLR$ is \prope{separable}}                      &                                               & and
%20171226%      1.  & \spV_j          = \cls{\spV_j}              & \forall j\in\Z                 & (\prope{closed})                              & and 
%20171226%    \\2.  & \spV_j          \subset \spV_{j+1}          & \forall j\in\Z                 & (\prope{linearly ordered})                    & and 
%20171226%    \\3.  & \clsp{\Setu_{j\in\Z} \spV_j} = \spLLR         &                                & (\prope{dense} in $\spLLR$)    & and 
%20171226%   %\cntn & \Seti_{j\in\Z} \spV_j = \setn{\vzero}       &                                & (\structe{greatest lower bound} is $\spZero$) & and 
%20171226%    \\4.  & \ff\in\spV_j \iff    \opDil\ff\in\spV_{j+1} & \forall j\in\Z,\,\ff\in\spLLR  & (\prope{self-similar})                        & and
%20171226%   %\cntn & \ff\in\spV_j \iff    \opTrn\ff\in\spV_j     & \forall n\in\Z,\,\ff\in\spLLR  & (\prope{translation invariant})               & and 
%20171226%    \\5.  & \mc{3}{l}{\ds\exists \fphi \st \setxZ{\opTrn^n\fphi} \text{ is a \structe{Riesz basis} for $\spV_0$.}}                       & 
%20171226%  \end{array}$
%20171226%  \\
%20171226%  A \structe{multiresolution analysis} is also called an \hid{MRA}.\\
%20171226%  An element $\spV_j$ of $\seqjZ{\spV_j}$ is a \hid{scaling subspace} of the space $\spLLR$.\\
%20171226%  The pair $\hxs{\MRAspaceLLRV}$ is a \hid{multiresolution analysis space}, or \hid{MRA space}.\\
%20171226%  The function $\hxs{\fphi}$ is the \hid{scaling function} of the \structe{MRA space}.
%20171226%  }
%20171226%\end{definition}
%20171226%
%20171226%The traditional definition of the \structe{MRA} also includes the following:
%20171226%  \\\indentx$\begin{array}{F>{\ds}lCD}
%20171226%      \cntn & \ff\in\spV_j \iff    \opTrn^n\ff\in\spV_j     & \forall n,j\in\Z,\,\ff\in\spLLR  & (\prope{translation invariant})
%20171226%      \cntn & \Seti_{j\in\Z} \spV_j = \setn{\vzero}         &                                  & (\structe{greatest lower bound} is $\spZero$)
%20171226%  \end{array}$\\
%20171226%However, \pref{prop:mra_transinvar} (next) demonstrates that
%20171226%both of these follow from the \structe{MRA} as defined in \pref{def:mra}.
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{proposition}
%20171226%\footnote{
%20171226%  \citerpgc{hernandez1996}{45}{0849382742}{Theorem 1.6},
%20171226%  \citerppgc{wojtaszczyk1997}{19}{28}{0521578949}{Proposition 2.14},
%20171226%  \citerppgc{pinsky2002}{313}{314}{0534376606}{Lemma 6.4.28}
%20171226%  }
%20171226%\label{prop:mra_transinvar}
%20171226%\label{prop:mra_glb}
%20171226%%--------------------------------------
%20171226%\propbox{
%20171226%  \brbr{\begin{array}{N}
%20171226%    $\seqjZ{\spV_j}$ is an \structe{MRA}\\
%20171226%    \xref{def:mra}
%20171226%  \end{array}}
%20171226%  \implies
%20171226%  \brbl{\begin{array}{F>{\ds}lCD}
%20171226%    1. & \ff\in\spV_j \iff    \opTrn^n\ff\in\spV_j   & \forall n,j\in\Z,\,\ff\in\spLLR  &(\prope{translation invariant}) and\\
%20171226%    2. & \Seti_{j\in\Z} \spV_j = \setn{\vzero}       &                                  & (\structe{greatest lower bound} is $\spZero$)
%20171226%  \end{array}}
%20171226%  }
%20171226%\end{proposition}
%20171226%\begin{proof}
%20171226%%\begin{enumerate}
%20171226%Proof for (1):
%20171226%\begin{align*}
%20171226%  &\opTrn^n\ff\in\spV_j
%20171226%  \\&\iff \opTrn^n\ff\in\linspan\set{\opDil^j\opTrn^m\fphi}{\scy m\in\Z}
%20171226%          &&
%20171226%          && \text{by definition of $\setn{\fphi}$} && \text{\xref{def:mra}}
%20171226%  \\&\iff \exists \seqxZ{\alpha_n} \st \opTrn^n\ff(x)
%20171226%          &&= \sum_{k\in\Z}\alpha_k\opDil^j\opTrn^k\fphi(x)
%20171226%          && \text{by definition of $\setn{\fphi}$} && \text{\xref{def:mra}}
%20171226%  \\&\iff \exists \seqxZ{\alpha_n} \st \ff(x)
%20171226%          &&= \opTrn^{-n}\sum_{k\in\Z}\alpha_k\opDil^j\opTrn^k\fphi(x)
%20171226%          && \text{by definition of $\opTrn$} && \text{\xref{def:opT}}
%20171226%  \\&     &&= \sum_{k\in\Z}\alpha_k\opTrn^{-n}\opDil^j\opTrn^k\fphi(x)
%20171226%          %&& \text{by \prefp{prop:opTD_sum}}
%20171226%  \\&     &&= \sum_{k\in\Z}\alpha_k\opDil^j\opTrn^{k-2n}\fphi(x)
%20171226%          && \text{by \thme{commutator relation}} && \text{\xref{prop:DTTD}}
%20171226%  \\&     &&= \sum_{\ell\in\Z}\alpha_{\ell+2n}\opDil^j\opTrn^{\ell}\fphi(x)
%20171226%          && \text{where $\ell\eqd k-2n\implies$} &&k=\ell+2n
%20171226%  \\&     &&= \sum_{\ell\in\Z}\beta_{\ell}\opDil^j\opTrn^{\ell}\fphi(x)
%20171226%          && \text{where $\beta_{\ell}\eqd\alpha_{\ell+2n}$}
%20171226%  \\&     &&\iff \quad\ff\in\spV_j
%20171226%          && \text{by def. of $\setn{\opTrn^n\fphi}$} && \text{\xref{def:mra}}
%20171226%\end{align*}
%20171226%
%20171226%Proof for (2):
%20171226%\begin{enumerate}
%20171226%  \item Let $\opP_j$ be the \ope{projection operator} that generates the scaling subspace $\spV_j$ such that \label{idef:mra_glb_Pj}
%20171226%    \\\indentx$\ds\opV_j=\set{\opP_j\ff}{\ff\in\spLLR}$
%20171226%
%20171226%  \item lemma: Functions with \prope{compact support} are \prope{dense} in $\spLLR$.
%20171226%        \label{ilem:mra_glb_dense}
%20171226%        Therefore, we only need to prove that the proposition is true for functions with support in $\intcc{-R}{R}$, for all $R>0$.
%20171226%
%20171226%  \item For some function $\ff\in\spLLR$, let $\seqxZ{\ff_n}$ be a sequence of functions in $\spLLR$ 
%20171226%        with \prope{compact support} such that
%20171226%        \\\indentx
%20171226%        $\support\ff_n\subseteq\intcc{-R}{R}$ for some $R>0$
%20171226%        \quad and\quad
%20171226%        $\ds\ff(x)=\lim_{n\to\infty}\seqn{\ff_n(x)}$.
%20171226%        \label{idef:mra_glb_ffn}
%20171226%
%20171226%  \item lemma: $\ds\Seti\spV_j=\setn{\vzero}\quad\iff\quad\lim_{j\to-\infty}\norm{\opP_j\ff}=0\quad{\scy\forall\ff\in\spLLR}$. Proof:  \label{ilem:mra_glb_VjPj}
%20171226%    \begin{align*}
%20171226%      \Seti_{j\in\Z}\spV_j 
%20171226%        &= \Seti_{j\in\Z}\set{\opP_j\ff}{\ff\in\spLLR}
%20171226%        && \text{by definition of $\spV_j$} && \text{\xref{idef:mra_glb_Pj}}
%20171226%      \\&= \lim_{j\to-\infty}\set{\opP_j\ff}{\ff\in\spLLR}
%20171226%        && \text{by definition of $\seti$} && \text{\ifxref{setstrct}{def:setop}}
%20171226%      \\&= \vzero
%20171226%      \iff \lim_{j\to-\infty}\norm{\opP_j\ff}=0
%20171226%        && \text{by \prope{nondegenerate} property of $\normn$} && \text{\xref{def:norm}}
%20171226%    \end{align*}
%20171226%  
%20171226%  \item lemma: $\ds\lim_{j\to-\infty}\norm{\opP_j\ff}=0\quad{\scy\forall\ff\in\spLLR}$. Proof:\\
%20171226%        Let $\setindAx$ be the \fncte{set indicator function} \xref{def:setind} \label{ilem:mra_glb_norm}
%20171226%    \begin{align*}
%20171226%      &\lim_{j\to-\infty}\norm{\opP_j\ff}^2
%20171226%      \\&=   \lim_{j\to-\infty}\norm{\opP_j\lim_{n\to\infty}\seqn{\ff_n}}^2
%20171226%        &&   \text{by \prefp{idef:mra_glb_ffn}}
%20171226%      \\&\le \lim_{j\to-\infty}B\sum_{n\in\Z}\abs{\inprod{\opP_j\lim_{n\to\infty}\seqn{\ff_n}}{\opDil^j\opTrn^n\fphi}}^2
%20171226%        &&   \text{by \prope{frame property}} && \text{\xref{prop:rbasis_frame}}
%20171226%      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\abs{\inprod{\lim_{n\to\infty}\seqn{\ff_n}}{\opDil^j\opTrn^n\fphi}}^2
%20171226%        &&   \text{by definition of $\opP_j$} && \text{\xref{idef:mra_glb_Pj}}
%20171226%      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\abs{\inprod{\setind_\intcc{-R}{R}(x)\lim_{n\to\infty}\seqn{\ff_n}}{\opDil^j\opTrn^n\fphi(x)}}^2
%20171226%        &&   \text{by definition of $\seqn{\ff_n}$}&& \text{\xref{idef:mra_glb_ffn}}
%20171226%      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\abs{\inprod{\lim_{n\to\infty}\seqn{\ff_n}}{\setind_\intcc{-R}{R}(x)\opDil^j\opTrn^n\fphi(x)}}^2
%20171226%        &&   \text{prop. of $\inprodn$ in $\spLLR$}&& \text{ \xref{def:spLLR}}
%20171226%      \\&\le \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\lim_{n\to\infty}\seqn{\ff_n}}^2\norm{\setind_\intcc{-R}{R}(x)\opDil^j\opTrn^n\fphi(x)}^2
%20171226%        &&   \text{by \thme{CS Inequality}}&& \text{\ifxref{vsinprod}{thm:cs}}
%20171226%      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\setind_\intcc{-R}{R}(x)\opDil^j\opTrn^n\fphi(x)}^2
%20171226%        &&   \text{by definition of $\seqn{\ff_n}$}&& \text{\xref{idef:mra_glb_ffn}}
%20171226%      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\brs{\mcom{\opDil^j\opDil^{-j}}{$\opI$}\setind_\intcc{-R}{R}(x)}\brs{\opDil^j\opTrn^n\fphi(x)}}^2
%20171226%        &&   \text{by property of $\opDil$} && \text{\xref{prop:opDi}}
%20171226%      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{2^{j/2}\opDil^j\brb{\brs{\opDil^{-j}\setind_\intcc{-R}{R}(x)}\brs{\opTrn^n\fphi(x)}}}^2
%20171226%        &&   \mathrlap{\text{by \prefp{prop:DjTnfg}}}
%20171226%      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\opDil^j\brb{2^{j/2}2^{-j/2}\setind_\intcc{-R}{R}(2^{-j}x)\brs{\opTrn^n\fphi(x)}}}^2
%20171226%        &&   \text{by property of $\opDil$} && \text{\xref{prop:opDi}}
%20171226%      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\opDil^j\brb{\brs{\mcom{\opTrn^n\opTrn^{-n}}{$\opI$}\setind_\intcc{-R}{R}(2^{-j}x)}\brs{\opTrn^n\fphi(x)}}}^2
%20171226%        &&   \text{by property of $\opTrn$} && \text{\xref{prop:opTi}}
%20171226%      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\opDil^j\brb{\brs{\opTrn^n\setind_\intcc{-R}{R}(2^{-j}x+n)}\brs{\opTrn^n\fphi(x)}}}^2
%20171226%        &&   \text{by property of $\opTrn$} && \text{\xref{prop:opTi}}
%20171226%      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\opDil^j\opTrn^n\brb{\setind_\intcc{-R}{R}(2^{-j}x+n)\fphi(x)}}^2
%20171226%        &&   \text{by property of $\opDil$} && \text{\xref{prop:opDi}}
%20171226%      \\&=   \lim_{j\to-\infty}B\sum_{n\in\Z}\norm{\ff}^2\norm{\setind_\intcc{-R}{R}(2^{-j}x+n)\fphi(x)}^2
%20171226%        &&   \text{by \prope{unitary} prop.} && \text{\xref{thm:TD_unitary}}
%20171226%      \\&=   B\norm{\ff}^2\sum_{n\in\Z}\lim_{j\to-\infty}\norm{\setind_\intcc{-2^jR+n}{2^jR+n}(u)\fphi(2^{-j}(u-n))}^2
%20171226%        &&   \text{$u\eqd 2^jx+n\implies$} && x=2^{-j}(u-n)
%20171226%      \\&=   B\norm{\ff}^2\sum_{n\in\Z}\lim_{j\to-\infty}\int_{-2^jR+n}^{2^jR+n}\abs{\fphi(2^{-j}(u-n))}^2\du
%20171226%      \\&=   B\norm{\ff}^2\sum_{n\in\Z}\int_{n}^{n}\abs{\fphi(0)}^2\du
%20171226%      \\&=   0
%20171226%    \end{align*}
%20171226%
%20171226%  \item Final step in proof that $\ds\Seti\spV_j=\setn{\vzero}$: by \prefp{ilem:mra_glb_VjPj} and \prefp{ilem:mra_glb_norm}
%20171226%%\end{enumerate}
%20171226%\end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%
%20171226%
%20171226%%---------------------------------------
%20171226%\begin{proposition}
%20171226%\citetbl{
%20171226%  \citerppgc{wojtaszczyk1997}{28}{31}{0521578949}{Proposition 2.15}
%20171226%  }
%20171226%\label{prop:mra_UVj}
%20171226%%--------------------------------------
%20171226%%Let $\spO\eqd\mrasys$.
%20171226%Let a \structe{Riesz sequence} be defined as in \prefp{def:rieszseq}.
%20171226%\propbox{
%20171226%  \brb{\begin{array}{FMD}
%20171226%    (1). & $\seqn{\opTrn^n\fphi}$ is a \structe{Riesz sequence} &  and \\
%20171226%    (2). & $\Fphi(\omega)$ is \prope{continuous} at $0$         &  and \\
%20171226%    (3). & $\Fphi(0)\neq0$                                      &  
%20171226%  \end{array}}
%20171226%  \implies
%20171226%  \brb{\begin{array}{>{\ds}lD}
%20171226%     \cls{\brp{\Setu_{j\in\Z} \spV_j}} = \spLLR  & (\prope{dense} in $\spLLR$) 
%20171226%  \end{array}}
%20171226%  }
%20171226%\end{proposition}
%20171226%\begin{proof}
%20171226%\begin{enumerate}
%20171226%  \item Let $\opP_j$ be the \ope{projection operator} that generates the scaling subspace $\spV_j$ such that \label{item:mra_UVj_Pj}
%20171226%    \\\indentx$\ds\opV_j=\set{\opP_j\ff}{\ff\in\spH}$
%20171226%
%20171226%  \item definition: Choose $\ff\in\spLLR$ such that $\ff\orthog\Setu_{j\in\Z}\spV_j$.
%20171226%        Let $\Ff(\omega)$ be the \ope{Fourier Transform} \xref{def:opFT} of $\ff(x)$.
%20171226%        \label{idef:mra_UVj_f}
%20171226%
%20171226%  \item lemma: The function $\ff$ \xref{idef:mra_UVj_f} \emph{exists} because the set of functions that 
%20171226%        can be chosen to be $\ff$ at least contains $0$ (it is not the emptyset). Proof:
%20171226%        \label{ilem:mra_UVj_fexists}
%20171226%        \begin{align*}
%20171226%          \ff(x)=0
%20171226%            &\implies \inprodr{\ff}{\set{\fh\in\spLLR}{\fh\in\Setu_{j\in\Z}\spV_j}}
%20171226%          \\&= \inprodr{0}{\set{\fh\in\spLLR}{\fh\in\Setu_{j\in\Z}\spV_j}}
%20171226%          \\&= 0
%20171226%          \\&\implies\quad \ff\orthog\Setu_{j\in\Z}\spV_j
%20171226%          \\&\implies\quad \text{$\ff$ exists}
%20171226%        \end{align*}
%20171226%
%20171226%  \item lemma: $\norm{\opP_j\ff}=0\quad{\scy\forall j\in\Z}$. Proof:
%20171226%        \label{ilem:mra_UVj_Pf}
%20171226%    \begin{align*}
%20171226%      \norm{\opP_j\ff}
%20171226%        &= \norm{0}
%20171226%        && \text{by definition of $\ff$} &&\text{\xref{idef:mra_UVj_f}}
%20171226%      \\&= 0
%20171226%        && \text{by \prope{nondegenerate} property of $\normn$} && \text{\ifxref{vsnorm}{def:norm}}
%20171226%    \end{align*}
%20171226%
%20171226%  \item definition: Choose some function $\fg\in\spLLR$ such that $\Fg(\omega)=\Ff(\omega)\setind_\intcc{-R}{R}$ \xref{def:setind} 
%20171226%        for some $R>0$ 
%20171226%        and such that $\norm{\ff-\fg}<\varepsilon$.
%20171226%        Let $\Fg(\omega)$ be the \ope{Fourier Transform} \xref{def:opFT} of $\fg(x)$.
%20171226%        \label{idef:mra_UVj_g}
%20171226%
%20171226%  \item lemma: The function $\fg$ \xref{idef:mra_UVj_g} \emph{exists}. Proof: For some (possibly very large) $R$,
%20171226%        \label{idef:mra_UVj_gexists}
%20171226%    \begin{align*}
%20171226%      \varepsilon
%20171226%        &> \norm{\Ff(\omega)-\Fg(\omega)}
%20171226%        && \text{by definition of $\fg$} && \text{\xref{idef:mra_UVj_g}}
%20171226%      \\&= \norm{\opFT\ff(x)-\opFT\fg(x)}
%20171226%        && \text{by definition of $\Ff$ and $\Fg$} && \text{\xref{idef:mra_UVj_f}, \xref{idef:mra_UVj_g}}
%20171226%      \\&= \norm{\opFT\brs{\ff(x)-\fg(x)}}
%20171226%        && \text{by \prope{linearity} of $\opFT$} && \text{\xref{def:linop}}
%20171226%      \\&= \norm{\ff(x)-\fg(x)}
%20171226%        && \text{by \prope{unitary} property of $\opFT$} && \text{ \xref{thm:ft_unitary}}
%20171226%      \\&\implies\quad\text{$\fg$ exists}
%20171226%        && \mathrlap{\text{because it's possible to satisfy \prefp{idef:mra_UVj_g}}}
%20171226%    \end{align*}
%20171226%
%20171226%  \item lemma: $\norm{\opP_j\fg}<\varepsilon\quad{\scy\forall j\in\Z}$ for sufficiently large $R$. Proof:
%20171226%        \label{ilem:mra_UVj_ge}
%20171226%    \begin{align*}
%20171226%      \varepsilon
%20171226%        &>   \norm{\ff-\fg}
%20171226%        &&   \text{by definition of $\fg$} && \text{\xref{idef:mra_UVj_g}}
%20171226%      \\&\ge \norm{\opP_j\brs{\ff-\fg}}
%20171226%        &&   \text{by property of \ope{projection operator}s} && \text{\xref{def:opP}}
%20171226%      \\&=   \norm{\opP_j\ff-\opP_j\fg}
%20171226%        &&   \text{by \prope{additive} property of $\opP_j$} && \text{\ifxref{operator}{def:linop}}
%20171226%      \\&\ge \abs{\norm{\opP_j\ff}-\norm{\opP_j\fg}}
%20171226%        &&   \text{by \thme{Reverse Triangle Inequality}} && \text{\ifxref{vsnorm}{thm:rti}}
%20171226%      \\&=   \abs{0-\norm{\opP_j\fg}}
%20171226%        &&   \text{by \xref{ilem:mra_UVj_Pf}}
%20171226%      \\&=   \norm{\opP_j\fg}
%20171226%        &&   \text{by \prope{strictly positive} property of $\normn$} && \text{\xref{def:norm}}
%20171226%    \end{align*}
%20171226%
%20171226%  \item  lemma: $\fg=0$. Proof: \label{ilem:mra_UVj_g0}
%20171226%    \begin{align*}
%20171226%       0
%20171226%        &=   \lim_{j\to\infty}\norm{\opP_j\fg}^2
%20171226%        &&   \text{by \prefp{ilem:mra_UVj_ge}}
%20171226%      \\&\ge \lim_{j\to\infty}A\sum_{n\in\Z}\abs{\inprod{\opP_j\fg}{\opDil^j\opTrn^n\fphi}}^2
%20171226%        &&   \text{by \prope{frame property}} && \text{ \xref{prop:rbasis_frame}}
%20171226%      \\&=   \lim_{j\to\infty}A\sum_{n\in\Z}\abs{\inprod{\fg}{\opDil^j\opTrn^n\fphi}}^2
%20171226%        &&   \text{by definition of $\opP_j$} && \text{ \xref{item:mra_UVj_Pj}}
%20171226%      \\&=   \lim_{j\to\infty}A\sum_{n\in\Z}\abs{\inprod{\opFT\fg}{\opFT\opDil^j\opTrn^n\fphi}}^2
%20171226%        &&   \text{by \prope{unitary} property of $\opFT$} && \text{ \xref{thm:ft_unitary}}
%20171226%      \\&=   \lim_{j\to\infty}A\sum_{n\in\Z}\abs{\inprod{\Fg(\omega)}{2^{-j/2}e^{-i2^{-j}\omega n}\Fphi(2^{-j}\omega)}}^2
%20171226%        &&   \text{by \prefp{prop:FTDf}}
%20171226%      \\&=   \lim_{j\to\infty}A\sum_{n\in\Z}\abs{\inprod{\Fg(\omega)\Fphi^\ast(2^{-j}\omega)}{2^{-j/2}e^{-i2^{-j}\omega n}}}^2
%20171226%        &&   \text{by property of $\inprodn$ in $\spLLR$}
%20171226%      \\&=   \lim_{j\to\infty}A\norm{\Fg(\omega)\Fphi^\ast(2^{-j}\omega)}^2
%20171226%        &&   \text{by \thme{Parseval's Identity}} && \text{\xref{thm:fst}}
%20171226%      \\&=   A\norm{\Fg(\omega)\Fphi^\ast(0)}^2
%20171226%        &&   \text{by left hypothesis (2)}
%20171226%      \\&=   A\abs{\Fphi^\ast(0)}^2\,\norm{\Fg(\omega)}^2
%20171226%        &&   \text{by \prope{homogeneous} property of $\normn$} && \text{\ifxref{vsnorm}{def:norm}}
%20171226%      \\&=   A\abs{\Fphi(0)}^2\,\norm{\fg}^2
%20171226%        &&   \text{by \prope{unitary} property of $\opFT$} && \text{\xref{thm:ft_unitary}}
%20171226%      \\&\implies \norm{\fg}=0
%20171226%        &&   \text{by left hypothesis (3)}
%20171226%      \\&\iff     \fg=0
%20171226%        &&   \text{by \prope{nondegenerate} property of $\normn$} && \text{\ifxref{vsnorm}{def:norm}}
%20171226%      %\\&\implies  \cls{\brp{\Setu_{j\in\Z}\spV_j}}=\spLLR
%20171226%    \end{align*}
%20171226%
%20171226%  \item Final step in proof that $\ds\cls{\brp{\Setu_{j\in\Z} \spV_j}} = \spLLR$:
%20171226%    \begin{align*}
%20171226%      \fg
%20171226%        &=0
%20171226%        && \text{by \prefp{ilem:mra_UVj_g0}}
%20171226%      \\&\implies\ff=0
%20171226%        && \text{by definition of $\fg$} && \text{\xref{idef:mra_UVj_g}}
%20171226%      \\&\implies \cls{\brp{\Setu_{j\in\Z} \spV_j}} = \spLLR
%20171226%    \end{align*}
%20171226%\end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%%=======================================
%20171226%%\subsection{Separable Hilbert Space}
%20171226%%=======================================
%20171226%\pref{def:mra} defines an MRA on the space $\spLLR$, which is a special case of a \structe{separable Hilbert space}.
%20171226%A Hilbert space\ifsxrefs{seq}{def:hilbert}is a \structe{linear space}\ifsxrefs{vector}{def:vspace}that is 
%20171226%equipped with an \structe{inner product}\ifsxref{vsinprod}{def:inprod},
%20171226%is \prope{complete}\ifsxrefs{seq}{def:complete}with respect to the 
%20171226%\structe{metric}\ifsxrefs{metric}{def:metric}induced by the inner product,
%20171226%and contains a subset that is \prope{dense}\ifsxrefs{topology}{def:dense}in $\spLLR$.
%20171226%
%20171226%An \structe{inner product} on a linear space endows the linear space with a \structe{topology}\ifsxref{topology}{def:topology}.
%20171226%The sum such as $\sum_{n=1}^\xN \alpha_n \ff_n$ is finite and thus suitable for a finite linear space only.
%20171226%An infinite space requires an infinite sum $\sum_{n=1}^\infty \alpha_n \fphi_n$, and an infinite sum is defined
%20171226%in terms of a limit \xref{def:suminf}.
%20171226%%  \\\indentx$\ds\sum_{n=1}^\infty \alpha_n \fphi_n \eqd \lim_{\xN\to\infty}\mcom{\ds\sum_{n=1}^\xN \alpha_n \fphi_n}{partial sum}$.\\
%20171226%The limit, in turn, is defined in terms of a \structe{topology}\ifsxref{topology}{def:topology}.
%20171226%The \structe{inner product}\ifsxrefs{vsinprod}{def:inprod} induces a \structe{norm} \xref{def:norm} which induces a 
%20171226%\structe{metric}\ifsxrefs{metric}{def:metric} which induces a topology\ifsxref{metric}{thm:(X,d)->(X,t)}.
%20171226%
%20171226%%A common example of a separable Hilbert space is the space of square integrable functions, $\spLLR$.
%20171226%%And in fact, for the design examples in this book, the reader may simply set $\spLLR=\spLLR$.
%20171226%
%20171226%%%---------------------------------------
%20171226%%\begin{proposition}
%20171226%%\label{prop:Vn_separable}
%20171226%%%---------------------------------------
%20171226%%Let $\MRAspaceLLRV$ be an \structe{MRA space}.
%20171226%%\propbox{
%20171226%%  \text{$\spV_j$ is \prope{separable}}\qquad\scy\forall j\in\Z
%20171226%%  }
%20171226%%\end{proposition}
%20171226%%\begin{proof}
%20171226%%\begin{enume}
%20171226%%  \item By \pref{def:mra}, $\spLLR$ is \prope{separable}.
%20171226%%  \item So by \prefp{thm:XdYd_separable}, each $\spV_j$ is \prope{separable} as well.
%20171226%%\end{enume}
%20171226%%\end{proof}
%20171226%%
%20171226%
%20171226%
%20171226%%=======================================
%20171226%%\subsection{Closure properties}
%20171226%%=======================================
%20171226%\pref{def:mra} defines each subspace $\spV_j$ to be \prope{closed} ($\spV_j=\cls{\spV_j}$) in $\spLLR$.
%20171226%As one might imagine, the properties of \prope{completeness}\ifsxrefs{seq}{def:complete}and 
%20171226%\prope{closure}\ifsxrefs{topology}{def:clsA}%, \prefp{def:subspace_closed}
%20171226%are closely related. % (see next proposition).
%20171226%Moreover, Every \prope{complete} sequence is also \prope{bounded}\ifsxref{metric}{def:bounded},
%20171226%and so each subspace $\spV_j$ is \prope{bounded} as well. % (see \prefp{prop:Vn_bounded}).
%20171226%%Both are topological properties. Completeness is defined on sequences \xref{def:sequence}; %closure is defined on sets.
%20171226%
%20171226%
%20171226%
%20171226%%%---------------------------------------
%20171226%%\begin{proposition}
%20171226%%%---------------------------------------
%20171226%%Let $\MRAspaceLLRV$ be an \structe{MRA space}.
%20171226%%\propbox{
%20171226%%  \mcom{\spLLR=\cls\spLLR}{$\spLLR$ is \prope{closed}.}
%20171226%%  }
%20171226%%\begin{proof}
%20171226%%        The limit of an expansion (if the limit exists) may be inside the linear space or outside. \label{item:mra_Hcomplete}
%20171226%%        We would like it to be inside. That is, we would like the space $\spLLR$ to contain all its 
%20171226%%        \structe{limit points} \xref{def:limitpnt}.
%20171226%%        The space $\spLLR$ does contain all its limit points because by definition, it is \propb{complete} \xref{def:complete}.
%20171226%%        Any metric space (which includes all inner product spaces) that is \prope{complete} is also \prope{closed}
%20171226%%        \xref{thm:comcls}.
%20171226%%        And a metric space is \prope{closed} if and only if it contains all its limit points \xref{thm:cst}.
%20171226%%        An inner product space that is \prope{complete} is called a \structe{Hilbert space} \xref{def:hilbert}.
%20171226%%\end{proof}
%20171226%
%20171226%%---------------------------------------
%20171226%\begin{proposition}
%20171226%\label{prop:Vn_complete}
%20171226%%---------------------------------------
%20171226%Let $\MRAspaceLLRV$ be an \structe{MRA space}.
%20171226%\propbox{
%20171226%  \text{Each subspace $\spV_j$ is \prope{complete}.}
%20171226%  }
%20171226%\end{proposition}
%20171226%\begin{proof}
%20171226%\begin{enume}
%20171226%  \item By definition \pref{def:mra}, $\spLLR$ is \prope{complete}. 
%20171226%  \item In any metric space, (which includes all inner product spaces such as $\spLLR$),
%20171226%        a \prope{closed} subspace of a \prope{complete} metric space is itself also \prope{complete}\ifsxref{seq}{thm:comcls}.
%20171226%  \item In any \prope{complete} metric space $\spX$ (which includes all Hilbert spaces such as $\spLLR$), 
%20171226%        the two properties coincide---that is, a subspace is complete \emph{if and only if} 
%20171226%        it is closed in the space $\spX$\ifsxref{seq}{cor:comcomcls}.
%20171226%  \item So because $\spLLR$ is \prope{complete} and each $\spV_j$ is \prope{closed}, then each $\spV_j$ is also \prope{complete}.
%20171226%\end{enume}
%20171226%\end{proof}
%20171226%
%20171226%%%---------------------------------------
%20171226%%\begin{proposition}
%20171226%%\label{prop:Vn_bounded}
%20171226%%%---------------------------------------
%20171226%%Let $\MRAspaceLLRV$ be an \structe{MRA space}.
%20171226%%\propbox{\begin{array}{MMC}
%20171226%%  $\spLLR$   & is \prope{bounded}.\\
%20171226%%  $\spV_j$ & is \prope{bounded} & \forall n\in\Z .
%20171226%%\end{array}}
%20171226%%\end{proposition}
%20171226%%\begin{proof}
%20171226%%\begin{enume}
%20171226%%  \item Every \prope{complete} metric space is \prope{bounded}\ifsxref{seq}{thm:convergent==>cauchy}.
%20171226%%  \item $\spLLR$ is \prope{complete}, so it is also \prope{bounded} \xref{def:mra}.
%20171226%%  \item Each $\spV_j$ is \prope{complete}, so each $\spV_j$ is also \prope{bounded} \xref{prop:Vn_complete}.
%20171226%%\end{enume}
%20171226%%\end{proof}
%20171226%
%20171226%%=======================================
%20171226%\subsection{Order structure}
%20171226%%=======================================
%20171226%
%20171226%\begin{minipage}{\tw-58mm}%
%20171226%  A \structe{multiresolution analysis} \xref{def:mra} together with the set inclusion relation $\subseteq$
%20171226%  forms the \hie{linearly ordered set} \ifdochas{order}{\xref{def:toset}}
%20171226%  $\hxs{\opair{\seqn{\spV_j}}{\subseteq}}$, illustrated to the right by a \structe{Hasse diagram}\ifsxref{order}{def:hasse}.
%20171226%  Subspaces $\spV_j$ increase in ``size" with increasing $j$.
%20171226%  That is, they contain more and more vectors (functions) for larger and larger $j$---%
%20171226%  with the upper limit of this sequence being $\spLLR$.
%20171226%  %and the subspace $\spZero$ (smallest $n$) containing only the $\vzero$ vector.
%20171226%  Alternatively, we can say that approximation within a subspace $\spV_j$ 
%20171226%  yields greater ``\hie{resolution}" for increasing $j$.
%20171226%  %In general, the number of subspaces in such a sequence can be countably infinite (e.g. $n\in\Z$).
%20171226%\end{minipage}%
%20171226%\hfill\tbox{\includegraphics{graphics/latmra.pdf}}%
%20171226%
%20171226%The \structe{least upper bound} (\structe{l.u.b.}) of the linearly ordered set $\opair{\seqn{\spV_j}}{\subseteq}$ is $\spLLR$ \xref{def:mra}:
%20171226%  \\\indentx
%20171226%   $\ds\clsp{\Setu_{j\in\Z} \spV_j} = \spLLR$.
%20171226%   %$\ds\lim_{\xN\to\infty}\spV_j \eqd \clsp{\Setu_{j\in\Z} \spV_j} = \spLLR$.
%20171226%  \\
%20171226%
%20171226%%      \propb{upper bounded}:
%20171226%%  Furthermore, the property $\clsp{\Setu_{j\in\Z} \spV_j} = \spLLR$
%20171226%%  demonstrates that the sequence of scaling subspaces $\seqn{\spV_j}$ is \prope{upper bounded} by $\spLLR$. % \xref{def:complete_set}.
%20171226%%  Because the subspaces are nested (or linearly ordered with respect to $\subset$) such that $\spV_j\subset\spV_{j+1}$,
%20171226%%  we could define the least upper bound (or the limit) of such a sequence 
%20171226%%  as\citetbl{Many thanks to William Elliot, David C. Ullrich, and Seymour J. Shmuel Metz for help with this topic.
%20171226%%             %\url{https://groups.google.com/forum/\#!topic/sci.math/YD4N58JH5to}
%20171226%%            }
%20171226%
%20171226%The \structe{greatest lower bound} (\structe{g.l.b.}) of the linearly ordered set $\opair{\seqn{\spV_j}}{\subseteq}$ is $\spZero$ \xref{prop:mra_glb}:
%20171226%  \\\indentx
%20171226%    $\ds\Seti_{j\in\Z}\spV_j = \spZero$.
%20171226%  \\
%20171226%
%20171226%All linear subspaces contain the zero vector\ifsxref{subspace}{prop:subspace_prop}.
%20171226%So the intersection of any two subspaces must at least contain $\vzero$.
%20171226%If the intersection of any two linear subspaces $\spX$ and $\spY$ is exactly $\setn{\vzero}$, 
%20171226%then for any vector in
%20171226%the sum of those subspaces ($\vu\in\spX\adds\spY$) there are \propb{unique} vectors $\ff\in\spX$ and 
%20171226%$\fg\in\spY$ such that $\vu=\ff+\fg$.
%20171226%This is \emph{not} necessarily true if the intersection contains more than just $\setn{\vzero}$
%20171226%\ifsxref{subspace}{thm:XY0_unique}.
%20171226%
%20171226%
%20171226%%%=======================================
%20171226%%\subsection{Bases for wavelet system}
%20171226%%%=======================================
%20171226%%%%A linear space is a separable Hilbert space if and only if it has a complete basis.
%20171226%%%Note that \pref{def:mra} does not require $\lim_{\xN\to\infty}\spV_j$ to be equal to $\spLLR$, 
%20171226%%%it is only requires it to be \prope{dense} in $\spLLR$
%20171226%%%(just as the rationals are dense in the real numbers).
%20171226%%%In the set of real numbers, a countable union of closed sets is called a $\symx{\setFsigma}$ set
%20171226%%%($\setF$ stands for the French word \hie{ferm/'e} or \prope{closed}, and $\sigma$ stands for the French word \hie{somme} or sum).\citetbl{
%20171226%%%  \citerpg{carothers2000}{130}{0521497566}\\
%20171226%%%  \citerpg{givant2009}{270}{0387402934}
%20171226%%%  }                                                                             
%20171226%%
%20171226%%\prefp{def:mra} defines an MRA on the space $\spLLR$.
%20171226%%The space $\spLLR$ is an example of a Hilbert space. % $\spLLR$. 
%20171226%%A Hilbert space is a linear space equipped with an inner product 
%20171226%%and that is complete with respect to the topology induced by the inner product.
%20171226%%
%20171226%%\begin{enumerate}
%20171226%%  \item A \structb{linear space} \ifsxrefs{vector}{def:vspace} supports the expansion of a vector $\ff$
%20171226%%        (e.g. a function) in terms of a set of \structe{coordinates} $\setxn{\alpha_n}$ and a 
%20171226%%        \structe{Hamel basis} $\setxn{\fphi_n}$\ifsxrefs{frames}{def:hamel}such that \label{item:mra_hamel}
%20171226%%          \\\indentx$\ds \ff(x)=\sum_{n=1}^\xN \alpha_n \fphi_n(x)$.\\
%20171226%%        If such coordinates exist for a vector $\ff$ and basis $\setxn{\fphi_n}$, 
%20171226%%        then those coordinates are \prope{unique}\ifsxref{frames}{thm:hamel_unique}.
%20171226%%
%20171226%%  \item The Hamel basis described in \pref{item:mra_hamel} provides sufficient support for expansion in finite linear spaces, 
%20171226%%        but is problematic in infinite spaces.                           
%20171226%%        In an infinite linear space with a topology (such as a Banach space or a Hilbert space),
%20171226%%        a \structe{Schauder basis}\ifsxrefs{frames}{def:schauder}is often used.
%20171226%%        The Schauder basis is defined in terms of a special type of convergence called \prope{strong convergence}\ifsxref{seq}{def:strong_converge}.
%20171226%%        Strong convergence is defined in terms of the norm induced by the inner product: \label{item:mra_strong}
%20171226%%        \\\indentx$\ds  
%20171226%%          \ff \eqs \sum_{n=1}^\infty\alpha_n\fphi_n
%20171226%%              \eqd \lim_{\xN\to\infty}\sum_{n=1}^\xN\alpha_n\fphi_n
%20171226%%              \implies
%20171226%%              \mcom{\ds\lim_{\xN\to\infty}\norm{\ff-\sum_{n=1}^\xN\alpha_n\fphi_n}=0}{\prope{strong convergence}}
%20171226%%        $.\\
%20171226%%        %\\\indentx$\ds  
%20171226%%        %  \ff \eqs \sum_{n=1}^\infty\inprod{\ff}{\fphi_n}\fphi_n
%20171226%%        %      \eqd \lim_{\xN\to\infty}\sum_{n=1}^\xN\inprod{\ff}{\fphi_n}\fphi_n
%20171226%%        %      \implies
%20171226%%        %      \mcom{\ds\lim_{\xN\to\infty}\norm{\ff-\sum_{n=1}^\xN\inprod{\ff}{\fphi_n}\fphi_n}=0}{\prope{strong convergence}}
%20171226%%        %$.\\
%20171226%%        That is, the sum $\sum_{n=1}^\infty\alpha_n\fphi_n$ is by definition  
%20171226%%        the limit of the partial sums
%20171226%%        $\sum_{n=1}^\xN\alpha_n\fphi_n$\ifsxref{series}{def:suminf},
%20171226%%        and that these sums \prope{converge strongly} (``$\eqs$",\ifsxref{seq}{def:strong_converge}) to a limit $\ff$
%20171226%%        with respect to the topology induced by the norm $\normn$, which in turn is 
%20171226%%        induced by the inner product $\inprodn$. % \xref{def:norm=inprod}.
%20171226%%        The completeness property ensures that all of these limits $\ff$ are also in the space $\spLLR$.
%20171226%% 
%20171226%%  \item In an MRA space $\MRAspaceLLRV$, the space $\spLLR$ is separable \xref{def:mra}, and the subspaces $\spV_j$ are
%20171226%%        separable as well. % \xref{prop:Vn_separable}.
%20171226%%        The property of a space being separable is very important in analysis:
%20171226%%    \begin{enumerate}
%20171226%%      \item Every Banach space (which includes all Hilbert spaces such as $\spLLR$ and each $\spV_j$) with 
%20171226%%            a Schauder basis is \prope{separable}\ifsxref{frames}{thm:Bschauder==>separable}.\label{item:mra_Bschauder_separable}
%20171226%%      \item The converse is \emph{not} true---not every separable Banach space has a basis\ifsxrefpo{frames}{BasisProblem}.
%20171226%%    \end{enumerate}
%20171226%%
%20171226%%  \item Besides providing a topology, the \structe{inner product} also supports 
%20171226%%        the notion of a subspace geometry, 
%20171226%%        including the property of \prope{orthogonality}\ifsxref{vsinprod}{def:orthog}.
%20171226%%    \begin{enumerate}
%20171226%%      \item Orthogonality supports the \structe{Fourier expansion}\ifsxrefs{frames}{def:hspace_fex}of a vector $\ff$ over an 
%20171226%%        \structe{orthornormal basis} $\setxZp{\fphi_n}$ in the form \label{item:mra_inprod}
%20171226%%        \\\indentx$\ds  
%20171226%%          \ff \eqs \sum_{n=1}^\infty \mcom{\inprod{\ff}{\fphi_n}}{\structe{Fourier coefficient}}\fphi_n
%20171226%%          $
%20171226%%      \item In contrast to \pref{item:mra_Bschauder_separable}, life in Hilbert spaces is much simpler. 
%20171226%%            A Hilbert space has a Schauder basis \emph{if and only if} it is 
%20171226%%            separable \ifsxrefs{frames}{thm:schauder<==>separable}. 
%20171226%%            And so $\spLLR$ and each $\spV_j$ \emph{have} Schauder bases\ifsxref{frames}{thm:schauder<==>separable}.
%20171226%%      \item A special case of a Schauder basis is an orthonormal basis\ifsxref{frames}{def:basis_ortho}.
%20171226%%            A Hilbert space has an orthonormal basis if and only if it is separable\ifsxref{frames}{thm:ortho<==>separable}.
%20171226%%            And so $\spLLR$ and each $\spV_j$ \emph{have} orthonormal bases as well% 
%20171226%%            \ifdochas{frames}{ (\xref{thm:schauder<==>separable}, \xref{thm:HV_orthobasis})}.
%20171226%%      \item It is always possible to construct an orthonormal basis for a separable Hilbert space using the 
%20171226%%            \thme{Graham Schmidt orthogonalization} procedure.
%20171226%%    \end{enumerate} 
%20171226%%
%20171226%%
%20171226%%
%20171226%%\item 
%20171226%%  %Note that the intersection of any two orthogonal subspaces contains the zero vector only \xref{thm:YoZ==>YZ0}.
%20171226%%  A basis\ifsxrefs{frames}{sec:hspace_bases} $\setxn{\fphi_n}$ that is \prope{orthonormal}  possesses a number of useful properties
%20171226%%  including the following:
%20171226%%    \begin{enumerate}
%20171226%%      \item The \thmb{Pathogorean Theorem} holds such that  $\norm{\sum_{n=1}^\xN \fphi_{n}}^2 = \sum_{n=1}^\xN \norm{\fphi_n}^2$\ifsxref{frames}{thm:pythag}.
%20171226%%      \item The sequence $\setn{\fphi_n}$ is \prope{linearly independent}\ifsxref{frames}{thm:orthog==>linin}.
%20171226%%      %\item \thmb{Bessel's equality} holds such that 
%20171226%%      %      $\ds\norm{\ff-\sum_{i=n}^\xN \inprod{\ff}{\fphi_n} \fphi_n }^2 = \norm{\ff}^2 - \sum_{i=1}^\xN |\inprod{\ff}{\fphi_n}|^2$
%20171226%%      \item \thmb{Bessel's inequality} holds such that 
%20171226%%            $\ds\sum_{n=1}^\infty \abs{\inprod{\ff}{\fphi_n}}^2 \le \norm{\ff}^2$\ifsxref{frames}{thm:bessel_ineq}.
%20171226%%      \item Every vector $\ff$ in $\spLLR$ has a \structe{Fourier expansion}\ifsxrefs{frames}{def:hspace_fex}such that \\
%20171226%%            $\ds\ff\eqs\sum_{n=1}^\infty \inprod{\ff}{\fphi_n} \fphi_n$\ifsxref{frames}{thm:hspace_fex}.
%20171226%%      \item \thmb{Parseval's identity} holds \textbf{if and only if} $\setn{\fphi_n}$ is an orthonormal basis:\\
%20171226%%            $\ds\norm{\ff}^2 \eqs\sum_{n=1}^\infty \abs{\inprod{\ff}{\fphi_n}}^2  \quad\scy\forall\ff\in\setX$%
%20171226%%            \ifsxref{frames}{thm:parsevalid}.
%20171226%%      \item The \structe{Fourier expansion} of a vector $\ff$ in a Hilbert space $\spLLR$
%20171226%%            on an orthonormal basis $\setn{\fphi_n}$ 
%20171226%%            that spans a subspace $\spY\subseteq\spLLR$ is the best approximation of $\ff$ in $\spY$ with respect to
%20171226%%            the metric induced by the inner product (\thme{Best Approximation Theorem}\ifsxref{frames}{thm:bat}).
%20171226%%    \end{enumerate}
%20171226%%
%20171226%%
%20171226%%  \item \structb{Riesz basis}: \pref{def:mra} does not explicitly require an orthonormal basis.
%20171226%%         Instead, it only specifies the weaker (more general) constraint of a Riesz basis.
%20171226%%         This constraint implies simply that there is a linear mapping between the Riesz basis and an orthonormal basis.
%20171226%%         In particular, an orthonormal basis can be constructed from the Riesz basis.
%20171226%%\end{enumerate}
%20171226%
%20171226%%%--------------------------------------
%20171226%%\begin{proposition}
%20171226%%\label{thm:HV_orthobasis}
%20171226%%%--------------------------------------
%20171226%%Let $\MRAspaceLLRV$ be an MRA space.
%20171226%%\propbox{\begin{array}{MMC}
%20171226%%  $\spLLR$   & has an \structe{orthonormal basis}\\
%20171226%%  $\spV_j$ & has an \structe{orthonormal basis} & \forall j\in\Z
%20171226%%\end{array}}
%20171226%%\end{proposition}
%20171226%%\begin{proofns}
%20171226%%\begin{enume}
%20171226%%  %\item By \prefp{def:mra}, $\spLLR$ is \prope{separable}.
%20171226%%  \item $\spLLR$ is \prope{separable}.
%20171226%%  \item Therefore $\spLLR$ has an orthonormal basis\ifsxref{frames}{thm:ortho<==>separable}.
%20171226%%  \item Therefore each $\spV_j$ is \prope{separable}\ifsxref{subspace}{prop:Vn_separable}.
%20171226%%  \item So each $\spV_j$ has an orthonormal basis\ifsxref{frames}{thm:ortho<==>separable}.
%20171226%%\end{enume}
%20171226%%\end{proofns}
%20171226%
%20171226%%=======================================
%20171226%\subsection{Dilation equation}
%20171226%%=======================================
%20171226%Several functions in mathematics exhibit a kind of \prope{self-similar} or \prope{recursive} property:
%20171226%\begin{listi}
%20171226%  \item If a function $\ff(x)$ is \prope{linear}, then \xref{ex:TD_flinear}
%20171226%        \\\indentx$\ds\ff(x) = \ff(1)x - \ff(0)\opTrn x$.   %{$\setn{x,\,\opTrn x}$ is a \structe{basis} for $\clLcc$}$.
%20171226%  \item If a function $\ff(x)$ is sufficiently \prope{bandlimited}, then the \structe{Cardinal series} \xref{ex:TD_cardinalseries} demonstrates
%20171226%        \\\indentx$\ds\ff(x) = \sum_{n=1}^\infty \ff(n) \opTrn^n\frac{\sin\brs{\pi(x)}}{\pi(x)}$.
%20171226%  \item \fncte{B-splines} \xref{thm:bspline_recursion} are another example:
%20171226%        \\\indentx$\ds\fN_n(x)   = \frac{1}{n}x\fN_{n-1}(x) - \frac{1}{n}x\opTrn\fN_{n-1}(x) + \frac{n+1}{n}\opTrn\fN_{n-1}(x)  \qquad\scy\forall n\in\Znn\setd\setn{1},\,  \forall x\in\R$.
%20171226%\end{listi}
%20171226%
%20171226%The scaling function $\fphi(x)$ \xref{def:mra} also exhibits a kind of \prope{self-similar} property.
%20171226%By \prefp{def:mra}, the dilation $\opDil\ff$ of each vector $\ff$ in $\spV_0$ is in $\spV_1$.
%20171226%If $\setxZ{\opTrn^n\fphi}$ is a basis for $\spV_0$,
%20171226%then $\setxZ{\opDil\opTrn^n\fphi}$ is a basis for $\spV_1$,
%20171226%$\setxZ{\opDil^2\opTrn^n\fphi}$ is a basis for $\spV_2$, \ldots;
%20171226%and in general $\set{\opDil^j\opTrn^m\fphi}{j\in\Z}$ is a basis for $\spV_j$.
%20171226%Also, if $\fphi$ is in $\spV_0$, then it is also in $\spV_1$ (because $\spV_0\subset\spV_1$).
%20171226%And because $\fphi$ is in $\spV_1$ and because $\setxZ{\opDil\opTrn^n\fphi}$ is a basis for $\spV_1$,
%20171226%$\fphi$ is a linear combination of the elements in $\setxZ{\opDil\opTrn^n\fphi}$.
%20171226%That is, $\fphi$ can be represented as a linear combination of translated and dilated versions of itself.
%20171226%The resulting equation is called the \hie{dilation equation} (\pref{def:dilation_eq}, next).\footnote{%
%20171226%The property of \prope{translation invariance} is of particular significance in the theory of 
%20171226%\structe{normed linear spaces} (a Hilbert space is a complete normed linear space equipped with an inner product)%
%20171226%\ifdochas{vsnorm}{---see \prefp{lem:vsn_ti} and \prefp{thm:vsn_d2norm}}.
%20171226%}
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{definition}
%20171226%\citetbl{
%20171226%  \citerp{jawerth}{7}
%20171226%  }
%20171226%\label{def:dilation_eq}
%20171226%%--------------------------------------
%20171226%Let $\MRAspaceLLRV$ be a \structe{multiresolution analysis space} with scaling function $\fphi$ \xref{def:mra}.
%20171226%Let $\seqxZ{h_n}$ be a \structe{sequence} \xref{def:seq} in $\spllR$ \xref{def:spllR}.
%20171226%\defboxp{
%20171226%  The equation 
%20171226%    \\\indentx$\ds\fphi(x)=\sum_{n\in\Z}  h_n \opDil \opTrn^n \fphi(x)\qquad\scy\forall x\in\R$\\
%20171226%  is called the \equd{dilation equation}.
%20171226%  It is also called the \equd{refinement equation},
%20171226%  \equd{two-scale difference equation}, and \equd{two-scale relation}.
%20171226%  }
%20171226%\end{definition}
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{theorem}[\thmd{dilation equation}]
%20171226%\label{thm:h->phi}
%20171226%\label{thm:dilation_eq}
%20171226%%--------------------------------------
%20171226%%Let $\MRAspaceLLRV$ be a \structe{multiresolution analysis space} with scaling function $\fphi$ \xref{def:mra}.
%20171226%%Let $\mrasys$ be an \structe{MRA system} \xref{def:mrasys}.
%20171226%Let an \structe{MRA space} and \fncte{scaling function} be as defined in \prefp{def:mra}.
%20171226%%Let $\Fphi(\omega)$ be the \fncte{Fourier transform}\ifsxrefs{harFour}{def:ft}of $\fphi(x)$.
%20171226%%Let $\Dh(\omega)$ be the \fncte{Discrete time Fourier transform}\ifsxref{dsp}{def:dtft} of $\seqn{h_n}$.
%20171226%%\\Let $\ds\prod_{n=1}^\infty x_n \eqd \lim_{\xN\to\infty}\prod_{n=1}^\xN x_n$.
%20171226%\thmbox{
%20171226%  \brb{\begin{array}{M}
%20171226%    $\MRAspaceLLRV$ is an \structe{MRA space}\\ 
%20171226%    with \structe{scaling function} $\fphi$
%20171226%  \end{array}}
%20171226%  \quad\implies\quad
%20171226%  \mcom{\brb{\begin{array}{>{\ds}l}
%20171226%    \scy\exists \seqxZ{h_n} \st\\
%20171226%    \fphi(x)=\sum_{n\in\Z}  h_n \opDil \opTrn^n \fphi(x)\qquad
%20171226%    \scy\forall x\in\R
%20171226%  \end{array}}}{\prope{dilation equation in ``time"}}
%20171226%  }
%20171226%\end{theorem}
%20171226%\begin{proof}
%20171226%    \begin{align*}
%20171226%      \fphi &\in \spV_0
%20171226%            && \text{by \prefp{def:mra}}
%20171226%          \\&\subseteq \spV_1
%20171226%            && \text{by \prefp{def:mra}}
%20171226%          \\&= \Span\setxZ{\opDil\opTrn^n\fphi(x)}
%20171226%          \\&\implies 
%20171226%             \exists \seqxZ{h_n} \st
%20171226%                \fphi = \sum_{n\in\Z} h_n \opDil \opTrn^n \fphi
%20171226%    \end{align*}
%20171226%\end{proof}
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{lemma}
%20171226%\citetbl{
%20171226%  \citerpg{mallat}{228}{012466606X}
%20171226%  }
%20171226%\label{lem:Fphi}
%20171226%%--------------------------------------
%20171226%Let $\fphi(x)$ be a function in $\spLLR$ \xref{def:spLLR}.
%20171226%Let $\Fphi(\omega)$ be the \fncte{Fourier transform}\ifsxrefs{harFour}{def:ft}of $\fphi(x)$.
%20171226%Let $\Dh(\omega)$ be the \fncte{Discrete time Fourier transform}\ifsxref{dsp}{def:dtft} of a sequence $\seqnZ{h_n}$.
%20171226%\lembox{
%20171226%  \begin{array}{>{\ds}lc rc>{\ds}lCD}
%20171226%  {\scy(A)}\quad\fphi(x)=\sum_{n\in\Z}  h_n \opDil \opTrn^n \fphi(x)\quad{\scy \forall x\in\R} %{\prope{dilation equation in ``time" (A)}}
%20171226%    &\iff&
%20171226%    \Fphi\brp{\omega} &=& \cwt \: \Dh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
%20171226%                        & \forall \omega\in\R
%20171226%                        & (1)
%20171226%  \\&\iff&
%20171226%    \Fphi\brp{\omega} &=& \Fphi\brp{\frac{\omega}{2^\xN}} \prod_{n=1}^\xN \cwt\:\Dh\brp{\frac{\omega}{2^n}}
%20171226%                        & \forall n\in\Zp,\,\omega\in\R
%20171226%                        & (2)
%20171226%  \end{array} 
%20171226%  }
%20171226%\end{lemma}
%20171226%\begin{proof}
%20171226%\begin{enumerate}
%20171226%  \item Proof that (A)$\implies$(1): \label{item:Fphi_A1}
%20171226%    \begin{align*}
%20171226%      \Fphi\brp{\omega}
%20171226%        &\eqd \opFT\fphi
%20171226%      \\&= \opFT\sum_{n\in\Z} h_n \opDil \opTrn^n \fphi(x)
%20171226%        && \text{by (A)}
%20171226%      \\&= \sum_{n\in\Z} h_n \opFT\opDil\opTrn^n \fphi(x)
%20171226%      \\&= \sum_{n\in\Z} h_n \mcom{\cwt e^{-i\frac{\omega}{2} n}\fphi\brp{\frac{\omega}{2}}}{$\opFT\opDil\opTrn^n \fphi(x)$}
%20171226%        && \text{by \prefp{prop:FTDf}}
%20171226%      \\&= \cwt \mcom{\brs{\sum_{n\in\Z} h_n e^{-i\frac{\omega}{2} n}}}{$\Dh(\omega/2)$} \Fphi\brp{\frac{\omega}{2}}
%20171226%      \\&= \cwt\:\Dh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
%20171226%        && \text{by definition of \ope{DTFT} \xref{def:dtft}}
%20171226%    \end{align*}
%20171226%
%20171226%  \item Proof that (A)$\impliedby$(1):
%20171226%    \begin{align*}
%20171226%      \fphi(x) 
%20171226%        &= \opFTi\Fphi(\omega)
%20171226%        && \text{by definition of $\Fphi(\omega)$}
%20171226%      \\&= \opFTi\cwt\:\Dh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
%20171226%        && \text{by (1)}
%20171226%      \\&= \opFTi\cwt\:\sum_{n\in\Z}h_n e^{-i\frac{\omega}{2} n}\: \Fphi\brp{\frac{\omega}{2}}
%20171226%        && \text{by definition of \ope{DTFT} \xref{def:dtft}}
%20171226%      \\&= \cwt\:\sum_{n\in\Z}h_n \opFTi e^{-i\frac{\omega}{2} n}\: \Fphi\brp{\frac{\omega}{2}}
%20171226%        && \text{by property of linear operators}
%20171226%      \\&= \cwt\:\sum_{n\in\Z}h_n \opFTi \opFT\opDil\opTrn^n\fphi
%20171226%        && \text{by \prefp{prop:FTDf}}
%20171226%      \\&= \sum_{n\in\Z} h_n \opDil\opTrn^n \fphi(x)
%20171226%    \end{align*}
%20171226%
%20171226%  \item Proof that (1)$\implies$(2):
%20171226%    \begin{enumerate}
%20171226%      \item Proof for $\xN=1$ case:
%20171226%        \begin{align*}
%20171226%          \brlr{\Fphi\brp{\frac{\omega}{2^\xN}}\:\prod_{n=1}^\xN \cwt \Dh\brp{\frac{\omega}{2^n}}}_{\xN=1}
%20171226%            &= \cwt\:\Dh\brp{\frac{\omega}{2}}\Fphi\brp{\frac{\omega}{2}}
%20171226%          \\&= \Fphi(\omega)
%20171226%            && \text{by (1)}
%20171226%        \end{align*}
%20171226%
%20171226%      \item Proof that [$\xN$ case]$\implies$[$\xN+1$ case]:
%20171226%        \begin{align*}
%20171226%          \Fphi\brp{\frac{\omega}{2^{\xN+1}}}\:\prod_{n=1}^{\xN+1} \cwt \Dh\brp{\frac{\omega}{2^n}}
%20171226%            &= \brs{\prod_{n=1}^{\xN} \cwt \Dh\brp{\frac{\omega}{2^n}}}
%20171226%               \mcom{\cwt \Dh\brp{\frac{\omega}{2^{N+1}}}\Fphi\brp{\frac{\omega}{2^{\xN+1}}}}{$\Fphi(\omega/2^\xN)$}
%20171226%          \\&= \Fphi(\omega/2^\xN) \prod_{n=1}^{\xN} \cwt \Dh\brp{\frac{\omega}{2^n}}
%20171226%          \\&= \Fphi(\omega)
%20171226%            && \text{by [$\xN$ case] hypothesis}
%20171226%        \end{align*}
%20171226%    \end{enumerate}
%20171226%
%20171226%  \item Proof that (1)$\impliedby$(2):
%20171226%    \begin{align*}
%20171226%      \Fphi(\omega)
%20171226%        &= \brlr{\Fphi\brp{\frac{\omega}{2^{\xN}}}\:\prod_{n=1}^{\xN} \cwt \Dh\brp{\frac{\omega}{2^n}}}_{\xN=1}
%20171226%        && \text{by (2)}
%20171226%      \\&= \Fphi\brp{\frac{\omega}{2}}\cwt \Dh\brp{\frac{\omega}{2}}
%20171226%      \\&= \cwt\Dh\brp{\frac{\omega}{2}}\Fphi\brp{\frac{\omega}{2}} 
%20171226%    \end{align*}
%20171226%
%20171226%\end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{lemma}
%20171226%\label{lem:Fphi_infty}
%20171226%% 2013 August 09 Friday
%20171226%% 2013 August 20 Monday: modified \implies relation
%20171226%%--------------------------------------
%20171226%Let $\fphi(x)$ be a function in $\spLLR$ \xref{def:spLLR}.
%20171226%Let $\Fphi(\omega)$ be the \fncte{Fourier transform}\ifsxrefs{harFour}{def:ft}of $\fphi(x)$.
%20171226%Let $\Dh(\omega)$ be the \fncte{Discrete time Fourier transform}\ifsxref{dsp}{def:dtft} of $\seqn{h_n}$.
%20171226%Let $\ds\prod_{n=1}^\infty x_n \eqd \lim_{\xN\to\infty}\prod_{n=1}^\xN x_n$, with respect to the standard norm in $\spLLR$.
%20171226%
%20171226%\lembox{
%20171226%  \begin{array}{>{\ds}l c rc>{\ds}lCD}
%20171226%    \brb{\begin{array}{M}
%20171226%      $\Fphi\brp{\omega} = C\prod_{n=1}^\infty \cwt\:\Dh\brp{\frac{\omega}{2^n}}$\\
%20171226%      $\scy\forall C>0,\,\omega\in\R$\qquad\qquad\scs(A)
%20171226%    \end{array}}
%20171226%      &\implies& \fphi(x)          &=& \sum_{n\in\Z}  h_n \opDil \opTrn^n \fphi(x)
%20171226%                                     & \forall x\in\R 
%20171226%                                     & (1) %{\prope{dilation equation in ``time" (A)}}
%20171226%    \\&\iff&     \Fphi\brp{\omega} &=& \cwt \: \Dh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
%20171226%                                     & \forall \omega\in\R
%20171226%                                     & (2)
%20171226%  \\
%20171226%      &\iff&     \Fphi\brp{\omega} &=& \Fphi\brp{\frac{\omega}{2^\xN}} \prod_{n=1}^\xN \cwt\:\Dh\brp{\frac{\omega}{2^n}}
%20171226%                                     & \forall n\in\Zp,\,\omega\in\R
%20171226%                                     & (3)
%20171226%  \end{array}
%20171226%  }
%20171226%\end{lemma}
%20171226%\begin{proof}
%20171226%  \begin{enumerate}
%20171226%    \item Proof that (1)$\iff$(2)$\iff$(3): by \prefp{lem:Fphi}
%20171226%    \item Proof that (A)$\implies$(2):
%20171226%      \begin{align*}
%20171226%        \Fphi(\omega)
%20171226%          &= C\:\prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega}{2^n}}
%20171226%          && \text{by left hypothesis}
%20171226%        \\&= C\:\cwt \Dh\brp{\frac{\omega}{2}} \prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega}{2^{n+1}}}
%20171226%        \\&= C\:\cwt \Dh\brp{\frac{\omega}{2}} \prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega/2}{2^{n}}}
%20171226%        \\&= \cwt \Dh\brp{\frac{\omega}{2}}\brs{C\prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega/2}{2^{n}}}}
%20171226%        \\&= \cwt \Dh\brp{\frac{\omega}{2}} \Fphi\brp{\frac{\omega}{2}}
%20171226%          && \text{by left hypothesis}
%20171226%      \end{align*}
%20171226%  \end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{proposition}
%20171226%\label{prop:Fphi}
%20171226%%--------------------------------------
%20171226%Let $\fphi(x)$ be a function in $\spLLR$ \xref{def:spLLR}.
%20171226%Let $\Fphi(\omega)$ be the \fncte{Fourier transform}\ifsxrefs{harFour}{def:ft}of $\fphi(x)$.
%20171226%Let $\Dh(\omega)$ be the \fncte{Discrete time Fourier transform}\ifsxref{dsp}{def:dtft} of $\seqn{h_n}$.
%20171226%Let $\ds\prod_{n=1}^\infty x_n \eqd \lim_{\xN\to\infty}\prod_{n=1}^\xN x_n$, with respect to the standard norm in $\spLLR$.
%20171226%\propbox{
%20171226%  \brb{\begin{array}{M}
%20171226%    $\Fphi(\omega)$ is\\
%20171226%    \prope{continuous}\\ 
%20171226%    at $\,\omega=0$
%20171226%  \end{array}}
%20171226%  \quad\implies\quad
%20171226%  \brb{\begin{array}{c rc>{\ds}lCD}
%20171226%        &
%20171226%    \fphi(x)          &=& \sum_{n\in\Z}  h_n \opDil \opTrn^n \fphi(x)
%20171226%                        & \forall x\in\R 
%20171226%                        & (1) %{\prope{dilation equation in ``time" (A)}}
%20171226%  \\\iff&
%20171226%    \Fphi\brp{\omega} &=& \cwt \: \Dh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
%20171226%                        & \forall \omega\in\R
%20171226%                        & (2)
%20171226%  \\\iff&
%20171226%    \Fphi\brp{\omega} &=& \Fphi\brp{\frac{\omega}{2^\xN}} \prod_{n=1}^\xN \cwt\:\Dh\brp{\frac{\omega}{2^n}}
%20171226%                        & \forall n\in\Zp,\,\omega\in\R
%20171226%                        & (3)
%20171226%  \\\iff&
%20171226%    \Fphi\brp{\omega} &=& \Fphi\brp{0} \prod_{n=1}^\infty \cwt\:\Dh\brp{\frac{\omega}{2^n}} 
%20171226%                        & \omega\in\R
%20171226%                        & (4)
%20171226%  \end{array}}
%20171226%  }
%20171226%\end{proposition}
%20171226%%\lembox{
%20171226%%  \brb{\begin{array}{FMCD}
%20171226%%    (A) & $\ds\fphi(x)=\sum_{n\in\Z}  h_n \opDil \opTrn^n \fphi(x)$ & \forall x\in\R & and\\ % & {\prope{dilation equation}}\\
%20171226%%    (B) & \mc{3}{M}{$\Fphi(\omega)$ is \prope{continuous} at $\omega=0$}
%20171226%%  \end{array}}
%20171226%%  \implies
%20171226%%  \brb{\begin{array}{>{\ds}lCD}
%20171226%%    \Fphi\brp{\omega} = \Fphi\brp{0} \prod_{n=1}^\infty \cwt\:\Dh\brp{\frac{\omega}{2^n}} & \forall \omega\in\R
%20171226%%  \end{array}} 
%20171226%%  }
%20171226%%\end{lemma}
%20171226%\begin{proof}
%20171226%  \begin{enumerate}
%20171226%    \item Proof that (1)$\iff$(2)$\iff$(3): by \prefp{lem:Fphi}
%20171226%    \item Proof that (3)$\implies$(4):
%20171226%      \begin{align*}
%20171226%        \Fphi\brp{0}\:\prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega}{2^n}}
%20171226%          &= \lim_{\xN\to\infty}\Fphi\brp{\frac{\omega}{2^{\xN}}}\:\prod_{n=1}^{\xN} \cwt \Dh\brp{\frac{\omega}{2^n}}
%20171226%          && \text{by \prope{continuity} and definition of $\prod_{n=1}^\infty x_n$}
%20171226%        \\&= \Fphi(\omega)
%20171226%          && \text{by (3) and \prefp{lem:Fphi}}
%20171226%      \end{align*}
%20171226%    \item Proof that (2)$\impliedby$(4): by \prefp{lem:Fphi_infty}
%20171226%      %\begin{align*}
%20171226%      %  \Fphi(\omega)
%20171226%      %    &= \Fphi\brp{0}\:\prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega}{2^n}}
%20171226%      %    && \text{by (4)}
%20171226%      %  \\&= \Fphi\brp{0}\:\cwt \Dh\brp{\frac{\omega}{2}} \prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega}{2^{n+1}}}
%20171226%      %  \\&= \Fphi\brp{0}\:\cwt \Dh\brp{\frac{\omega}{2}} \prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega/2}{2^{n}}}
%20171226%      %  \\&= \cwt \Dh\brp{\frac{\omega}{2}}\brs{ \Fphi\brp{0}\prod_{n=1}^{\infty} \cwt \Dh\brp{\frac{\omega/2}{2^{n}}}}
%20171226%      %  \\&= \cwt \Dh\brp{\frac{\omega}{2}} \Fphi\brp{\frac{\omega}{2}}
%20171226%      %    && \text{by (4)}
%20171226%      %\end{align*}
%20171226%  \end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%
%20171226%
%20171226%%\if 0
%20171226%
%20171226%
%20171226%\pref{def:hn} (next) formally defines the coefficients that appear in \prefpp{thm:dilation_eq}.
%20171226%%--------------------------------------
%20171226%\begin{definition}%[subspace coefficients]
%20171226%\label{def:hn}
%20171226%\label{def:mrasys}
%20171226%%--------------------------------------
%20171226%Let $\MRAspaceLLRV$ be a multiresolution analysis space with scaling function $\fphi$.
%20171226%Let $\seqxZ{h_n}$ be a sequence of coefficients such that $\fphi = \sum_{n\in\Z}  h_n \opDil\opTrn^n \fphi$.
%20171226%\defboxp{
%20171226%  A \structd{multiresolution system} is the tuple $\mrasys$.
%20171226%  The sequence $\seqxZ{h_n}$ is the \fnctd{scaling coefficient sequence}.
%20171226%  A multiresolution system is also called an \structd{MRA system}.
%20171226%  An \structe{MRA system} is an \structd{orthonormal MRA system} if $\setnZ{\opTrn^n\fphi}$ is \prope{orthonormal}.
%20171226%  }
%20171226%\end{definition}
%20171226%
%20171226%%Examples of \hi{multiresolution analyses} are provided in
%20171226%%\pref{ex:wavstrct_haar_sin} (next)
%20171226%%-- \prefp{ex:sw_gh_bspline}.
%20171226%
%20171226%%%--------------------------------------
%20171226%%\begin{definition}
%20171226%%\label{def:wavstrct_normcoef}
%20171226%%%--------------------------------------
%20171226%%Let $\mrasys$ be a {multiresolution system}, and $\opDil$ the dilation operator.
%20171226%%\defboxp{
%20171226%%  The \hid{normalization coefficient at resolution $n$} is the quantity 
%20171226%%  \\\indentx$\norm{\opDil^j\fphi}$.
%20171226%%  }
%20171226%%\end{definition}
%20171226%
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{theorem}
%20171226%\label{thm:V0Vn}
%20171226%%--------------------------------------
%20171226%Let $\mrasys$ be an \structe{MRA system} \xref{def:mrasys}.\\
%20171226%Let $\linspan\setA$ be the \structe{linear span} \xref{def:span} of a set $\setA$.
%20171226%\thmbox{
%20171226%  \mcom{\linspan\setxZ{\opTrn^n\fphi}=\spV_0}
%20171226%       {$\setxZ{\opTrn^n\fphi}$ is a \structe{basis} for $\spV_0$}
%20171226%  \qquad\implies\qquad
%20171226%  \mcom{\linspan\setxZ{\opDil^j\opTrn^n\fphi}=\spV_j\quad{\scy\forall j\in\Znn}}
%20171226%       {$\setxZ{\opDil^j\opTrn^n\fphi}$ is a \structe{basis} for $\spV_j$}
%20171226%  }
%20171226%\end{theorem}
%20171226%\begin{proof} Proof is by induction:\citetbl{\citerpg{smith2011}{4}{1420063723}}
%20171226%\begin{enumerate}
%20171226%\item induction basis (proof for $j=0$ case):
%20171226%      %$\setxZ{\opDil^0\opTrn^n\fphi}$ is a basis for $\spV_0$
%20171226%      %\\\indentx$\ds \spV_0 = \set{\ff(x)}{\ff(x) = \sum_{n\in\Z} \fc_{n} \fphi(x-n)}.$
%20171226%  \begin{align*}
%20171226%    \brlr{\linspan\setxZ{\opDil^j\opTrn^n\fphi}}_{j=0}
%20171226%      &= \linspan\setxZ{\opTrn^n\fphi}
%20171226%    \\&= \spV_0
%20171226%      && \text{by left hypothesis}
%20171226%  \end{align*}
%20171226%
%20171226%\item induction step (proof that $j$ case $\implies$ $j+1$ case):
%20171226%      %$\setxZ{\opDil^j\opTrn^n\fphi}$ is a basis for $\spV_j$
%20171226%      %$\implies$ $\setxZ{\opDil^{j+1}\opTrn^n\fphi}$ is a basis for $\spV_{j+1}$:
%20171226%  \begin{align*}
%20171226%    &\linspan\setxZ{\opDil^{j+1}\opTrn^n\fphi}
%20171226%    \\&= \set{\ff\in\spLLR}{\exists \seqn{\alpha_n} \st \ff(x)=\sum_{n\in\Z}\alpha_n \opDil^{j+1}\opTrn^n\fphi}
%20171226%      && \text{by definition of $\linspan$} &&\text{\xref{def:span}}
%20171226%    \\&= \set{\ff\in\spLLR}{\exists \seqn{\alpha_n} \st \ff(x)=\opDil\sum_{n\in\Z}\alpha_n \opDil^{j}\opTrn^n\fphi}
%20171226%    \\&= \set{\ff\in\spLLR}{\exists \seqn{\alpha_n} \st \opDili\ff(x)=\sum_{n\in\Z}\alpha_n \opDil^{j}\opTrn^n\fphi}
%20171226%    \\&= \mathrlap{
%20171226%         \set{\brs{\opDil\ff}\in\spLLR}{\exists \seqn{\alpha_n} \st \opDili\brs{\opDil\ff(x)}=\sum_{n\in\Z}\alpha_n \opDil^{j}\opTrn^n\fphi}
%20171226%         }
%20171226%    \\&= \opDil\set{\ff\in\spLLR}{\exists \seqn{\alpha_n} \st \ff(x)=\sum_{n\in\Z}\alpha_n \opDil^{j}\opTrn^n\fphi}
%20171226%    \\&= \opDil\linspan\setxZ{\opDil^j\opTrn^n\fphi}
%20171226%      && \text{by definition of $\linspan$} &&\text{\xref{def:span}}
%20171226%    \\&= \opDil\spV_j
%20171226%      && \text{by induction hypothesis}
%20171226%    \\&= \spV_{j+1}
%20171226%      && \text{by \prope{self-similar} property} &&\text{\xref{def:mra}}
%20171226%  \end{align*}
%20171226%\end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{example}
%20171226%\label{ex:wavstrct_haar_sin}
%20171226%\exmx{Haar scaling function}
%20171226%%--------------------------------------
%20171226%\exbox{\begin{array}{rclm{54mm}} 
%20171226%  \mc{4}{M}{In the \hie{Haar} MRA, the scaling function $\fphi(x)$ is the \hie{pulse function}}
%20171226%  \\
%20171226%  \fphi(x) &=& \brbl{\begin{array}{lM}
%20171226%                       1  & for $x\in\intco{0}{1}$ \\
%20171226%                       0  & otherwise.
%20171226%                     \end{array}}
%20171226%  &
%20171226%  \includegraphics{graphics/pulse.pdf}
%20171226%  \\
%20171226%  \mc{4}{M}{In the subspace $\spV_j$ ($j\in\Z$) the scaling functions are}
%20171226%  \\
%20171226%  \opDil^j\fphi(x) &=& \brbl{\begin{array}{lM}
%20171226%                               \brp{2}^{j/2}   & for $x\in\intco{0}{\brp{2^{-j}}}$ \\
%20171226%                               0                  & otherwise.
%20171226%                              \end{array}}
%20171226%  &
%20171226%  \includegraphics{graphics/pulse2.pdf}%
%20171226%\end{array}}
%20171226%
%20171226%The scaling subspace $\spV_0$ is the span $\spV_0\eqd\Span\setxZ{\opTrn^n\fphi}$.
%20171226%The scaling subspace $\spV_j$ is the span $\spV_j\eqd\Span\set{\opDil^j\opTrn^n\fphi}{n\in\Z}$.
%20171226%  %$\opDil^j\fphi$ such that
%20171226%Note that $\norm{\opDil^j\opTrn^n\fphi}$ for each resolution $j$ and shift $n$ is unity:
%20171226%  \begin{align*}
%20171226%    \norm{\opDil^j\opTrn^n\fphi}^2
%20171226%      &= \norm{\fphi}^2  
%20171226%      && \text{by \prefp{thm:TD_unitary}}
%20171226%   %\\&= \int_{\intco{0}{\brp{2^{-j}}} \abs{\brp{\sqrt{2}}^j}^2 \dx
%20171226%    \\&= \int_0^1 \abs{1}^2 \dx
%20171226%      && \text{by definition of $\normn$ on $\spLLR$ \xref{def:spLLR}}
%20171226%    %\\&= \brp{2^{-j}\brp{2^j}
%20171226%    \\&= 1
%20171226%  \end{align*}
%20171226%
%20171226%\begin{minipage}{\tw-64mm}
%20171226%Let $\ff(x)=\sin(\pi x)$.
%20171226%Suppose we want to project $\ff(x)$ onto the subspaces $\spV_0$, $\spV_1$, $\spV_2$, \ldots.
%20171226%\end{minipage}%
%20171226%\hfill\tbox{\includegraphics{graphics/sin_pi_t.pdf}}%
%20171226%\\
%20171226%\begin{minipage}{\tw-68mm}
%20171226%\ragr
%20171226%The values of the transform coefficients for the subspace $\spV_j$ are %illustrated in \prefp{fig:wavstrct_Haar_sin}
%20171226%given by
%20171226%\end{minipage}%
%20171226%\hfill%
%20171226%\tbox{%
%20171226%%\begin{figure}[t]
%20171226%  %\mbox{}\\%
%20171226%  %\psset{unit=8mm}%
%20171226%  %\input{../common/math/graphics/comb_123_pi.tex}%
%20171226%  \includegraphics{graphics/haar0_sin_t.pdf}%  8mm
%20171226%  }
%20171226%\\
%20171226%  \begin{align*}
%20171226%    \brs{\opR_j\ff(x)}(n) 
%20171226%      &=    \frac{1}{\norm{\opDil^j\opTrn^n\fphi}^2}\inprod{\ff(x)}{\opDil^j\opTrn^n\fphi} 
%20171226%    %\\&=    \frac{1}{\cancelto{1}{\norm{\fphi}^2}}
%20171226%    %        \inprod{\ff(x)}{\opDil^j\fphi\brp{x-n}}
%20171226%    %  &&    \text{by definition of $\opTrn$ \xref{def:wav_opT}} 
%20171226%    \\&=    \frac{1}{\cancelto{1}{\norm{\fphi}^2}}\inprod{\ff(x)}{2^{j/2}\fphi\brp{2^j x-n}} 
%20171226%      &&    \text{by \prefp{prop:DjTn}}
%20171226%    \\&=    2^{j/2} \inprod{\ff(x)}{\fphi\brp{2^j x-n}} 
%20171226%    \\&=    2^{j/2} 
%20171226%            \int_{2^{-j}n}^{2^{-j}(n+1)} \ff(x) \dx
%20171226%    \\&=    2^{j/2} 
%20171226%            \int_{2^{-j}n}^{2^{-j}(n+1)} \sin(\pi x) \dx
%20171226%    \\&=    2^{j/2}
%20171226%            \left. \brp{-\frac{1}{\pi}}\cos\brp{\pi x} \right|_{2^{-j} n}^{2^{-j}(n+1)}
%20171226%    \\&=    \frac{2^{j/2}}{\pi}
%20171226%            \brs{
%20171226%              \cos\brp{{2^{-j}n\pi}} -
%20171226%              \cos\brp{{2^{-j}(n+1)\pi}}  
%20171226%              }
%20171226%  \end{align*}
%20171226%
%20171226%
%20171226%
%20171226%And the projection $\opA_n\ff(x)$ of the function $\ff(x)$ onto the subspace $\spV_j$ is
%20171226%%(alternatively, the \hie{projection} of $\ff(x)$ \emph{onto} the space $\spV_j$ is) %\\
%20171226%%\begin{minipage}{\tw-95mm}
%20171226%  \begin{align*}
%20171226%    \opA_j\ff(x) 
%20171226%      &= \sum_{n\in\Z} \inprod{\ff(x)}{\opDil^j\opTrn^n\fphi} \opDil^j\opTrn^n\fphi 
%20171226%    \\&= \frac{2^{j/2}}{\pi}
%20171226%         \sum_{n\in\Z}
%20171226%         \brs{
%20171226%           \cos\brp{2^{-j}n\pi} -
%20171226%           \cos\brp{2^{-j}(n+1)\pi}  
%20171226%           } 2^{j/2}\fphi\brp{2^j x-n}
%20171226%    \\&= \frac{2^j}{\pi}
%20171226%         \sum_{n\in\Z}
%20171226%         \brs{
%20171226%           \cos\brp{2^{-j} n\pi} -
%20171226%           \cos\brp{2^{-j}(n+1)\pi}  
%20171226%           } \fphi\brp{2^j x-n}
%20171226%  \end{align*}
%20171226%%\end{minipage}%
%20171226%%\hfill%
%20171226%%\begin{minipage}{90mm}%
%20171226%%  \mbox{}\\%
%20171226%%  \psset{unit=8mm}%
%20171226%%  %\input{../common/math/graphics/square_123_pi.tex}
%20171226%%  \input{../common/wavelets/graphics/haar0_sin_a.tex}
%20171226%%\end{minipage}
%20171226%
%20171226%The transforms of $\sin(\pi x)$ into the subspaces $\spV_0$, $\spV_1$, and $\spV_2$,
%20171226%as well as the approximations in those subspaces are as illustrated in \prefpp{fig:wavstrct_haar_sin}.
%20171226%\end{example}
%20171226%\begin{figure}
%20171226%  \centering%
%20171226%  \begin{tabular}{|l|l|l|}
%20171226%    \hline
%20171226%    \mc{1}{|c|}{subspace}&\mc{1}{c|}{transform}&\mc{1}{c|}{approximation}
%20171226%    \\\hline\hline
%20171226%    $\spV_0$
%20171226%    & \includegraphics{graphics/haar0_sin_t.pdf}
%20171226%    & \includegraphics{graphics/haar0_sin_a.pdf}
%20171226%    \\\hline
%20171226%    $\spV_1$
%20171226%    & \includegraphics{graphics/haar1_sin_t.pdf}
%20171226%    & \includegraphics{graphics/haar1_sin_a.pdf}
%20171226%    \\\hline
%20171226%    $\spV_2$
%20171226%    & \includegraphics{graphics/haar2_sin_t.pdf}
%20171226%    & \includegraphics{graphics/haar2_sin_a.pdf}
%20171226%    \\\hline
%20171226%  \end{tabular}
%20171226%  \caption{
%20171226%    Projections of $\sin(\pi x)$ on Haar subspaces
%20171226%    \xref{ex:wavstrct_haar_sin}
%20171226%    \label{fig:wavstrct_haar_sin}
%20171226%    }
%20171226%\end{figure}
%20171226%
%20171226%
%20171226%
%20171226%
%20171226%%=======================================
%20171226%\subsection{Necessary Conditions}
%20171226%%=======================================
%20171226%%Next we look at  two necessary conditions in the ``time domain" for scaling coefficient design.
%20171226%%%They can be used in generating simultaneous equations for wavelet system design.
%20171226%%\\\indentx
%20171226%%  \begin{tabular}{@{\qquad}clll}
%20171226%%    \imark & \hie{admissibility condition}: & \pref{thm:admiss}        & \xref{thm:admiss} \\
%20171226%%    \imark & \hie{quadrature condition}:    & \pref{thm:wav_quadcon}   & \xref{thm:wav_quadcon}
%20171226%%  \end{tabular}
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{theorem}[\thmd{admissibility condition}]
%20171226%\label{thm:admiss}
%20171226%%--------------------------------------
%20171226%%Let $\mrasys$ be a multiresolution system.
%20171226%Let $\Zh(z)$ be the \fncte{Z-transform} \xref{def:opZ} and 
%20171226%$\Dh(\omega)$ the \fncte{discrete-time Fourier transform} \xref{def:dtft} of a sequence $\seqxZ{h_n}$.
%20171226%\thmbox{\begin{array}{M}
%20171226%  %\brb{\begin{array}{M}$\mrasys$\\is an \structe{MRA system}\end{array}} &\impnotimpby&
%20171226%  $\brb{\text{$\mrasys$ is an \structe{MRA system} \xref{def:mrasys}}}$
%20171226%  \\$\ds\quad
%20171226%  \impnotimpby \mcom{\brb{\sum_{n\in\Z}  h_n  = \sqrt{2}}}{(1) \prope{admissibility} in ``time"}               
%20171226%  \iff         \mcom{\brb{\Zh(z)\Big|_{z=1}   = \sqrt{2}}}{(2) \prope{admissibility} in ``z domain"}                  
%20171226%  \iff         \mcom{\brb{\Dh(\omega)\Big|_{\omega=0} = \sqrt{2}}}{(3) \prope{admissibility} in ``frequency"}
%20171226%  $
%20171226%\end{array}}
%20171226%\end{theorem}
%20171226%\begin{proof}
%20171226%\begin{enumerate}
%20171226%  \item Proof that MRA system $\implies$ (1):
%20171226%    \begin{align*}
%20171226%      \sum_{n\in\Z} h_n
%20171226%        &= \frac{\int_\R \fphi(x) \dx}{\int_\R \fphi(x) \dx} \sum_{n\in\Z} h_n
%20171226%      \\&= \frac{1}{\int_\R \fphi(x) \dx} \int_\R \sum_{n\in\Z} h_n \fphi(x) \dx
%20171226%      \\&= \frac{1}{\int_\R \fphi(x) \dx} \int_\R \sum_{n\in\Z} h_n \frac{\sqrt{2}}{\sqrt{2}}\fphi(2y-n) 2\dy
%20171226%        && \text{let $y\eqd \frac{x+n}{2}\implies x=2y-n \implies \dx=2\dy$}
%20171226%      \\&= \frac{2}{\sqrt{2}}\frac{1}{\int_\R \fphi(x) \dx} \int_\R \sum_{n\in\Z} h_n \opDil\opTrn^n\fphi(y)\dy
%20171226%        && \text{by definitions of $\opTrn$ and $\opDil$ \xref{def:opT}}
%20171226%      \\&= \sqrt{2} \frac{1}{\int_\R \fphi(x) \dx} \int_\R \fphi(y) \dy
%20171226%        && \text{by \thme{dilation equation} \xref{thm:dilation_eq}}
%20171226%      \\&= \sqrt{2}
%20171226%    \end{align*}
%20171226%
%20171226%  \item Alternate proof that MRA system $\implies$ (1):\\
%20171226%    %Select a vector $\ff$ such that $\inprod{\fphi}{\ff}\ne 0$.
%20171226%    Let $\ff(x)\eqd 1\quad\forall x\in\R$. % be a constant vector (e.g. $\ff(x)=1$). Then \ldots
%20171226%    \begin{align*}
%20171226%      \inprod{\fphi}{\ff}
%20171226%        &= \inprod{\sum_{n\in\Z} h_n \opDil\opTrn^n \fphi}{\ff}
%20171226%        && \text{by \thme{dilation equation}} && \text{\xref{thm:dilation_eq}}
%20171226%      \\&= \sum_{n\in\Z} h_n \inprod{\opDil\opTrn^n \fphi}{\ff}
%20171226%        && \text{by \prop{linearity} of $\inprodn$} && \text{\ifxref{vsinprod}{def:inprod}}
%20171226%      \\&= \sum_{n\in\Z} h_n \inprod{ \fphi}{(\opDil\opTrn^n)^\ast\ff}
%20171226%        && \text{by definition of operator adjoint} && \text{\ifxref{operator}{thm:op_star}}
%20171226%      \\&= \sum_{n\in\Z} h_n \inprod{ \fphi}{(\opTrna)^n \opDila \ff}
%20171226%        && \text{by property of operator adjoint} && \text{\ifxref{operator}{thm:op_star}}
%20171226%      \\&= \sum_{n\in\Z} h_n \inprod{ \fphi}{(\opTrni)^n \opDili \ff}
%20171226%        && \text{by unitary property of $\opTrn$ and $\opDil$} && \text{\xref{prop:TD_unitary}}
%20171226%      \\&= \sum_{n\in\Z} h_n \inprod{ \fphi}{(\opTrni)^n \cwt  \ff}
%20171226%        && \text{because $\ff$ is a constant hypothesis} &&\text{and by \prefp{prop:opDi}}
%20171226%      \\&= \sum_{n\in\Z} h_n \inprod{ \fphi}{ \cwt \ff}
%20171226%        && \text{by $\ff(x)=1$ definition}
%20171226%      \\&= \sum_{n\in\Z} h_n \cwt \inprod{ \fphi}{ \ff}
%20171226%        && \text{by property of $\inprodn$} && \text{\ifxref{vsinprod}{def:inprod}}
%20171226%      \\&= \cwt \; \inprod{\fphi}{\ff}\; \sum_{n\in\Z} h_n
%20171226%      \\&\implies \sum_{n\in\Z} h_n = \sqrt{2}
%20171226%    \end{align*}
%20171226%
%20171226%  \item Proof that (1) $\iff$ (2) $\iff$ (3): by \prefp{prop:tzf}.
%20171226%
%20171226%  \item Proof for $\notimpliedby$ part: by \prefp{cnt:admiss}.
%20171226%\end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{counterex}
%20171226%\label{cnt:admiss}
%20171226%%--------------------------------------
%20171226%Let $\mrasys$ be an \structe{MRA system} \xref{def:mrasys}.
%20171226%\cntbox{\begin{array}{M}
%20171226%  $\brb{\begin{array}{lm{28mm}}
%20171226%     \seqn{h_n} \eqd \sqrt{2}\kdelta_{n-1} \eqd
%20171226%       \brbl{\begin{array}{lD}
%20171226%         \sqrt{2}     & for $n=1$  \\
%20171226%         0            & otherwise.
%20171226%       \end{array}}
%20171226%    &\includegraphics{graphics/hn1.pdf}%
%20171226%  \end{array}}
%20171226%  \quad\implies\quad
%20171226%  \brb{\fphi(x)=0}$
%20171226%  \\
%20171226%  which means
%20171226%  \\
%20171226%  $\ds\brb{\sum_{n\in\Z} h_n = \sqrt{2}} \quad\notimplies\quad \brb{\text{$\mrasys$ is an MRA system for $\spLLR$.}}$
%20171226%\end{array}}
%20171226%\end{counterex}
%20171226%\begin{proof}
%20171226%\begin{align*}
%20171226%  \fphi(x)
%20171226%    &= \sum_{n\in\Z} h_n \opDil\opTrn^n\fphi(x)
%20171226%    && \text{by \thme{dilation equation}} &&\text{\xref{thm:dilation_eq}}
%20171226%  \\&= \sum_{n\in\Z} h_n \fphi(2x-n)
%20171226%    && \text{by definitions of $\opDil$ and $\opTrn$} &&\text{\xref{def:opT}}
%20171226%  \\&= \sum_{n\in\Z} \mcom{\sqrt{2}\kdelta_{n-1}}{$\seqn{h_n}$} \fphi(2x-n)
%20171226%    && \text{by definitions of $\seqn{h_n}$}
%20171226%  \\&= \sqrt{2}\fphi(2x-1)
%20171226%    && \text{by definition of $\fphi(x)$}
%20171226%  \\\implies
%20171226%  \fphi(x) &= 0
%20171226%\end{align*}
%20171226%This implies $\fphi(x)=0$, which implies that $\mrasys$ is \emph{not} an \structe{MRA system} for $\spLLR$ because
%20171226%  \\\indentx$\ds \clsp{\Setu_{j\in\Z} \spV_j} = \clsp{\Setu_{j\in\Z} \linspan\set{\opDil^j\opTrn^n\fphi}{\scy n\in\Z}} \neq \spLLR$\\
%20171226%(the \structe{least upper bound} is \emph{not} $\spLLR$).
%20171226%\end{proof}
%20171226%
%20171226%
%20171226%
%20171226%
%20171226%%--------------------------------------
%20171226%\begin{theorem}[\thmd{Quadrature condition} in ``time"]
%20171226%\label{thm:wav_quadcon}
%20171226%\label{thm:wav_hh}
%20171226%%--------------------------------------
%20171226%Let $\mrasys$ be an \structe{MRA system} \xref{def:mrasys}.
%20171226%\thmbox{
%20171226%  \sum_{m\in\Z} h_m \sum_{k\in\Z} h_k^\ast \inprod{\fphi}{\opTrn^{2n-m+k} \fphi}
%20171226%  =\inprod{\fphi}{\opTrn^n \fphi}
%20171226%  \qquad\scy\forall n\in\Z
%20171226%  }
%20171226%\end{theorem}
%20171226%\begin{proof}
%20171226%\begin{align*}
%20171226%  \inprod{\fphi}{\opTrn^n \fphi}
%20171226%    &= \inprod{\sum_{m\in\Z} h_m \opDil \opTrn^m \fphi }{\opTrn^n \sum_{k\in\Z} h_k \opDil \opTrn^k \fphi}
%20171226%    && \text{by \thme{dilation equation}} && \text{\xref{thm:dilation_eq}}
%20171226%  \\&= \sum_{m\in\Z} h_m \sum_{k\in\Z} h_k^\ast \inprod{\opDil \opTrn^m \fphi }{\opTrn^n \opDil \opTrn^k \fphi}
%20171226%    && \text{by properties of $\inprodn$} && \text{\ifxref{vsinprod}{def:inprod}}
%20171226%  \\&= \sum_{m\in\Z} h_m \sum_{k\in\Z} h_k^\ast \inprod{\fphi }{\left(\opDil \opTrn^m \right)^\ast \opTrn^n \opDil \opTrn^k \fphi}
%20171226%    && \text{by definition of operator adjoint} && \text{\ifxref{operator}{prop:op_adjoint}}
%20171226%  \\&= \sum_{m\in\Z} h_m \sum_{k\in\Z} h_k^\ast \inprod{\fphi }{\left(\opDil \opTrn^m \right)^\ast \opDil \opTrn^{2n} \opTrn^k \fphi}
%20171226%    && \text{by \prefp{prop:DTTD}}
%20171226%  \\&= \sum_{m\in\Z} h_m \sum_{k\in\Z} h_k^\ast \inprod{\fphi }{\opTrna^m \opDila \opDil \opTrn^{2n} \opTrn^k \fphi}
%20171226%    && \text{by operator star-algebra properties} && \text{\ifxref{operator}{thm:op_star}}
%20171226%  \\&= \sum_{m\in\Z} h_m \sum_{k\in\Z} h_k^\ast \inprod{\fphi }{\opTrn^{-m} \opDil^{-1} \opDil \opTrn^{2n} \opTrn^k \fphi}
%20171226%    && \text{by \prefp{prop:TD_unitary}}
%20171226%  \\&= \sum_{m\in\Z} h_m \sum_{k\in\Z} h_k^\ast \inprod{\fphi }{\opTrn^{2n-m+k} \fphi}
%20171226%\end{align*}
%20171226%\end{proof}
%20171226%
%20171226%%%---------------------------------------
%20171226%%\begin{theorem}[Neumann Expansion Theorem]
%20171226%%\index{Neumann Expansion Theorem}
%20171226%%\thmx{Neumann Expansion Theorem}
%20171226%%\label{thm:op_net2}
%20171226%%\citep{michel1993}{415}
%20171226%%%---------------------------------------
%20171226%%Let $\opA\in\clFxx$ be an operator on a linear space $\spX$.
%20171226%%Let $\opA^0\eqd \opI$.
%20171226%%\thmbox{\begin{array}{ll}
%20171226%%  \left.\begin{array}{lrclD}
%20171226%%    1. & \opA          &\in& \oppB(\spX,\spX) & ($\opA$ is bounded) \\
%20171226%%    2. & \normop{\opA} &<&   1
%20171226%%  \end{array}\right\}
%20171226%%  \implies
%20171226%%  \left\{\begin{array}{lrc>{\ds}l}
%20171226%%    1. & (\opI-\opA)^{-1} &&\text{ exists} \\
%20171226%%    2. & \normop{(\opI-\opA)^{-1}} &\le& \frac{1}{1-\normop{\opA}} \\
%20171226%%    3. & (\opI-\opA)^{-1} &=& \sum_{n=0}^\infty \opA^\xN  \\
%20171226%%       & \mc{3}{c}{\text{ with uniform convergence}}
%20171226%%  \end{array}\right.
%20171226%%\end{array}}
%20171226%%\end{theorem}
%20171226%%
%20171226%%
%20171226%%
%20171226%%
%20171226%%
%20171226%%
%20171226%%
%20171226%%%--------------------------------------
%20171226%%\begin{theorem}
%20171226%%\label{thm:wav_net}
%20171226%%\thmx{$\sum_{n\in\Z} \abs{h_n} \ge 1$}
%20171226%%%--------------------------------------
%20171226%%Let $\wavsys$ be a \hi{wavelet system}.
%20171226%%\thmbox{
%20171226%%  \sum_{n\in\Z} \abs{h_n} \ge 1
%20171226%%  }
%20171226%%\end{theorem}
%20171226%%\begin{proof}
%20171226%%\begin{align*}
%20171226%%  &&
%20171226%%  \fphi &= \sum_{n\in\Z} h_n \opTrn^n \opDil \fphi
%20171226%%  \\\implies&&
%20171226%%  \left(\opI - \sum_{n\in\Z} h_n \opTrn^n \opDil \right)\fphi &= \vzero
%20171226%%  \\\implies&&
%20171226%%  \left(\opI - \sum_{n\in\Z} h_n \opTrn^n \opDil \right)^{-1} & \text{must not exist}
%20171226%%  \\\implies&&
%20171226%%  \normop{\sum_{n\in\Z} h_n \opTrn^n \opDil} & \ge 1
%20171226%%    && \text{by Neumann Expansion Theorem \xref{thm:op_net2}}
%20171226%%  \\\implies&&
%20171226%%  1
%20171226%%      &\le \normop{\sum_{n\in\Z} h_n \opTrn^n \opDil}
%20171226%%     &&    %\text{by Neumann Expansion Theorem \xref{thm:op_net2}}
%20171226%%  \\&&&\le \sum_{n\in\Z}  \normop{h_n \opTrn^n \opDil}
%20171226%%     &&    \text{by generalized triangle inequality \ifdochas{vsnorm}{\xref{thm:norm_tri}}}
%20171226%%  \\&&&=   \sum_{n\in\Z}  \abs{h_n}\; \cancelto{1}{\normop{ \opTrn^n \opDil}}
%20171226%%     &&    \text{by homogeneous property of norm \ifdochas{vsnorm}{\xref{def:norm}}}
%20171226%%  \\&&&=   \sum_{n\in\Z}  \abs{h_n}
%20171226%%     &&    \ifdochas{operator}{\text{by \prefp{prop:op_unitary_UV} and \prefp{thm:unitary_prop}}}
%20171226%%\end{align*}
%20171226%%\end{proof}
%20171226%
%20171226%
%20171226%
%20171226%
%20171226%\pref{thm:gen_quadcon} (next) presents the \structe{quadrature necessary conditions} of a \structe{wavelet system}.
%20171226%These relations simplify dramatically in the special case of an
%20171226%\structe{orthonormal wavelet system} \xref{thm:oquadcon}.
%20171226%%--------------------------------------
%20171226%\begin{theorem}[\thmd{Quadrature condition} in ``frequency"]
%20171226%\citetbl{
%20171226%  \citerp{chui}{135},
%20171226%  \citerp{goswami}{110}
%20171226%  }
%20171226%\label{thm:Sphi}
%20171226%%--------------------------------------
%20171226%Let $\mrasys$ be an \structe{MRA system} \xref{def:mrasys}.
%20171226%Let $\Fx(\omega)$ be the \fncte{discrete time Fourier transform}\ifsxrefs{dsp}{def:dtft}for a sequence $\seqxZ{x_n}$ in $\spllR$.
%20171226%Let $\Swphi(\omega)$ be the \fncte{auto-power spectrum} \xref{def:Swfg} of $\fphi$.
%20171226%\thmbox{\begin{array}{>{\ds}lc>{\ds}l}
%20171226%   \abs{\Dh\left(\omega     \right)}^2 \rnode[b]{noteSphi1}{\Sphi}(\omega) + \abs{\Dh\brp{\omega+\pi }}^2 \rnode[b]{noteSphi2}{\Sphi}(\omega+\pi) &=& 2\rnode[b]{noteSphi3}{\Sphi}(2\omega)
%20171226%\end{array}}
%20171226%\hfill
%20171226%\rnode[bl]{noteSphi}{\footnotesize$\brp{\begin{array}{N}
%20171226%  Note: $\Sphi(\omega)=1$\\% $\iff$ $\setxZ{\opTrn^n\fphi}$\\
%20171226%  for \prope{orthonormal} MRA\\
%20171226%  \xref{lem:oms_quadcon}
%20171226%\end{array}}$}
%20171226%\ncarc[arcangle=30,linewidth=0.5pt,linecolor=red,linestyle=dashed]{->}{noteSphi}{noteSphi1}
%20171226%\ncarc[arcangle=30,linewidth=0.5pt,linecolor=red,linestyle=dashed]{->}{noteSphi}{noteSphi2}
%20171226%\ncarc[arcangle=30,linewidth=0.5pt,linecolor=red,linestyle=dashed]{->}{noteSphi}{noteSphi3}
%20171226%\end{theorem}
%20171226%\begin{proof}
%20171226%%\begin{enumerate}
%20171226%%  \item First note that $\Dh(\omega)$ and $\Dg(\omega)$ are periodic with period $2\pi$ such that\ifsxrefs{dsp}{prop:dtft_2pi} 
%20171226%%  \label{item:qc1}
%20171226%%    \\\indentx$\begin{array}{rclC}
%20171226%%         \Dh(\omega+2\pi n) &=& \Dh(\omega) & \forall n\in\Z   \\
%20171226%%         \Dg(\omega+2\pi n) &=& \Dg(\omega) & \forall n\in\Z   
%20171226%%       \end{array}$
%20171226%%
%20171226%%\item Proof for theorem statement:
%20171226%\begin{align*}
%20171226%   &2\Sphi(2\omega)
%20171226%   \\&= 2\brp{2\pi}\sum_{n\in\Z} \left|\Fphi(2\omega+2\pi n)\right|^2
%20171226%     && \text{by \prefp{thm:Swfg}}
%20171226%   \\&= 2\brp{2\pi}\sum_{n\in\Z} \left|\cwt \Dh\left(\frac{2\omega+2\pi n}{2}\right)\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2
%20171226%     && \text{by \prefp{lem:Fphi}}
%20171226%   \\&= \mathrlap{
%20171226%          {2\pi}\sum_{n\in\Ze} \left|\Dh\left(\frac{2\omega+2\pi n}{2}\right)\right|^2\left|\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2 +
%20171226%          {2\pi}\sum_{n\in\Zo} \left|\Dh\left(\frac{2\omega+2\pi n}{2}\right)\right|^2\left|\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2
%20171226%          }
%20171226%   \\&= \mathrlap{
%20171226%          2\pi\sum_{n\in\Z} \left|\Dh\left(\omega+2\pi n\right)\right|^2\left|\Fphi\left(\omega+2\pi n\right)\right|^2 +
%20171226%          2\pi\sum_{n\in\Z} \left|\Dh\left(\omega+2\pi n+\pi \right)\right|^2\left|\Fphi\left(\omega+2\pi n+ \pi \right)\right|^2
%20171226%          }
%20171226%   \\&= 2\pi\sum_{n\in\Z} \left|\Dh\left(\omega\right)\right|^2\left|\Fphi\left(\omega+2\pi n\right)\right|^2 +
%20171226%        2\pi\sum_{n\in\Z} \left|\Dh\left(\omega+\pi \right)\right|^2\left|\Fphi\left(\omega+2\pi n+ \pi \right)\right|^2
%20171226%     && \text{by \prefp{prop:dtft_2pi}}
%20171226%        %\indentx\text{by (\prefp{item:qc1})}
%20171226%   \\&= \left|\Dh\left(\omega     \right)\right|^2 \brp{2\pi\sum_{n\in\Z} \left|\Fphi\left(\omega    +2\pi n\right)\right|^2} +
%20171226%        \left|\Dh\left(\omega+\pi \right)\right|^2 \brp{2\pi\sum_{n\in\Z} \left|\Fphi\left(\omega+\pi+2\pi n\right)\right|^2}
%20171226%   \\&= \left|\Dh\left(\omega     \right)\right|^2 \Sphi(\omega) +
%20171226%        \left|\Dh\left(\omega+\pi \right)\right|^2 \Sphi(\omega+\pi)
%20171226%     && \text{by \prefp{thm:Swfg}}
%20171226%\end{align*}
%20171226%
%20171226%%\end{enumerate}
%20171226%\end{proof}
%20171226%
%20171226%
%20171226%%=======================================
%20171226%\subsection{Sufficient conditions}
%20171226%%=======================================
%20171226%\pref{thm:mra_rdc} (next) gives a set of \emph{sufficient} conditions on the \fncte{scaling function} \xref{def:mra} 
%20171226%$\fphi$ to generate an \structe{MRA}.
%20171226%\ifdochas{ortho}{\prefpp{thm:h_ns} provides a set of sufficient conditions on the \fncte{scaling coefficients} \xref{def:hn} $\seqnZ{h_n}$ 
%20171226%to generate an \structe{MRA}; howbeit, this set results in the more restrictive \prope{orthonormal} MRA.}
%20171226%%---------------------------------------
%20171226%\begin{theorem}
%20171226%\citetbl{
%20171226%  \citerpgc{wojtaszczyk1997}{28}{0521578949}{Theorem 2.13},
%20171226%  \citerpgc{pinsky2002}{313}{0534376606}{Theorem 6.4.27}
%20171226%  }
%20171226%\label{thm:mra_rdc}
%20171226%\label{thm:mra_sufficient_phi}
%20171226%%--------------------------------------
%20171226%%Let an \structe{MRA} be defined as in \prefp{def:mra}.
%20171226%%Let a \structe{Riesz sequence} be defined as in \prefp{def:rieszseq}.
%20171226%Let $\spV_j\eqd\linspan\setxZ{\opTrn\fphi(x)}$ \xref{def:span}.
%20171226%\thmbox{
%20171226%  \brb{\begin{array}{FMD}
%20171226%    (1). & $\seqn{\opTrn^n\fphi}$ is a \structe{Riesz sequence} \xref{def:rieszseq}    & and \\
%20171226%    (2). & $\ds\exists \seqn{h_n} \st \fphi(x)=\sum_{n\in\Z}h_n\opDil\opTrn^n\fphi(x)$ & and \\
%20171226%    (3). & $\Fphi(\omega)$ is \prope{continuous} at $0$                                & and \\
%20171226%    (4). & $\Fphi(0)\neq0$
%20171226%  \end{array}}
%20171226%  \implies
%20171226%  \brb{\begin{array}{N}
%20171226%    $\seqjZ{\spV_j}$ is an \structe{MRA}\\
%20171226%    \xref{def:mra}
%20171226%  \end{array}}
%20171226%  }
%20171226%\end{theorem}
%20171226%\begin{proof}
%20171226%For this to be true, each of the conditions in the definition of an \structe{MRA} \xref{def:mra} must be satisfied:
%20171226%\begin{enumerate}
%20171226%  \item Proof that each $\spV_j$ is \prope{closed}: by definition of $\linspan$
%20171226%
%20171226%  \item Proof that $\seqn{\spV_j}$ is \prope{linearly ordered}: 
%20171226%    \begin{align*}
%20171226%      \spV_j\subseteq\spV_{j+1}
%20171226%        &\iff \linspan\setn{\opDil^j\opTrn^n\fphi}\subseteq\linspan\setn{\opDil^{j+1}\opTrn^n\fphi}
%20171226%        &\iff (2)
%20171226%    \end{align*}
%20171226%
%20171226%  \item Proof that $\ds\Setu_{j\in\Z}\spV_j$ is \prope{dense} in $\spLLR$: by \prefp{prop:mra_UVj}
%20171226%  
%20171226%  \item Proof of \prope{self-similar} property:
%20171226%    \begin{align*}
%20171226%      \brb{\ff\in\spV_j\iff\opDil\ff\in\spV_{j+1}}
%20171226%        &\iff \ff\in\linspan\setn{\opTrn^n\fphi}\iff\opDil\ff\in\linspan\setn{\opDil\opTrn^n\fphi}
%20171226%        &\iff (2)
%20171226%    \end{align*}
%20171226%
%20171226%  \item Proof for \structe{Riesz basis}: by (1) and \prefp{prop:mra_UVj}.
%20171226%\end{enumerate}
%20171226%\end{proof}



%=======================================
%\section{Wavelet analysis}
%=======================================
%=======================================
\section{Definition}
%=======================================
The term ``wavelet" comes from the French word ``\hie{ondelette}", meaning ``small wave". 
And in essence, wavelets are ``small waves" (as opposed to the ``long waves" of Fourier analysis) 
that form a basis for the Hilbert space $\spLLR$.\citetbl{
  \citerpg{strang1996}{ix}{0961408871},
  \citerpg{atkinson2009}{191}{1441904581}
  }
%---------------------------------------
\begin{definition}
\citetbl{
  \citerpgc{wojtaszczyk1997}{17}{0521578949}{Definition 2.1}
  }
\label{def:wavelet}
\label{def:seqWn}
\label{def:wavstrct_psi}
%---------------------------------------
%Let $\MRAspaceLLRV$ be an \structe{multiresolution space} \xref{def:mra}.
Let $\opTrn$ and $\opDil$ be as defined in \prefp{def:opT}.
\defboxp{
  A function $\fpsi(x)$ in $\spLLR$ is a \fnctd{wavelet function} for $\spLLR$ if
  \\\indentx$\set{\opDil^j\opTrn^n\fpsi}{\scy j,n\in\Z}$ is a \structe{Riesz basis} for $\spLLR$.\\
  In this case, $\fpsi$ is also called the \fnctd{mother wavelet} of the basis $\set{\opDil^j\opTrn^n\fpsi}{\scy j,n\in\Z}$.
  The sequence of subspaces $\seqjZ{\spW_j}$ is the \structd{wavelet analysis} induced by $\fpsi$, 
  where each subspace $\spW_j$ is defined as
  \\\indentx$\spW_j\eqd\linspan\setnZ{\opDil^j\opTrn^n\fpsi}$ .
  }
\end{definition}

%---------------------------------------
%\begin{definition}
%---------------------------------------
%Let $\MRAspaceLLRV$ be an \structe{multiresolution space} \xref{def:mra}.
%Let the operation $\adds$ represent \hie{Minkowski addition} on $\spLLR$\ifsxref{subspace}{def:sub_add}.%
%\defboxt{
%  %The \hid{wavelet subspace} $\spW_j$ is the orthogonal complement of $\spV_j$ in $\spV_{j+1}$ such that
%  %  \\\indentx$\spV_j \adds \spW_j = \spV_{j+1}$
%  %  \\
%  The sequence $\seqjZ{\spW_j}$ is a \hid{wavelet analysis} on $\MRAspaceLLRV$ if
%  \\\indentx$\begin{array}{FMCD}
%    1. & $\spV_{j+1} = \mcom{\spV_j \adds \spW_j}{\hi{Minkowski addition}}$
%       & \forall \spW_j \in \seqxZ{\spW_j}\text{ and }\spV_j\in\seqjZ{\spV_j}
%       & and
%     %\qquad\text{\scriptsize ($\spW_j$ is the complement of $\spV_j$ in $\spV_{j+1}$)}
%    \\
%    2. & \mc{2}{M}{There exists $\fpsi\in\spLLR$ such that $\seqxZ{\opTrn^n\fpsi}$ is a \structe{Riesz basis} for $\spW_0$.}
%  \end{array}$
%  }
%\end{definition}

%%---------------------------------------
%\begin{proposition}[complemented subspaces]
%%---------------------------------------
%Let $\MRAspaceLLRV$ be an \structe{MRA space}.
%Let $\spV_j^\orthog$ be the \structe{orthogonal complement} \xref{def:sub_ocomp} of $\spV_j$.
%\propbox{
%  \spV_j^{\orthog\orthog}=\spV_j \qquad\scy\forall n\in\Z \qquad\scs\text{\prope{involutory}}
%  }
%\end{proposition}
%\begin{proof}
%\begin{enume}
%  \item By \pref{def:mra}, $\spV_j$ is \prope{closed} in $\spLLR$ ($\spV_j=\cls\spV_j$).
%  \item By \prefpp{thm:inprod_orthog}, $\spV_j^{\orthog\orthog}=\spV_j$.
%\end{enume}
%\end{proof}

A \structe{wavelet analysis} $\seqn{\spW_j}$ is often constructed from a \structe{multiresolution anaysis} \xref{def:mra}
$\seqn{\spV_j}$ under the relationship
\\\indentx$\ds\spV_{j+1} = \spV_j \adds \spW_j$,\qquad where $\adds$ is subspace addition (\ope{Minkowski addition}).\\
By this relationship alone, $\seqn{\spW_j}$ is in no way uniquely defined 
in terms of a multiresolution analysis $\seqn{\spV_j}$.
In general there are many possible complements of a subspace $\spV_j$.
To uniquely define such a wavelet subspace, one or more additional constraints are required.
One of the most common additional constraints is \hie{orthogonality}, such that
$\spV_j$ and $\spW_j$ are orthogonal to each other\ifdochas{ortho}{ (see \prefp{chp:ortho})}.




%=======================================
\section{Dilation equation}
%=======================================
Suppose $\seqxZ{\opTrn^n\fpsi}$ is a basis for $\spW_0$.
By \prefp{def:seqWn}, the wavelet subspace $\spW_0$ is contained in the 
scaling subspace $\spV_1$.
By \prefp{def:mra}, the sequence $\seqxZ{\opDil\opTrn^n\fphi}$ is a basis for $\spV_1$.
Because $\spW_0$ is contained in $\spV_1$,
the sequence $\seqxZ{\opDil\opTrn^n\fphi}$ is also a basis for $\spW_0$.

%--------------------------------------
\begin{theorem}[\thmd{wavelet dilation equation}]
\label{thm:g->psi}
%--------------------------------------
Let $\mrasys$ be a \structe{multiresolution system} \xref{def:mrasys}
and $\seqjZ{\spW_j}$ be a \structe{wavelet analysis} \xref{def:seqWn} 
with respect to\\
$\mrasys$ and with \fncte{wavelet function} $\fpsi$ \xref{def:wavelet}.
\thmbox{
  \begin{array}{l rc>{\ds}l @{\qquad}D}
    \exists \seqxZ{g_n} \st
      & \fpsi &=& \sum_{n\in\Z}  g_n \opDil \opTrn^n \fphi
      & 
  \end{array}}
\end{theorem}
\begin{proof}
\begin{align*}
  \fpsi &\in \spW_0
        && \text{by \prefp{def:seqWn}}
      \\&\subseteq \spV_1
        && \text{by \prefp{def:seqWn}}
      \\&= \Span\seqxZ{\opDil\opTrn^n\fphi(x)}
        && \text{by \prefp{def:mra} (MRA)}
      \\&\implies 
         \exists \seqxZ{g_n} \st
            \fpsi = \sum_{n\in\Z}  g_n \opDil \opTrn^n \fphi
\end{align*}

%\item Proof that $\fpsi(x) = \sqrt{2} \sum_{n\in\Z}  g_n  \fphi(2x-n)$:
%\begin{align*}
%              &  \set{\fphi(2x-n)}{n\in\Z} \text{ spans } \spV_1
%              && \text{by (1)}
%  \\
%              &  \set{\fpsi(x-n)}{n\in\Z} \text{ spans } \spW_0
%  \\ \implies & \fpsi(x)\in \spW_0 \subset \spV_1
%  \\ \implies & \text{$\fpsi(x)$ can be represented as a linear combination of $\fphi(2x-n)$}.
%\end{align*}
%\end{enumerate}
\end{proof}

A \structe{wavelet system} (next definition) consists of two subspace sequences: 
\begin{liste}
  \item A \structb{multiresolution analysis} $\seqn{\spV_j}$ \xref{def:mra}
     provides ``coarse" approximations of a function in $\spLLR$ at different ``scales" or resolutions.
  \item A \structb{wavelet analysis} $\seqn{\spW_j}$
     provides the ``detail" of the function missing from the approximation provided by a given scaling subspace
     \xref{def:seqWn}.
\end{liste}

%--------------------------------------
\begin{definition}
\label{def:wavsys}
\label{def:gn}
%--------------------------------------
Let $\mrasys$ be a \structe{multiresolution system} \xref{def:mra}
and $\seqjZ{\spW_j}$ a wavelet analysis \xref{def:seqWn}
with respect to $\seqjZ{\spV_j}$.
Let $\seqxZ{g_n}$ be a sequence of coefficients.
\defbox{\begin{array}{M}
  A \structd{wavelet system} is the tuple \quad$\ds\wavsys$\\
  and the sequence $\seqxZ{g_n}$ that satisfies the equation
  $\ds\fpsi = \sum_{n\in\Z}  g_n \opDil \opTrn^n \fphi$\\
  is the \structd{wavelet coefficient sequence}.
\end{array}}
\end{definition}

%--------------------------------------
\begin{remark}
%--------------------------------------
The pair of coefficient sequences $\opair{\seqn{h_n}}{\seqn{g_n}}$ generates 
the scaling function $\fphi(x)$ \xref{def:wavstrct_phi} 
and the wavelet function $\fpsi(x)$ \xref{def:wavstrct_psi}.
These functions in turn generate 
the multiresolution analysis $\seqn{\spV_j}$ \xref{def:seqVn}
and the wavelet analysis $\seqn{\spW_j}$ \xref{def:seqWn}.
Therefore, the coefficient sequence pair $\opair{\seqn{h_n}}{\seqn{g_n}}$ 
totally defines a wavelet system\\$\wavsys$ \xref{def:wavsys}.

Furthermore, especially in the case of orthonormal wavelets, the wavelet coefficient
sequence $\seqxZ{g_n}$ is often defined in terms of the 
scaling coefficient sequence $\seqxZ{h_n}$
in a very simple and straightforward manner.
Therefore, in the case of an orthonormal wavelet system, the coefficient
scaling sequence $\seqxZ{h_n}$ often totally defines the entire wavelet system.
And in this case, designing a wavelet system is only a matter of finding a handful of
scaling coefficients $\seqn{h_1,\,h_2,\,\ldots,\,h_n}$\ldots because once you have these,
you can generate everything else.
\end{remark}


%%---------------------------------------
%\begin{definition}
%\label{def:wav_lat_coef}
%%---------------------------------------
%Let $\seqxZ{h_n}$ be a sequence of scaling coefficients and
%    $\seqxZ{g_n}$ be the associated sequence of wavelet coefficients.
%%    $\subseteq$ the set inclusion relation,
%%    $\setu$ the set union operation, and
%%    $\seti$ the set intersection operation.
%\defbox{\begin{array}{l}
%  \text{The tupple }
%  \qquad \wavlatcoef \\
%  \text{is called the \hid{lattice of wavelet bases coefficients}.}
%\end{array}}
%\end{definition}



%\begin{figure}[t]
%\setlength{\unitlength}{8mm}
%\begin{center}
%\begin{tabular}{cc}
%   \includegraphics*[width=6\tw/16, height=6\tw/16, clip=true]{../common/wavelets/haar_sj.eps} &
%   \includegraphics*[width=6\tw/16, height=6\tw/16, clip=true]{../common/wavelets/haar_sk.eps} \\
%   \footnotesize varying dilation, constant translation   &
%   \footnotesize varying translation, constant dilation
%\end{tabular}
%\caption{
%   \label{fig:haar-jn}
%   Haar scaling function at varying dilations and translations.
%   }
%\end{center}
%\end{figure}



%=======================================
\section{Order structure}
%=======================================
%The axioms of \prefp{def:mra} generate a subspace architecture.
%These transform representation sequences may be \hie{ordered} with \hie{ordering relations}
%as follows:%
%\footnote{\hie{projection operator ordering}: \prefp{def:operator_lattice}}

\begin{minipage}{\tw-70mm}\raggedright
The \structe{wavelet system} $\wavsys$ \xref{def:wavsys} together with the 
set inclusion relation $\subseteq$ 
forms an \structe{ordered set}\ifsxref{order}{def:poset}, 
illustrated to the right by a \hie{Hasse diagram}\ifsxref{order}{def:hasse}.%\ifdochas{order}{\footnotemark}
%Under these three order relations, wavelet system generate three isomorphic lattices such 
%as are illustrated in \prefp{fig:wav_VPb_isomorphic} 
%and in the figure to the right.
\end{minipage}%
\hfill\tbox{\includegraphics{graphics/latwav.pdf}}%

%---------------------------------------
\begin{proposition}
\label{prop:order_wavstrct}
%---------------------------------------
Let $\wavsys$ be a wavelet system with order relation $\subseteq$.
The lattice $\latL\eqd\lattice{\seqn{\spV_j},\seqn{\spW_j}}{\subseteq}{\join}{\meet}$ has 
the following properties:
\propbox{\begin{array}{FM}
      1.  & $\latL$ is \prope{nondistributive}.
    \\2.  & $\latL$ is \prope{nonmodular}.
    %\cntn & $\latL$ is \prope{complemented}.
    %\cntn & $\latL$ is \prope{not uniquely complemented}.
    %\cntn & $\latL$ is \prope{nonorthocomplemented}.
    \\3.  & $\latL$ is \prope{noncomplemented}.
    \\4.  & $\latL$ is \prope{nonBoolean}.
\end{array}}
\end{proposition}
\begin{proof}
%\mbox{}\hspace{20mm}
%  \latmatlw{4}{0.5}
%    {
%           &       & \null                 \\  
%           & \null                         \\  
%     \null &       & \null &       & \null \\  
%           &       & \null                   
%    }
%    {\ncline{1,3}{2,2}\ncline{2,2}{3,1}
%     \ncline{1,3}{3,5}
%     \ncline{2,2}{3,3}
%     \ncline{4,3}{3,1}\ncline{4,3}{3,3}\ncline{4,3}{3,5}
%    }
%    {\nput{ 90}{1,3}{$1$}
%     \nput{135}{2,2}{$v$}
%     \nput{0}{3,1}{$x$}
%     \nput{ 67}{3,3}{$y$}
%     \nput{  0}{3,5}{$z$}
%     \nput{-90}{4,3}{$0$}
%    }
\begin{enumerate}
  \item Proof that $\latL$ is \prope{nondistributive}: \label{item:wavprop_nondistrib}
    \begin{enumerate}
      \item $\latL$ contains the $N5$ lattice\ifsxref{latm}{def:lat_N5}.
      \item Because $\latL$ contains the $N5$ lattice, $\latL$ is \prope{nondistributive}\ifdochas{latm}{ by \prefp{thm:latd_char_n5m3}}.
    \end{enumerate}

  \item Proof that $\latL$ is \prope{nonmodular} and \prope{nondistributive}: 
    \begin{enumerate}
      \item $\latL$ contains the $N5$ lattice\ifsxref{latm}{def:lat_N5}.
      \item Because $\latL$ contains the $N5$ lattice, $\latL$ is \prope{nonmodular}\ifdochas{latm}{ by \prefp{thm:lat_mod_iff_N5}}.
    \end{enumerate}

  \item Proof that $\latL$ is \prope{noncomplemented}:
    \begin{minipage}{50mm}
      \begin{align*}
          x' &= y' = v' = z
        \\z' &= \setn{x,y,v}
        \\x''&= \brp{x'}'
           \\&= z'
           \\&= \setn{x,y,v}
           \\&\ne  x
      \end{align*}
    \end{minipage}\qquad\tbox{\includegraphics{graphics/lat6_plat_xyzv10.pdf}}%

  %\item Proof that $\latL$ is \prope{not uniquely complemented}:\\
  %   For example, subspace $\spW_2$ in \prefp{fig:wav_VPb_isomorphic} is complemented
  %   by $\spV_1$, $\spV_2$, and $\spW_1$.
  %\item Proof that $\latL$ is \prope{orthomodular}:
  %  \begin{enumerate}
  %    \item $\latL$ does \emph{not} contain the $O_6$ lattice\ifdochas{ortholat}{ \xref{def:latoc_omod}}.
  %    \item Because $\latL$ does not contain the $O_6$ lattice, $\latL$ is \prope{orthomodular}\ifdochas{ortholat}{ by \prefp{thm:latoc_omod}}.
  %  \end{enumerate}

  \item Proof that $\latL$ is \prope{nonBoolean}:
    \begin{enumerate}
      \item $\latL$ is \prope{nondistributive} (\pref{item:wavprop_nondistrib}).
      \item Because $\latL$ is \prope{nondistributive}, it is \prope{nonBoolean}\ifdochas{boolean}{ by \prefp{def:booalg}}.
    \end{enumerate}
\end{enumerate}
\end{proof}




%=======================================
\section{Subspace algebraic structure}
%=======================================
%--------------------------------------
\begin{theorem}
\label{thm:mra_subalg}
%--------------------------------------
Let $\wavsys$ be a \structe{wavelet system} \xref{def:wavsys}.
Let $\spV_1 \adds \spV_2$ represent \fncte{Minkowski addition} of two subspaces $\spV_1$ and $\spV_2$ of a Hilbert space $\spH$.
\thmbox{\begin{array}{rc>{\ds}l D}
    \spLLR &=& \lim_{j\to\infty}\spV_j                 
             & ($\spLLR$ is equivalent to one very large scaling subspace)\\
           &=& \spV_j \adds \spW_j \adds \spW_{j+1} \adds \spW_{j+2} \adds\, \cdots 
             & $\brp{\begin{array}{D}$\spLLR$ is equivalent to one scaling space\\
                                       and a sequence of wavelet subspaces\end{array}} $\\
           &=& \cdots\,\adds \spW_{-2} \adds \spW_{-1} \adds \spW_0 \adds \spW_1 \adds \spW_2 \adds\,\cdots        
             & ($\spLLR$ is equivalent to a sequence of wavelet subspaces)
  \end{array}}
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Proof for (1):
    \begin{align*}
      \spLLR 
        &= \lim_{j\to\infty}\spV_j                 
        && \text{by \prefp{def:mra}}
    \end{align*}

  \item Proof for (2):
    \begin{align*}
      \mcom{\spV_j \adds \spW_j}{$\spV_{j+1}$} \adds \spW_{j+1} \adds \spW_{j+2} \adds \cdots
        &= \mcom{\spV_{j+1} \adds \spW_{j+1}}{$\spV_{j+2}$} \adds \spW_{j+2} \adds \spW_{j+3} \adds \cdots
      \\&= \mcom{\spV_{j+2} \adds \spW_{j+2}}{$\spV_{j+3}$} \adds \spW_{j+3} \adds \spW_{j+4} \adds \cdots
      \\&= \mcom{\spV_{j+3} \adds \spW_{j+3}}{$\spV_{j+4}$} \adds \spW_{j+4} \adds \spW_{j+5} \adds \cdots
      \\&= \mcom{\spV_{j+5} \adds \spW_{j+5}}{$\spV_{j+5}$} \adds \spW_{j+6} \adds \spW_{j+6} \adds \cdots
      \\&= \lim_{j\to\infty}\spV_{j+5} \adds \spW_{j+5} \adds \spW_{j+6} \adds \spW_{j+6} \adds \cdots
      \\&= \spLLR
    \end{align*}

  \item Proof for (3):
    \begin{align*}
      \spLLR &= \mcom{\spV_0}{$\spV_{-1}\adds\spW_{-1}$} \adds \spW_0 \adds \spW_1 \adds \spW_2 \adds \spW_3 \adds \cdots
             && \text{by (2)}
           \\&= \mcom{\spV_{-1}}{$\spV_{-2}\adds\spW_{-2}$} \spW_{-1} \adds \spW_0 \adds \spW_1 \adds \spW_2 \adds \spW_3 \adds \cdots
           \\&= \mcom{\spV_{-2}}{$\spV_{-3}\adds\spW_{-3}$} \spW_{-2} \adds \spW_{-1} \adds \spW_0 \adds \spW_1 \adds \spW_2 \adds \spW_3 \adds \cdots
           \\&= \mcom{\spV_{-3}}{$\spV_{-4}\adds\spW_{-4}$} \spW_{-3} \adds \spW_{-2} \adds \spW_{-1} \adds \spW_0 \adds \spW_1 \adds \spW_2 \adds \spW_3 \adds \cdots
           \\&\vdots
           \\&= \cdots \adds \spW_{-3} \adds \spW_{-2} \adds \spW_{-1} \adds \spW_0 \adds \spW_1 \adds \spW_2 \adds \spW_3 \adds \cdots
    \end{align*}
\end{enumerate}
\end{proof}

%--------------------------------------
\begin{remark}
%--------------------------------------
In the special case that two subspaces $\spW_1$ and $\spW_2$ are \prope{orthogonal} to each other, then 
the \fncte{subspace addition} operation $\spW_1\adds\spW_2$ is frequently expressed as
$\spW_1\oplus\spW_2$.
In the case of an \structe{orthonormal wavelet system}\ifsxref{ortho}{def:ows}, 
the expressions in \prefpp{thm:mra_subalg} could be expressed as
\\\indentx$\begin{array}{rc>{\ds}l}
    \spLLR &=& \lim_{j\to\infty}\spV_j                 \\
           &=& \spV_j \oplus \spW_j \oplus \spW_{j+1} \oplus \spW_{j+2} \oplus\, \cdots \\
           &=& \cdots\,\oplus \spW_{-2} \oplus \spW_{-1} \oplus \spW_0 \oplus \spW_1 \oplus \spW_2 \oplus\,\cdots .       
  \end{array}$
\end{remark}.


%=======================================
\section{Necessary conditions}
%=======================================

%--------------------------------------
\begin{theorem}[\thmd{quadrature condition}s in ``time"]
\label{thm:wavsys_quadcon}
%--------------------------------------
Let $\wavsys$ be a wavelet system \xref{def:wavsys}.
\thmbox{\begin{array}{F>{\ds}rc>{\ds}lC}
  1. & \sum_{m\in\Z} h_m \sum_{k\in\Z} h_k^\ast \inprod{\fphi}{\opTrn^{2n-m+k} \fphi} &=& \inprod{\fphi}{\opTrn^n \fphi} & \forall n\in\Z\\
  2. & \sum_{m\in\Z} g_m \sum_{k\in\Z} g_k^\ast \inprod{\fphi}{\opTrn^{2n-m+k} \fphi} &=& \inprod{\fpsi}{\opTrn^n \fpsi} & \forall n\in\Z\\
  3. & \sum_{m\in\Z} h_m \sum_{k\in\Z} g_k^\ast \inprod{\fphi}{\opTrn^{2n-m+k} \fphi} &=& \inprod{\fphi}{\opTrn^n \fpsi} & \forall n\in\Z
\end{array}}
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Proof for (1): by \prefp{thm:wav_quadcon}.
  \item Proof for (2): 
    \begin{align*}
      \inprod{\fpsi}{\opTrn^n \fpsi}
        &= \inprod{\sum_{m\in\Z} g_m \opDil \opTrn^m \fphi }{\opTrn^n \sum_{k\in\Z} g_k \opDil \opTrn^k \fphi}
        && \text{by \thme{wavelet dilation equation}}
        && \text{\xref{thm:g->psi}}
      \\&= \sum_{m\in\Z} g_m \sum_{k\in\Z} g_k^\ast \inprod{\opDil \opTrn^m \fphi }{\opTrn^n \opDil \opTrn^k \fphi}
        && \text{by properties of $\inprodn$}
        && \text{\xref{def:inprod}}
      \\&= \sum_{m\in\Z} g_m \sum_{k\in\Z} g_k^\ast \inprod{\fphi }{\left(\opDil \opTrn^m \right)^\ast \opTrn^n \opDil \opTrn^k \fphi}
        && \text{by def. of operator adjoint}
        && \text{\ifxref{operator}{prop:op_adjoint}}
      \\&= \sum_{m\in\Z} g_m \sum_{k\in\Z} g_k^\ast \inprod{\fphi }{\left(\opDil \opTrn^m \right)^\ast \opDil \opTrn^{2n} \opTrn^k \fphi}
        && \text{by \prefp{prop:DTTD}}
      \\&= \sum_{m\in\Z} g_m \sum_{k\in\Z} g_k^\ast \inprod{\fphi }{\opTrna^m \opDila \opDil \opTrn^{2n} \opTrn^k \fphi}
        && \text{by operator star-algebra prop.}
        && \text{\ifxref{operator}{thm:op_star}}
      \\&= \sum_{m\in\Z} g_m \sum_{k\in\Z} g_k^\ast \inprod{\fphi }{\opTrn^{-m} \opDil^{-1} \opDil \opTrn^{2n} \opTrn^k \fphi}
        && \text{by \prefp{prop:TD_unitary}}
      \\&= \sum_{m\in\Z} g_m \sum_{k\in\Z} g_k^\ast \inprod{\fphi }{\opTrn^{2n-m+k} \fphi}
    \end{align*}

  \item Proof for (3): 
    \begin{align*}
      &\inprod{\fphi}{\opTrn^n \fpsi}
      \\&= \inprod{\sum_{m\in\Z} h_m \opDil \opTrn^m \fphi }{\opTrn^n \sum_{k\in\Z} g_k \opDil \opTrn^k \fphi}
        && \text{by \prefp{thm:dilation_eq}}
        && \text{and \prefp{thm:g->psi}}
      \\&= \sum_{m\in\Z} h_m \sum_{k\in\Z} g_k^\ast \inprod{\opDil \opTrn^m \fphi }{\opTrn^n \opDil \opTrn^k \fphi}
        && \text{by properties of $\inprodn$}
        && \text{\xref{def:inprod}}
      \\&= \sum_{m\in\Z} h_m \sum_{k\in\Z} g_k^\ast \inprod{\fphi }{\left(\opDil \opTrn^m \right)^\ast \opTrn^n \opDil \opTrn^k \fphi}
        && \text{by definition of operator adjoint}
        && \text{\ifxref{operator}{prop:op_adjoint}}
      \\&= \sum_{m\in\Z} h_m \sum_{k\in\Z} g_k^\ast \inprod{\fphi }{\left(\opDil \opTrn^m \right)^\ast \opDil \opTrn^{2n} \opTrn^k \fphi}
        && \text{by \prefp{prop:DTTD}}
      \\&= \sum_{m\in\Z} h_m \sum_{k\in\Z} g_k^\ast \inprod{\fphi }{\opTrna^m \opDila \opDil \opTrn^{2n} \opTrn^k \fphi}
        && \text{by operator star-algebra properties}
        && \text{\ifxref{operator}{thm:op_star}}
      \\&= \sum_{m\in\Z} h_m \sum_{k\in\Z} g_k^\ast \inprod{\fphi }{\opTrn^{-m} \opDil^{-1} \opDil \opTrn^{2n} \opTrn^k \fphi}
        && \text{by \prefp{prop:TD_unitary}}
      \\&= \sum_{m\in\Z} h_m \sum_{k\in\Z} g_k^\ast \inprod{\fphi }{\opTrn^{2n-m+k} \fphi}
    \end{align*}
\end{enumerate}
\end{proof}



%=======================================
%\section{Fourier properties}
%=======================================

%--------------------------------------
\begin{proposition}
\label{prop:vsmra_real_Fpsi}
\label{prop:psi_g_phi}
%--------------------------------------
Let $\wavsys$ be a wavelet system.
Let $\Fphi(\omega)$ and $\Fpsi(\omega)$ be the \fncte{Fourier transform}s\ifsxrefs{harFour}{def:ft}of $\fphi(x)$ and $\fpsi(x)$, respectively.
Let $\Dg(\omega)$ be the \fncte{Discrete time Fourier transform}\ifsxrefs{dsp}{def:dtft}of $\seqn{g_n}$.
%  $\begin{array}[t]{rc>{\ds}l c>{\ds}l D}
%    \Fpsi\brp{\omega}
%      &\eqd& \opFT\fpsi
%      &\eqd& \frac{1}{\sqrt{2\pi}}\int_t \fpsi(x) e^{-i\omega t} \dx
%      &      (\structe{Fourier transform}, \prefp{def:ft})
%      \\
%    \Dg(\omega)
%      &\eqd& \opDTFT\seqn{g_n}
%      &\eqd& \sum_{n\in\Z} g_n e^{-i\omega n}
%      &      (\structe{Discrete-time Fourier Transform}).
%  \end{array}$
\propbox{
  \Fpsi\brp{\omega}
    %\eqd
    %\mcom{\opFT\fpsi = \brp{\opDili \opDTFT\seqn{g_n}} \; \brp{\opDili \opFT\fphi}}
    %     {operator notation}
    =
    {\cwt \: \Dg\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}}
    %     {traditional notation}
  }
\end{proposition}
\begin{proof}
\begin{align*}
  \Fpsi\brp{\omega}
    &\eqd \opFT\fpsi
  \\&= \opFT\sum_{n\in\Z} g_n \opDil \opTrn^n \fphi
    && \text{by \thme{wavelet dilation equation}}
    && \text{\xref{thm:g->psi}}
  \\&= \sum_{n\in\Z} g_n \opFT\opDil \opTrn^n \fphi
  \\&= \sum_{n\in\Z} g_n \opDili \opFT\opTrn^n \fphi
    && \text{by \prefp{cor:wavstrct_FTD}}
  \\&= \sum_{n\in\Z} g_n \opDili e^{-i\omega n} \opFT\fphi
    && \text{by \prefp{cor:wavstrct_FTD}}
  \\&= \sum_{n\in\Z} g_n \sqrt{2}\brp{\opDili e^{-i\omega n}} \brp{\opDili\opFT\fphi}
    && \text{by \prefp{prop:DjTnfg}}
  \\&= \sqrt{2}\brp{\opDili \sum_{n\in\Z} g_n e^{-i\omega n}} \; \brp{\opDili \opFT\fphi}
  \\&= \sqrt{2}\brp{\opDili \opDTFT\seqn{g_n}} \; \brp{\opDili \opFT\fphi}
    && \text{by definition of $\opDTFT$}
    && \text{\ifxref{dsp}{def:dtft}}
  \\&= \sqrt{2}\cwt \: \Dg\brp{\frac{\omega}{2}}\: \cwt \Fphi\brp{\frac{\omega}{2}}
    && \text{by property of $\opDil$} && \text{\xref{prop:opDi}}
  \\&= \cwt \: \Dg\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
\end{align*}
%
%\begin{align*}
%  \Fpsi\brp{\omega}
%    &= \opF\fpsi
%  \\&= \opFT\sum_{n\in\Z} g_n \opDil \opTrn^n \fphi
%    && %\text{by \thme{dilation equation} \xref{thm:dilation_eq}}
%  \\&= \sum_{n\in\Z} g_n \opFT\opDil \opTrn^n \fphi
%  \\&= \sum_{n\in\Z} g_n \opDili \opFT\opTrn^n \fphi
%    && \text{by \prefp{prop:vsmra_real_FD}}
%  \\&= \sum_{n\in\Z} g_n \opDili e^{-i\omega n} \opFT\fphi
%    && \text{by \prefp{prop:vsmra_real_FT}}
%  \\&= \brp{\opDili \sum_{n\in\Z} g_n e^{-i\omega n}} \; \brp{\opDili \opFT\fphi}
%  \\&= \brp{\opDili \opDTFT\seqn{g_n}} \; \brp{\opDili \opFT\fphi}
%  \\&= \fscale \: \Dg\brp{\frac{\omega}{2}}\: \fscale \Fphi\brp{\frac{\omega}{2}}
%    && \text{by property of $\opDil$} && \text{\xref{prop:opDi}}
%  \\&= \frac{1}{2}\: \Dh\brp{\frac{\omega}{2}}\: \Fphi\brp{\frac{\omega}{2}}
%\end{align*}
\end{proof}

%=======================================
%\section{Immediate results}
%=======================================



%=======================================
%\subsection{Power Spectrum}
%=======================================
%%--------------------------------------
%\begin{definition}
%\citep{chui}{134}
%\label{def:wav_S}
%\index{scaling power spectrum function         }
%\index{wavelet power spectrum function         }
%\index{scaling wavelet power spectrum function }
%\index{Laurent polynomial}
%%--------------------------------------
%Let $\wavsys$ be a \hi{wavelet system}.
%Let $\Szfg(z)$ be the \fncte{complex cross-power spectrum} of $\ff$ and $\fg$ \xref{def:Szfg} in $\spLLR$
%and $\Swfg(\omega)$ be the \fncte{cross-power spectrum} of $\ff$ and $\fg$ \xref{def:Swfg} in $\spLLR$.
%\defbox{\begin{array}{>{\ds}rc>{\ds}lM}
%    \Szphi(z)  &\eqd&  \left.\Szfg(z)\right|_{\ff=\fg=\fphi} &is the \hid{scaling power spectrum function}.
%    \Szpsi(z)  &\eqd&  \left.\Szfg(z)\right|_{\ff=\fg=\fpsi} &is the \hid{wavelet power spectrum function}.
%    \Szpsi(z)  &\eqd&  \Szfg(z) &is the \hid{scaling power spectrum function}.
%    \\
%    \Spsi(\omega) &\eqd&  \sum_{n\in\Z} \Rpsi(n) \fkernea{n}{\omega}
%    &is the \hid{wavelet power spectrum function}.
%    \\
%    \Shs (\omega) &\eqd&  \sum_{n\in\Z} \Rhs (n) \fkernea{n}{\omega}
%    &is the \hid{scaling wavelet power spectrum function}.
%\end{array}}
%%\\The Laurent polynomial $\Sphi(\omega)$ is also called the \hid{Euler-Frobenius polynomial}.
%\end{definition}


%In this chapter, we don't assume the special case of orthonormality.
%But good things happen if we do happen to have orthonormality.
%One of them is that the power spectrum equations in \prefp{lem:SSS}
%simplify to constants \xref{lem:SSSo}.

\pref{thm:gen_quadcon} (next) presents the \structe{quadrature} necessary conditions of a \hi{wavelet system}.
These relations simplify dramatically in the special case of an
\structe{orthonormal wavelet system} \xref{thm:oquadcon}.
%--------------------------------------
\begin{theorem}[\thmd{Quadrature conditions} in ``frequency"]
\citetbl{
  \citerp{chui}{135},
  \citerp{goswami}{110}
  }
\label{thm:gen_quadcon}
%--------------------------------------
Let $\wavsys$ be a \hi{wavelet system}.
Let $\Fx(\omega)$ be the \fncte{discrete time Fourier transform}\ifsxrefs{dsp}{def:dtft}for a sequence $\seqxZ{x_n}$ in $\spllR$.
Let $\Swphi(\omega)$ be the \fncte{auto-power spectrum} \xref{def:Swfg} of $\fphi$,
    $\Swpsi(\omega)$ be the \fncte{auto-power spectrum} of $\fpsi$,
and $\Shs(\omega)$ be the \fncte{cross-power spectrum} of $\fphi$ and $\fpsi$.
\thmbox{\begin{array}{F>{\ds}lc>{\ds}l}
   1. & \abs{\Dh\left(\omega     \right)}^2 \Sphi(\omega) + \abs{\Dh\brp{\omega+\pi }}^2 \Sphi(\omega+\pi) &=& 2\Sphi(2\omega)
\\ 2. & \abs{\Dg\left(\omega     \right)}^2 \Sphi(\omega) + \abs{\Dg\brp{\omega+\pi }}^2 \Sphi(\omega+\pi) &=& 2\Spsi(2\omega)
\\ 3. & \Dh(\omega)\Dg^\ast(\omega)         \Sphi(\omega) + \Dh(\omega +\pi)\Dg^\ast(\omega +\pi)\Sphi(\omega+\pi) &=& 2\Shs(2\omega)
\end{array}}
\end{theorem}
\begin{proof}
\begin{enumerate}
  %\item First note that $\Dh(\omega)$ and $\Dg(\omega)$ are periodic with period $2\pi$ such that\ifsxrefs{dsp}{prop:dtft_2pi}
  %  \\$\begin{array}{rclC}
  %       \Dh(\omega+2\pi n) &=& \Dh(\omega) & \forall n\in\Z   \\
  %       \Dg(\omega+2\pi n) &=& \Dg(\omega) & \forall n\in\Z   
  %     \end{array}$

\item Proof for (1): by \prefp{thm:Sphi}.

\item Proof for (2):
\begin{align*}
   2\Spsi(2\omega)
     &\eqd 2\brp{2\pi}\sum_{n\in\Z} \left|\Fpsi(2\omega+2\pi n)\right|^2
   \\&= 2\brp{2\pi}\sum_{n\in\Z} \left|\cwt \Dg\left(\frac{2\omega+2\pi n}{2}\right)\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2
        \indentx\text{by \prefp{lem:Fphi}}
   \\&= 2\pi
        \sum_{n\in\Ze} \left|\Dg\left(\frac{2\omega+2\pi n}{2}\right)\right|^2\left|\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2 +
     \\&\qquad 2\pi
        \sum_{n\in\Zo} \left|\Dg\left(\frac{2\omega+2\pi n}{2}\right)\right|^2\left|\Fphi\left(\frac{2\omega+2\pi n}{2}\right)\right|^2
   \\&= 2\pi\sum_{n\in\Z} \abs{\Dg\brp{\omega+2\pi n     }}^2 \abs{\Fphi\brp{\omega+2\pi n       }}^2 +
        2\pi\sum_{n\in\Z} \abs{\Dg\brp{\omega+2\pi n+\pi }}^2 \abs{\Fphi\brp{\omega+2\pi n + \pi }}^2  
   \\&= 2\pi\sum_{n\in\Z} \abs{\Dg\brp{\omega            }}^2 \abs{\Fphi\brp{\omega+2\pi n       }}^2 +
        2\pi\sum_{n\in\Z} \abs{\Dg\brp{\omega+\pi        }}^2 \abs{\Fphi\brp{\omega+2\pi n + \pi }}^2  
   \\&= \abs{\Dg\brp{\omega     }}^2 \brp{2\pi\sum_{n\in\Z} \abs{\Fphi\brp{\omega+2\pi n       }}^2 +}
        \abs{\Dg\brp{\omega+\pi }}^2 \brp{2\pi\sum_{n\in\Z} \abs{\Fphi\brp{\omega+\pi+2\pi n   }}^2  }
   \\&= \abs{\Dg\brp{\omega     }}^2\Sphi(\omega) +
        \abs{\Dg\brp{\omega+\pi }}^2 \Sphi(\omega+\pi)
        \indentx\text{by \prefp{thm:Swfg}}
\end{align*}


\item Proof for (3):
\begin{align*}
  2\Shs(2\omega)
    &=  2\brp{2\pi}\sum_{n\in\Z} \Fphi(2\omega+2\pi n) \Fpsi^\ast(2\omega+2\pi n)
  \\&=  2\brp{2\pi}\sum_{n\in\Z}
        \cwt 
        \Dh  \left(\omega +\pi n \right)
        \Fphi\left(\omega +\pi n \right)
        \cwt 
        \Dg^\ast  \left(\omega +\pi n \right)
        \Fphi^\ast\left(\omega +\pi n \right)
        \quad\text{by \prefp{lem:Fphi}}
  \\&=  2\pi
        \sum_{n\in\Z}
        \Dh  \left(\omega +\pi n \right)
        \Dg^\ast  \left(\omega +\pi n \right)
        \left| \Fphi\left(\omega +\pi n \right) \right|^2
  \\&=  2\pi
        \sum_{n\in\Zo}
        \Dh  \left(\omega +\pi n \right)
        \Dg^\ast  \left(\omega +\pi n \right)
        \left| \Fphi\left(\omega +\pi n \right) \right|^2
      \\&\qquad+ 2\pi\sum_{n\in\Ze}
        \Dh  \left(\omega +\pi n \right)
        \Dg^\ast  \left(\omega +\pi n \right)
        \left| \Fphi\left(\omega +\pi n \right) \right|^2
  \\&=  2\pi\sum_{n\in\Z}
        \Dh  \left(\omega +2\pi n+\pi \right)
        \Dg^\ast  \left(\omega +2\pi n+\pi \right)
        \left| \Fphi\left(\omega +2\pi n+\pi \right) \right|^2
      \\&\qquad+ 2\pi\sum_{n\in\Z}
        \Dh  \left(\omega +2\pi n\right)
        \Dg^\ast  \left(\omega +2\pi n\right)
        \left| \Fphi\left(\omega +2\pi n\right) \right|^2
  \\&=  2\pi
        \sum_{n\in\Z}
        \Dh  \left(\omega +\pi \right)
        \Dg^\ast  \left(\omega +\pi \right)
        \left| \Fphi\left(\omega +2\pi n+\pi \right) \right|^2
      + 2\pi\sum_{n\in\Z}
        \Dh  \left(\omega \right)
        \Dg^\ast  \left(\omega \right)
        \left| \Fphi\left(\omega +2\pi n\right) \right|^2
  \\&=  \Dh  \left(\omega \right)
        \Dg^\ast  \left(\omega \right)
        \brp{2\pi\sum_{n\in\Z} \left| \Fphi\left(\omega +2\pi n\right) \right|^2}
      \\&\qquad+ \Dh  \left(\omega +\pi \right)
        \Dg^\ast  \left(\omega +\pi \right)
        \brp{2\pi\sum_{n\in\Z}\left| \Fphi\left(\omega +\pi+2\pi n\right) \right|^2}
  \\&=  \Dh(\omega)
        \Dg^\ast(\omega)
        \brp{2\pi\sum_{n\in\Z} \left| \Fphi(\omega +2\pi n) \right|^2}
      + \Dh  (\omega +\pi)
        \Dg^\ast (\omega +\pi)
        \brp{2\pi\sum_{n\in\Z}\left| \Fphi(\omega +\pi+2\pi n) \right|^2}
  \\&=  \Dh(\omega     ) \Dg^\ast(\omega     )\Sphi(\omega)
      + \Dh(\omega +\pi) \Dg^\ast(\omega +\pi)\Sphi(\omega+\pi)
        \indentx\text{by \prefp{thm:Swfg}}
\end{align*}

\end{enumerate}
\end{proof}

%%=======================================
%\begin{definition}
%%=======================================
%Let $\wavsys$ be a wavelet system.
%Let $\oppS\seqn{\fphi}_m$ be the \hid{span} of the basis vectors $\seqn{\fphi}_m$.
%We define the following order relations. 
%\defbox{\begin{array}{rcll}
%%  \opP_m         &\orel&  \opP_n         & \quad\text{if}\quad \opP_m\opP_n=\opP_n\opP_m=\opP_m \\
%  \spV_m         &\orela& \spV_j         & \quad\text{if}\quad \spV_m \subseteq \spV_j \\
%  \seqn{\fphi}_m &\orelb& \seqn{\fphi}_n & \quad\text{if}\quad \oppS\seqn{\fphi}_m \subseteq \oppS\seqn{\fphi}_n %\qquad\text{where $\oppS$ is the span}
%\end{array}}
%\end{definition}
%



%The sequences of subspaces discussed in this section together with
%set relations $\subseteq$, $\setu$, and $\seti$,
%for a lattice.
%This ``\hie{lattice of wavelet subspaces}" is defined next.
%%---------------------------------------
%\begin{definition}
%\label{def:wav_lat_subspace}
%%---------------------------------------
%Let $\seqjZ{\spV_j}$ be a sequence of scaling subspaces and
%    $\seqjZ{\spW_j}$ be a sequence of wavelet subspaces.
%%    $\subseteq$ the set inclusion relation,
%%    $\odot$ the set union operation, and
%%    $\seti$ the set intersection operation.
%\defbox{\begin{array}{l}
%  \text{The tupple }
%  \qquad \wavlatsubs \\
%  \text{is called the \hid{lattice of wavelet subspaces}.}
%\end{array}}
%\end{definition}


%=======================================
\section{Sufficient condition}
%=======================================
In this text, an often used sufficient condition for designing the \structe{wavelet coefficient sequence} 
$\seqn{g_n}$ \xref{def:gn} is the \prope{conjugate quadrature filter condition} \xref{def:cqf}. 
It expresses the sequence $\seqn{g_n}$ in terms of the \structe{scaling coefficient sequence} \xref{def:hn}
and a ``shift" integer $\xN$ as $g_n = \pm(-1)^n h^\ast_{\xN-n}$.
The \structe{CQF condition} has the following ``nice" properties:
\\\indentx\begin{tabular}{>{\scs}rp{\tw-30mm}}
    1. & Given a \structe{scaling coefficient sequence} $\seqn{h_n}$ \xref{def:hn}, 
         it is extremely simple to compute the \structe{wavelet coefficient sequence} $\seqn{g_n}$ \xref{def:gn}.
  \\2. & If $\setn{\opTrn\fphi}$ of a \structe{wavelet system} $\wavsys$ \xref{def:wavsys} is \prope{orthonormal} and 
         $\otriple{\seqn{g_n}}{\seqn{h_n}}{\xN}$ satisfies the \prope{CQF condition}, 
         then $\setn{\opTrn^n\fpsi}$ is also \prope{orthnormal}\ifsxref{ortho}{thm:ortho_qmr}.
  \\3. & If $\setn{\opTrn\fphi}$ of a \structe{wavelet system} $\wavsys$ \xref{def:wavsys} is \prope{orthonormal} and 
         $\otriple{\seqn{g_n}}{\seqn{h_n}}{\xN}$ satisfies the \prope{CQF condition}, 
         then the \structe{wavelet subspace} $\spW_0$ is 
         \prope{orthnormal} to the \structe{scaling subspace} $\spV_0$ ($\spW_0\orthog\spV_0$)\ifsxref{ortho}{thm:ortho_qmr}.
\end{tabular}

%---------------------------------------
\begin{theorem}
\label{thm:wavstrct_cqf}
%---------------------------------------
Let $\wavsys$ be a \structe{wavelet system} \xref{def:wavsys}.
Let $\Dg(\omega)$ be the \ope{DTFT} \xref{def:dtft} and $\Zg(z)$ the \ope{Z-transform} \xref{def:opZ} of $\seqn{g_n}$.
\thmbox{
  \begin{array}{>{\ds}rc >{\ds}rcl @{\qquad}D}
  \mcom{g_n = \pm(-1)^n h^\ast_{\xN-n},\,{\scy\xN\in\Z}}{\structe{conjugate quadrature filter}}
      &\iff&     \Dg(\omega)                   &=& \pm (-1)^\xN e^{-i\omega\xN} \Dh^\ast(\omega+\pi)\Big|_{\omega=\pi}   & (1)
    \\&\implies& \sum_{n\in\Z} (-1)^n g_n      &=& \sqrt{2}                                                              & (2)
    \\&\iff&     \Zg(z)\Big|_{z=-1}            &=& \sqrt{2}                                                              & (3)
    \\&\iff&     \Dg(\omega)\Big|_{\omega=\pi} &=& \sqrt{2}                                                              & (4)
  \end{array}}
\end{theorem}
\begin{proof}
  \begin{enumerate}
    \item Proof that CQF$\iff$(1): by \prefp{thm:cqf}

    \item Proof that CQF$\implies$(4):
      \begin{align*}
        \Dg(\pi)
          &= \Dg(\omega)\Big|_{\omega=\pi}
        \\&= \pm (-1)^\xN e^{-i\omega\xN} \Dh^\ast(\omega+\pi)\Big|_{\omega=\pi}
          && \text{by \thme{CQF theorem}}
          && \text{\xref{thm:cqf}}
        \\&= \pm (-1)^\xN e^{-i\pi\xN} \Dh^\ast(2\pi)
        \\&= \pm (-1)^\xN (-1)^\xN \Dh^\ast(0)
          && \text{by \thme{DTFT periodicity}}
          && \text{\xref{prop:dtft_2pi}}
        \\&= \sqrt{2}
          && \text{by \thme{admissibility condition}}
          && \text{\xref{thm:admiss}}
      \end{align*}

    \item Proof that (2)$\iff$(3)$\iff$(4): by \prefp{prop:dsp_zminone}
  \end{enumerate}
\end{proof}

%=======================================
\section{Support size}
%=======================================
%--------------------------------------
\begin{theorem}[\thmd{support size}]
\citetbl{
  \citerppg{mallat}{243}{244}{012466606X}
  }
\label{thm:support}
%--------------------------------------
Let $\wavsys$ be a \structe{wavelet system} \xref{def:wavsys}
induced by the \thme{CQF conditions} \xref{thm:wavstrct_cqf}.
Let $\support\ff$ be the support of a function $\ff$ \xref{def:support}.
\thmbox{
  \begin{array}{>{\ds}rc>{\ds}l}
  \support\fphi &=& \support\fh
  \\
  %\xN\in\Zo \text{ and }  g_n  = \pm(-1)^\xN\fh(\xN-n) \quad\implies\quad
  \support\fpsi &=& \intcc{\frac{\xN-(n_2-n_1)}{2}}{\frac{\xN+(n_2-n_1)}{2}}
  \end{array}
  }
\end{theorem}
\begin{proof}
\begin{enumerate}
  \item Proof that $\support\fphi = \support\fh$: by \prefpp{thm:mra_support}

  %\item Definitions: \label{item:wavstrct_support_def}
  %  \\$\begin{array}{rcl}
  %    \support\fphi &\eqd& [a,b] \\
  %    \support\fh   &\eqd& [k,m].
  %   \end{array}$

  %\item lemma: \label{ilem:mra_support_lemma}
  %  \\$\support\fphi(x)=\brs{a,b} \quad\iff\quad \support\fphi(2x)=\brs{\frac{a}{2},\frac{b}{2}}$
  %
  %\item lemma: \label{ilem:mra_support_mpy}
  %  \\$\support\brs{\lambda\fphi(x)}=\support\brs{\fphi(x)}\quad\forall\lambda\in\R\setd0$.

  \item Proof that $\support \psi=\intcc{\frac{\xN-(n_2-n_1)}{2}}{\frac{\xN+(n_2-n_1)}{2}}$:
      \begin{align*}
        \support\fpsi(x)
          &= \support \brs{ \sum_{n\in\Z} g_n \opDil\opTrn^n\fphi(x) }
          && \text{by \thme{wavelet dilation equation}} 
          && \text{\xref{thm:g->psi}}
        \\&= \support \brs{\sqrt{2}\sum_{n\in\Z}  g_n \fphi(2x-n)}
          && \text{by definition of $\opTrn$ and $\opDil$} 
          && \text{\xref{def:opTD}}
        \\&= \support \brs{\sqrt{2}\sum_{n\in\Z} \pm (-1)^\xN \fh(\xN-n)\fphi(2x-n)}
          && \text{by \thme{CQF conditions}} && \text{\xref{thm:wavstrct_cqf}}
        \\&= \support \brs{\sum_{n\in\Z} \fh(\xN-n)\fphi(2x-n)}
          && \text{by \prefpp{ilem:mra_support_mpy}}
        \\&= \cls{\set{x\in\R}{\sum_{n\in\Z} \fh(\xN-n)\fphi(2x-n)\ne 0}}
          && \text{by definition of $\support$} && \text{\xref{def:support}}
        \\&= \intcc{\frac{n_1}{2}+\frac{\xN-n_2}{2}} {\frac{n_2}{2}+\frac{\xN-n_1}{2}}
        \\&= \intcc{\frac{\xN-(n_2-n_1)}{2}}         {\frac{\xN+(n_2-n_1)}{2}}
      \end{align*}
\end{enumerate}
\end{proof}

%--------------------------------------
\begin{example}
%--------------------------------------
Here are some examples using \fncte{Daubechies wavelet function}s.
\exbox{\begin{array}{NNN}
%    \includegraphics{graphics/b3_g.pdf}
    \includegraphics{graphics/d1_psi_g.pdf}
   &\includegraphics{graphics/d2_psi_g.pdf}
   &\includegraphics{graphics/d3_psi_g.pdf}
   %&\includegraphics{graphics/d4_psi_g.pdf}
  %\\\fncte{B-spline of order 2}
  \\\fncte{Daubechies-1}
   &\fncte{Daubechies-2}
   &\fncte{Daubechies-3}
   %&\fncte{Daubechies-4 wavelet function}
  \\\xref{ex:dau-p1}&\xref{ex:dau-p2}&\xref{ex:dau-p3}
\end{array}}
\end{example}

%=======================================
\section{Examples}
%=======================================
%Under the very general constraints of this chapter, I know of no wavelet examples.
No further examples of wavelets are presented in this section. 
Examples begin in the next chapter which is about a property called the \prope{partition of unity}.
%The very minimal of requirements, it seems is a \prope{partition of unity} \xref{chp:pounity}.
Other design constraints leading to wavelets with more ``powerful" properties include 
\prope{vanishing moments} \xref{chp:vanish}, \prope{orthonormality}\ifsxref{ortho}{chp:ortho},
\prope{compact support}\ifsxref{compactp}{chp:compactp}, and \prope{minimum phase} \xref{def:ztr_minphase}.

%Here are some examples of \structe{wavelet systems} \xref{def:wavsys}:
%\begin{longtable}{|l||ll||c|c|c|c|c|}
%  \hline
%  Name   & \mc{2}{||c|}{Reference} & \rotatebox{75}{\prope{partition of unity}} 
%                                   & \rotatebox{75}{\prope{vanishing moments}} 
%                                   & \rotatebox{75}{\prope{orthonormality}} 
%                                   & \rotatebox{75}{\prope{compact support}}
%                                   & \rotatebox{75}{\prope{minimum phase}}
%%         &          &       & \xref{chp:pounity}         & \xref{chp:vanish}         & \xref{chp:ortho}       & \xref{chp:compactp}
%  \\\hline
%  %Haar             & \scs\pref{ex:pun_n=2}       & \scs\prefpo{ex:pun_n=2}       & $\checkmark$ & 1 & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
%  %order 1 B-spline & \scs\pref{ex:sw_gh_tent}    & \scs\prefpo{ex:sw_gh_tent}    & $\checkmark$ & 2 & $          $ & $          $ & $          $ \\
%  %order 3 B-spline & \scs\pref{ex:sw_gh_bspline} & \scs\prefpo{ex:sw_gh_bspline} & $\checkmark$ & 4 & $          $ & $          $ & $          $ \\
%  order 0 B-spline & \pref{ex:N0_hg}                          & \prefpo{ex:N0_hg} & $\checkmark$ & 1 & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
%  order 1 B-spline & \pref{ex:N1_hg}                          & \prefpo{ex:N1_hg} & $\checkmark$ & 2 & $          $ & $          $ & $          $ \\
%  order 2 B-spline & \pref{ex:N2_hg}                          & \prefpo{ex:N2_hg} & $\checkmark$ & 4 & $          $ & $          $ & $          $ \\
%  Daubechies-p2    & \ifdochas{compactp}{\pref{ex:dau-p2}}    & \ifdochas{compactp}{\prefpo{ex:dau-p2}}        & $\checkmark$ & 2 & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
%  Daubechies-p3    & \ifdochas{compactp}{\pref{ex:dau-p3}}    & \ifdochas{compactp}{\prefpo{ex:dau-p3}}        & $\checkmark$ & 3 & $\checkmark$ & $\checkmark$ & $\checkmark$ \\
%  Symlet-p4        & \ifdochas{compactp}{\pref{ex:symlet_p4}} & \ifdochas{compactp}{\prefpo{ex:symlet_p4}}     & $\checkmark$ & 4 & $\checkmark$ & $\checkmark$ & $          $ \\
%  \hline
%\end{longtable}




%================================================================================
%================================================================================
%================================================================================
%================================================================================
%================================================================================

%\paragraph{Fourier Transform.}
%One of the most widely used transforms is the Fourier transform.
%The Fourier Transform is an integral operator with an exponential kernel.
%And what is so special about exponential kernels?
%Is it just that they were discovered sooner than other kernels with other transforms?
%The answer in general is ``no".
%The exponential has two properties that makes it extremely special:
%  \begin{liste}
%    \item The exponential is an eigenvalue of any LTI operator \xref{thm:Le=he}
%    \item The exponential generates a continuous point spectrum for the differential operator
%          \xref{thm:spec_D}
%  \end{liste}
%
%\thmbox{
%  \left.\begin{array}{ll}
%    1. & \text{$\opL$ is linear and} \\
%    2. & \text{$\opL$ is time-invariant}
%  \end{array}\right\}
%  \qquad\implies\qquad
%    \opL \lkerne{t}{s}
%    =
%    \mcomr{\Lh^\ast(-s)}{eigenvalue} \mcoml{\lkerne{t}{s}}{eigenvector}
%  }
%
%
%What makes wavelet system unique from other analysis systems
%(such as Fourier analysis) is its \hie{subspace architecture}.
%In this section, we present this architecture using four representations:
%
%\begin{tabular}{lp{\tw/2}ll}
%  \circOne   & lattice of subspaces             \dotfill&\pref{sec:wav_lat_subspace} & \xref{sec:wav_lat_subspace} \\
%  \circTwo   & lattice of projection operators  \dotfill&\pref{sec:wav_lat_op}       & \xref{sec:wav_lat_op} \\
%  \circThree & lattice of bases vectors         \dotfill&\pref{sec:wav_lat_bases}    & \xref{sec:wav_lat_bases} \\
%  \circFour  & lattice of bases coefficients    \dotfill&\pref{sec:wav_lat_coef}     & \xref{sec:wav_lat_coef} \\
%\end{tabular}
%
%\prefp{thm:wav_lat_iso} will show that all four of these representations are
%essentially equivalent (are isomorphisms).
%The wavelet system itself is simply a collection of the projection operators
%\xref{def:wav_transform} found in the wavelet operator lattice.


